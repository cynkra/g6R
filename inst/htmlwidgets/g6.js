/*! For license information please see g6.js.LICENSE.txt */
(()=>{var t={2:(t,e,n)=>{var i=n(2199),r=n(4664),a=n(5950);t.exports=function(t){return i(t,a,r)}},79:(t,e,n)=>{var i=n(3702),r=n(80),a=n(4739),o=n(8655),s=n(1175);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},80:(t,e,n)=>{var i=n(6025),r=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=i(e,t);return!(n<0||(n==e.length-1?e.pop():r.call(e,n,1),--this.size,0))}},104:(t,e,n)=>{var i=n(3661);function r(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],a=n.cache;if(a.has(r))return a.get(r);var o=t.apply(this,i);return n.cache=a.set(r,o)||a,o};return n.cache=new(r.Cache||i),n}r.Cache=i,t.exports=r},117:(t,e,n)=>{var i;try{i={clone:n(2629),constant:n(7334),each:n(6135),filter:n(7612),has:n(1448),isArray:n(6449),isEmpty:n(2193),isFunction:n(1882),isUndefined:n(2216),keys:n(5950),map:n(5378),reduce:n(860),size:n(7091),transform:n(9752),union:n(299),values:n(5880)}}catch(t){}i||(i=window._),t.exports=i},124:(t,e,n)=>{var i=n(9325);t.exports=function(){return i.Date.now()}},135:(t,e,n)=>{var i=n(6857),r=n(3988);function a(t,e,n,i,a,o){var s={width:0,height:0,rank:o,borderType:e},l=a[e][o-1],u=r.addDummyNode(t,"border",s,n);a[e][o]=u,t.setParent(u,i),l&&t.setEdge(l,u,{weight:1})}t.exports=function(t){i.forEach(t.children(),(function e(n){var r=t.children(n),o=t.node(n);if(r.length&&i.forEach(r,e),i.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var s=o.minRank,l=o.maxRank+1;s<l;++s)a(t,"borderLeft","_bl",n,o,s),a(t,"borderRight","_br",n,o,s)}}))}},181:t=>{t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},228:t=>{"use strict";var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(t,e,i,a,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new r(i,a||t,o),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},s.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,o=new Array(a);r<a;r++)o[r]=i[r].fn;return o},s.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},s.prototype.emit=function(t,e,i,r,a,o){var s=n?n+t:t;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,i),!0;case 4:return c.fn.call(c.context,e,i,r),!0;case 5:return c.fn.call(c.context,e,i,r,a),!0;case 6:return c.fn.call(c.context,e,i,r,a,o),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,i);break;case 4:c[u].fn.call(c[u].context,e,i,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,i,r){var a=n?n+t:t;if(!this._events[a])return this;if(!e)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==e||r&&!s.once||i&&s.context!==i||o(this,a);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==e||r&&!s[l].once||i&&s[l].context!==i)&&u.push(s[l]);u.length?this._events[a]=1===u.length?u[0]:u:o(this,a)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s},270:(t,e,n)=>{var i=n(7068),r=n(346);t.exports=function t(e,n,a,o,s){return e===n||(null==e||null==n||!r(e)&&!r(n)?e!=e&&n!=n:i(e,n,a,o,t,s))}},289:(t,e,n)=>{var i=n(2651);t.exports=function(t){return i(this,t).get(t)}},294:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},299:(t,e,n)=>{var i=n(3120),r=n(9302),a=n(5765),o=n(3693),s=r((function(t){return a(i(t,1,o,!0))}));t.exports=s},317:t=>{t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}},346:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},361:t=>{var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,n){var i=typeof t;return!!(n=null==n?9007199254740991:n)&&("number"==i||"symbol"!=i&&e.test(t))&&t>-1&&t%1==0&&t<n}},392:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},426:t=>{var e=Object.prototype.hasOwnProperty;t.exports=function(t,n){return null!=t&&e.call(t,n)}},498:(t,e,n)=>{var i=n(9888);t.exports=function(t){try{i(t)}catch(t){if(t instanceof i.CycleException)return!1;throw t}return!0}},514:(t,e,n)=>{var i=n(4932);t.exports=function(t,e){return i(e,(function(e){return t[e]}))}},583:(t,e,n)=>{var i=n(7237),r=n(7255),a=n(8586),o=n(7797);t.exports=function(t){return a(t)?i(o(t)):r(t)}},631:(t,e,n)=>{var i=n(8077),r=n(9326);t.exports=function(t,e){return null!=t&&r(t,e,i)}},641:(t,e,n)=>{var i=n(6649),r=n(5950);t.exports=function(t,e){return t&&i(t,e,r)}},659:(t,e,n)=>{var i=n(1873),r=Object.prototype,a=r.hasOwnProperty,o=r.toString,s=i?i.toStringTag:void 0;t.exports=function(t){var e=a.call(t,s),n=t[s];try{t[s]=void 0;var i=!0}catch(t){}var r=o.call(t);return i&&(e?t[s]=n:delete t[s]),r}},673:(t,e,n)=>{"use strict";var i=n(788),r=n(3718);const a=" ".repeat(2),o=" ".repeat(4);function s(t,e={}){const{maxRows:n=15,maxColumns:i=10,maxNumSize:r=8,padMinus:s="auto"}=e;return`${t.constructor.name} {\n${a}[\n${o}${function(t,e,n,i,r){const{rows:a,columns:s}=t,u=Math.min(a,e),c=Math.min(s,n),h=[];if("auto"===r){r=!1;t:for(let e=0;e<u;e++)for(let n=0;n<c;n++)if(t.get(e,n)<0){r=!0;break t}}for(let e=0;e<u;e++){let n=[];for(let a=0;a<c;a++)n.push(l(t.get(e,a),i,r));h.push(`${n.join(" ")}`)}return c!==s&&(h[h.length-1]+=` ... ${s-n} more columns`),u!==a&&h.push(`... ${a-e} more rows`),h.join(`\n${o}`)}(t,n,i,r,s)}\n${a}]\n${a}rows: ${t.rows}\n${a}columns: ${t.columns}\n}`}function l(t,e,n){return(t>=0&&n?` ${u(t,e-1)}`:u(t,e)).padEnd(e)}function u(t,e){let n=t.toString();if(n.length<=e)return n;let i=t.toFixed(e);if(i.length>e&&(i=t.toFixed(Math.max(0,e-(i.length-e)))),i.length<=e&&!i.startsWith("0.000")&&!i.startsWith("-0.000"))return i;let r=t.toExponential(e);return r.length>e&&(r=t.toExponential(Math.max(0,e-(r.length-e)))),r.slice(0)}function c(t,e,n){let i=n?t.rows:t.rows-1;if(e<0||e>i)throw new RangeError("Row index out of range")}function h(t,e,n){let i=n?t.columns:t.columns-1;if(e<0||e>i)throw new RangeError("Column index out of range")}function d(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function f(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function p(t,e){if(!i.isAnyArray(e))throw new TypeError("row indices must be an array");for(let n=0;n<e.length;n++)if(e[n]<0||e[n]>=t.rows)throw new RangeError("row indices are out of range")}function g(t,e){if(!i.isAnyArray(e))throw new TypeError("column indices must be an array");for(let n=0;n<e.length;n++)if(e[n]<0||e[n]>=t.columns)throw new RangeError("column indices are out of range")}function v(t,e,n,i,r){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(m("startRow",e),m("endRow",n),m("startColumn",i),m("endColumn",r),e>n||i>r||e<0||e>=t.rows||n<0||n>=t.rows||i<0||i>=t.columns||r<0||r>=t.columns)throw new RangeError("Submatrix indices are out of range")}function y(t,e=0){let n=[];for(let i=0;i<t;i++)n.push(e);return n}function m(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function b(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class x{static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("data length does not match given dimensions");let i=new w(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,n[r*e+t]);return i}static rowVector(t){let e=new w(1,t.length);for(let n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){let e=new w(t.length,1);for(let n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static zeros(t,e){return new w(t,e)}static ones(t,e){return new w(t,e).fill(1)}static rand(t,e,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{random:i=Math.random}=n;let r=new w(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++)r.set(n,t,i());return r}static randInt(t,e,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{min:i=0,max:r=1e3,random:a=Math.random}=n;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(r))throw new TypeError("max must be an integer");if(i>=r)throw new RangeError("min must be smaller than max");let o=r-i,s=new w(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++){let e=i+Math.round(a()*o);s.set(n,t,e)}return s}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);let i=Math.min(t,e),r=this.zeros(t,e);for(let t=0;t<i;t++)r.set(t,t,n);return r}static diag(t,e,n){let i=t.length;void 0===e&&(e=i),void 0===n&&(n=e);let r=Math.min(i,e,n),a=this.zeros(e,n);for(let e=0;e<r;e++)a.set(e,e,t[e]);return a}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,i=t.columns,r=new w(n,i);for(let a=0;a<n;a++)for(let n=0;n<i;n++)r.set(a,n,Math.min(t.get(a,n),e.get(a,n)));return r}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,i=t.columns,r=new this(n,i);for(let a=0;a<n;a++)for(let n=0;n<i;n++)r.set(a,n,Math.max(t.get(a,n),e.get(a,n)));return r}static checkMatrix(t){return x.isMatrix(t)?t:new w(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.call(this,e,n);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let n=0;n<this.columns;n++)t[e].push(this.get(e,n))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,n=-1,i=!0,r=!1;for(;t<this.rows&&i;){for(e=0,r=!1;e<this.columns&&!1===r;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(r=!0,n=e):(i=!1,r=!0);t++}return i}isReducedEchelonForm(){let t=0,e=0,n=-1,i=!0,r=!1;for(;t<this.rows&&i;){for(e=0,r=!1;e<this.columns&&!1===r;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(r=!0,n=e):(i=!1,r=!0);for(let n=e+1;n<this.rows;n++)0!==this.get(t,n)&&(i=!1);t++}return i}echelonForm(){let t=this.clone(),e=0,n=0;for(;e<t.rows&&n<t.columns;){let i=e;for(let r=e;r<t.rows;r++)t.get(r,n)>t.get(i,n)&&(i=r);if(0===t.get(i,n))n++;else{t.swapRows(e,i);let r=t.get(e,n);for(let i=n;i<t.columns;i++)t.set(e,i,t.get(e,i)/r);for(let i=e+1;i<t.rows;i++){let r=t.get(i,n)/t.get(e,n);t.set(i,n,0);for(let a=n+1;a<t.columns;a++)t.set(i,a,t.get(i,a)-t.get(e,a)*r)}e++,n++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,n=t.rows,i=n-1;for(;i>=0;)if(0===t.maxRow(i))i--;else{let r=0,a=!1;for(;r<n&&!1===a;)1===t.get(i,r)?a=!0:r++;for(let n=0;n<i;n++){let a=t.get(n,r);for(let o=r;o<e;o++){let e=t.get(n,o)-a*t.get(i,o);t.set(n,o,e)}}i--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:n=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let i=new w(this.rows*e,this.columns*n);for(let t=0;t<e;t++)for(let e=0;e<n;e++)i.setSubMatrix(this,this.rows*t,this.columns*e);return i}fill(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){c(this,t);let e=[];for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}getRowVector(t){return w.rowVector(this.getRow(t))}setRow(t,e){c(this,t),e=d(this,e);for(let n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){c(this,t),c(this,e);for(let n=0;n<this.columns;n++){let i=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,i)}return this}getColumn(t){h(this,t);let e=[];for(let n=0;n<this.rows;n++)e.push(this.get(n,t));return e}getColumnVector(t){return w.columnVector(this.getColumn(t))}setColumn(t,e){h(this,t),e=f(this,e);for(let n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){h(this,t),h(this,e);for(let n=0;n<this.rows;n++){let i=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,i)}return this}addRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){c(this,t);for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){h(this,t);for(let n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){b(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.get(n,i)>t&&(t=this.get(n,i),e[0]=n,e[1]=i);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){b(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.get(n,i)<t&&(t=this.get(n,i),e[0]=n,e[1]=i);return e}maxRow(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){c(this,t),b(this);let e=this.get(t,0),n=[t,0];for(let i=1;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i),n[1]=i);return n}minRow(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){c(this,t),b(this);let e=this.get(t,0),n=[t,0];for(let i=1;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i),n[1]=i);return n}maxColumn(t){if(h(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){h(this,t),b(this);let e=this.get(0,t),n=[0,t];for(let i=1;i<this.rows;i++)this.get(i,t)>e&&(e=this.get(i,t),n[0]=i);return n}minColumn(t){if(h(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){h(this,t),b(this);let e=this.get(0,t),n=[0,t];for(let i=1;i<this.rows;i++)this.get(i,t)<e&&(e=this.get(i,t),n[0]=i);return n}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let n=0;n<t;n++)e.push(this.get(n,n));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){x.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let n=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i];return n}mmul(t){t=w.checkMatrix(t);let e=this.rows,n=this.columns,i=t.columns,r=new w(e,i),a=new Float64Array(n);for(let o=0;o<i;o++){for(let e=0;e<n;e++)a[e]=t.get(e,o);for(let t=0;t<e;t++){let e=0;for(let i=0;i<n;i++)e+=this.get(t,i)*a[i];r.set(t,o,e)}}return r}mpow(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");let e=w.eye(this.rows),n=this;for(let i=t;i>=1;i/=2)1&i&&(e=e.mmul(n)),n=n.mmul(n);return e}strassen2x2(t){t=w.checkMatrix(t);let e=new w(2,2);const n=this.get(0,0),i=t.get(0,0),r=this.get(0,1),a=t.get(0,1),o=this.get(1,0),s=t.get(1,0),l=this.get(1,1),u=t.get(1,1),c=(n+l)*(i+u),h=(o+l)*i,d=n*(a-u),f=l*(s-i),p=(n+r)*u,g=c+f-p+(r-l)*(s+u),v=d+p,y=h+f,m=c-h+d+(o-n)*(i+a);return e.set(0,0,g),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=w.checkMatrix(t);let e=new w(3,3);const n=this.get(0,0),i=this.get(0,1),r=this.get(0,2),a=this.get(1,0),o=this.get(1,1),s=this.get(1,2),l=this.get(2,0),u=this.get(2,1),c=this.get(2,2),h=t.get(0,0),d=t.get(0,1),f=t.get(0,2),p=t.get(1,0),g=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),b=t.get(2,2),x=(n-a)*(-d+g),E=(-n+a+o)*(h-d+g),k=(a+o)*(-h+d),M=n*h,S=(-n+l+u)*(h-f+v),N=(-n+l)*(f-v),T=(l+u)*(-h+f),A=(-r+u+c)*(g+y-m),O=(r-c)*(g-m),P=r*y,C=(u+c)*(-y+m),R=(-r+o+s)*(v+y-b),L=(r-s)*(v-b),D=(o+s)*(-y+b),I=M+P+i*p,_=(n+i+r-a-o-u-c)*g+E+k+M+A+P+C,B=M+S+T+(n+i+r-o-s-l-u)*v+P+R+D,F=x+o*(-h+d+p-g-v-y+b)+E+M+P+R+L,j=x+E+k+M+s*m,G=P+R+L+D+a*f,z=M+S+N+u*(-h+f+p-g-v-y+m)+A+O+P,V=A+O+P+C+l*d,W=M+S+N+T+c*b;return e.set(0,0,I),e.set(0,1,_),e.set(0,2,B),e.set(1,0,F),e.set(1,1,j),e.set(1,2,G),e.set(2,0,z),e.set(2,1,V),e.set(2,2,W),e}mmulStrassen(t){t=w.checkMatrix(t);let e=this.clone(),n=e.rows,i=e.columns,r=t.rows,a=t.columns;function o(t,e,n){let i=t.rows,r=t.columns;if(i===e&&r===n)return t;{let i=x.zeros(e,n);return i=i.setSubMatrix(t,0,0),i}}i!==r&&console.warn(`Multiplying ${n} x ${i} and ${r} x ${a} matrix: dimensions do not match.`);let s=Math.max(n,r),l=Math.max(i,a);return e=o(e,s,l),function t(e,n,i,r){if(i<=512||r<=512)return e.mmul(n);i%2==1&&r%2==1?(e=o(e,i+1,r+1),n=o(n,i+1,r+1)):i%2==1?(e=o(e,i+1,r),n=o(n,i+1,r)):r%2==1&&(e=o(e,i,r+1),n=o(n,i,r+1));let a=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),l=e.subMatrix(0,a-1,0,s-1),u=n.subMatrix(0,a-1,0,s-1),c=e.subMatrix(0,a-1,s,e.columns-1),h=n.subMatrix(0,a-1,s,n.columns-1),d=e.subMatrix(a,e.rows-1,0,s-1),f=n.subMatrix(a,n.rows-1,0,s-1),p=e.subMatrix(a,e.rows-1,s,e.columns-1),g=n.subMatrix(a,n.rows-1,s,n.columns-1),v=t(x.add(l,p),x.add(u,g),a,s),y=t(x.add(d,p),u,a,s),m=t(l,x.sub(h,g),a,s),b=t(p,x.sub(f,u),a,s),E=t(x.add(l,c),g,a,s),w=t(x.sub(d,l),x.add(u,h),a,s),k=t(x.sub(c,p),x.add(f,g),a,s),M=x.add(v,b);M.sub(E),M.add(k);let S=x.add(m,E),N=x.add(y,b),T=x.sub(v,y);T.add(m),T.add(w);let A=x.zeros(2*M.rows,2*M.columns);return A=A.setSubMatrix(M,0,0),A=A.setSubMatrix(S,M.rows,0),A=A.setSubMatrix(N,0,M.columns),A=A.setSubMatrix(T,M.rows,M.columns),A.subMatrix(0,i-1,0,r-1)}(e,t=o(t,s,l),s,l)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let i=new w(this.rows,this.columns);for(let t=0;t<this.rows;t++){const a=this.getRow(t);a.length>0&&r(a,{min:e,max:n,output:a}),i.setRow(t,a)}return i}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let i=new w(this.rows,this.columns);for(let t=0;t<this.columns;t++){const a=this.getColumn(t);a.length&&r(a,{min:e,max:n,output:a}),i.setColumn(t,a)}return i}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let n=0;n<t;n++){let t=this.get(e,n),i=this.get(e,this.columns-1-n);this.set(e,n,i),this.set(e,this.columns-1-n,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let n=0;n<t;n++){let t=this.get(n,e),i=this.get(this.rows-1-n,e);this.set(n,e,i),this.set(this.rows-1-n,e,t)}return this}kroneckerProduct(t){t=w.checkMatrix(t);let e=this.rows,n=this.columns,i=t.rows,r=t.columns,a=new w(e*i,n*r);for(let o=0;o<e;o++)for(let e=0;e<n;e++)for(let n=0;n<i;n++)for(let s=0;s<r;s++)a.set(i*o+n,r*e+s,this.get(o,e)*t.get(n,s));return a}kroneckerSum(t){if(t=w.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,n=t.rows,i=this.kroneckerProduct(w.eye(n,n)),r=w.eye(e,e).kroneckerProduct(t);return i.add(r)}transpose(){let t=new w(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t=E){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=E){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,i){v(this,t,e,n,i);let r=new w(e-t+1,i-n+1);for(let a=t;a<=e;a++)for(let e=n;e<=i;e++)r.set(a-t,e-n,this.get(a,e));return r}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let i=new w(t.length,n-e+1);for(let r=0;r<t.length;r++)for(let a=e;a<=n;a++){if(t[r]<0||t[r]>=this.rows)throw new RangeError(`Row index out of range: ${t[r]}`);i.set(r,a-e,this.get(t[r],a))}return i}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let i=new w(n-e+1,t.length);for(let r=0;r<t.length;r++)for(let a=e;a<=n;a++){if(t[r]<0||t[r]>=this.columns)throw new RangeError(`Column index out of range: ${t[r]}`);i.set(a-e,r,this.get(a,t[r]))}return i}setSubMatrix(t,e,n){if((t=w.checkMatrix(t)).isEmpty())return this;v(this,e,e+t.rows-1,n,n+t.columns-1);for(let i=0;i<t.rows;i++)for(let r=0;r<t.columns;r++)this.set(e+i,n+r,t.get(i,r));return this}selection(t,e){p(this,t),g(this,e);let n=new w(t.length,e.length);for(let i=0;i<t.length;i++){let r=t[i];for(let t=0;t<e.length;t++){let a=e[t];n.set(i,t,this.get(r,a))}}return n}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let n=0;n<t;n++)e+=this.get(n,n);return e}clone(){return this.constructor.copy(this,new w(this.rows,this.columns))}static copy(t,e){for(const[n,i,r]of t.entries())e.set(n,i,r);return e}sum(t){switch(t){case"row":return function(t){let e=y(t.rows);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[n]+=t.get(n,i);return e}(this);case"column":return function(t){let e=y(t.columns);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[i]+=t.get(n,i);return e}(this);case void 0:return function(t){let e=0;for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)e+=t.get(n,i);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=y(t.rows,1);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[n]*=t.get(n,i);return e}(this);case"column":return function(t){let e=y(t.columns,1);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[i]*=t.get(n,i);return e}(this);case void 0:return function(t){let e=1;for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)e*=t.get(n,i);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:n=!0,mean:r=this.mean(t)}=e;if("boolean"!=typeof n)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!i.isAnyArray(r))throw new TypeError("mean must be an array");return function(t,e,n){const i=t.rows,r=t.columns,a=[];for(let o=0;o<i;o++){let i=0,s=0,l=0;for(let e=0;e<r;e++)l=t.get(o,e)-n[o],i+=l,s+=l*l;e?a.push((s-i*i/r)/(r-1)):a.push((s-i*i/r)/r)}return a}(this,n,r);case"column":if(!i.isAnyArray(r))throw new TypeError("mean must be an array");return function(t,e,n){const i=t.rows,r=t.columns,a=[];for(let o=0;o<r;o++){let r=0,s=0,l=0;for(let e=0;e<i;e++)l=t.get(e,o)-n[o],r+=l,s+=l*l;e?a.push((s-r*r/i)/(i-1)):a.push((s-r*r/i)/i)}return a}(this,n,r);case void 0:if("number"!=typeof r)throw new TypeError("mean must be a number");return function(t,e,n){const i=t.rows,r=t.columns,a=i*r;let o=0,s=0,l=0;for(let e=0;e<i;e++)for(let i=0;i<r;i++)l=t.get(e,i)-n,o+=l,s+=l*l;return e?(s-o*o/a)/(a-1):(s-o*o/a)/a}(this,n,r);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const n=this.variance(t,e);if(void 0===t)return Math.sqrt(n);for(let t=0;t<n.length;t++)n[t]=Math.sqrt(n[t]);return n}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:n=this.mean(t)}=e;switch(t){case"row":if(!i.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)-e[n])}(this,n),this;case"column":if(!i.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)-e[i])}(this,n),this;case void 0:if("number"!=typeof n)throw new TypeError("center must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)-e)}(this,n),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let n=e.scale;switch(t){case"row":if(void 0===n)n=function(t){const e=[];for(let n=0;n<t.rows;n++){let i=0;for(let e=0;e<t.columns;e++)i+=t.get(n,e)**2/(t.columns-1);e.push(Math.sqrt(i))}return e}(this);else if(!i.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)/e[n])}(this,n),this;case"column":if(void 0===n)n=function(t){const e=[];for(let n=0;n<t.columns;n++){let i=0;for(let e=0;e<t.rows;e++)i+=t.get(e,n)**2/(t.rows-1);e.push(Math.sqrt(i))}return e}(this);else if(!i.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)/e[i])}(this,n),this;case void 0:if(void 0===n)n=function(t){const e=t.size-1;let n=0;for(let i=0;i<t.columns;i++)for(let r=0;r<t.rows;r++)n+=t.get(r,i)**2/e;return Math.sqrt(n)}(this);else if("number"!=typeof n)throw new TypeError("scale must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)/e)}(this,n),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return s(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function E(t,e){return t-e}x.prototype.klass="Matrix","undefined"!=typeof Symbol&&(x.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return s(this)}),x.random=x.rand,x.randomInt=x.randInt,x.diagonal=x.diag,x.prototype.diagonal=x.prototype.diag,x.identity=x.eye,x.prototype.negate=x.prototype.neg,x.prototype.tensorProduct=x.prototype.kroneckerProduct;class w extends x{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let n=0;n<t;n++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(t,e){if(super(),w.isMatrix(t))this.#t(t.rows,t.columns),w.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else{if(!i.isAnyArray(t))throw new TypeError("First argument must be a positive number or an array");{const n=t;if("number"!=typeof(e=(t=n.length)?n[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let i=0;i<t;i++){if(n[i].length!==e)throw new RangeError("Inconsistent array dimensions");if(!n[i].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(n[i]))}this.rows=t,this.columns=e}}}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}removeRow(t){return c(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),c(this,t,!0),e=Float64Array.from(d(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){h(this,t);for(let e=0;e<this.rows;e++){const n=new Float64Array(this.columns-1);for(let i=0;i<t;i++)n[i]=this.data[e][i];for(let i=t+1;i<this.columns;i++)n[i-1]=this.data[e][i];this.data[e]=n}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),h(this,t,!0),e=f(this,e);for(let n=0;n<this.rows;n++){const i=new Float64Array(this.columns+1);let r=0;for(;r<t;r++)i[r]=this.data[n][r];for(i[r++]=e[n];r<this.columns+1;r++)i[r]=this.data[n][r-1];this.data[n]=i}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t.get(e,n));return this},t.add=function(t,n){return new e(t).add(n)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t.get(e,n));return this},t.sub=function(t,n){return new e(t).sub(n)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t.get(e,n));return this},t.mul=function(t,n){return new e(t).mul(n)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t.get(e,n));return this},t.div=function(t,n){return new e(t).div(n)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t.get(e,n));return this},t.mod=function(t,n){return new e(t).mod(n)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t.get(e,n));return this},t.and=function(t,n){return new e(t).and(n)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t.get(e,n));return this},t.or=function(t,n){return new e(t).or(n)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t.get(e,n));return this},t.xor=function(t,n){return new e(t).xor(n)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t.get(e,n));return this},t.leftShift=function(t,n){return new e(t).leftShift(n)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t.get(e,n));return this},t.signPropagatingRightShift=function(t,n){return new e(t).signPropagatingRightShift(n)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t.get(e,n));return this},t.rightShift=function(t,n){return new e(t).rightShift(n)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,n){return new e(t).pow(n)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)**t.get(e,n));return this}}(x,w);class k extends x{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return w.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),w.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=w.copy(t,new w(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new w(t,t);else if(this.#e=new w(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new k(this.diagonalSize);for(const[e,n,i]of this.upperRightEntries())t.set(e,n,i);return t}toMatrix(){return new w(this)}get(t,e){return this.#e.get(t,e)}set(t,e,n){return this.#e.set(t,e,n),this.#e.set(e,t,n),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const n=e.slice();return n.splice(t,1),this.#e.addRow(t,n),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[n,i]of t.entries())i||e.push(n);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let n=0,i=0,r=0;r<e.length;r++)e[r]=this.get(i,n),++n>=t&&(n=++i);return e}static fromCompact(t){const e=t.length,n=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const i=new k(n);for(let r=0,a=0,o=0;o<e;o++)i.set(r,a,t[o]),++r>=n&&(r=++a);return i}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield[t,e,n],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield n,++e>=this.diagonalSize&&(e=++t)}}}k.prototype.klassType="SymmetricMatrix";class M extends k{static isDistanceMatrix(t){return k.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,n){return t===e&&(n=0),super.set(t,e,n)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new k(this)}clone(){const t=new M(this.diagonalSize);for(const[e,n,i]of this.upperRightEntries())e!==n&&t.set(e,n,i);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let n=1,i=0,r=0;r<e.length;r++)e[r]=this.get(i,n),++n>=t&&(n=1+ ++i);return e}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const n=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const i=new this(n);for(let r=1,a=0,o=0;o<e;o++)i.set(r,a,t[o]),++r>=n&&(r=1+ ++a);return i}}M.prototype.klassSubType="DistanceMatrix";class S extends x{constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}}class N extends S{constructor(t,e,n){p(t,e),g(t,n),super(t,e.length,n.length),this.rowIndices=e,this.columnIndices=n}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class T extends x{constructor(t,e={}){const{rows:n=1}=e;if(t.length%n!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=n,this.columns=t.length/n,this.data=t}set(t,e,n){let i=this._calculateIndex(t,e);return this.data[i]=n,this}get(t,e){let n=this._calculateIndex(t,e);return this.data[n]}_calculateIndex(t,e){return t*this.columns+e}}class A extends x{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}}class O{constructor(t){let e,n,i,r,a,o,s,l,u,c=(t=A.checkMatrix(t)).clone(),h=c.rows,d=c.columns,f=new Float64Array(h),p=1;for(e=0;e<h;e++)f[e]=e;for(l=new Float64Array(h),n=0;n<d;n++){for(e=0;e<h;e++)l[e]=c.get(e,n);for(e=0;e<h;e++){for(u=Math.min(e,n),a=0,i=0;i<u;i++)a+=c.get(e,i)*l[i];l[e]-=a,c.set(e,n,l[e])}for(r=n,e=n+1;e<h;e++)Math.abs(l[e])>Math.abs(l[r])&&(r=e);if(r!==n){for(i=0;i<d;i++)o=c.get(r,i),c.set(r,i,c.get(n,i)),c.set(n,i,o);s=f[r],f[r]=f[n],f[n]=s,p=-p}if(n<h&&0!==c.get(n,n))for(e=n+1;e<h;e++)c.set(e,n,c.get(e,n)/c.get(n,n))}this.LU=c,this.pivotVector=f,this.pivotSign=p}isSingular(){let t=this.LU,e=t.columns;for(let n=0;n<e;n++)if(0===t.get(n,n))return!0;return!1}solve(t){t=w.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let n,i,r,a=t.columns,o=t.subMatrixRow(this.pivotVector,0,a-1),s=e.columns;for(r=0;r<s;r++)for(n=r+1;n<s;n++)for(i=0;i<a;i++)o.set(n,i,o.get(n,i)-o.get(r,i)*e.get(n,r));for(r=s-1;r>=0;r--){for(i=0;i<a;i++)o.set(r,i,o.get(r,i)/e.get(r,r));for(n=0;n<r;n++)for(i=0;i<a;i++)o.set(n,i,o.get(n,i)-o.get(r,i)*e.get(n,r))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,n=t.columns;for(let i=0;i<n;i++)e*=t.get(i,i);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,i=new w(e,n);for(let r=0;r<e;r++)for(let e=0;e<n;e++)r>e?i.set(r,e,t.get(r,e)):r===e?i.set(r,e,1):i.set(r,e,0);return i}get upperTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,i=new w(e,n);for(let r=0;r<e;r++)for(let e=0;e<n;e++)r<=e?i.set(r,e,t.get(r,e)):i.set(r,e,0);return i}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function P(t,e){let n=0;return Math.abs(t)>Math.abs(e)?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0!==e?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0}class C{constructor(t){let e,n,i,r,a=(t=A.checkMatrix(t)).clone(),o=t.rows,s=t.columns,l=new Float64Array(s);for(i=0;i<s;i++){let t=0;for(e=i;e<o;e++)t=P(t,a.get(e,i));if(0!==t){for(a.get(i,i)<0&&(t=-t),e=i;e<o;e++)a.set(e,i,a.get(e,i)/t);for(a.set(i,i,a.get(i,i)+1),n=i+1;n<s;n++){for(r=0,e=i;e<o;e++)r+=a.get(e,i)*a.get(e,n);for(r=-r/a.get(i,i),e=i;e<o;e++)a.set(e,n,a.get(e,n)+r*a.get(e,i))}}l[i]=-t}this.QR=a,this.Rdiag=l}solve(t){t=w.checkMatrix(t);let e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let i,r,a,o,s=t.columns,l=t.clone(),u=e.columns;for(a=0;a<u;a++)for(r=0;r<s;r++){for(o=0,i=a;i<n;i++)o+=e.get(i,a)*l.get(i,r);for(o=-o/e.get(a,a),i=a;i<n;i++)l.set(i,r,l.get(i,r)+o*e.get(i,a))}for(a=u-1;a>=0;a--){for(r=0;r<s;r++)l.set(a,r,l.get(a,r)/this.Rdiag[a]);for(i=0;i<a;i++)for(r=0;r<s;r++)l.set(i,r,l.get(i,r)-l.get(a,r)*e.get(i,a))}return l.subMatrix(0,u-1,0,s-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,n=this.QR,i=n.columns,r=new w(i,i);for(t=0;t<i;t++)for(e=0;e<i;e++)t<e?r.set(t,e,n.get(t,e)):t===e?r.set(t,e,this.Rdiag[t]):r.set(t,e,0);return r}get orthogonalMatrix(){let t,e,n,i,r=this.QR,a=r.rows,o=r.columns,s=new w(a,o);for(n=o-1;n>=0;n--){for(t=0;t<a;t++)s.set(t,n,0);for(s.set(n,n,1),e=n;e<o;e++)if(0!==r.get(n,n)){for(i=0,t=n;t<a;t++)i+=r.get(t,n)*s.get(t,e);for(i=-i/r.get(n,n),t=n;t<a;t++)s.set(t,e,s.get(t,e)+i*r.get(t,n))}}return s}}class R{constructor(t,e={}){if((t=A.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let n=t.rows,i=t.columns;const{computeLeftSingularVectors:r=!0,computeRightSingularVectors:a=!0,autoTranspose:o=!1}=e;let s,l=Boolean(r),u=Boolean(a),c=!1;if(n<i)if(o){s=t.transpose(),n=s.rows,i=s.columns,c=!0;let e=l;l=u,u=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let h=Math.min(n,i),d=Math.min(n+1,i),f=new Float64Array(d),p=new w(n,h),g=new w(i,i),v=new Float64Array(i),y=new Float64Array(n),m=new Float64Array(d);for(let t=0;t<d;t++)m[t]=t;let b=Math.min(n-1,i),x=Math.max(0,Math.min(i-2,n)),E=Math.max(b,x);for(let t=0;t<E;t++){if(t<b){f[t]=0;for(let e=t;e<n;e++)f[t]=P(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<n;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<i;e++){if(t<b&&0!==f[t]){let i=0;for(let r=t;r<n;r++)i+=s.get(r,t)*s.get(r,e);i=-i/s.get(t,t);for(let r=t;r<n;r++)s.set(r,e,s.get(r,e)+i*s.get(r,t))}v[e]=s.get(t,e)}if(l&&t<b)for(let e=t;e<n;e++)p.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<i;e++)v[t]=P(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<i;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<n&&0!==v[t]){for(let e=t+1;e<n;e++)y[e]=0;for(let e=t+1;e<n;e++)for(let n=t+1;n<i;n++)y[e]+=v[n]*s.get(e,n);for(let e=t+1;e<i;e++){let i=-v[e]/v[t+1];for(let r=t+1;r<n;r++)s.set(r,e,s.get(r,e)+i*y[r])}}if(u)for(let e=t+1;e<i;e++)g.set(e,t,v[e])}}let k=Math.min(i,n+1);if(b<i&&(f[b]=s.get(b,b)),n<k&&(f[k-1]=0),x+1<k&&(v[x]=s.get(x,k-1)),v[k-1]=0,l){for(let t=b;t<h;t++){for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}for(let t=b-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<h;e++){let i=0;for(let r=t;r<n;r++)i+=p.get(r,t)*p.get(r,e);i=-i/p.get(t,t);for(let r=t;r<n;r++)p.set(r,e,p.get(r,e)+i*p.get(r,t))}for(let e=t;e<n;e++)p.set(e,t,-p.get(e,t));p.set(t,t,1+p.get(t,t));for(let e=0;e<t-1;e++)p.set(e,t,0)}else{for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}}if(u)for(let t=i-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<i;e++){let n=0;for(let r=t+1;r<i;r++)n+=g.get(r,t)*g.get(r,e);n=-n/g.get(t+1,t);for(let r=t+1;r<i;r++)g.set(r,e,g.get(r,e)+n*g.get(r,t))}for(let e=0;e<i;e++)g.set(e,t,0);g.set(t,t,1)}let M=k-1,S=Number.EPSILON;for(;k>0;){let t,e;for(t=k-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===k-2)e=4;else{let n;for(n=k-1;n>=t&&n!==t;n--){let e=(n!==k?Math.abs(v[n]):0)+(n!==t+1?Math.abs(v[n-1]):0);if(Math.abs(f[n])<=S*e){f[n]=0;break}}n===t?e=3:n===k-1?e=1:(e=2,t=n)}switch(t++,e){case 1:{let e=v[k-2];v[k-2]=0;for(let n=k-2;n>=t;n--){let r=P(f[n],e),a=f[n]/r,o=e/r;if(f[n]=r,n!==t&&(e=-o*v[n-1],v[n-1]=a*v[n-1]),u)for(let t=0;t<i;t++)r=a*g.get(t,n)+o*g.get(t,k-1),g.set(t,k-1,-o*g.get(t,n)+a*g.get(t,k-1)),g.set(t,n,r)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let i=t;i<k;i++){let r=P(f[i],e),a=f[i]/r,o=e/r;if(f[i]=r,e=-o*v[i],v[i]=a*v[i],l)for(let e=0;e<n;e++)r=a*p.get(e,i)+o*p.get(e,t-1),p.set(e,t-1,-o*p.get(e,i)+a*p.get(e,t-1)),p.set(e,i,r)}break}case 3:{const e=Math.max(Math.abs(f[k-1]),Math.abs(f[k-2]),Math.abs(v[k-2]),Math.abs(f[t]),Math.abs(v[t])),r=f[k-1]/e,a=f[k-2]/e,o=v[k-2]/e,s=f[t]/e,c=v[t]/e,h=((a+r)*(a-r)+o*o)/2,d=r*o*(r*o);let y=0;0===h&&0===d||(y=h<0?0-Math.sqrt(h*h+d):Math.sqrt(h*h+d),y=d/(h+y));let m=(s+r)*(s-r)+y,b=s*c;for(let e=t;e<k-1;e++){let r=P(m,b);0===r&&(r=Number.MIN_VALUE);let a=m/r,o=b/r;if(e!==t&&(v[e-1]=r),m=a*f[e]+o*v[e],v[e]=a*v[e]-o*f[e],b=o*f[e+1],f[e+1]=a*f[e+1],u)for(let t=0;t<i;t++)r=a*g.get(t,e)+o*g.get(t,e+1),g.set(t,e+1,-o*g.get(t,e)+a*g.get(t,e+1)),g.set(t,e,r);if(r=P(m,b),0===r&&(r=Number.MIN_VALUE),a=m/r,o=b/r,f[e]=r,m=a*v[e]+o*f[e+1],f[e+1]=-o*v[e]+a*f[e+1],b=o*v[e+1],v[e+1]=a*v[e+1],l&&e<n-1)for(let t=0;t<n;t++)r=a*p.get(t,e)+o*p.get(t,e+1),p.set(t,e+1,-o*p.get(t,e)+a*p.get(t,e+1)),p.set(t,e,r)}v[k-2]=m;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,u))for(let e=0;e<=M;e++)g.set(e,t,-g.get(e,t));for(;t<M&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,u&&t<i-1)for(let n=0;n<i;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);if(l&&t<n-1)for(let i=0;i<n;i++)e=p.get(i,t+1),p.set(i,t+1,p.get(i,t)),p.set(i,t,e);t++}k--}}if(c){let t=g;g=p,p=t}this.m=n,this.n=i,this.s=f,this.U=p,this.V=g}solve(t){let e=t,n=this.threshold,i=this.s.length,r=w.zeros(i,i);for(let t=0;t<i;t++)Math.abs(this.s[t])<=n?r.set(t,t,0):r.set(t,t,1/this.s[t]);let a=this.U,o=this.rightSingularVectors,s=o.mmul(r),l=o.rows,u=a.rows,c=w.zeros(l,u);for(let t=0;t<l;t++)for(let e=0;e<u;e++){let n=0;for(let r=0;r<i;r++)n+=s.get(t,r)*a.get(e,r);c.set(t,e,n)}return c.mmul(e)}solveForDiagonal(t){return this.solve(w.diag(t))}inverse(){let t=this.V,e=this.threshold,n=t.rows,i=t.columns,r=new w(n,this.s.length);for(let a=0;a<n;a++)for(let n=0;n<i;n++)Math.abs(this.s[n])>e&&r.set(a,n,t.get(a,n)/this.s[n]);let a=this.U,o=a.rows,s=a.columns,l=new w(n,o);for(let t=0;t<n;t++)for(let e=0;e<o;e++){let n=0;for(let i=0;i<s;i++)n+=r.get(t,i)*a.get(e,i);l.set(t,e,n)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s;for(let i=0,r=n.length;i<r;i++)n[i]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return w.diag(this.s)}}function L(t,e,n=!1){return t=A.checkMatrix(t),e=A.checkMatrix(e),n?new R(t).solve(e):t.isSquare()?new O(t).solve(e):new C(t).solve(e)}function D(t,e){let n=[];for(let i=0;i<t;i++)i!==e&&n.push(i);return n}function I(t,e,n,i=1e-9,r=1e-9){if(t>r)return new Array(e.rows+1).fill(0);{let t=e.addRow(n,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<i&&t.set(e,0,0);return t.to1DArray()}}class _{constructor(t,e={}){const{assumeSymmetric:n=!1}=e;if(!(t=A.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let i,r,a=t.columns,o=new w(a,a),s=new Float64Array(a),l=new Float64Array(a),u=t,c=!1;if(c=!!n||t.isSymmetric(),c){for(i=0;i<a;i++)for(r=0;r<a;r++)o.set(i,r,u.get(i,r));!function(t,e,n,i){let r,a,o,s,l,u,c,h;for(l=0;l<t;l++)n[l]=i.get(t-1,l);for(s=t-1;s>0;s--){for(h=0,o=0,u=0;u<s;u++)h+=Math.abs(n[u]);if(0===h)for(e[s]=n[s-1],l=0;l<s;l++)n[l]=i.get(s-1,l),i.set(s,l,0),i.set(l,s,0);else{for(u=0;u<s;u++)n[u]/=h,o+=n[u]*n[u];for(r=n[s-1],a=Math.sqrt(o),r>0&&(a=-a),e[s]=h*a,o-=r*a,n[s-1]=r-a,l=0;l<s;l++)e[l]=0;for(l=0;l<s;l++){for(r=n[l],i.set(l,s,r),a=e[l]+i.get(l,l)*r,u=l+1;u<=s-1;u++)a+=i.get(u,l)*n[u],e[u]+=i.get(u,l)*r;e[l]=a}for(r=0,l=0;l<s;l++)e[l]/=o,r+=e[l]*n[l];for(c=r/(o+o),l=0;l<s;l++)e[l]-=c*n[l];for(l=0;l<s;l++){for(r=n[l],a=e[l],u=l;u<=s-1;u++)i.set(u,l,i.get(u,l)-(r*e[u]+a*n[u]));n[l]=i.get(s-1,l),i.set(s,l,0)}}n[s]=o}for(s=0;s<t-1;s++){if(i.set(t-1,s,i.get(s,s)),i.set(s,s,1),o=n[s+1],0!==o){for(u=0;u<=s;u++)n[u]=i.get(u,s+1)/o;for(l=0;l<=s;l++){for(a=0,u=0;u<=s;u++)a+=i.get(u,s+1)*i.get(u,l);for(u=0;u<=s;u++)i.set(u,l,i.get(u,l)-a*n[u])}}for(u=0;u<=s;u++)i.set(u,s+1,0)}for(l=0;l<t;l++)n[l]=i.get(t-1,l),i.set(t-1,l,0);i.set(t-1,t-1,1),e[0]=0}(a,l,s,o),function(t,e,n,i){let r,a,o,s,l,u,c,h,d,f,p,g,v,y,m,b;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;let x=0,E=0,w=Number.EPSILON;for(u=0;u<t;u++){for(E=Math.max(E,Math.abs(n[u])+Math.abs(e[u])),c=u;c<t&&!(Math.abs(e[c])<=w*E);)c++;if(c>u)do{for(r=n[u],h=(n[u+1]-r)/(2*e[u]),d=P(h,1),h<0&&(d=-d),n[u]=e[u]/(h+d),n[u+1]=e[u]*(h+d),f=n[u+1],a=r-n[u],o=u+2;o<t;o++)n[o]-=a;for(x+=a,h=n[c],p=1,g=p,v=p,y=e[u+1],m=0,b=0,o=c-1;o>=u;o--)for(v=g,g=p,b=m,r=p*e[o],a=p*h,d=P(h,e[o]),e[o+1]=m*d,m=e[o]/d,p=h/d,h=p*n[o]-m*r,n[o+1]=a+m*(p*r+m*n[o]),l=0;l<t;l++)a=i.get(l,o+1),i.set(l,o+1,m*i.get(l,o)+p*a),i.set(l,o,p*i.get(l,o)-m*a);h=-m*b*v*y*e[u]/f,e[u]=m*h,n[u]=p*h}while(Math.abs(e[u])>w*E);n[u]=n[u]+x,e[u]=0}for(o=0;o<t-1;o++){for(l=o,h=n[o],s=o+1;s<t;s++)n[s]<h&&(l=s,h=n[s]);if(l!==o)for(n[l]=n[o],n[o]=h,s=0;s<t;s++)h=i.get(s,o),i.set(s,o,i.get(s,l)),i.set(s,l,h)}}(a,l,s,o)}else{let t=new w(a,a),e=new Float64Array(a);for(r=0;r<a;r++)for(i=0;i<a;i++)t.set(i,r,u.get(i,r));!function(t,e,n,i){let r,a,o,s,l,u,c,h=t-1;for(u=1;u<=h-1;u++){for(c=0,s=u;s<=h;s++)c+=Math.abs(e.get(s,u-1));if(0!==c){for(o=0,s=h;s>=u;s--)n[s]=e.get(s,u-1)/c,o+=n[s]*n[s];for(a=Math.sqrt(o),n[u]>0&&(a=-a),o-=n[u]*a,n[u]=n[u]-a,l=u;l<t;l++){for(r=0,s=h;s>=u;s--)r+=n[s]*e.get(s,l);for(r/=o,s=u;s<=h;s++)e.set(s,l,e.get(s,l)-r*n[s])}for(s=0;s<=h;s++){for(r=0,l=h;l>=u;l--)r+=n[l]*e.get(s,l);for(r/=o,l=u;l<=h;l++)e.set(s,l,e.get(s,l)-r*n[l])}n[u]=c*n[u],e.set(u,u-1,c*a)}}for(s=0;s<t;s++)for(l=0;l<t;l++)i.set(s,l,s===l?1:0);for(u=h-1;u>=1;u--)if(0!==e.get(u,u-1)){for(s=u+1;s<=h;s++)n[s]=e.get(s,u-1);for(l=u;l<=h;l++){for(a=0,s=u;s<=h;s++)a+=n[s]*i.get(s,l);for(a=a/n[u]/e.get(u,u-1),s=u;s<=h;s++)i.set(s,l,i.get(s,l)+a*n[s])}}}(a,t,e,o),function(t,e,n,i,r){let a,o,s,l,u,c,h,d,f,p,g,v,y,m,b,x=t-1,E=t-1,w=Number.EPSILON,k=0,M=0,S=0,N=0,T=0,A=0,O=0,P=0;for(a=0;a<t;a++)for((a<0||a>E)&&(n[a]=r.get(a,a),e[a]=0),o=Math.max(a-1,0);o<t;o++)M+=Math.abs(r.get(a,o));for(;x>=0;){for(l=x;l>0&&(A=Math.abs(r.get(l-1,l-1))+Math.abs(r.get(l,l)),0===A&&(A=M),!(Math.abs(r.get(l,l-1))<w*A));)l--;if(l===x)r.set(x,x,r.get(x,x)+k),n[x]=r.get(x,x),e[x]=0,x--,P=0;else if(l===x-1){if(h=r.get(x,x-1)*r.get(x-1,x),S=(r.get(x-1,x-1)-r.get(x,x))/2,N=S*S+h,O=Math.sqrt(Math.abs(N)),r.set(x,x,r.get(x,x)+k),r.set(x-1,x-1,r.get(x-1,x-1)+k),d=r.get(x,x),N>=0){for(O=S>=0?S+O:S-O,n[x-1]=d+O,n[x]=n[x-1],0!==O&&(n[x]=d-h/O),e[x-1]=0,e[x]=0,d=r.get(x,x-1),A=Math.abs(d)+Math.abs(O),S=d/A,N=O/A,T=Math.sqrt(S*S+N*N),S/=T,N/=T,o=x-1;o<t;o++)O=r.get(x-1,o),r.set(x-1,o,N*O+S*r.get(x,o)),r.set(x,o,N*r.get(x,o)-S*O);for(a=0;a<=x;a++)O=r.get(a,x-1),r.set(a,x-1,N*O+S*r.get(a,x)),r.set(a,x,N*r.get(a,x)-S*O);for(a=0;a<=E;a++)O=i.get(a,x-1),i.set(a,x-1,N*O+S*i.get(a,x)),i.set(a,x,N*i.get(a,x)-S*O)}else n[x-1]=d+S,n[x]=d+S,e[x-1]=O,e[x]=-O;x-=2,P=0}else{if(d=r.get(x,x),f=0,h=0,l<x&&(f=r.get(x-1,x-1),h=r.get(x,x-1)*r.get(x-1,x)),10===P){for(k+=d,a=0;a<=x;a++)r.set(a,a,r.get(a,a)-d);A=Math.abs(r.get(x,x-1))+Math.abs(r.get(x-1,x-2)),d=f=.75*A,h=-.4375*A*A}if(30===P&&(A=(f-d)/2,A=A*A+h,A>0)){for(A=Math.sqrt(A),f<d&&(A=-A),A=d-h/((f-d)/2+A),a=0;a<=x;a++)r.set(a,a,r.get(a,a)-A);k+=A,d=f=h=.964}for(P+=1,u=x-2;u>=l&&(O=r.get(u,u),T=d-O,A=f-O,S=(T*A-h)/r.get(u+1,u)+r.get(u,u+1),N=r.get(u+1,u+1)-O-T-A,T=r.get(u+2,u+1),A=Math.abs(S)+Math.abs(N)+Math.abs(T),S/=A,N/=A,T/=A,u!==l)&&!(Math.abs(r.get(u,u-1))*(Math.abs(N)+Math.abs(T))<w*(Math.abs(S)*(Math.abs(r.get(u-1,u-1))+Math.abs(O)+Math.abs(r.get(u+1,u+1)))));)u--;for(a=u+2;a<=x;a++)r.set(a,a-2,0),a>u+2&&r.set(a,a-3,0);for(s=u;s<=x-1&&(m=s!==x-1,s!==u&&(S=r.get(s,s-1),N=r.get(s+1,s-1),T=m?r.get(s+2,s-1):0,d=Math.abs(S)+Math.abs(N)+Math.abs(T),0!==d&&(S/=d,N/=d,T/=d)),0!==d);s++)if(A=Math.sqrt(S*S+N*N+T*T),S<0&&(A=-A),0!==A){for(s!==u?r.set(s,s-1,-A*d):l!==u&&r.set(s,s-1,-r.get(s,s-1)),S+=A,d=S/A,f=N/A,O=T/A,N/=S,T/=S,o=s;o<t;o++)S=r.get(s,o)+N*r.get(s+1,o),m&&(S+=T*r.get(s+2,o),r.set(s+2,o,r.get(s+2,o)-S*O)),r.set(s,o,r.get(s,o)-S*d),r.set(s+1,o,r.get(s+1,o)-S*f);for(a=0;a<=Math.min(x,s+3);a++)S=d*r.get(a,s)+f*r.get(a,s+1),m&&(S+=O*r.get(a,s+2),r.set(a,s+2,r.get(a,s+2)-S*T)),r.set(a,s,r.get(a,s)-S),r.set(a,s+1,r.get(a,s+1)-S*N);for(a=0;a<=E;a++)S=d*i.get(a,s)+f*i.get(a,s+1),m&&(S+=O*i.get(a,s+2),i.set(a,s+2,i.get(a,s+2)-S*T)),i.set(a,s,i.get(a,s)-S),i.set(a,s+1,i.get(a,s+1)-S*N)}}}if(0!==M){for(x=t-1;x>=0;x--)if(S=n[x],N=e[x],0===N)for(l=x,r.set(x,x,1),a=x-1;a>=0;a--){for(h=r.get(a,a)-S,T=0,o=l;o<=x;o++)T+=r.get(a,o)*r.get(o,x);if(e[a]<0)O=h,A=T;else if(l=a,0===e[a]?r.set(a,x,0!==h?-T/h:-T/(w*M)):(d=r.get(a,a+1),f=r.get(a+1,a),N=(n[a]-S)*(n[a]-S)+e[a]*e[a],c=(d*A-O*T)/N,r.set(a,x,c),r.set(a+1,x,Math.abs(d)>Math.abs(O)?(-T-h*c)/d:(-A-f*c)/O)),c=Math.abs(r.get(a,x)),w*c*c>1)for(o=a;o<=x;o++)r.set(o,x,r.get(o,x)/c)}else if(N<0)for(l=x-1,Math.abs(r.get(x,x-1))>Math.abs(r.get(x-1,x))?(r.set(x-1,x-1,N/r.get(x,x-1)),r.set(x-1,x,-(r.get(x,x)-S)/r.get(x,x-1))):(b=B(0,-r.get(x-1,x),r.get(x-1,x-1)-S,N),r.set(x-1,x-1,b[0]),r.set(x-1,x,b[1])),r.set(x,x-1,0),r.set(x,x,1),a=x-2;a>=0;a--){for(p=0,g=0,o=l;o<=x;o++)p+=r.get(a,o)*r.get(o,x-1),g+=r.get(a,o)*r.get(o,x);if(h=r.get(a,a)-S,e[a]<0)O=h,T=p,A=g;else if(l=a,0===e[a]?(b=B(-p,-g,h,N),r.set(a,x-1,b[0]),r.set(a,x,b[1])):(d=r.get(a,a+1),f=r.get(a+1,a),v=(n[a]-S)*(n[a]-S)+e[a]*e[a]-N*N,y=2*(n[a]-S)*N,0===v&&0===y&&(v=w*M*(Math.abs(h)+Math.abs(N)+Math.abs(d)+Math.abs(f)+Math.abs(O))),b=B(d*T-O*p+N*g,d*A-O*g-N*p,v,y),r.set(a,x-1,b[0]),r.set(a,x,b[1]),Math.abs(d)>Math.abs(O)+Math.abs(N)?(r.set(a+1,x-1,(-p-h*r.get(a,x-1)+N*r.get(a,x))/d),r.set(a+1,x,(-g-h*r.get(a,x)-N*r.get(a,x-1))/d)):(b=B(-T-f*r.get(a,x-1),-A-f*r.get(a,x),O,N),r.set(a+1,x-1,b[0]),r.set(a+1,x,b[1]))),c=Math.max(Math.abs(r.get(a,x-1)),Math.abs(r.get(a,x))),w*c*c>1)for(o=a;o<=x;o++)r.set(o,x-1,r.get(o,x-1)/c),r.set(o,x,r.get(o,x)/c)}for(a=0;a<t;a++)if(a<0||a>E)for(o=a;o<t;o++)i.set(a,o,r.get(a,o));for(o=t-1;o>=0;o--)for(a=0;a<=E;a++){for(O=0,s=0;s<=Math.min(o,E);s++)O+=i.get(a,s)*r.get(s,o);i.set(a,o,O)}}}(a,l,s,o,t)}this.n=a,this.e=l,this.d=s,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,n=this.n,i=this.e,r=this.d,a=new w(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)a.set(t,e,0);a.set(t,t,r[t]),i[t]>0?a.set(t,t+1,i[t]):i[t]<0&&a.set(t,t-1,i[t])}return a}}function B(t,e,n,i){let r,a;return Math.abs(n)>Math.abs(i)?(r=i/n,a=n+r*i,[(t+r*e)/a,(e-r*t)/a]):(r=n/i,a=i+r*n,[(r*t+e)/a,(r*e-t)/a])}class F{constructor(t){if(!(t=A.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,n,i,r=t,a=r.rows,o=new w(a,a),s=!0;for(n=0;n<a;n++){let t=0;for(i=0;i<n;i++){let a=0;for(e=0;e<i;e++)a+=o.get(i,e)*o.get(n,e);a=(r.get(n,i)-a)/o.get(i,i),o.set(n,i,a),t+=a*a}for(t=r.get(n,n)-t,s&&=t>0,o.set(n,n,Math.sqrt(Math.max(t,0))),i=n+1;i<a;i++)o.set(n,i,0)}this.L=o,this.positiveDefinite=s}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=A.checkMatrix(t);let e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let i,r,a,o=t.columns,s=t.clone();for(a=0;a<n;a++)for(r=0;r<o;r++){for(i=0;i<a;i++)s.set(a,r,s.get(a,r)-s.get(i,r)*e.get(a,i));s.set(a,r,s.get(a,r)/e.get(a,a))}for(a=n-1;a>=0;a--)for(r=0;r<o;r++){for(i=a+1;i<n;i++)s.set(a,r,s.get(a,r)-s.get(i,r)*e.get(i,a));s.set(a,r,s.get(a,r)/e.get(a,a))}return s}get lowerTriangularMatrix(){return this.L}}class j{constructor(t,e={}){t=A.checkMatrix(t);let{Y:n}=e;const{scaleScores:r=!1,maxIterations:a=1e3,terminationCriteria:o=1e-10}=e;let s;if(n){if(n=i.isAnyArray(n)&&"number"==typeof n[0]?w.columnVector(n):A.checkMatrix(n),n.rows!==t.rows)throw new Error("Y should have the same number of rows as X");s=n.getColumnVector(0)}else s=t.getColumnVector(0);let l,u,c,h,d=1;for(let e=0;e<a&&d>o;e++)c=t.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),c=c.div(c.norm()),l=t.mmul(c).div(c.transpose().mmul(c).get(0,0)),e>0&&(d=l.clone().sub(h).pow(2).sum()),h=l.clone(),n?(u=n.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),u=u.div(u.norm()),s=n.mmul(u).div(u.transpose().mmul(u).get(0,0))):s=l;if(n){let e=t.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0));e=e.div(e.norm());let i=t.clone().sub(l.clone().mmul(e.transpose())),r=s.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),a=n.clone().sub(l.clone().mulS(r.get(0,0)).mmul(u.transpose()));this.t=l,this.p=e.transpose(),this.w=c.transpose(),this.q=u,this.u=s,this.s=l.transpose().mmul(l),this.xResidual=i,this.yResidual=a,this.betas=r}else this.w=c.transpose(),this.s=l.transpose().mmul(l).sqrt(),this.t=r?l.clone().div(this.s.get(0,0)):l,this.xResidual=t.sub(l.mmul(c.transpose()))}}e.y3=x,e.jy=F,e.oN=F,e.Hc=M,e.cg=_,e.hj=_,e.LU=O,e.Tb=O,e.uq=w,e.Zm=class extends S{constructor(t,e){g(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},e.Dq=class extends S{constructor(t,e){h(t,e),super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}},e.__=class extends S{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},e.q0=class extends S{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},e.lh=class extends S{constructor(t,e){p(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},e.pI=class extends S{constructor(t,e){c(t,e),super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}},e.zC=N,e.zg=class extends S{constructor(t,e,n,i,r){v(t,e,n,i,r),super(t,n-e+1,r-i+1),this.startRow=e,this.startColumn=i}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},e.g6=class extends S{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}},e.OL=j,e.ks=j,e.QR=C,e.jp=C,e.mk=R,e.W2=R,e.l=k,e.KY=T,e.dv=A,e.BR=function(t,e=t,n={}){t=new w(t);let r=!1;if("object"!=typeof e||w.isMatrix(e)||i.isAnyArray(e)?e=new w(e):(n=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:a=!0,scale:o=!0}=n;a&&(t.center("column"),r||e.center("column")),o&&(t.scale("column"),r||e.scale("column"));const s=t.standardDeviation("column",{unbiased:!0}),l=r?s:e.standardDeviation("column",{unbiased:!0}),u=t.transpose().mmul(e);for(let e=0;e<u.rows;e++)for(let n=0;n<u.columns;n++)u.set(e,n,u.get(e,n)*(1/(s[e]*l[n]))*(1/(t.rows-1)));return u},e.Wu=function(t,e=t,n={}){t=new w(t);let r=!1;if("object"!=typeof e||w.isMatrix(e)||i.isAnyArray(e)?e=new w(e):(n=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:a=!0}=n;a&&(t=t.center("column"),r||(e=e.center("column")));const o=t.transpose().mmul(e);for(let e=0;e<o.rows;e++)for(let n=0;n<o.columns;n++)o.set(e,n,o.get(e,n)*(1/(t.rows-1)));return o},e.a4=function t(e){if((e=w.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let n,i,r,a;if(2===e.columns)return n=e.get(0,0),i=e.get(0,1),r=e.get(1,0),a=e.get(1,1),n*a-i*r;if(3===e.columns){let a,o,s;return a=new N(e,[1,2],[1,2]),o=new N(e,[1,2],[0,2]),s=new N(e,[1,2],[0,1]),n=e.get(0,0),i=e.get(0,1),r=e.get(0,2),n*t(a)-i*t(o)+r*t(s)}return new O(e).determinant}throw Error("determinant can only be calculated for a square matrix")},e.DI=function(t,e=!1){return t=A.checkMatrix(t),e?new R(t).inverse():L(t,w.eye(t.rows))},e.Jo=function(t,e={}){const{thresholdValue:n=1e-9,thresholdError:i=1e-9}=e;let r=(t=w.checkMatrix(t)).rows,a=new w(r,r);for(let e=0;e<r;e++){let o=w.columnVector(t.getRow(e)),s=t.subMatrixRow(D(r,e)).transpose(),l=new R(s).solve(o),u=w.sub(o,s.mmul(l)).abs().max();a.setRow(e,I(u,l,e,n,i))}return a},e.Zi=function(t,e=Number.EPSILON){if((t=w.checkMatrix(t)).isEmpty())return t.transpose();let n=new R(t,{autoTranspose:!0}),i=n.leftSingularVectors,r=n.rightSingularVectors,a=n.diagonal;for(let t=0;t<a.length;t++)Math.abs(a[t])>e?a[t]=1/a[t]:a[t]=0;return r.mmul(w.diag(a).mmul(i.transpose()))},e.kH=L,e.LV=function(t,e){if(i.isAnyArray(t))return t[0]&&i.isAnyArray(t[0])?new A(t):new T(t,e);throw new Error("the argument is not an array")}},689:(t,e,n)=>{var i=n(2),r=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,a,o,s){var l=1&n,u=i(t),c=u.length;if(c!=i(e).length&&!l)return!1;for(var h=c;h--;){var d=u[h];if(!(l?d in e:r.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var g=!0;s.set(t,e),s.set(e,t);for(var v=l;++h<c;){var y=t[d=u[h]],m=e[d];if(a)var b=l?a(m,y,d,e,t,s):a(y,m,d,t,e,s);if(!(void 0===b?y===m||o(y,m,n,a,s):b)){g=!1;break}v||(v="constructor"==d)}if(g&&!v){var x=t.constructor,E=e.constructor;x==E||!("constructor"in t)||!("constructor"in e)||"function"==typeof x&&x instanceof x&&"function"==typeof E&&E instanceof E||(g=!1)}return s.delete(t),s.delete(e),g}},695:(t,e,n)=>{var i=n(8096),r=n(2428),a=n(6449),o=n(3656),s=n(361),l=n(7167),u=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=a(t),c=!n&&r(t),h=!n&&!c&&o(t),d=!n&&!c&&!h&&l(t),f=n||c||h||d,p=f?i(t.length,String):[],g=p.length;for(var v in t)!e&&!u.call(t,v)||f&&("length"==v||h&&("offset"==v||"parent"==v)||d&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,g))||p.push(v);return p}},756:(t,e,n)=>{var i=n(3805);t.exports=function(t){return t==t&&!i(t)}},776:(t,e,n)=>{var i=n(756),r=n(5950);t.exports=function(t){for(var e=r(t),n=e.length;n--;){var a=e[n],o=t[a];e[n]=[a,o,i(o)]}return e}},788:(t,e,n)=>{"use strict";n.r(e),n.d(e,{isAnyArray:()=>r});const i=Object.prototype.toString;function r(t){const e=i.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},860:(t,e,n)=>{var i=n(882),r=n(909),a=n(5389),o=n(5558),s=n(6449);t.exports=function(t,e,n){var l=s(t)?i:o,u=arguments.length<3;return l(t,a(e,4),n,u,r)}},882:t=>{t.exports=function(t,e,n,i){var r=-1,a=null==t?0:t.length;for(i&&a&&(n=t[++r]);++r<a;)n=e(n,t[r],r,t);return n}},909:(t,e,n)=>{var i=n(641),r=n(8329)(i);t.exports=r},938:t=>{t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},945:(t,e,n)=>{var i=n(79),r=n(8223),a=n(3661);t.exports=function(t,e){var n=this.__data__;if(n instanceof i){var o=n.__data__;if(!r||o.length<199)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new a(o)}return n.set(t,e),this.size=n.size,this}},999:(t,e,n)=>{var i=n(9302),r=n(6800);t.exports=function(t){return i((function(e,n){var i=-1,a=n.length,o=a>1?n[a-1]:void 0,s=a>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(a--,o):void 0,s&&r(n[0],n[1],s)&&(o=a<3?void 0:o,a=1),e=Object(e);++i<a;){var l=n[i];l&&t(e,l,i,o)}return e}))}},1033:t=>{t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},1042:(t,e,n)=>{var i=n(6110)(Object,"create");t.exports=i},1045:(t,e,n)=>{var i=n(9276);t.exports=function(t,e){return i(t,e,"post")}},1166:(t,e,n)=>{t.exports={Graph:n(6454),version:n(4458)}},1175:(t,e,n)=>{var i=n(6025);t.exports=function(t,e){var n=this.__data__,r=i(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}},1234:t=>{t.exports=function(t,e,n){for(var i=-1,r=t.length,a=e.length,o={};++i<r;){var s=i<a?e[i]:void 0;n(o,t[i],s)}return o}},1331:(t,e,n)=>{var i=n(2552),r=n(8879),a=n(346),o=Function.prototype,s=Object.prototype,l=o.toString,u=s.hasOwnProperty,c=l.call(Object);t.exports=function(t){if(!a(t)||"[object Object]"!=i(t))return!1;var e=r(t);if(null===e)return!0;var n=u.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==c}},1380:t=>{t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},1420:(t,e,n)=>{var i=n(79);t.exports=function(){this.__data__=new i,this.size=0}},1448:(t,e,n)=>{var i=n(426),r=n(9326);t.exports=function(t,e){return null!=t&&r(t,e,i)}},1453:(t,e,n)=>{"use strict";var i=n(6857),r=n(8918),a=n(6639),o=n(4520),s=n(7860),l=n(4384),u=n(8191).Graph,c=n(3988);function h(t,e,n){return i.map(e,(function(e){return s(t,e,n)}))}function d(t,e){var n=new u;i.forEach(t,(function(t){var r=t.graph().root,a=o(t,r,n,e);i.forEach(a.vs,(function(e,n){t.node(e).order=n})),l(t,n,a.vs)}))}function f(t,e){i.forEach(e,(function(e){i.forEach(e,(function(e,n){t.node(e).order=n}))}))}t.exports=function(t){var e=c.maxRank(t),n=h(t,i.range(1,e+1),"inEdges"),o=h(t,i.range(e-1,-1,-1),"outEdges"),s=r(t);f(t,s);for(var l,u=Number.POSITIVE_INFINITY,p=0,g=0;g<4;++p,++g){d(p%2?n:o,p%4>=2),s=c.buildLayerMatrix(t);var v=a(t,s);v<u&&(g=0,l=i.cloneDeep(s),u=v)}f(t,l)}},1459:t=>{t.exports=function(t){return this.__data__.has(t)}},1489:(t,e,n)=>{var i=n(7400);t.exports=function(t){var e=i(t),n=e%1;return e==e?n?e-n:e:0}},1549:(t,e,n)=>{var i=n(9651),r=n(3862),a=n(6721),o=n(2749),s=n(5749);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},1667:(t,e,n)=>{t.exports={components:n(3619),dijkstra:n(8905),dijkstraAll:n(4919),findCycles:n(6678),floydWarshall:n(3590),isAcyclic:n(498),postorder:n(1045),preorder:n(6016),prim:n(4423),tarjan:n(6291),topsort:n(9888)}},1684:(t,e,n)=>{var i=n(3599),r=n(6176),a=n(3488);t.exports=function(t){return t&&t.length?i(t,a,r):void 0}},1737:(t,e,n)=>{var i=n(117);function r(){this._arr=[],this._keyIndices={}}t.exports=r,r.prototype.size=function(){return this._arr.length},r.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},r.prototype.has=function(t){return i.has(this._keyIndices,t)},r.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},r.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},r.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),!i.has(n,t)){var r=this._arr,a=r.length;return n[t]=a,r.push({key:t,priority:e}),this._decrease(a),!0}return!1},r.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},r.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},r.prototype._heapify=function(t){var e=this._arr,n=2*t,i=n+1,r=t;n<e.length&&(r=e[n].priority<e[r].priority?n:r,i<e.length&&(r=e[i].priority<e[r].priority?i:r),r!==t&&(this._swap(t,r),this._heapify(r)))},r.prototype._decrease=function(t){for(var e,n=this._arr,i=n[t].priority;0!==t&&!(n[e=t>>1].priority<i);)this._swap(t,e),t=e},r.prototype._swap=function(t,e){var n=this._arr,i=this._keyIndices,r=n[t],a=n[e];n[t]=a,n[e]=r,i[a.key]=t,i[r.key]=e}},1769:(t,e,n)=>{var i=n(6449),r=n(8586),a=n(1802),o=n(3222);t.exports=function(t,e){return i(t)?t:r(t,e)?[t]:a(o(t))}},1791:(t,e,n)=>{var i=n(6547),r=n(3360);t.exports=function(t,e,n,a){var o=!n;n||(n={});for(var s=-1,l=e.length;++s<l;){var u=e[s],c=a?a(n[u],t[u],u,n,t):void 0;void 0===c&&(c=t[u]),o?r(n,u,c):i(n,u,c)}return n}},1799:(t,e,n)=>{var i=n(7217),r=n(270);t.exports=function(t,e,n,a){var o=n.length,s=o,l=!a;if(null==t)return!s;for(t=Object(t);o--;){var u=n[o];if(l&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<s;){var c=(u=n[o])[0],h=t[c],d=u[1];if(l&&u[2]){if(void 0===h&&!(c in t))return!1}else{var f=new i;if(a)var p=a(h,d,c,t,e,f);if(!(void 0===p?r(d,h,3,a,f):p))return!1}}return!0}},1800:t=>{var e=/\s/;t.exports=function(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n}},1802:(t,e,n)=>{var i=n(2224),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=i((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(r,(function(t,n,i,r){e.push(i?r.replace(a,"$1"):n||t)})),e}));t.exports=o},1811:t=>{var e=Date.now;t.exports=function(t){var n=0,i=0;return function(){var r=e(),a=16-(r-i);if(i=r,a>0){if(++n>=800)return arguments[0]}else n=0;return t.apply(void 0,arguments)}}},1873:(t,e,n)=>{var i=n(9325).Symbol;t.exports=i},1882:(t,e,n)=>{var i=n(2552),r=n(3805);t.exports=function(t){if(!r(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},1961:(t,e,n)=>{var i=n(9653);t.exports=function(t,e){var n=e?i(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},1986:(t,e,n)=>{var i=n(1873),r=n(7828),a=n(5288),o=n(5911),s=n(317),l=n(4247),u=i?i.prototype:void 0,c=u?u.valueOf:void 0;t.exports=function(t,e,n,i,u,h,d){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!h(new r(t),new r(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var f=s;case"[object Set]":var p=1&i;if(f||(f=l),t.size!=e.size&&!p)return!1;var g=d.get(t);if(g)return g==e;i|=2,d.set(t,e);var v=o(f(t),f(e),i,u,h,d);return d.delete(t),v;case"[object Symbol]":if(c)return c.call(t)==c.call(e)}return!1}},1993:(t,e,n)=>{var i=n(9811),r=n(9698),a=n(7927);t.exports=function(t){return r(t)?a(t):i(t)}},2006:(t,e,n)=>{var i=n(5389),r=n(4894),a=n(5950);t.exports=function(t){return function(e,n,o){var s=Object(e);if(!r(e)){var l=i(n,3);e=a(e),n=function(t){return l(s[t],t,s)}}var u=t(e,n,o);return u>-1?s[l?e[u]:u]:void 0}}},2031:(t,e,n)=>{var i=n(6857),r=n(8191).Graph,a=n(9859);t.exports=function(t,e){if(t.nodeCount()<=1)return[];var n=function(t,e){var n=new r,o=0,s=0;i.forEach(t.nodes(),(function(t){n.setNode(t,{v:t,in:0,out:0})})),i.forEach(t.edges(),(function(t){var i=n.edge(t.v,t.w)||0,r=e(t),a=i+r;n.setEdge(t.v,t.w,a),s=Math.max(s,n.node(t.v).out+=r),o=Math.max(o,n.node(t.w).in+=r)}));var u=i.range(s+o+3).map((function(){return new a})),c=o+1;return i.forEach(n.nodes(),(function(t){l(u,c,n.node(t))})),{graph:n,buckets:u,zeroIdx:c}}(t,e||o),u=function(t,e,n){for(var i,r=[],a=e[e.length-1],o=e[0];t.nodeCount();){for(;i=o.dequeue();)s(t,e,n,i);for(;i=a.dequeue();)s(t,e,n,i);if(t.nodeCount())for(var l=e.length-2;l>0;--l)if(i=e[l].dequeue()){r=r.concat(s(t,e,n,i,!0));break}}return r}(n.graph,n.buckets,n.zeroIdx);return i.flatten(i.map(u,(function(e){return t.outEdges(e.v,e.w)})),!0)};var o=i.constant(1);function s(t,e,n,r,a){var o=a?[]:void 0;return i.forEach(t.inEdges(r.v),(function(i){var r=t.edge(i),s=t.node(i.v);a&&o.push({v:i.v,w:i.w}),s.out-=r,l(e,n,s)})),i.forEach(t.outEdges(r.v),(function(i){var r=t.edge(i),a=i.w,o=t.node(a);o.in-=r,l(e,n,o)})),t.removeNode(r.v),o}function l(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}},2193:(t,e,n)=>{var i=n(8984),r=n(5861),a=n(2428),o=n(6449),s=n(4894),l=n(3656),u=n(5527),c=n(7167),h=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(s(t)&&(o(t)||"string"==typeof t||"function"==typeof t.splice||l(t)||c(t)||a(t)))return!t.length;var e=r(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(u(t))return!i(t).length;for(var n in t)if(h.call(t,n))return!1;return!0}},2199:(t,e,n)=>{var i=n(4528),r=n(6449);t.exports=function(t,e,n){var a=e(t);return r(t)?a:i(a,n(t))}},2216:t=>{t.exports=function(t){return void 0===t}},2224:(t,e,n)=>{var i=n(104);t.exports=function(t){var e=i(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},2271:(t,e,n)=>{var i=n(1791),r=n(4664);t.exports=function(t,e){return i(t,r(t),e)}},2420:(t,e,n)=>{var i=n(6649),r=n(4066),a=n(7241);t.exports=function(t,e){return null==t?t:i(t,r(e),a)}},2428:(t,e,n)=>{var i=n(7534),r=n(346),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(t){return r(t)&&o.call(t,"callee")&&!s.call(t,"callee")};t.exports=l},2523:t=>{t.exports=function(t,e,n,i){for(var r=t.length,a=n+(i?1:-1);i?a--:++a<r;)if(e(t[a],a,t))return a;return-1}},2552:(t,e,n)=>{var i=n(1873),r=n(659),a=n(9350),o=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":o&&o in Object(t)?r(t):a(t)}},2629:(t,e,n)=>{var i=n(9999);t.exports=function(t){return i(t,4)}},2651:(t,e,n)=>{var i=n(4218);t.exports=function(t,e){var n=t.__data__;return i(e)?n["string"==typeof e?"string":"hash"]:n.map}},2749:(t,e,n)=>{var i=n(1042),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:r.call(e,t)}},2804:(t,e,n)=>{var i=n(6110)(n(9325),"Promise");t.exports=i},2824:(t,e,n)=>{var i=n(7805),r=n(3290),a=n(1961),o=n(3007),s=n(5529),l=n(2428),u=n(6449),c=n(3693),h=n(3656),d=n(1882),f=n(3805),p=n(1331),g=n(7167),v=n(4974),y=n(9884);t.exports=function(t,e,n,m,b,x,E){var w=v(t,n),k=v(e,n),M=E.get(k);if(M)i(t,n,M);else{var S=x?x(w,k,n+"",t,e,E):void 0,N=void 0===S;if(N){var T=u(k),A=!T&&h(k),O=!T&&!A&&g(k);S=k,T||A||O?u(w)?S=w:c(w)?S=o(w):A?(N=!1,S=r(k,!0)):O?(N=!1,S=a(k,!0)):S=[]:p(k)||l(k)?(S=w,l(w)?S=y(w):f(w)&&!d(w)||(S=s(k))):N=!1}N&&(E.set(k,S),b(S,k,m,x,E),E.delete(k)),i(t,n,S)}}},2865:(t,e,n)=>{var i=n(9570),r=n(1811)(i);t.exports=r},2903:(t,e,n)=>{var i=n(3805),r=n(5527),a=n(181),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return a(t);var e=r(t),n=[];for(var s in t)("constructor"!=s||!e&&o.call(t,s))&&n.push(s);return n}},2948:(t,e,n)=>{var i=n(6857);t.exports=function(t){var e=function(t){var e={},n=0;return i.forEach(t.children(),(function r(a){var o=n;i.forEach(t.children(a),r),e[a]={low:o,lim:n++}})),e}(t);i.forEach(t.graph().dummyChains,(function(n){for(var i=t.node(n),r=i.edgeObj,a=function(t,e,n,i){var r,a,o=[],s=[],l=Math.min(e[n].low,e[i].low),u=Math.max(e[n].lim,e[i].lim);r=n;do{r=t.parent(r),o.push(r)}while(r&&(e[r].low>l||u>e[r].lim));for(a=r,r=i;(r=t.parent(r))!==a;)s.push(r);return{path:o.concat(s.reverse()),lca:a}}(t,e,r.v,r.w),o=a.path,s=a.lca,l=0,u=o[l],c=!0;n!==r.w;){if(i=t.node(n),c){for(;(u=o[l])!==s&&t.node(u).maxRank<i.rank;)l++;u===s&&(c=!1)}if(!c){for(;l<o.length-1&&t.node(u=o[l+1]).minRank<=i.rank;)l++;u=o[l]}t.setParent(n,u),n=t.successors(n)[0]}}))}},2949:(t,e,n)=>{var i=n(2651);t.exports=function(t,e){var n=i(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}},3007:t=>{t.exports=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}},3031:(t,e,n)=>{var i=n(3120),r=n(6155),a=n(9302),o=n(6800),s=a((function(t,e){if(null==t)return[];var n=e.length;return n>1&&o(t,e[0],e[1])?e=[]:n>2&&o(e[0],e[1],e[2])&&(e=[e[0]]),r(t,i(e,1),[])}));t.exports=s},3040:(t,e,n)=>{var i=n(1549),r=n(79),a=n(8223);t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(a||r),string:new i}}},3120:(t,e,n)=>{var i=n(4528),r=n(5891);t.exports=function t(e,n,a,o,s){var l=-1,u=e.length;for(a||(a=r),s||(s=[]);++l<u;){var c=e[l];n>0&&a(c)?n>1?t(c,n-1,a,o,s):i(s,c):o||(s[s.length]=c)}return s}},3170:(t,e,n)=>{var i=n(6547),r=n(1769),a=n(361),o=n(3805),s=n(7797);t.exports=function(t,e,n,l){if(!o(t))return t;for(var u=-1,c=(e=r(e,t)).length,h=c-1,d=t;null!=d&&++u<c;){var f=s(e[u]),p=n;if("__proto__"===f||"constructor"===f||"prototype"===f)return t;if(u!=h){var g=d[f];void 0===(p=l?l(g,f,d):void 0)&&(p=o(g)?g:a(e[u+1])?[]:{})}i(d,f,p),d=d[f]}return t}},3181:(t,e,n)=>{var i=n(5508)();t.exports=i},3201:t=>{var e=/\w*$/;t.exports=function(t){var n=new t.constructor(t.source,e.exec(t));return n.lastIndex=t.lastIndex,n}},3221:t=>{t.exports=function(t){return function(e,n,i){for(var r=-1,a=Object(e),o=i(e),s=o.length;s--;){var l=o[t?s:++r];if(!1===n(a[l],l,a))break}return e}}},3222:(t,e,n)=>{var i=n(7556);t.exports=function(t){return null==t?"":i(t)}},3243:(t,e,n)=>{var i=n(6110),r=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=r},3290:(t,e,n)=>{t=n.nmd(t);var i=n(9325),r=e&&!e.nodeType&&e,a=r&&t&&!t.nodeType&&t,o=a&&a.exports===r?i.Buffer:void 0,s=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,i=s?s(n):new t.constructor(n);return t.copy(i),i}},3335:t=>{t.exports=function(t,e){return t>e}},3345:t=>{t.exports=function(){return[]}},3349:(t,e,n)=>{var i=n(2199),r=n(6375),a=n(7241);t.exports=function(t){return i(t,a,r)}},3360:(t,e,n)=>{var i=n(3243);t.exports=function(t,e,n){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},3488:t=>{t.exports=function(t){return t}},3590:(t,e,n)=>{var i=n(117);t.exports=function(t,e,n){return function(t,e,n){var i={},r=t.nodes();return r.forEach((function(t){i[t]={},i[t][t]={distance:0},r.forEach((function(e){t!==e&&(i[t][e]={distance:Number.POSITIVE_INFINITY})})),n(t).forEach((function(n){var r=n.v===t?n.w:n.v,a=e(n);i[t][r]={distance:a,predecessor:t}}))})),r.forEach((function(t){var e=i[t];r.forEach((function(n){var a=i[n];r.forEach((function(n){var i=a[t],r=e[n],o=a[n],s=i.distance+r.distance;s<o.distance&&(o.distance=s,o.predecessor=r.predecessor)}))}))})),i}(t,e||r,n||function(e){return t.outEdges(e)})};var r=i.constant(1)},3599:(t,e,n)=>{var i=n(4394);t.exports=function(t,e,n){for(var r=-1,a=t.length;++r<a;){var o=t[r],s=e(o);if(null!=s&&(void 0===l?s==s&&!i(s):n(s,l)))var l=s,u=o}return u}},3605:t=>{t.exports=function(t){return this.__data__.get(t)}},3619:(t,e,n)=>{var i=n(117);t.exports=function(t){var e,n={},r=[];function a(r){i.has(n,r)||(n[r]=!0,e.push(r),i.each(t.successors(r),a),i.each(t.predecessors(r),a))}return i.each(t.nodes(),(function(t){e=[],a(t),e.length&&r.push(e)})),r}},3650:(t,e,n)=>{var i=n(4335)(Object.keys,Object);t.exports=i},3656:(t,e,n)=>{t=n.nmd(t);var i=n(9325),r=n(9935),a=e&&!e.nodeType&&e,o=a&&t&&!t.nodeType&&t,s=o&&o.exports===a?i.Buffer:void 0,l=(s?s.isBuffer:void 0)||r;t.exports=l},3661:(t,e,n)=>{var i=n(3040),r=n(7670),a=n(289),o=n(4509),s=n(2949);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},3663:(t,e,n)=>{var i=n(1799),r=n(776),a=n(7197);t.exports=function(t){var e=r(t);return 1==e.length&&e[0][2]?a(e[0][0],e[0][1]):function(n){return n===t||i(n,t,e)}}},3693:(t,e,n)=>{var i=n(4894),r=n(346);t.exports=function(t){return r(t)&&i(t)}},3702:t=>{t.exports=function(){this.__data__=[],this.size=0}},3714:(t,e,n)=>{var i=n(3730);t.exports=function(t,e,n){for(var r=-1,a=t.criteria,o=e.criteria,s=a.length,l=n.length;++r<s;){var u=i(a[r],o[r]);if(u)return r>=l?u:u*("desc"==n[r]?-1:1)}return t.index-e.index}},3718:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});var i=n(788);function r(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!(0,i.isAnyArray)(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,a=e.toIndex,o=void 0===a?t.length:a;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[r],l=r+1;l<o;l++)t[l]<s&&(s=t[l]);return s}(t),a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,a=e.toIndex,o=void 0===a?t.length:a;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[r],l=r+1;l<o;l++)t[l]>s&&(s=t[l]);return s}(t);if(r===a)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,s=void 0===o?n.autoMinMax?r:0:o,l=n.max,u=void 0===l?n.autoMinMax?a:1:l;if(s>=u)throw new RangeError("min option must be smaller than max option");for(var c=(u-s)/(a-r),h=0;h<t.length;h++)e[h]=(t[h]-r)*c+s;return e}},3729:t=>{t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}},3730:(t,e,n)=>{var i=n(4394);t.exports=function(t,e){if(t!==e){var n=void 0!==t,r=null===t,a=t==t,o=i(t),s=void 0!==e,l=null===e,u=e==e,c=i(e);if(!l&&!c&&!o&&t>e||o&&s&&u&&!l&&!c||r&&s&&u||!n&&u||!a)return 1;if(!r&&!o&&!c&&t<e||c&&n&&a&&!r&&!o||l&&n&&a||!s&&a||!u)return-1}return 0}},3736:(t,e,n)=>{var i=n(1873),r=i?i.prototype:void 0,a=r?r.valueOf:void 0;t.exports=function(t){return a?Object(a.call(t)):{}}},3776:(t,e,n)=>{"use strict";var i=n(6857),r=n(3988),a=n(9741).positionX;t.exports=function(t){(function(t){var e=r.buildLayerMatrix(t),n=t.graph().ranksep,a=0;i.forEach(e,(function(e){var r=i.max(i.map(e,(function(e){return t.node(e).height})));i.forEach(e,(function(e){t.node(e).y=a+r/2})),a+=r+n}))})(t=r.asNonCompoundGraph(t)),i.forEach(a(t),(function(e,n){t.node(n).x=e}))}},3805:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},3838:(t,e,n)=>{var i=n(1791),r=n(7241);t.exports=function(t,e){return t&&i(e,r(e),t)}},3860:(t,e,n)=>{var i=n(6857);t.exports=function(t,e){return i.map(e,(function(e){var n=t.inEdges(e);if(n.length){var r=i.reduce(n,(function(e,n){var i=t.edge(n),r=t.node(n.v);return{sum:e.sum+i.weight*r.order,weight:e.weight+i.weight}}),{sum:0,weight:0});return{v:e,barycenter:r.sum/r.weight,weight:r.weight}}return{v:e}}))}},3862:t=>{t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},3916:(t,e,n)=>{var i=n(3360),r=n(641),a=n(5389);t.exports=function(t,e){var n={};return e=a(e,3),r(t,(function(t,r,a){i(n,r,e(t,r,a))})),n}},3937:t=>{t.exports=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}},3950:t=>{t.exports=function(){}},3988:(t,e,n)=>{"use strict";var i=n(6857),r=n(8191).Graph;function a(t,e,n,r){var a;do{a=i.uniqueId(r)}while(t.hasNode(a));return n.dummy=e,t.setNode(a,n),a}function o(t){return i.max(i.map(t.nodes(),(function(e){var n=t.node(e).rank;if(!i.isUndefined(n))return n})))}t.exports={addDummyNode:a,simplify:function(t){var e=(new r).setGraph(t.graph());return i.forEach(t.nodes(),(function(n){e.setNode(n,t.node(n))})),i.forEach(t.edges(),(function(n){var i=e.edge(n.v,n.w)||{weight:0,minlen:1},r=t.edge(n);e.setEdge(n.v,n.w,{weight:i.weight+r.weight,minlen:Math.max(i.minlen,r.minlen)})})),e},asNonCompoundGraph:function(t){var e=new r({multigraph:t.isMultigraph()}).setGraph(t.graph());return i.forEach(t.nodes(),(function(n){t.children(n).length||e.setNode(n,t.node(n))})),i.forEach(t.edges(),(function(n){e.setEdge(n,t.edge(n))})),e},successorWeights:function(t){var e=i.map(t.nodes(),(function(e){var n={};return i.forEach(t.outEdges(e),(function(e){n[e.w]=(n[e.w]||0)+t.edge(e).weight})),n}));return i.zipObject(t.nodes(),e)},predecessorWeights:function(t){var e=i.map(t.nodes(),(function(e){var n={};return i.forEach(t.inEdges(e),(function(e){n[e.v]=(n[e.v]||0)+t.edge(e).weight})),n}));return i.zipObject(t.nodes(),e)},intersectRect:function(t,e){var n,i,r=t.x,a=t.y,o=e.x-r,s=e.y-a,l=t.width/2,u=t.height/2;if(!o&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*l>Math.abs(o)*u?(s<0&&(u=-u),n=u*o/s,i=u):(o<0&&(l=-l),n=l,i=l*s/o),{x:r+n,y:a+i}},buildLayerMatrix:function(t){var e=i.map(i.range(o(t)+1),(function(){return[]}));return i.forEach(t.nodes(),(function(n){var r=t.node(n),a=r.rank;i.isUndefined(a)||(e[a][r.order]=n)})),e},normalizeRanks:function(t){var e=i.min(i.map(t.nodes(),(function(e){return t.node(e).rank})));i.forEach(t.nodes(),(function(n){var r=t.node(n);i.has(r,"rank")&&(r.rank-=e)}))},removeEmptyRanks:function(t){var e=i.min(i.map(t.nodes(),(function(e){return t.node(e).rank}))),n=[];i.forEach(t.nodes(),(function(i){var r=t.node(i).rank-e;n[r]||(n[r]=[]),n[r].push(i)}));var r=0,a=t.graph().nodeRankFactor;i.forEach(n,(function(e,n){i.isUndefined(e)&&n%a!=0?--r:r&&i.forEach(e,(function(e){t.node(e).rank+=r}))}))},addBorderNode:function(t,e,n,i){var r={width:0,height:0};return arguments.length>=4&&(r.rank=n,r.order=i),a(t,"border",r,e)},maxRank:o,partition:function(t,e){var n={lhs:[],rhs:[]};return i.forEach(t,(function(t){e(t)?n.lhs.push(t):n.rhs.push(t)})),n},time:function(t,e){var n=i.now();try{return e()}finally{console.log(t+" time: "+(i.now()-n)+"ms")}},notime:function(t,e){return e()}}},4066:(t,e,n)=>{var i=n(3488);t.exports=function(t){return"function"==typeof t?t:i}},4128:(t,e,n)=>{var i=n(1800),r=/^\s+/;t.exports=function(t){return t?t.slice(0,i(t)+1).replace(r,""):t}},4218:t=>{t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},4247:t=>{t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}},4248:t=>{t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}},4335:t=>{t.exports=function(t,e){return function(n){return t(e(n))}}},4383:(t,e,n)=>{var i=n(6001),r=n(8816)((function(t,e){return null==t?{}:i(t,e)}));t.exports=r},4384:(t,e,n)=>{var i=n(6857);t.exports=function(t,e,n){var r,a={};i.forEach(n,(function(n){for(var i,o,s=t.parent(n);s;){if((i=t.parent(s))?(o=a[i],a[i]=s):(o=r,r=s),o&&o!==s)return void e.setEdge(o,s);s=i}}))}},4394:(t,e,n)=>{var i=n(2552),r=n(346);t.exports=function(t){return"symbol"==typeof t||r(t)&&"[object Symbol]"==i(t)}},4423:(t,e,n)=>{var i=n(117),r=n(6454),a=n(1737);t.exports=function(t,e){var n,o=new r,s={},l=new a;function u(t){var i=t.v===n?t.w:t.v,r=l.priority(i);if(void 0!==r){var a=e(t);a<r&&(s[i]=n,l.decrease(i,a))}}if(0===t.nodeCount())return o;i.each(t.nodes(),(function(t){l.add(t,Number.POSITIVE_INFINITY),o.setNode(t)})),l.decrease(t.nodes()[0],0);for(var c=!1;l.size()>0;){if(n=l.removeMin(),i.has(s,n))o.setEdge(n,s[n]);else{if(c)throw new Error("Input graph is not connected: "+t);c=!0}t.nodeEdges(n).forEach(u)}return o}},4458:t=>{t.exports="2.1.8"},4506:(t,e,n)=>{var i=n(3599),r=n(3335),a=n(3488);t.exports=function(t){return t&&t.length?i(t,a,r):void 0}},4509:(t,e,n)=>{var i=n(2651);t.exports=function(t){return i(this,t).has(t)}},4517:(t,e,n)=>{var i=n(6545),r=n(3950),a=n(4247),o=i&&1/a(new i([,-0]))[1]==1/0?function(t){return new i(t)}:r;t.exports=o},4520:(t,e,n)=>{var i=n(6857),r=n(3860),a=n(4959),o=n(5169);t.exports=function t(e,n,s,l){var u=e.children(n),c=e.node(n),h=c?c.borderLeft:void 0,d=c?c.borderRight:void 0,f={};h&&(u=i.filter(u,(function(t){return t!==h&&t!==d})));var p=r(e,u);i.forEach(p,(function(n){if(e.children(n.v).length){var r=t(e,n.v,s,l);f[n.v]=r,i.has(r,"barycenter")&&(a=n,o=r,i.isUndefined(a.barycenter)?(a.barycenter=o.barycenter,a.weight=o.weight):(a.barycenter=(a.barycenter*a.weight+o.barycenter*o.weight)/(a.weight+o.weight),a.weight+=o.weight))}var a,o}));var g=a(p,s);!function(t,e){i.forEach(t,(function(t){t.vs=i.flatten(t.vs.map((function(t){return e[t]?e[t].vs:t})),!0)}))}(g,f);var v=o(g,l);if(h&&(v.vs=i.flatten([h,v.vs,d],!0),e.predecessors(h).length)){var y=e.node(e.predecessors(h)[0]),m=e.node(e.predecessors(d)[0]);i.has(v,"barycenter")||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+y.order+m.order)/(v.weight+2),v.weight+=2}return v}},4528:t=>{t.exports=function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}},4664:(t,e,n)=>{var i=n(9770),r=n(3345),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(t){return null==t?[]:(t=Object(t),i(o(t),(function(e){return a.call(t,e)})))}:r;t.exports=s},4684:(t,e,n)=>{var i=n(9302),r=n(5288),a=n(6800),o=n(7241),s=Object.prototype,l=s.hasOwnProperty,u=i((function(t,e){t=Object(t);var n=-1,i=e.length,u=i>2?e[2]:void 0;for(u&&a(e[0],e[1],u)&&(i=1);++n<i;)for(var c=e[n],h=o(c),d=-1,f=h.length;++d<f;){var p=h[d],g=t[p];(void 0===g||r(g,s[p])&&!l.call(t,p))&&(t[p]=c[p])}return t}));t.exports=u},4713:(t,e,n)=>{var i=n(2523),r=n(5389),a=n(1489),o=Math.max;t.exports=function(t,e,n){var s=null==t?0:t.length;if(!s)return-1;var l=null==n?0:a(n);return l<0&&(l=o(s+l,0)),i(t,r(e,3),l)}},4733:(t,e,n)=>{var i=n(1791),r=n(5950);t.exports=function(t,e){return t&&i(e,r(e),t)}},4739:(t,e,n)=>{var i=n(6025);t.exports=function(t){var e=this.__data__,n=i(e,t);return n<0?void 0:e[n][1]}},4840:(t,e,n)=>{var i="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;t.exports=i},4850:(t,e,n)=>{"use strict";var i=n(6857);function r(t){i.forEach(t.nodes(),(function(e){a(t.node(e))})),i.forEach(t.edges(),(function(e){a(t.edge(e))}))}function a(t){var e=t.width;t.width=t.height,t.height=e}function o(t){t.y=-t.y}function s(t){var e=t.x;t.x=t.y,t.y=e}t.exports={adjust:function(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||r(t)},undo:function(t){var e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||function(t){i.forEach(t.nodes(),(function(e){o(t.node(e))})),i.forEach(t.edges(),(function(e){var n=t.edge(e);i.forEach(n.points,o),i.has(n,"y")&&o(n)}))}(t),"lr"!==e&&"rl"!==e||(function(t){i.forEach(t.nodes(),(function(e){s(t.node(e))})),i.forEach(t.edges(),(function(e){var n=t.edge(e);i.forEach(n.points,s),i.has(n,"x")&&s(n)}))}(t),r(t))}}},4894:(t,e,n)=>{var i=n(1882),r=n(294);t.exports=function(t){return null!=t&&r(t.length)&&!i(t)}},4901:(t,e,n)=>{var i=n(2552),r=n(294),a=n(346),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,t.exports=function(t){return a(t)&&r(t.length)&&!!o[i(t)]}},4919:(t,e,n)=>{var i=n(8905),r=n(117);t.exports=function(t,e,n){return r.transform(t.nodes(),(function(r,a){r[a]=i(t,a,e,n)}),{})}},4932:t=>{t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}},4959:(t,e,n)=>{"use strict";var i=n(6857);t.exports=function(t,e){var n={};return i.forEach(t,(function(t,e){var r=n[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};i.isUndefined(t.barycenter)||(r.barycenter=t.barycenter,r.weight=t.weight)})),i.forEach(e.edges(),(function(t){var e=n[t.v],r=n[t.w];i.isUndefined(e)||i.isUndefined(r)||(r.indegree++,e.out.push(n[t.w]))})),function(t){var e=[];function n(t){return function(e){var n,r,a,o;e.merged||(i.isUndefined(e.barycenter)||i.isUndefined(t.barycenter)||e.barycenter>=t.barycenter)&&(r=e,a=0,o=0,(n=t).weight&&(a+=n.barycenter*n.weight,o+=n.weight),r.weight&&(a+=r.barycenter*r.weight,o+=r.weight),n.vs=r.vs.concat(n.vs),n.barycenter=a/o,n.weight=o,n.i=Math.min(r.i,n.i),r.merged=!0)}}function r(e){return function(n){n.in.push(e),0==--n.indegree&&t.push(n)}}for(;t.length;){var a=t.pop();e.push(a),i.forEach(a.in.reverse(),n(a)),i.forEach(a.out,r(a))}return i.map(i.filter(e,(function(t){return!t.merged})),(function(t){return i.pick(t,["vs","i","barycenter","weight"])}))}(i.filter(n,(function(t){return!t.indegree})))}},4974:t=>{t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},5015:(t,e,n)=>{var i=n(2552),r=n(6449),a=n(346);t.exports=function(t){return"string"==typeof t||!r(t)&&a(t)&&"[object String]"==i(t)}},5083:(t,e,n)=>{var i=n(1882),r=n(7296),a=n(3805),o=n(7473),s=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,c=l.toString,h=u.hasOwnProperty,d=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!a(t)||r(t))&&(i(t)?d:s).test(o(t))}},5128:(t,e,n)=>{var i=n(909),r=n(4894);t.exports=function(t,e){var n=-1,a=r(t)?Array(t.length):[];return i(t,(function(t,i,r){a[++n]=e(t,i,r)})),a}},5169:(t,e,n)=>{var i=n(6857),r=n(3988);function a(t,e,n){for(var r;e.length&&(r=i.last(e)).i<=n;)e.pop(),t.push(r.vs),n++;return n}t.exports=function(t,e){var n,o=r.partition(t,(function(t){return i.has(t,"barycenter")})),s=o.lhs,l=i.sortBy(o.rhs,(function(t){return-t.i})),u=[],c=0,h=0,d=0;s.sort((n=!!e,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:n?e.i-t.i:t.i-e.i})),d=a(u,l,d),i.forEach(s,(function(t){d+=t.vs.length,u.push(t.vs),c+=t.barycenter*t.weight,h+=t.weight,d=a(u,l,d)}));var f={vs:i.flatten(u,!0)};return h&&(f.barycenter=c/h,f.weight=h),f}},5250:(t,e,n)=>{var i=n(7217),r=n(7805),a=n(6649),o=n(2824),s=n(3805),l=n(7241),u=n(4974);t.exports=function t(e,n,c,h,d){e!==n&&a(n,(function(a,l){if(d||(d=new i),s(a))o(e,n,l,c,t,h,d);else{var f=h?h(u(e,l),a,l+"",e,n,d):void 0;void 0===f&&(f=a),r(e,l,f)}}),l)}},5288:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},5325:(t,e,n)=>{var i=n(6131);t.exports=function(t,e){return!(null==t||!t.length)&&i(t,e,0)>-1}},5364:(t,e,n)=>{var i=n(5250),r=n(999)((function(t,e,n){i(t,e,n)}));t.exports=r},5378:(t,e,n)=>{var i=n(4932),r=n(5389),a=n(5128),o=n(6449);t.exports=function(t,e){return(o(t)?i:a)(t,r(e,3))}},5389:(t,e,n)=>{var i=n(3663),r=n(7978),a=n(3488),o=n(6449),s=n(583);t.exports=function(t){return"function"==typeof t?t:null==t?a:"object"==typeof t?o(t)?r(t[0],t[1]):i(t):s(t)}},5463:t=>{t.exports=function(t){return t!=t}},5481:(t,e,n)=>{var i=n(9325)["__core-js_shared__"];t.exports=i},5508:(t,e,n)=>{var i=n(6151),r=n(6800),a=n(7400);t.exports=function(t){return function(e,n,o){return o&&"number"!=typeof o&&r(e,n,o)&&(n=o=void 0),e=a(e),void 0===n?(n=e,e=0):n=a(n),o=void 0===o?e<n?1:-1:a(o),i(e,n,o,t)}}},5527:t=>{var e=Object.prototype;t.exports=function(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||e)}},5529:(t,e,n)=>{var i=n(9344),r=n(8879),a=n(5527);t.exports=function(t){return"function"!=typeof t.constructor||a(t)?{}:i(r(t))}},5558:t=>{t.exports=function(t,e,n,i,r){return r(t,(function(t,r,a){n=i?(i=!1,t):e(n,t,r,a)})),n}},5580:(t,e,n)=>{var i=n(6110)(n(9325),"DataView");t.exports=i},5749:(t,e,n)=>{var i=n(1042);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}},5765:(t,e,n)=>{var i=n(8859),r=n(5325),a=n(9905),o=n(9219),s=n(4517),l=n(4247);t.exports=function(t,e,n){var u=-1,c=r,h=t.length,d=!0,f=[],p=f;if(n)d=!1,c=a;else if(h>=200){var g=e?null:s(t);if(g)return l(g);d=!1,c=o,p=new i}else p=e?[]:f;t:for(;++u<h;){var v=t[u],y=e?e(v):v;if(v=n||0!==v?v:0,d&&y==y){for(var m=p.length;m--;)if(p[m]===y)continue t;e&&p.push(y),f.push(v)}else c(p,y,n)||(p!==f&&p.push(y),f.push(v))}return f}},5775:t=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},5802:function(t){var e;"undefined"!=typeof self&&self,e=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e){t.exports={assign:Object.assign,getHeight:function(t,e,n,i){return void 0===i&&(i="height"),"center"===n?(t[i]+e[i])/2:t.height}}},function(t,e,n){var i=n(3),r=function(){function t(t,e){void 0===e&&(e={}),this.options=e,this.rootNode=i(t,e)}return t.prototype.execute=function(){throw new Error("please override this method")},t}();t.exports=r},function(t,e,n){var i=n(4),r=["LR","RL","TB","BT","H","V"],a=["LR","RL","H"],o=r[0];t.exports=function(t,e,n){var s=e.direction||o;if(e.isHorizontal=function(t){return a.indexOf(t)>-1}(s),s&&-1===r.indexOf(s))throw new TypeError("Invalid direction: "+s);if(s===r[0])n(t,e);else if(s===r[1])n(t,e),t.right2left();else if(s===r[2])n(t,e);else if(s===r[3])n(t,e),t.bottom2top();else if(s===r[4]||s===r[5]){var l=i(t,e),u=l.left,c=l.right;n(u,e),n(c,e),e.isHorizontal?u.right2left():u.bottom2top(),c.translate(u.x-c.x,u.y-c.y),t.x=u.x,t.y=c.y;var h=t.getBoundingBox();e.isHorizontal?h.top<0&&t.translate(0,-h.top):h.left<0&&t.translate(-h.left,0)}var d=e.fixedRoot;return void 0===d&&(d=!0),d&&t.translate(-(t.x+t.width/2+t.hgap),-(t.y+t.height/2+t.vgap)),function(t,e){if(e.radial){var n=e.isHorizontal?["x","y"]:["y","x"],i=n[0],r=n[1],a={x:1/0,y:1/0},o={x:-1/0,y:-1/0},s=0;t.DFTraverse((function(t){s++;var e=t.x,n=t.y;a.x=Math.min(a.x,e),a.y=Math.min(a.y,n),o.x=Math.max(o.x,e),o.y=Math.max(o.y,n)}));var l=o[r]-a[r];if(0===l)return;var u=2*Math.PI/s;t.DFTraverse((function(e){var n=(e[r]-a[r])/l*(2*Math.PI-u)+u,o=e[i]-t[i];e.x=Math.cos(n)*o,e.y=Math.sin(n)*o}))}}(t,e),t}},function(t,e,n){var i=n(0),r={getId:function(t){return t.id||t.name},getPreH:function(t){return t.preH||0},getPreV:function(t){return t.preV||0},getHGap:function(t){return t.hgap||18},getVGap:function(t){return t.vgap||18},getChildren:function(t){return t.children},getHeight:function(t){return t.height||36},getWidth:function(t){var e=t.label||" ";return t.width||18*e.split("").length}};function a(t,e){var n=this;if(n.vgap=n.hgap=0,t instanceof a)return t;n.data=t;var i=e.getHGap(t),r=e.getVGap(t);return n.preH=e.getPreH(t),n.preV=e.getPreV(t),n.width=e.getWidth(t),n.height=e.getHeight(t),n.width+=n.preH,n.height+=n.preV,n.id=e.getId(t),n.x=n.y=0,n.depth=0,n.children||(n.children=[]),n.addGap(i,r),n}i.assign(a.prototype,{isRoot:function(){return 0===this.depth},isLeaf:function(){return 0===this.children.length},addGap:function(t,e){var n=this;n.hgap+=t,n.vgap+=e,n.width+=2*t,n.height+=2*e},eachNode:function(t){for(var e,n=[this];e=n.shift();)t(e),n=e.children.concat(n)},DFTraverse:function(t){this.eachNode(t)},BFTraverse:function(t){for(var e,n=[this];e=n.shift();)t(e),n=n.concat(e.children)},getBoundingBox:function(){var t={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode((function(e){t.left=Math.min(t.left,e.x),t.top=Math.min(t.top,e.y),t.width=Math.max(t.width,e.x+e.width),t.height=Math.max(t.height,e.y+e.height)})),t},translate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.eachNode((function(n){n.x+=t,n.y+=e,n.x+=n.preH,n.y+=n.preV}))},right2left:function(){var t=this,e=t.getBoundingBox();t.eachNode((function(t){t.x=t.x-2*(t.x-e.left)-t.width})),t.translate(e.width,0)},bottom2top:function(){var t=this,e=t.getBoundingBox();t.eachNode((function(t){t.y=t.y-2*(t.y-e.top)-t.height})),t.translate(0,e.height)}}),t.exports=function(t,e,n){void 0===e&&(e={});var o,s=new a(t,e=i.assign({},r,e)),l=[s];if(!n&&!t.collapsed)for(;o=l.shift();)if(!o.data.collapsed){var u=e.getChildren(o.data),c=u?u.length:0;if(o.children=new Array(c),u&&c)for(var h=0;h<c;h++){var d=new a(u[h],e);o.children[h]=d,l.push(d),d.parent=o,d.depth=o.depth+1}}return s}},function(t,e,n){var i=n(3);t.exports=function(t,e){for(var n=i(t.data,e,!0),r=i(t.data,e,!0),a=t.children.length,o=Math.round(a/2),s=e.getSide||function(t,e){return e<o?"right":"left"},l=0;l<a;l++){var u=t.children[l];"right"===s(u,l)?r.children.push(u):n.children.push(u)}return n.eachNode((function(t){t.isRoot()||(t.side="left")})),r.eachNode((function(t){t.isRoot()||(t.side="right")})),{left:n,right:r}}},function(t,e,n){var i={compactBox:n(6),dendrogram:n(8),indented:n(10),mindmap:n(12)};t.exports=i},function(t,e,n){function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}var r=n(1),a=n(7),o=n(2),s=n(0),l=function(t){function e(){return t.apply(this,arguments)||this}var n,r;return r=t,(n=e).prototype=Object.create(r.prototype),n.prototype.constructor=n,i(n,r),e.prototype.execute=function(){return o(this.rootNode,this.options,a)},e}(r),u={};t.exports=function(t,e){return e=s.assign({},u,e),new l(t,e).execute()}},function(t,e){function n(t,e,n,i){void 0===i&&(i=[]);var r=this;r.w=t||0,r.h=e||0,r.y=n||0,r.x=0,r.c=i||[],r.cs=i.length,r.prelim=0,r.mod=0,r.shift=0,r.change=0,r.tl=null,r.tr=null,r.el=null,r.er=null,r.msel=0,r.mser=0}function i(t,e,n){n?t.y+=e:t.x+=e,t.children.forEach((function(t){i(t,e,n)}))}function r(t,e){var n=e?t.y:t.x;return t.children.forEach((function(t){n=Math.min(r(t,e),n)})),n}function a(t,e){i(t,-r(t,e),e)}function o(t,e,n){n?e.y=t.x:e.x=t.x,t.c.forEach((function(t,i){o(t,e.children[i],n)}))}function s(t,e,n){void 0===n&&(n=0),e?(t.x=n,n+=t.width):(t.y=n,n+=t.height),t.children.forEach((function(t){s(t,e,n)}))}n.fromNode=function(t,e){if(!t)return null;var i=[];return t.children.forEach((function(t){i.push(n.fromNode(t,e))})),e?new n(t.height,t.width,t.x,i):new n(t.width,t.height,t.y,i)},t.exports=function(t,e){void 0===e&&(e={});var i=e.isHorizontal;function r(t){0===t.cs?(t.el=t,t.er=t,t.msel=t.mser=0):(t.el=t.c[0].el,t.msel=t.c[0].msel,t.er=t.c[t.cs-1].er,t.mser=t.c[t.cs-1].mser)}function l(t,e,n){for(var i=t.c[e-1],r=i.mod,a=t.c[e],o=a.mod;null!==i&&null!==a;){d(i)>n.low&&(n=n.nxt);var s=r+i.prelim+i.w-(o+a.prelim);s>0&&(o+=s,u(t,e,n.index,s));var l=d(i),f=d(a);l<=f&&null!==(i=h(i))&&(r+=i.mod),l>=f&&null!==(a=c(a))&&(o+=a.mod)}!i&&a?function(t,e,n,i){var r=t.c[0].el;r.tl=n;var a=i-n.mod-t.c[0].msel;r.mod+=a,r.prelim-=a,t.c[0].el=t.c[e].el,t.c[0].msel=t.c[e].msel}(t,e,a,o):i&&!a&&function(t,e,n,i){var r=t.c[e].er;r.tr=n;var a=i-n.mod-t.c[e].mser;r.mod+=a,r.prelim-=a,t.c[e].er=t.c[e-1].er,t.c[e].mser=t.c[e-1].mser}(t,e,i,r)}function u(t,e,n,i){t.c[e].mod+=i,t.c[e].msel+=i,t.c[e].mser+=i,function(t,e,n,i){if(n!==e-1){var r=e-n;t.c[n+1].shift+=i/r,t.c[e].shift-=i/r,t.c[e].change-=i-i/r}}(t,e,n,i)}function c(t){return 0===t.cs?t.tl:t.c[0]}function h(t){return 0===t.cs?t.tr:t.c[t.cs-1]}function d(t){return t.y+t.h}function f(t,e,n){for(;null!==n&&t>=n.low;)n=n.nxt;return{low:t,index:e,nxt:n}}s(t,i);var p=n.fromNode(t,i);return function t(e){if(0!==e.cs){t(e.c[0]);for(var n=f(d(e.c[0].el),0,null),i=1;i<e.cs;++i){t(e.c[i]);var a=d(e.c[i].er);l(e,i,n),n=f(a,i,n)}!function(t){t.prelim=(t.c[0].prelim+t.c[0].mod+t.c[t.cs-1].mod+t.c[t.cs-1].prelim+t.c[t.cs-1].w)/2-t.w/2}(e),r(e)}else r(e)}(p),function t(e,n){n+=e.mod,e.x=e.prelim+n,function(t){for(var e=0,n=0,i=0;i<t.cs;i++)n+=(e+=t.c[i].shift)+t.c[i].change,t.c[i].mod+=n}(e);for(var i=0;i<e.cs;i++)t(e.c[i],n)}(p,0),o(p,t,i),a(t,i),t}},function(t,e,n){function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}var r=n(1),a=n(9),o=n(2),s=n(0),l=function(t){function e(){return t.apply(this,arguments)||this}var n,r;return r=t,(n=e).prototype=Object.create(r.prototype),n.prototype.constructor=n,i(n,r),e.prototype.execute=function(){var t=this;return t.rootNode.width=0,o(t.rootNode,t.options,a)},e}(r),u={};t.exports=function(t,e){return e=s.assign({},u,e),new l(t,e).execute()}},function(t,e,n){var i=n(0);function r(t,e){void 0===t&&(t=0),void 0===e&&(e=[]);var n=this;n.x=n.y=0,n.leftChild=n.rightChild=null,n.height=0,n.children=e}var a={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function o(t,e,n){n?(e.x=t.x,e.y=t.y):(e.x=t.y,e.y=t.x),t.children.forEach((function(t,i){o(t,e.children[i],n)}))}t.exports=function(t,e){void 0===e&&(e={}),e=i.assign({},a,e);var n,s=0,l=function t(e){if(!e)return null;e.width=0,e.depth&&e.depth>s&&(s=e.depth);var n=e.children,i=n.length,a=new r(e.height,[]);return n.forEach((function(e,n){var r=t(e);a.children.push(r),0===n&&(a.leftChild=r),n===i-1&&(a.rightChild=r)})),a.originNode=e,a.isLeaf=e.isLeaf(),a}(t);return function t(e){if(e.isLeaf||0===e.children.length)e.drawingDepth=s;else{var n=e.children.map((function(e){return t(e)})),i=Math.min.apply(null,n);e.drawingDepth=i-1}return e.drawingDepth}(l),function t(i){i.x=i.drawingDepth*e.rankSep,i.isLeaf?(i.y=0,n&&(i.y=n.y+n.height+e.nodeSep,i.originNode.parent!==n.originNode.parent&&(i.y+=e.subTreeSep)),n=i):(i.children.forEach((function(e){t(e)})),i.y=(i.leftChild.y+i.rightChild.y)/2)}(l),o(l,t,e.isHorizontal),t}},function(t,e,n){function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}var r=n(1),a=n(11),o=n(4),s=n(0),l=["LR","RL","H"],u=l[0],c=function(t){function e(){return t.apply(this,arguments)||this}var n,r;return r=t,(n=e).prototype=Object.create(r.prototype),n.prototype.constructor=n,i(n,r),e.prototype.execute=function(){var t=this.options,e=this.rootNode;t.isHorizontal=!0;var n=t.indent,i=void 0===n?20:n,r=t.dropCap,s=void 0===r||r,c=t.direction,h=void 0===c?u:c,d=t.align;if(h&&-1===l.indexOf(h))throw new TypeError("Invalid direction: "+h);if(h===l[0])a(e,i,s,d);else if(h===l[1])a(e,i,s,d),e.right2left();else if(h===l[2]){var f=o(e,t),p=f.left,g=f.right;a(p,i,s,d),p.right2left(),a(g,i,s,d);var v=p.getBoundingBox();g.translate(v.width,0),e.x=g.x-e.width/2}return e},e}(r),h={};t.exports=function(t,e){return e=s.assign({},h,e),new c(t,e).execute()}},function(t,e,n){var i=n(0);t.exports=function(t,e,n,r){var a=null;t.eachNode((function(t){!function(t,e,n,r,a){var o=("function"==typeof n?n(t):n)*t.depth;if(!r)try{if(t.id===t.parent.children[0].id)return t.x+=o,void(t.y=e?e.y:0)}catch(t){}if(t.x+=o,e){if(t.y=e.y+i.getHeight(e,t,a),e.parent&&t.parent.id!==e.parent.id){var s=e.parent,l=s.y+i.getHeight(s,t,a);t.y=l>t.y?l:t.y}}else t.y=0}(t,a,e,n,r),a=t}))}},function(t,e,n){function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}var r=n(1),a=n(13),o=n(2),s=n(0),l=function(t){function e(){return t.apply(this,arguments)||this}var n,r;return r=t,(n=e).prototype=Object.create(r.prototype),n.prototype.constructor=n,i(n,r),e.prototype.execute=function(){return o(this.rootNode,this.options,a)},e}(r),u={};t.exports=function(t,e){return e=s.assign({},u,e),new l(t,e).execute()}},function(t,e,n){var i=n(0);function r(t,e){var n=0;return t.children.length?t.children.forEach((function(t){n+=r(t,e)})):n=t.height,t._subTreeSep=e.getSubTreeSep(t.data),t.totalHeight=Math.max(t.height,n)+2*t._subTreeSep,t.totalHeight}function a(t){var e=t.children,n=e.length;if(n){e.forEach((function(t){a(t)}));var i=e[0],r=e[n-1],o=r.y-i.y+r.height,s=0;if(e.forEach((function(t){s+=t.totalHeight})),o>t.height)t.y=i.y+o/2-t.height/2;else if(1!==e.length||t.height>s){var l=t.y+(t.height-o)/2-i.y;e.forEach((function(t){t.translate(0,l)}))}else t.y=(i.y+i.height/2+r.y+r.height/2)/2-t.height/2}}var o={getSubTreeSep:function(){return 0}};t.exports=function(t,e){void 0===e&&(e={}),e=i.assign({},o,e),t.parent={x:0,width:0,height:0,y:0},t.BFTraverse((function(t){t.x=t.parent.x+t.parent.width})),t.parent=null,r(t,e),t.startY=0,t.y=t.totalHeight/2-t.height/2,t.eachNode((function(t){var e=t.children,n=e.length;if(n){var i=e[0];if(i.startY=t.startY+t._subTreeSep,1===n)i.y=t.y+t.height/2-i.height/2;else{i.y=i.startY+i.totalHeight/2-i.height/2;for(var r=1;r<n;r++){var a=e[r];a.startY=e[r-1].startY+e[r-1].totalHeight,a.y=a.startY+a.totalHeight/2-a.height/2}}}})),a(t)}}])},t.exports=e()},5861:(t,e,n)=>{var i=n(5580),r=n(8223),a=n(2804),o=n(6545),s=n(8303),l=n(2552),u=n(7473),c="[object Map]",h="[object Promise]",d="[object Set]",f="[object WeakMap]",p="[object DataView]",g=u(i),v=u(r),y=u(a),m=u(o),b=u(s),x=l;(i&&x(new i(new ArrayBuffer(1)))!=p||r&&x(new r)!=c||a&&x(a.resolve())!=h||o&&x(new o)!=d||s&&x(new s)!=f)&&(x=function(t){var e=l(t),n="[object Object]"==e?t.constructor:void 0,i=n?u(n):"";if(i)switch(i){case g:return p;case v:return c;case y:return h;case m:return d;case b:return f}return e}),t.exports=x},5880:(t,e,n)=>{var i=n(514),r=n(5950);t.exports=function(t){return null==t?[]:i(t,r(t))}},5891:(t,e,n)=>{var i=n(1873),r=n(2428),a=n(6449),o=i?i.isConcatSpreadable:void 0;t.exports=function(t){return a(t)||r(t)||!!(o&&t&&t[o])}},5911:(t,e,n)=>{var i=n(8859),r=n(4248),a=n(9219);t.exports=function(t,e,n,o,s,l){var u=1&n,c=t.length,h=e.length;if(c!=h&&!(u&&h>c))return!1;var d=l.get(t),f=l.get(e);if(d&&f)return d==e&&f==t;var p=-1,g=!0,v=2&n?new i:void 0;for(l.set(t,e),l.set(e,t);++p<c;){var y=t[p],m=e[p];if(o)var b=u?o(m,y,p,e,t,l):o(y,m,p,t,e,l);if(void 0!==b){if(b)continue;g=!1;break}if(v){if(!r(e,(function(t,e){if(!a(v,e)&&(y===t||s(y,t,n,o,l)))return v.push(e)}))){g=!1;break}}else if(y!==m&&!s(y,m,n,o,l)){g=!1;break}}return l.delete(t),l.delete(e),g}},5950:(t,e,n)=>{var i=n(695),r=n(8984),a=n(4894);t.exports=function(t){return a(t)?i(t):r(t)}},5970:(t,e,n)=>{var i=n(3120);t.exports=function(t){return null!=t&&t.length?i(t,1):[]}},6001:(t,e,n)=>{var i=n(7420),r=n(631);t.exports=function(t,e){return i(t,e,(function(e,n){return r(t,n)}))}},6009:(t,e,n)=>{t=n.nmd(t);var i=n(4840),r=e&&!e.nodeType&&e,a=r&&t&&!t.nodeType&&t,o=a&&a.exports===r&&i.process,s=function(){try{return a&&a.require&&a.require("util").types||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=s},6016:(t,e,n)=>{var i=n(9276);t.exports=function(t,e){return i(t,e,"pre")}},6025:(t,e,n)=>{var i=n(5288);t.exports=function(t,e){for(var n=t.length;n--;)if(i(t[n][0],e))return n;return-1}},6038:(t,e,n)=>{var i=n(5861),r=n(346);t.exports=function(t){return r(t)&&"[object Set]"==i(t)}},6110:(t,e,n)=>{var i=n(5083),r=n(392);t.exports=function(t,e){var n=r(t,e);return i(n)?n:void 0}},6131:(t,e,n)=>{var i=n(2523),r=n(5463),a=n(6959);t.exports=function(t,e,n){return e==e?a(t,e,n):i(t,r,n)}},6135:(t,e,n)=>{t.exports=n(9754)},6151:t=>{var e=Math.ceil,n=Math.max;t.exports=function(t,i,r,a){for(var o=-1,s=n(e((i-t)/(r||1)),0),l=Array(s);s--;)l[a?s:++o]=t,t+=r;return l}},6155:(t,e,n)=>{var i=n(4932),r=n(7422),a=n(5389),o=n(5128),s=n(3937),l=n(7301),u=n(3714),c=n(3488),h=n(6449);t.exports=function(t,e,n){e=e.length?i(e,(function(t){return h(t)?function(e){return r(e,1===t.length?t[0]:t)}:t})):[c];var d=-1;e=i(e,l(a));var f=o(t,(function(t,n,r){return{criteria:i(e,(function(e){return e(t)})),index:++d,value:t}}));return s(f,(function(t,e){return u(t,e,n)}))}},6169:(t,e,n)=>{var i=n(9653);t.exports=function(t,e){var n=e?i(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},6176:t=>{t.exports=function(t,e){return t<e}},6189:t=>{var e=Object.prototype.hasOwnProperty;t.exports=function(t){var n=t.length,i=new t.constructor(n);return n&&"string"==typeof t[0]&&e.call(t,"index")&&(i.index=t.index,i.input=t.input),i}},6195:t=>{t.exports=function(t){return!(!t||"string"==typeof t)&&(t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))}},6246:(t,e,n)=>{t.exports={graphlib:n(8191),layout:n(8202),debug:n(8909),util:{time:n(3988).time,notime:n(3988).notime},version:n(7038)}},6291:(t,e,n)=>{var i=n(117);t.exports=function(t){var e=0,n=[],r={},a=[];function o(s){var l=r[s]={onStack:!0,lowlink:e,index:e++};if(n.push(s),t.successors(s).forEach((function(t){i.has(r,t)?r[t].onStack&&(l.lowlink=Math.min(l.lowlink,r[t].index)):(o(t),l.lowlink=Math.min(l.lowlink,r[t].lowlink))})),l.lowlink===l.index){var u,c=[];do{u=n.pop(),r[u].onStack=!1,c.push(u)}while(s!==u);a.push(c)}}return t.nodes().forEach((function(t){i.has(r,t)||o(t)})),a}},6353:(t,e,n)=>{var i=n(6857),r=n(3988);function a(t,e,n,o,s,l,u){var c=t.children(u);if(c.length){var h=r.addBorderNode(t,"_bt"),d=r.addBorderNode(t,"_bb"),f=t.node(u);t.setParent(h,u),f.borderTop=h,t.setParent(d,u),f.borderBottom=d,i.forEach(c,(function(i){a(t,e,n,o,s,l,i);var r=t.node(i),c=r.borderTop?r.borderTop:i,f=r.borderBottom?r.borderBottom:i,p=r.borderTop?o:2*o,g=c!==f?1:s-l[u]+1;t.setEdge(h,c,{weight:p,minlen:g,nestingEdge:!0}),t.setEdge(f,d,{weight:p,minlen:g,nestingEdge:!0})})),t.parent(u)||t.setEdge(e,h,{weight:0,minlen:s+l[u]})}else u!==e&&t.setEdge(e,u,{weight:0,minlen:n})}t.exports={run:function(t){var e=r.addDummyNode(t,"root",{},"_root"),n=function(t){var e={};function n(r,a){var o=t.children(r);o&&o.length&&i.forEach(o,(function(t){n(t,a+1)})),e[r]=a}return i.forEach(t.children(),(function(t){n(t,1)})),e}(t),o=i.max(i.values(n))-1,s=2*o+1;t.graph().nestingRoot=e,i.forEach(t.edges(),(function(e){t.edge(e).minlen*=s}));var l=function(t){return i.reduce(t.edges(),(function(e,n){return e+t.edge(n).weight}),0)}(t)+1;i.forEach(t.children(),(function(i){a(t,e,s,l,o,n,i)})),t.graph().nodeRankFactor=s},cleanup:function(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,i.forEach(t.edges(),(function(e){t.edge(e).nestingEdge&&t.removeEdge(e)}))}}},6375:(t,e,n)=>{var i=n(4528),r=n(8879),a=n(4664),o=n(3345),s=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)i(e,a(t)),t=r(t);return e}:o;t.exports=s},6449:t=>{var e=Array.isArray;t.exports=e},6454:(t,e,n)=>{"use strict";var i=n(117);t.exports=a;var r="\0";function a(t){this._isDirected=!i.has(t,"directed")||t.directed,this._isMultigraph=!!i.has(t,"multigraph")&&t.multigraph,this._isCompound=!!i.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=i.constant(void 0),this._defaultEdgeLabelFn=i.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function o(t,e){t[e]?t[e]++:t[e]=1}function s(t,e){--t[e]||delete t[e]}function l(t,e,n,r){var a=""+e,o=""+n;if(!t&&a>o){var s=a;a=o,o=s}return a+""+o+""+(i.isUndefined(r)?"\0":r)}function u(t,e){return l(t,e.v,e.w,e.name)}a.prototype._nodeCount=0,a.prototype._edgeCount=0,a.prototype.isDirected=function(){return this._isDirected},a.prototype.isMultigraph=function(){return this._isMultigraph},a.prototype.isCompound=function(){return this._isCompound},a.prototype.setGraph=function(t){return this._label=t,this},a.prototype.graph=function(){return this._label},a.prototype.setDefaultNodeLabel=function(t){return i.isFunction(t)||(t=i.constant(t)),this._defaultNodeLabelFn=t,this},a.prototype.nodeCount=function(){return this._nodeCount},a.prototype.nodes=function(){return i.keys(this._nodes)},a.prototype.sources=function(){var t=this;return i.filter(this.nodes(),(function(e){return i.isEmpty(t._in[e])}))},a.prototype.sinks=function(){var t=this;return i.filter(this.nodes(),(function(e){return i.isEmpty(t._out[e])}))},a.prototype.setNodes=function(t,e){var n=arguments,r=this;return i.each(t,(function(t){n.length>1?r.setNode(t,e):r.setNode(t)})),this},a.prototype.setNode=function(t,e){return i.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=r,this._children[t]={},this._children[r][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},a.prototype.node=function(t){return this._nodes[t]},a.prototype.hasNode=function(t){return i.has(this._nodes,t)},a.prototype.removeNode=function(t){var e=this;if(i.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],i.each(this.children(t),(function(t){e.setParent(t)})),delete this._children[t]),i.each(i.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],i.each(i.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},a.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(i.isUndefined(e))e=r;else{for(var n=e+="";!i.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},a.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},a.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==r)return e}},a.prototype.children=function(t){if(i.isUndefined(t)&&(t=r),this._isCompound){var e=this._children[t];if(e)return i.keys(e)}else{if(t===r)return this.nodes();if(this.hasNode(t))return[]}},a.prototype.predecessors=function(t){var e=this._preds[t];if(e)return i.keys(e)},a.prototype.successors=function(t){var e=this._sucs[t];if(e)return i.keys(e)},a.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return i.union(e,this.successors(t))},a.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},a.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var n=this;i.each(this._nodes,(function(n,i){t(i)&&e.setNode(i,n)})),i.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,n.edge(t))}));var r={};function a(t){var i=n.parent(t);return void 0===i||e.hasNode(i)?(r[t]=i,i):i in r?r[i]:a(i)}return this._isCompound&&i.each(e.nodes(),(function(t){e.setParent(t,a(t))})),e},a.prototype.setDefaultEdgeLabel=function(t){return i.isFunction(t)||(t=i.constant(t)),this._defaultEdgeLabelFn=t,this},a.prototype.edgeCount=function(){return this._edgeCount},a.prototype.edges=function(){return i.values(this._edgeObjs)},a.prototype.setPath=function(t,e){var n=this,r=arguments;return i.reduce(t,(function(t,i){return r.length>1?n.setEdge(t,i,e):n.setEdge(t,i),i})),this},a.prototype.setEdge=function(){var t,e,n,r,a=!1,s=arguments[0];"object"==typeof s&&null!==s&&"v"in s?(t=s.v,e=s.w,n=s.name,2===arguments.length&&(r=arguments[1],a=!0)):(t=s,e=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],a=!0)),t=""+t,e=""+e,i.isUndefined(n)||(n=""+n);var u=l(this._isDirected,t,e,n);if(i.has(this._edgeLabels,u))return a&&(this._edgeLabels[u]=r),this;if(!i.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[u]=a?r:this._defaultEdgeLabelFn(t,e,n);var c=function(t,e,n,i){var r=""+e,a=""+n;if(!t&&r>a){var o=r;r=a,a=o}var s={v:r,w:a};return i&&(s.name=i),s}(this._isDirected,t,e,n);return t=c.v,e=c.w,Object.freeze(c),this._edgeObjs[u]=c,o(this._preds[e],t),o(this._sucs[t],e),this._in[e][u]=c,this._out[t][u]=c,this._edgeCount++,this},a.prototype.edge=function(t,e,n){var i=1===arguments.length?u(this._isDirected,arguments[0]):l(this._isDirected,t,e,n);return this._edgeLabels[i]},a.prototype.hasEdge=function(t,e,n){var r=1===arguments.length?u(this._isDirected,arguments[0]):l(this._isDirected,t,e,n);return i.has(this._edgeLabels,r)},a.prototype.removeEdge=function(t,e,n){var i=1===arguments.length?u(this._isDirected,arguments[0]):l(this._isDirected,t,e,n),r=this._edgeObjs[i];return r&&(t=r.v,e=r.w,delete this._edgeLabels[i],delete this._edgeObjs[i],s(this._preds[e],t),s(this._sucs[t],e),delete this._in[e][i],delete this._out[t][i],this._edgeCount--),this},a.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var r=i.values(n);return e?i.filter(r,(function(t){return t.v===e})):r}},a.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var r=i.values(n);return e?i.filter(r,(function(t){return t.w===e})):r}},a.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))}},6533:(t,e,n)=>{var i=n(3599),r=n(5389),a=n(6176);t.exports=function(t,e){return t&&t.length?i(t,r(e,2),a):void 0}},6545:(t,e,n)=>{var i=n(6110)(n(9325),"Set");t.exports=i},6547:(t,e,n)=>{var i=n(3360),r=n(5288),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var o=t[e];a.call(t,e)&&r(o,n)&&(void 0!==n||e in t)||i(t,e,n)}},6574:(t,e,n)=>{var i=n(909);t.exports=function(t,e){var n=[];return i(t,(function(t,i,r){e(t,i,r)&&n.push(t)})),n}},6639:(t,e,n)=>{"use strict";var i=n(6857);function r(t,e,n){for(var r=i.zipObject(n,i.map(n,(function(t,e){return e}))),a=i.flatten(i.map(e,(function(e){return i.sortBy(i.map(t.outEdges(e),(function(e){return{pos:r[e.w],weight:t.edge(e).weight}})),"pos")})),!0),o=1;o<n.length;)o<<=1;var s=2*o-1;o-=1;var l=i.map(new Array(s),(function(){return 0})),u=0;return i.forEach(a.forEach((function(t){var e=t.pos+o;l[e]+=t.weight;for(var n=0;e>0;)e%2&&(n+=l[e+1]),l[e=e-1>>1]+=t.weight;u+=t.weight*n}))),u}t.exports=function(t,e){for(var n=0,i=1;i<e.length;++i)n+=r(t,e[i-1],e[i]);return n}},6649:(t,e,n)=>{var i=n(3221)();t.exports=i},6678:(t,e,n)=>{var i=n(117),r=n(6291);t.exports=function(t){return i.filter(r(t),(function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))}},6721:(t,e,n)=>{var i=n(1042),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(i){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return r.call(e,t)?e[t]:void 0}},6757:(t,e,n)=>{var i=n(1033),r=Math.max;t.exports=function(t,e,n){return e=r(void 0===e?t.length-1:e,0),function(){for(var a=arguments,o=-1,s=r(a.length-e,0),l=Array(s);++o<s;)l[o]=a[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=a[o];return u[e]=n(l),i(t,this,u)}}},6800:(t,e,n)=>{var i=n(5288),r=n(4894),a=n(361),o=n(3805);t.exports=function(t,e,n){if(!o(n))return!1;var s=typeof e;return!!("number"==s?r(n)&&a(e,n.length):"string"==s&&e in n)&&i(n[e],t)}},6822:(t,e,n)=>{"use strict";var i=n(6857),r=n(2031);t.exports={run:function(t){var e="greedy"===t.graph().acyclicer?r(t,function(t){return function(e){return t.edge(e).weight}}(t)):function(t){var e=[],n={},r={};return i.forEach(t.nodes(),(function a(o){i.has(r,o)||(r[o]=!0,n[o]=!0,i.forEach(t.outEdges(o),(function(t){i.has(n,t.w)?e.push(t):a(t.w)})),delete n[o])})),e}(t);i.forEach(e,(function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,i.uniqueId("rev"))}))},undo:function(t){i.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.reversed){t.removeEdge(e);var i=n.forwardName;delete n.reversed,delete n.forwardName,t.setEdge(e.w,e.v,n,i)}}))}}},6857:(t,e,n)=>{var i;try{i={cloneDeep:n(8055),constant:n(7334),defaults:n(4684),each:n(6135),filter:n(7612),find:n(7309),flatten:n(5970),forEach:n(9754),forIn:n(2420),has:n(1448),isUndefined:n(2216),last:n(8090),map:n(5378),mapValues:n(3916),max:n(4506),merge:n(5364),min:n(1684),minBy:n(6533),now:n(124),pick:n(4383),range:n(3181),reduce:n(860),sortBy:n(3031),uniqueId:n(7200),values:n(5880),zipObject:n(7248)}}catch(t){}i||(i=window._),t.exports=i},6860:(t,e,n)=>{"use strict";var i=n(6857),r=n(8481),a=n(8073).slack,o=n(8073).longestPath,s=n(8191).alg.preorder,l=n(8191).alg.postorder,u=n(3988).simplify;function c(t){t=u(t),o(t);var e,n=r(t);for(f(n),h(n,t);e=g(n);)y(n,t,e,v(n,t,e))}function h(t,e){var n=l(t,t.nodes());n=n.slice(0,n.length-1),i.forEach(n,(function(n){!function(t,e,n){var i=t.node(n).parent;t.edge(n,i).cutvalue=d(t,e,n)}(t,e,n)}))}function d(t,e,n){var r=t.node(n).parent,a=!0,o=e.edge(n,r),s=0;return o||(a=!1,o=e.edge(r,n)),s=o.weight,i.forEach(e.nodeEdges(n),(function(i){var o,l,u=i.v===n,c=u?i.w:i.v;if(c!==r){var h=u===a,d=e.edge(i).weight;if(s+=h?d:-d,o=n,l=c,t.hasEdge(o,l)){var f=t.edge(n,c).cutvalue;s+=h?-f:f}}})),s}function f(t,e){arguments.length<2&&(e=t.nodes()[0]),p(t,{},1,e)}function p(t,e,n,r,a){var o=n,s=t.node(r);return e[r]=!0,i.forEach(t.neighbors(r),(function(a){i.has(e,a)||(n=p(t,e,n,a,r))})),s.low=o,s.lim=n++,a?s.parent=a:delete s.parent,n}function g(t){return i.find(t.edges(),(function(e){return t.edge(e).cutvalue<0}))}function v(t,e,n){var r=n.v,o=n.w;e.hasEdge(r,o)||(r=n.w,o=n.v);var s=t.node(r),l=t.node(o),u=s,c=!1;s.lim>l.lim&&(u=l,c=!0);var h=i.filter(e.edges(),(function(e){return c===m(0,t.node(e.v),u)&&c!==m(0,t.node(e.w),u)}));return i.minBy(h,(function(t){return a(e,t)}))}function y(t,e,n,r){var a=n.v,o=n.w;t.removeEdge(a,o),t.setEdge(r.v,r.w,{}),f(t),h(t,e),function(t,e){var n=i.find(t.nodes(),(function(t){return!e.node(t).parent})),r=s(t,n);r=r.slice(1),i.forEach(r,(function(n){var i=t.node(n).parent,r=e.edge(n,i),a=!1;r||(r=e.edge(i,n),a=!0),e.node(n).rank=e.node(i).rank+(a?r.minlen:-r.minlen)}))}(t,e)}function m(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}t.exports=c,c.initLowLimValues=f,c.initCutValues=h,c.calcCutValue=d,c.leaveEdge=g,c.enterEdge=v,c.exchangeEdges=y},6959:t=>{t.exports=function(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}},7038:t=>{t.exports="0.8.5"},7068:(t,e,n)=>{var i=n(7217),r=n(5911),a=n(1986),o=n(689),s=n(5861),l=n(6449),u=n(3656),c=n(7167),h="[object Arguments]",d="[object Array]",f="[object Object]",p=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,g,v,y){var m=l(t),b=l(e),x=m?d:s(t),E=b?d:s(e),w=(x=x==h?f:x)==f,k=(E=E==h?f:E)==f,M=x==E;if(M&&u(t)){if(!u(e))return!1;m=!0,w=!1}if(M&&!w)return y||(y=new i),m||c(t)?r(t,e,n,g,v,y):a(t,e,x,n,g,v,y);if(!(1&n)){var S=w&&p.call(t,"__wrapped__"),N=k&&p.call(e,"__wrapped__");if(S||N){var T=S?t.value():t,A=N?e.value():e;return y||(y=new i),v(T,A,n,g,y)}}return!!M&&(y||(y=new i),o(t,e,n,g,v,y))}},7091:(t,e,n)=>{var i=n(8984),r=n(5861),a=n(4894),o=n(5015),s=n(1993);t.exports=function(t){if(null==t)return 0;if(a(t))return o(t)?s(t):t.length;var e=r(t);return"[object Map]"==e||"[object Set]"==e?t.size:i(t).length}},7167:(t,e,n)=>{var i=n(4901),r=n(7301),a=n(6009),o=a&&a.isTypedArray,s=o?r(o):i;t.exports=s},7197:t=>{t.exports=function(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}}},7199:(t,e,n)=>{var i=n(9653),r=n(6169),a=n(3201),o=n(3736),s=n(1961);t.exports=function(t,e,n){var l=t.constructor;switch(e){case"[object ArrayBuffer]":return i(t);case"[object Boolean]":case"[object Date]":return new l(+t);case"[object DataView]":return r(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(t,n);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(t);case"[object RegExp]":return a(t);case"[object Symbol]":return o(t)}}},7200:(t,e,n)=>{var i=n(3222),r=0;t.exports=function(t){var e=++r;return i(t)+e}},7217:(t,e,n)=>{var i=n(79),r=n(1420),a=n(938),o=n(3605),s=n(9817),l=n(945);function u(t){var e=this.__data__=new i(t);this.size=e.size}u.prototype.clear=r,u.prototype.delete=a,u.prototype.get=o,u.prototype.has=s,u.prototype.set=l,t.exports=u},7237:t=>{t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},7241:(t,e,n)=>{var i=n(695),r=n(2903),a=n(4894);t.exports=function(t){return a(t)?i(t,!0):r(t)}},7248:(t,e,n)=>{var i=n(6547),r=n(1234);t.exports=function(t,e){return r(t||[],e||[],i)}},7255:(t,e,n)=>{var i=n(7422);t.exports=function(t){return function(e){return i(e,t)}}},7296:(t,e,n)=>{var i,r=n(5481),a=(i=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function(t){return!!a&&a in t}},7301:t=>{t.exports=function(t){return function(e){return t(e)}}},7309:(t,e,n)=>{var i=n(2006)(n(4713));t.exports=i},7334:t=>{t.exports=function(t){return function(){return t}}},7400:(t,e,n)=>{var i=n(9374),r=1/0;t.exports=function(t){return t?(t=i(t))===r||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}},7420:(t,e,n)=>{var i=n(7422),r=n(3170),a=n(1769);t.exports=function(t,e,n){for(var o=-1,s=e.length,l={};++o<s;){var u=e[o],c=i(t,u);n(c,u)&&r(l,a(u,t),c)}return l}},7422:(t,e,n)=>{var i=n(1769),r=n(7797);t.exports=function(t,e){for(var n=0,a=(e=i(e,t)).length;null!=t&&n<a;)t=t[r(e[n++])];return n&&n==a?t:void 0}},7473:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},7494:(t,e,n)=>{var i=n(117),r=n(6454);function a(t){return i.map(t.nodes(),(function(e){var n=t.node(e),r=t.parent(e),a={v:e};return i.isUndefined(n)||(a.value=n),i.isUndefined(r)||(a.parent=r),a}))}function o(t){return i.map(t.edges(),(function(e){var n=t.edge(e),r={v:e.v,w:e.w};return i.isUndefined(e.name)||(r.name=e.name),i.isUndefined(n)||(r.value=n),r}))}t.exports={write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:a(t),edges:o(t)};return i.isUndefined(t.graph())||(e.value=i.clone(t.graph())),e},read:function(t){var e=new r(t.options).setGraph(t.value);return i.each(t.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),i.each(t.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}}},7534:(t,e,n)=>{var i=n(2552),r=n(346);t.exports=function(t){return r(t)&&"[object Arguments]"==i(t)}},7556:(t,e,n)=>{var i=n(1873),r=n(4932),a=n(6449),o=n(4394),s=i?i.prototype:void 0,l=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(a(e))return r(e,t)+"";if(o(e))return l?l.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},7612:(t,e,n)=>{var i=n(9770),r=n(6574),a=n(5389),o=n(6449);t.exports=function(t,e){return(o(t)?i:r)(t,a(e,3))}},7670:(t,e,n)=>{var i=n(2651);t.exports=function(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}},7730:(t,e,n)=>{var i=n(9172),r=n(7301),a=n(6009),o=a&&a.isMap,s=o?r(o):i;t.exports=s},7797:(t,e,n)=>{var i=n(4394);t.exports=function(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},7805:(t,e,n)=>{var i=n(3360),r=n(5288);t.exports=function(t,e,n){(void 0!==n&&!r(t[e],n)||void 0===n&&!(e in t))&&i(t,e,n)}},7828:(t,e,n)=>{var i=n(9325).Uint8Array;t.exports=i},7860:(t,e,n)=>{var i=n(6857),r=n(8191).Graph;t.exports=function(t,e,n){var a=function(t){for(var e;t.hasNode(e=i.uniqueId("_root")););return e}(t),o=new r({compound:!0}).setGraph({root:a}).setDefaultNodeLabel((function(e){return t.node(e)}));return i.forEach(t.nodes(),(function(r){var s=t.node(r),l=t.parent(r);(s.rank===e||s.minRank<=e&&e<=s.maxRank)&&(o.setNode(r),o.setParent(r,l||a),i.forEach(t[n](r),(function(e){var n=e.v===r?e.w:e.v,a=o.edge(n,r),s=i.isUndefined(a)?0:a.weight;o.setEdge(n,r,{weight:t.edge(e).weight+s})})),i.has(s,"minRank")&&o.setNode(r,{borderLeft:s.borderLeft[e],borderRight:s.borderRight[e]}))})),o}},7927:t=>{var e="\\ud800-\\udfff",n="["+e+"]",i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",a="[^"+e+"]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+i+"|"+r+")?",u="[\\ufe0e\\ufe0f]?",c=u+l+"(?:\\u200d(?:"+[a,o,s].join("|")+")"+u+l+")*",h="(?:"+[a+i+"?",i,o,s,n].join("|")+")",d=RegExp(r+"(?="+r+")|"+h+c,"g");t.exports=function(t){for(var e=d.lastIndex=0;d.test(t);)++e;return e}},7978:(t,e,n)=>{var i=n(270),r=n(8156),a=n(631),o=n(8586),s=n(756),l=n(7197),u=n(7797);t.exports=function(t,e){return o(t)&&s(e)?l(u(t),e):function(n){var o=r(n,t);return void 0===o&&o===e?a(n,t):i(e,o,3)}}},8055:(t,e,n)=>{var i=n(9999);t.exports=function(t){return i(t,5)}},8073:(t,e,n)=>{"use strict";var i=n(6857);t.exports={longestPath:function(t){var e={};i.forEach(t.sources(),(function n(r){var a=t.node(r);if(i.has(e,r))return a.rank;e[r]=!0;var o=i.min(i.map(t.outEdges(r),(function(e){return n(e.w)-t.edge(e).minlen})));return o!==Number.POSITIVE_INFINITY&&null!=o||(o=0),a.rank=o}))},slack:function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}}},8077:t=>{t.exports=function(t,e){return null!=t&&e in Object(t)}},8090:t=>{t.exports=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}},8096:t=>{t.exports=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}},8156:(t,e,n)=>{var i=n(7422);t.exports=function(t,e,n){var r=null==t?void 0:i(t,e);return void 0===r?n:r}},8191:(t,e,n)=>{var i;try{i=n(8362)}catch(t){}i||(i=window.graphlib),t.exports=i},8202:(t,e,n)=>{"use strict";var i=n(6857),r=n(6822),a=n(8209),o=n(9361),s=n(3988).normalizeRanks,l=n(2948),u=n(3988).removeEmptyRanks,c=n(6353),h=n(135),d=n(4850),f=n(1453),p=n(3776),g=n(3988),v=n(8191).Graph;t.exports=function(t,e){var n=e&&e.debugTiming?g.time:g.notime;n("layout",(function(){var e=n("  buildLayoutGraph",(function(){return function(t){var e=new v({multigraph:!0,compound:!0}),n=N(t.graph());return e.setGraph(i.merge({},m,S(n,y),i.pick(n,b))),i.forEach(t.nodes(),(function(n){var r=N(t.node(n));e.setNode(n,i.defaults(S(r,x),E)),e.setParent(n,t.parent(n))})),i.forEach(t.edges(),(function(n){var r=N(t.edge(n));e.setEdge(n,i.merge({},k,S(r,w),i.pick(r,M)))})),e}(t)}));n("  runLayout",(function(){!function(t,e){e("    makeSpaceForEdgeLabels",(function(){!function(t){var e=t.graph();e.ranksep/=2,i.forEach(t.edges(),(function(n){var i=t.edge(n);i.minlen*=2,"c"!==i.labelpos.toLowerCase()&&("TB"===e.rankdir||"BT"===e.rankdir?i.width+=i.labeloffset:i.height+=i.labeloffset)}))}(t)})),e("    removeSelfEdges",(function(){!function(t){i.forEach(t.edges(),(function(e){if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e,label:t.edge(e)}),t.removeEdge(e)}}))}(t)})),e("    acyclic",(function(){r.run(t)})),e("    nestingGraph.run",(function(){c.run(t)})),e("    rank",(function(){o(g.asNonCompoundGraph(t))})),e("    injectEdgeLabelProxies",(function(){!function(t){i.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.width&&n.height){var i=t.node(e.v),r={rank:(t.node(e.w).rank-i.rank)/2+i.rank,e};g.addDummyNode(t,"edge-proxy",r,"_ep")}}))}(t)})),e("    removeEmptyRanks",(function(){u(t)})),e("    nestingGraph.cleanup",(function(){c.cleanup(t)})),e("    normalizeRanks",(function(){s(t)})),e("    assignRankMinMax",(function(){!function(t){var e=0;i.forEach(t.nodes(),(function(n){var r=t.node(n);r.borderTop&&(r.minRank=t.node(r.borderTop).rank,r.maxRank=t.node(r.borderBottom).rank,e=i.max(e,r.maxRank))})),t.graph().maxRank=e}(t)})),e("    removeEdgeLabelProxies",(function(){!function(t){i.forEach(t.nodes(),(function(e){var n=t.node(e);"edge-proxy"===n.dummy&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))}))}(t)})),e("    normalize.run",(function(){a.run(t)})),e("    parentDummyChains",(function(){l(t)})),e("    addBorderSegments",(function(){h(t)})),e("    order",(function(){f(t)})),e("    insertSelfEdges",(function(){!function(t){var e=g.buildLayerMatrix(t);i.forEach(e,(function(e){var n=0;i.forEach(e,(function(e,r){var a=t.node(e);a.order=r+n,i.forEach(a.selfEdges,(function(e){g.addDummyNode(t,"selfedge",{width:e.label.width,height:e.label.height,rank:a.rank,order:r+ ++n,e:e.e,label:e.label},"_se")})),delete a.selfEdges}))}))}(t)})),e("    adjustCoordinateSystem",(function(){d.adjust(t)})),e("    position",(function(){p(t)})),e("    positionSelfEdges",(function(){!function(t){i.forEach(t.nodes(),(function(e){var n=t.node(e);if("selfedge"===n.dummy){var i=t.node(n.e.v),r=i.x+i.width/2,a=i.y,o=n.x-r,s=i.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:r+2*o/3,y:a-s},{x:r+5*o/6,y:a-s},{x:r+o,y:a},{x:r+5*o/6,y:a+s},{x:r+2*o/3,y:a+s}],n.label.x=n.x,n.label.y=n.y}}))}(t)})),e("    removeBorderNodes",(function(){!function(t){i.forEach(t.nodes(),(function(e){if(t.children(e).length){var n=t.node(e),r=t.node(n.borderTop),a=t.node(n.borderBottom),o=t.node(i.last(n.borderLeft)),s=t.node(i.last(n.borderRight));n.width=Math.abs(s.x-o.x),n.height=Math.abs(a.y-r.y),n.x=o.x+n.width/2,n.y=r.y+n.height/2}})),i.forEach(t.nodes(),(function(e){"border"===t.node(e).dummy&&t.removeNode(e)}))}(t)})),e("    normalize.undo",(function(){a.undo(t)})),e("    fixupEdgeLabelCoords",(function(){!function(t){i.forEach(t.edges(),(function(e){var n=t.edge(e);if(i.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(t)})),e("    undoCoordinateSystem",(function(){d.undo(t)})),e("    translateGraph",(function(){!function(t){var e=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,a=0,o=t.graph(),s=o.marginx||0,l=o.marginy||0;function u(t){var i=t.x,o=t.y,s=t.width,l=t.height;e=Math.min(e,i-s/2),n=Math.max(n,i+s/2),r=Math.min(r,o-l/2),a=Math.max(a,o+l/2)}i.forEach(t.nodes(),(function(e){u(t.node(e))})),i.forEach(t.edges(),(function(e){var n=t.edge(e);i.has(n,"x")&&u(n)})),e-=s,r-=l,i.forEach(t.nodes(),(function(n){var i=t.node(n);i.x-=e,i.y-=r})),i.forEach(t.edges(),(function(n){var a=t.edge(n);i.forEach(a.points,(function(t){t.x-=e,t.y-=r})),i.has(a,"x")&&(a.x-=e),i.has(a,"y")&&(a.y-=r)})),o.width=n-e+s,o.height=a-r+l}(t)})),e("    assignNodeIntersects",(function(){!function(t){i.forEach(t.edges(),(function(e){var n,i,r=t.edge(e),a=t.node(e.v),o=t.node(e.w);r.points?(n=r.points[0],i=r.points[r.points.length-1]):(r.points=[],n=o,i=a),r.points.unshift(g.intersectRect(a,n)),r.points.push(g.intersectRect(o,i))}))}(t)})),e("    reversePoints",(function(){!function(t){i.forEach(t.edges(),(function(e){var n=t.edge(e);n.reversed&&n.points.reverse()}))}(t)})),e("    acyclic.undo",(function(){r.undo(t)}))}(e,n)})),n("  updateInputGraph",(function(){!function(t,e){i.forEach(t.nodes(),(function(n){var i=t.node(n),r=e.node(n);i&&(i.x=r.x,i.y=r.y,e.children(n).length&&(i.width=r.width,i.height=r.height))})),i.forEach(t.edges(),(function(n){var r=t.edge(n),a=e.edge(n);r.points=a.points,i.has(a,"x")&&(r.x=a.x,r.y=a.y)})),t.graph().width=e.graph().width,t.graph().height=e.graph().height}(t,e)}))}))};var y=["nodesep","edgesep","ranksep","marginx","marginy"],m={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},b=["acyclicer","ranker","rankdir","align"],x=["width","height"],E={width:0,height:0},w=["minlen","weight","width","height","labeloffset"],k={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},M=["labelpos"];function S(t,e){return i.mapValues(i.pick(t,e),Number)}function N(t){var e={};return i.forEach(t,(function(t,n){e[n.toLowerCase()]=t})),e}},8209:(t,e,n)=>{"use strict";var i=n(6857),r=n(3988);t.exports={run:function(t){t.graph().dummyChains=[],i.forEach(t.edges(),(function(e){!function(t,e){var n,i,a,o=e.v,s=t.node(o).rank,l=e.w,u=t.node(l).rank,c=e.name,h=t.edge(e),d=h.labelRank;if(u!==s+1){for(t.removeEdge(e),a=0,++s;s<u;++a,++s)h.points=[],i={width:0,height:0,edgeLabel:h,edgeObj:e,rank:s},n=r.addDummyNode(t,"edge",i,"_d"),s===d&&(i.width=h.width,i.height=h.height,i.dummy="edge-label",i.labelpos=h.labelpos),t.setEdge(o,n,{weight:h.weight},c),0===a&&t.graph().dummyChains.push(n),o=n;t.setEdge(o,l,{weight:h.weight},c)}}(t,e)}))},undo:function(t){i.forEach(t.graph().dummyChains,(function(e){var n,i=t.node(e),r=i.edgeLabel;for(t.setEdge(i.edgeObj,r);i.dummy;)n=t.successors(e)[0],t.removeNode(e),r.points.push({x:i.x,y:i.y}),"edge-label"===i.dummy&&(r.x=i.x,r.y=i.y,r.width=i.width,r.height=i.height),e=n,i=t.node(e)}))}}},8223:(t,e,n)=>{var i=n(6110)(n(9325),"Map");t.exports=i},8303:(t,e,n)=>{var i=n(6110)(n(9325),"WeakMap");t.exports=i},8329:(t,e,n)=>{var i=n(4894);t.exports=function(t,e){return function(n,r){if(null==n)return n;if(!i(n))return t(n,r);for(var a=n.length,o=e?a:-1,s=Object(n);(e?o--:++o<a)&&!1!==r(s[o],o,s););return n}}},8362:(t,e,n)=>{var i=n(1166);t.exports={Graph:i.Graph,json:n(7494),alg:n(1667),version:i.version}},8440:(t,e,n)=>{var i=n(6038),r=n(7301),a=n(6009),o=a&&a.isSet,s=o?r(o):i;t.exports=s},8481:(t,e,n)=>{"use strict";var i=n(6857),r=n(8191).Graph,a=n(8073).slack;function o(t,e){return i.forEach(t.nodes(),(function n(r){i.forEach(e.nodeEdges(r),(function(i){var o=i.v,s=r===o?i.w:o;t.hasNode(s)||a(e,i)||(t.setNode(s,{}),t.setEdge(r,s,{}),n(s))}))})),t.nodeCount()}function s(t,e){return i.minBy(e.edges(),(function(n){if(t.hasNode(n.v)!==t.hasNode(n.w))return a(e,n)}))}function l(t,e,n){i.forEach(t.nodes(),(function(t){e.node(t).rank+=n}))}t.exports=function(t){var e,n,i=new r({directed:!1}),u=t.nodes()[0],c=t.nodeCount();for(i.setNode(u,{});o(i,t)<c;)e=s(i,t),n=i.hasNode(e.v)?a(t,e):-a(t,e),l(i,t,n);return i}},8586:(t,e,n)=>{var i=n(6449),r=n(4394),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;t.exports=function(t,e){if(i(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!r(t))||o.test(t)||!a.test(t)||null!=e&&t in Object(e)}},8655:(t,e,n)=>{var i=n(6025);t.exports=function(t){return i(this.__data__,t)>-1}},8816:(t,e,n)=>{var i=n(5970),r=n(6757),a=n(2865);t.exports=function(t){return a(r(t,void 0,i),t+"")}},8854:(t,e,n)=>{var i=n(5775),r=n(9872),a=Object.hasOwnProperty,o=Object.create(null);for(var s in i)a.call(i,s)&&(o[i[s]]=s);var l=t.exports={to:{},get:{}};function u(t,e,n){return Math.min(Math.max(e,t),n)}function c(t){var e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}l.get=function(t){var e,n;switch(t.substring(0,3).toLowerCase()){case"hsl":e=l.get.hsl(t),n="hsl";break;case"hwb":e=l.get.hwb(t),n="hwb";break;default:e=l.get.rgb(t),n="rgb"}return e?{model:n,value:e}:null},l.get.rgb=function(t){if(!t)return null;var e,n,r,o=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=e[2],e=e[1],n=0;n<3;n++){var s=2*n;o[n]=parseInt(e.slice(s,s+2),16)}r&&(o[3]=parseInt(r,16)/255)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(r=(e=e[1])[3],n=0;n<3;n++)o[n]=parseInt(e[n]+e[n],16);r&&(o[3]=parseInt(r+r,16)/255)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)o[n]=parseInt(e[n+1],0);e[4]&&(e[5]?o[3]=.01*parseFloat(e[4]):o[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(e=t.match(/^(\w+)$/))?"transparent"===e[1]?[0,0,0,0]:a.call(i,e[1])?((o=i[e[1]])[3]=1,o):null:null;for(n=0;n<3;n++)o[n]=Math.round(2.55*parseFloat(e[n+1]));e[4]&&(e[5]?o[3]=.01*parseFloat(e[4]):o[3]=parseFloat(e[4]))}for(n=0;n<3;n++)o[n]=u(o[n],0,255);return o[3]=u(o[3],0,1),o},l.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,u(parseFloat(e[2]),0,100),u(parseFloat(e[3]),0,100),u(isNaN(n)?1:n,0,1)]}return null},l.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,u(parseFloat(e[2]),0,100),u(parseFloat(e[3]),0,100),u(isNaN(n)?1:n,0,1)]}return null},l.to.hex=function(){var t=r(arguments);return"#"+c(t[0])+c(t[1])+c(t[2])+(t[3]<1?c(Math.round(255*t[3])):"")},l.to.rgb=function(){var t=r(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},l.to.rgb.percent=function(){var t=r(arguments),e=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),i=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+n+"%, "+i+"%)":"rgba("+e+"%, "+n+"%, "+i+"%, "+t[3]+")"},l.to.hsl=function(){var t=r(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},l.to.hwb=function(){var t=r(arguments),e="";return t.length>=4&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},l.to.keyword=function(t){return o[t.slice(0,3)]}},8859:(t,e,n)=>{var i=n(3661),r=n(1380),a=n(1459);function o(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new i;++e<n;)this.add(t[e])}o.prototype.add=o.prototype.push=r,o.prototype.has=a,t.exports=o},8879:(t,e,n)=>{var i=n(4335)(Object.getPrototypeOf,Object);t.exports=i},8905:(t,e,n)=>{var i=n(117),r=n(1737);t.exports=function(t,e,n,i){return function(t,e,n,i){var a,o,s={},l=new r,u=function(t){var e=t.v!==a?t.v:t.w,i=s[e],r=n(t),u=o.distance+r;if(r<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+r);u<i.distance&&(i.distance=u,i.predecessor=a,l.decrease(e,u))};for(t.nodes().forEach((function(t){var n=t===e?0:Number.POSITIVE_INFINITY;s[t]={distance:n},l.add(t,n)}));l.size()>0&&(a=l.removeMin(),(o=s[a]).distance!==Number.POSITIVE_INFINITY);)i(a).forEach(u);return s}(t,String(e),n||a,i||function(e){return t.outEdges(e)})};var a=i.constant(1)},8909:(t,e,n)=>{var i=n(6857),r=n(3988),a=n(8191).Graph;t.exports={debugOrdering:function(t){var e=r.buildLayerMatrix(t),n=new a({compound:!0,multigraph:!0}).setGraph({});return i.forEach(t.nodes(),(function(e){n.setNode(e,{label:e}),n.setParent(e,"layer"+t.node(e).rank)})),i.forEach(t.edges(),(function(t){n.setEdge(t.v,t.w,{},t.name)})),i.forEach(e,(function(t,e){var r="layer"+e;n.setNode(r,{rank:"same"}),i.reduce(t,(function(t,e){return n.setEdge(t,e,{style:"invis"}),e}))})),n}}},8918:(t,e,n)=>{"use strict";var i=n(6857);t.exports=function(t){var e={},n=i.filter(t.nodes(),(function(e){return!t.children(e).length})),r=i.max(i.map(n,(function(e){return t.node(e).rank}))),a=i.map(i.range(r+1),(function(){return[]})),o=i.sortBy(n,(function(e){return t.node(e).rank}));return i.forEach(o,(function n(r){if(!i.has(e,r)){e[r]=!0;var o=t.node(r);a[o.rank].push(r),i.forEach(t.successors(r),n)}})),a}},8948:(t,e,n)=>{var i=n(1791),r=n(6375);t.exports=function(t,e){return i(t,r(t),e)}},8984:(t,e,n)=>{var i=n(5527),r=n(3650),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return r(t);var e=[];for(var n in Object(t))a.call(t,n)&&"constructor"!=n&&e.push(n);return e}},9172:(t,e,n)=>{var i=n(5861),r=n(346);t.exports=function(t){return r(t)&&"[object Map]"==i(t)}},9219:t=>{t.exports=function(t,e){return t.has(e)}},9276:(t,e,n)=>{var i=n(117);function r(t,e,n,a,o,s){i.has(a,e)||(a[e]=!0,n||s.push(e),i.each(o(e),(function(e){r(t,e,n,a,o,s)})),n&&s.push(e))}t.exports=function(t,e,n){i.isArray(e)||(e=[e]);var a=(t.isDirected()?t.successors:t.neighbors).bind(t),o=[],s={};return i.each(e,(function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);r(t,e,"post"===n,s,a,o)})),o}},9302:(t,e,n)=>{var i=n(3488),r=n(6757),a=n(2865);t.exports=function(t,e){return a(r(t,e,i),t+"")}},9325:(t,e,n)=>{var i=n(4840),r="object"==typeof self&&self&&self.Object===Object&&self,a=i||r||Function("return this")();t.exports=a},9326:(t,e,n)=>{var i=n(1769),r=n(2428),a=n(6449),o=n(361),s=n(294),l=n(7797);t.exports=function(t,e,n){for(var u=-1,c=(e=i(e,t)).length,h=!1;++u<c;){var d=l(e[u]);if(!(h=null!=t&&n(t,d)))break;t=t[d]}return h||++u!=c?h:!!(c=null==t?0:t.length)&&s(c)&&o(d,c)&&(a(t)||r(t))}},9344:(t,e,n)=>{var i=n(3805),r=Object.create,a=function(){function t(){}return function(e){if(!i(e))return{};if(r)return r(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=a},9350:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},9361:(t,e,n)=>{"use strict";var i=n(8073).longestPath,r=n(8481),a=n(6860);t.exports=function(t){switch(t.graph().ranker){case"network-simplex":default:!function(t){a(t)}(t);break;case"tight-tree":!function(t){i(t),r(t)}(t);break;case"longest-path":o(t)}};var o=i},9374:(t,e,n)=>{var i=n(4128),r=n(3805),a=n(4394),o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(a(t))return NaN;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=i(t);var n=s.test(t);return n||l.test(t)?u(t.slice(2),n?2:8):o.test(t)?NaN:+t}},9570:(t,e,n)=>{var i=n(7334),r=n(3243),a=n(3488),o=r?function(t,e){return r(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:a;t.exports=o},9651:(t,e,n)=>{var i=n(1042);t.exports=function(){this.__data__=i?i(null):{},this.size=0}},9653:(t,e,n)=>{var i=n(7828);t.exports=function(t){var e=new t.constructor(t.byteLength);return new i(e).set(new i(t)),e}},9698:t=>{var e=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.exports=function(t){return e.test(t)}},9741:(t,e,n)=>{"use strict";var i=n(6857),r=n(8191).Graph,a=n(3988);function o(t,e){var n={};return i.reduce(e,(function(e,r){var a=0,o=0,s=e.length,u=i.last(r);return i.forEach(r,(function(e,c){var h=function(t,e){if(t.node(e).dummy)return i.find(t.predecessors(e),(function(e){return t.node(e).dummy}))}(t,e),d=h?t.node(h).order:s;(h||e===u)&&(i.forEach(r.slice(o,c+1),(function(e){i.forEach(t.predecessors(e),(function(i){var r=t.node(i),o=r.order;!(o<a||d<o)||r.dummy&&t.node(e).dummy||l(n,i,e)}))})),o=c+1,a=d)})),r})),n}function s(t,e){var n={};function r(e,r,a,o,s){var u;i.forEach(i.range(r,a),(function(r){u=e[r],t.node(u).dummy&&i.forEach(t.predecessors(u),(function(e){var i=t.node(e);i.dummy&&(i.order<o||i.order>s)&&l(n,e,u)}))}))}return i.reduce(e,(function(e,n){var a,o=-1,s=0;return i.forEach(n,(function(i,l){if("border"===t.node(i).dummy){var u=t.predecessors(i);u.length&&(a=t.node(u[0]).order,r(n,s,l,o,a),s=l,o=a)}r(n,s,n.length,a,e.length)})),n})),n}function l(t,e,n){if(e>n){var i=e;e=n,n=i}var r=t[e];r||(t[e]=r={}),r[n]=!0}function u(t,e,n){if(e>n){var r=e;e=n,n=r}return i.has(t[e],n)}function c(t,e,n,r){var a={},o={},s={};return i.forEach(e,(function(t){i.forEach(t,(function(t,e){a[t]=t,o[t]=t,s[t]=e}))})),i.forEach(e,(function(t){var e=-1;i.forEach(t,(function(t){var l=r(t);if(l.length){l=i.sortBy(l,(function(t){return s[t]}));for(var c=(l.length-1)/2,h=Math.floor(c),d=Math.ceil(c);h<=d;++h){var f=l[h];o[t]===t&&e<s[f]&&!u(n,t,f)&&(o[f]=t,o[t]=a[t]=a[f],e=s[f])}}}))})),{root:a,align:o}}function h(t,e,n,a,o){var s={},l=function(t,e,n,a){var o=new r,s=t.graph(),l=function(t,e,n){return function(r,a,o){var s,l=r.node(a),u=r.node(o),c=0;if(c+=l.width/2,i.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":s=-l.width/2;break;case"r":s=l.width/2}if(s&&(c+=n?s:-s),s=0,c+=(l.dummy?e:t)/2,c+=(u.dummy?e:t)/2,c+=u.width/2,i.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":s=u.width/2;break;case"r":s=-u.width/2}return s&&(c+=n?s:-s),s=0,c}}(s.nodesep,s.edgesep,a);return i.forEach(e,(function(e){var r;i.forEach(e,(function(e){var i=n[e];if(o.setNode(i),r){var a=n[r],s=o.edge(a,i);o.setEdge(a,i,Math.max(l(t,e,r),s||0))}r=e}))})),o}(t,e,n,o),u=o?"borderLeft":"borderRight";function c(t,e){for(var n=l.nodes(),i=n.pop(),r={};i;)r[i]?t(i):(r[i]=!0,n.push(i),n=n.concat(e(i))),i=n.pop()}return c((function(t){s[t]=l.inEdges(t).reduce((function(t,e){return Math.max(t,s[e.v]+l.edge(e))}),0)}),l.predecessors.bind(l)),c((function(e){var n=l.outEdges(e).reduce((function(t,e){return Math.min(t,s[e.w]-l.edge(e))}),Number.POSITIVE_INFINITY),i=t.node(e);n!==Number.POSITIVE_INFINITY&&i.borderType!==u&&(s[e]=Math.max(s[e],n))}),l.successors.bind(l)),i.forEach(a,(function(t){s[t]=s[n[t]]})),s}function d(t,e){return i.minBy(i.values(e),(function(e){var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return i.forIn(e,(function(e,i){var a=function(t,e){return t.node(e).width}(t,i)/2;n=Math.max(e+a,n),r=Math.min(e-a,r)})),n-r}))}function f(t,e){var n=i.values(e),r=i.min(n),a=i.max(n);i.forEach(["u","d"],(function(n){i.forEach(["l","r"],(function(o){var s,l=n+o,u=t[l];if(u!==e){var c=i.values(u);(s="l"===o?r-i.min(c):a-i.max(c))&&(t[l]=i.mapValues(u,(function(t){return t+s})))}}))}))}function p(t,e){return i.mapValues(t.ul,(function(n,r){if(e)return t[e.toLowerCase()][r];var a=i.sortBy(i.map(t,r));return(a[1]+a[2])/2}))}t.exports={positionX:function(t){var e,n=a.buildLayerMatrix(t),r=i.merge(o(t,n),s(t,n)),l={};i.forEach(["u","d"],(function(a){e="u"===a?n:i.values(n).reverse(),i.forEach(["l","r"],(function(n){"r"===n&&(e=i.map(e,(function(t){return i.values(t).reverse()})));var o=("u"===a?t.predecessors:t.successors).bind(t),s=c(0,e,r,o),u=h(t,e,s.root,s.align,"r"===n);"r"===n&&(u=i.mapValues(u,(function(t){return-t}))),l[a+n]=u}))}));var u=d(t,l);return f(l,u),p(l,t.graph().align)},findType1Conflicts:o,findType2Conflicts:s,addConflict:l,hasConflict:u,verticalAlignment:c,horizontalCompaction:h,alignCoordinates:f,findSmallestWidthAlignment:d,balance:p}},9752:(t,e,n)=>{var i=n(3729),r=n(9344),a=n(641),o=n(5389),s=n(8879),l=n(6449),u=n(3656),c=n(1882),h=n(3805),d=n(7167);t.exports=function(t,e,n){var f=l(t),p=f||u(t)||d(t);if(e=o(e,4),null==n){var g=t&&t.constructor;n=p?f?new g:[]:h(t)&&c(g)?r(s(t)):{}}return(p?i:a)(t,(function(t,i,r){return e(n,t,i,r)})),n}},9754:(t,e,n)=>{var i=n(3729),r=n(909),a=n(4066),o=n(6449);t.exports=function(t,e){return(o(t)?i:r)(t,a(e))}},9770:t=>{t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length,r=0,a=[];++n<i;){var o=t[n];e(o,n,t)&&(a[r++]=o)}return a}},9811:(t,e,n)=>{var i=n(7237)("length");t.exports=i},9817:t=>{t.exports=function(t){return this.__data__.has(t)}},9859:t=>{function e(){var t={};t._next=t._prev=t,this._sentinel=t}function n(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function i(t,e){if("_next"!==t&&"_prev"!==t)return e}t.exports=e,e.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return n(e),e},e.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&n(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e},e.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,i)),n=n._prev;return"["+t.join(", ")+"]"}},9872:(t,e,n)=>{"use strict";var i=n(6195),r=Array.prototype.concat,a=Array.prototype.slice,o=t.exports=function(t){for(var e=[],n=0,o=t.length;n<o;n++){var s=t[n];i(s)?e=r.call(e,a.call(s)):e.push(s)}return e};o.wrap=function(t){return function(){return t(o(arguments))}}},9884:(t,e,n)=>{var i=n(1791),r=n(7241);t.exports=function(t){return i(t,r(t))}},9888:(t,e,n)=>{var i=n(117);function r(t){var e={},n={},r=[];if(i.each(t.sinks(),(function o(s){if(i.has(n,s))throw new a;i.has(e,s)||(n[s]=!0,e[s]=!0,i.each(t.predecessors(s),o),delete n[s],r.push(s))})),i.size(e)!==t.nodeCount())throw new a;return r}function a(){}t.exports=r,r.CycleException=a,a.prototype=new Error},9905:t=>{t.exports=function(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}},9935:t=>{t.exports=function(){return!1}},9999:(t,e,n)=>{var i=n(7217),r=n(3729),a=n(6547),o=n(4733),s=n(3838),l=n(3290),u=n(3007),c=n(2271),h=n(8948),d=n(2),f=n(3349),p=n(5861),g=n(6189),v=n(7199),y=n(5529),m=n(6449),b=n(3656),x=n(7730),E=n(3805),w=n(8440),k=n(5950),M=n(7241),S="[object Arguments]",N="[object Function]",T="[object Object]",A={};A[S]=A["[object Array]"]=A["[object ArrayBuffer]"]=A["[object DataView]"]=A["[object Boolean]"]=A["[object Date]"]=A["[object Float32Array]"]=A["[object Float64Array]"]=A["[object Int8Array]"]=A["[object Int16Array]"]=A["[object Int32Array]"]=A["[object Map]"]=A["[object Number]"]=A[T]=A["[object RegExp]"]=A["[object Set]"]=A["[object String]"]=A["[object Symbol]"]=A["[object Uint8Array]"]=A["[object Uint8ClampedArray]"]=A["[object Uint16Array]"]=A["[object Uint32Array]"]=!0,A["[object Error]"]=A[N]=A["[object WeakMap]"]=!1,t.exports=function t(e,n,O,P,C,R){var L,D=1&n,I=2&n,_=4&n;if(O&&(L=C?O(e,P,C,R):O(e)),void 0!==L)return L;if(!E(e))return e;var B=m(e);if(B){if(L=g(e),!D)return u(e,L)}else{var F=p(e),j=F==N||"[object GeneratorFunction]"==F;if(b(e))return l(e,D);if(F==T||F==S||j&&!C){if(L=I||j?{}:y(e),!D)return I?h(e,s(L,e)):c(e,o(L,e))}else{if(!A[F])return C?e:{};L=v(e,F,D)}}R||(R=new i);var G=R.get(e);if(G)return G;R.set(e,L),w(e)?e.forEach((function(i){L.add(t(i,n,O,i,e,R))})):x(e)&&e.forEach((function(i,r){L.set(r,t(i,n,O,r,e,R))}));var z=B?void 0:(_?I?f:d:I?M:k)(e);return r(z||e,(function(i,r){z&&(i=e[r=i]),a(L,r,t(i,n,O,r,e,R))})),L}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var a=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.u=t=>t+".js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=i[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href,(()=>{"use strict";var t={};n.r(t),n.d(t,{add:()=>Ft,adjoint:()=>it,clone:()=>K,copy:()=>Z,create:()=>q,determinant:()=>rt,equals:()=>Wt,exactEquals:()=>Vt,frob:()=>Bt,fromQuat:()=>St,fromQuat2:()=>bt,fromRotation:()=>pt,fromRotationTranslation:()=>mt,fromRotationTranslationScale:()=>kt,fromRotationTranslationScaleOrigin:()=>Mt,fromScaling:()=>ft,fromTranslation:()=>dt,fromValues:()=>Q,fromXRotation:()=>gt,fromYRotation:()=>vt,fromZRotation:()=>yt,frustum:()=>Nt,getRotation:()=>wt,getScaling:()=>Et,getTranslation:()=>xt,identity:()=>tt,invert:()=>nt,lookAt:()=>Dt,mul:()=>Ut,multiply:()=>at,multiplyScalar:()=>Gt,multiplyScalarAndAdd:()=>zt,ortho:()=>Rt,orthoNO:()=>Ct,orthoZO:()=>Lt,perspective:()=>At,perspectiveFromFieldOfView:()=>Pt,perspectiveNO:()=>Tt,perspectiveZO:()=>Ot,rotate:()=>lt,rotateX:()=>ut,rotateY:()=>ct,rotateZ:()=>ht,scale:()=>st,set:()=>J,str:()=>_t,sub:()=>Ht,subtract:()=>jt,targetTo:()=>It,translate:()=>ot,transpose:()=>et});var e={};function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}function a(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function c(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function d(t,e){if(t){if("string"==typeof t)return h(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function f(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function g(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(g=function(){return!!t})()}function v(t,e,n){return e=p(e),function(t,e){if(e&&("object"==i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,g()?Reflect.construct(e,n||[],p(t).constructor):e.apply(t,n))}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,o,s=[],l=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(s.push(i.value),s.length!==e);l=!0);}catch(t){u=!0,r=t}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}(t,e)||d(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.r(e),n.d(e,{circle:()=>bg,diamond:()=>Eg,rect:()=>kg,simple:()=>Sg,triangle:()=>xg,triangleRect:()=>Mg,vee:()=>wg}),HTMLWidgets;const x=n(228);var E=1e-6,w="undefined"!=typeof Float32Array?Float32Array:Array;function k(){var t=new w(3);return w!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function M(t){var e=new w(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function S(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function N(t,e,n){var i=new w(3);return i[0]=t,i[1]=e,i[2]=n,i}function T(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function A(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function O(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function P(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function C(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function R(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function L(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function D(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function I(t,e){var n=e[0],i=e[1],r=e[2],a=n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function _(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function B(t,e,n){var i=e[0],r=e[1],a=e[2],o=n[0],s=n[1],l=n[2];return t[0]=r*l-a*s,t[1]=a*o-i*l,t[2]=i*s-r*o,t}function F(t,e,n,i){var r=e[0],a=e[1],o=e[2];return t[0]=r+i*(n[0]-r),t[1]=a+i*(n[1]-a),t[2]=o+i*(n[2]-o),t}function j(t,e,n){var i=e[0],r=e[1],a=e[2],o=n[3]*i+n[7]*r+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*i+n[4]*r+n[8]*a+n[12])/o,t[1]=(n[1]*i+n[5]*r+n[9]*a+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*a+n[14])/o,t}function G(t,e,n){var i=e[0],r=e[1],a=e[2];return t[0]=i*n[0]+r*n[3]+a*n[6],t[1]=i*n[1]+r*n[4]+a*n[7],t[2]=i*n[2]+r*n[5]+a*n[8],t}function z(t,e,n){var i=n[0],r=n[1],a=n[2],o=n[3],s=e[0],l=e[1],u=e[2],c=r*u-a*l,h=a*s-i*u,d=i*l-r*s,f=r*d-a*h,p=a*c-i*d,g=i*h-r*c,v=2*o;return c*=v,h*=v,d*=v,f*=2,p*=2,g*=2,t[0]=s+c+f,t[1]=l+h+p,t[2]=u+d+g,t}function V(t,e){var n=t[0],i=t[1],r=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(n-a)<=E*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=E*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-s)<=E*Math.max(1,Math.abs(r),Math.abs(s))}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var W=P,U=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.hypot(n,i,r)},H=S;function Y(){var t=new w(4);return w!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function $(t,e,n,i){var r=new w(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}function X(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*a+n[12]*o,t[1]=n[1]*i+n[5]*r+n[9]*a+n[13]*o,t[2]=n[2]*i+n[6]*r+n[10]*a+n[14]*o,t[3]=n[3]*i+n[7]*r+n[11]*a+n[15]*o,t}function q(){var t=new w(16);return w!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function K(t){var e=new w(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Z(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Q(t,e,n,i,r,a,o,s,l,u,c,h,d,f,p,g){var v=new w(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=i,v[4]=r,v[5]=a,v[6]=o,v[7]=s,v[8]=l,v[9]=u,v[10]=c,v[11]=h,v[12]=d,v[13]=f,v[14]=p,v[15]=g,v}function J(t,e,n,i,r,a,o,s,l,u,c,h,d,f,p,g,v){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=f,t[13]=p,t[14]=g,t[15]=v,t}function tt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function et(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=a,t[11]=e[14],t[12]=r,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function nt(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],y=e[15],m=n*s-i*o,b=n*l-r*o,x=n*u-a*o,E=i*l-r*s,w=i*u-a*s,k=r*u-a*l,M=c*g-h*p,S=c*v-d*p,N=c*y-f*p,T=h*v-d*g,A=h*y-f*g,O=d*y-f*v,P=m*O-b*A+x*T+E*N-w*S+k*M;return P?(P=1/P,t[0]=(s*O-l*A+u*T)*P,t[1]=(r*A-i*O-a*T)*P,t[2]=(g*k-v*w+y*E)*P,t[3]=(d*w-h*k-f*E)*P,t[4]=(l*N-o*O-u*S)*P,t[5]=(n*O-r*N+a*S)*P,t[6]=(v*x-p*k-y*b)*P,t[7]=(c*k-d*x+f*b)*P,t[8]=(o*A-s*N+u*M)*P,t[9]=(i*N-n*A-a*M)*P,t[10]=(p*w-g*x+y*m)*P,t[11]=(h*x-c*w-f*m)*P,t[12]=(s*S-o*T-l*M)*P,t[13]=(n*T-i*S+r*M)*P,t[14]=(g*b-p*E-v*m)*P,t[15]=(c*E-h*b+d*m)*P,t):null}function it(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],y=e[15];return t[0]=s*(d*y-f*v)-h*(l*y-u*v)+g*(l*f-u*d),t[1]=-(i*(d*y-f*v)-h*(r*y-a*v)+g*(r*f-a*d)),t[2]=i*(l*y-u*v)-s*(r*y-a*v)+g*(r*u-a*l),t[3]=-(i*(l*f-u*d)-s*(r*f-a*d)+h*(r*u-a*l)),t[4]=-(o*(d*y-f*v)-c*(l*y-u*v)+p*(l*f-u*d)),t[5]=n*(d*y-f*v)-c*(r*y-a*v)+p*(r*f-a*d),t[6]=-(n*(l*y-u*v)-o*(r*y-a*v)+p*(r*u-a*l)),t[7]=n*(l*f-u*d)-o*(r*f-a*d)+c*(r*u-a*l),t[8]=o*(h*y-f*g)-c*(s*y-u*g)+p*(s*f-u*h),t[9]=-(n*(h*y-f*g)-c*(i*y-a*g)+p*(i*f-a*h)),t[10]=n*(s*y-u*g)-o*(i*y-a*g)+p*(i*u-a*s),t[11]=-(n*(s*f-u*h)-o*(i*f-a*h)+c*(i*u-a*s)),t[12]=-(o*(h*v-d*g)-c*(s*v-l*g)+p*(s*d-l*h)),t[13]=n*(h*v-d*g)-c*(i*v-r*g)+p*(i*d-r*h),t[14]=-(n*(s*v-l*g)-o*(i*v-r*g)+p*(i*l-r*s)),t[15]=n*(s*d-l*h)-o*(i*d-r*h)+c*(i*l-r*s),t}function rt(t){var e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],g=t[14],v=t[15];return(e*o-n*a)*(h*v-d*g)-(e*s-i*a)*(c*v-d*p)+(e*l-r*a)*(c*g-h*p)+(n*s-i*o)*(u*v-d*f)-(n*l-r*o)*(u*g-h*f)+(i*l-r*s)*(u*p-c*f)}function at(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],g=e[12],v=e[13],y=e[14],m=e[15],b=n[0],x=n[1],E=n[2],w=n[3];return t[0]=b*i+x*s+E*h+w*g,t[1]=b*r+x*l+E*d+w*v,t[2]=b*a+x*u+E*f+w*y,t[3]=b*o+x*c+E*p+w*m,b=n[4],x=n[5],E=n[6],w=n[7],t[4]=b*i+x*s+E*h+w*g,t[5]=b*r+x*l+E*d+w*v,t[6]=b*a+x*u+E*f+w*y,t[7]=b*o+x*c+E*p+w*m,b=n[8],x=n[9],E=n[10],w=n[11],t[8]=b*i+x*s+E*h+w*g,t[9]=b*r+x*l+E*d+w*v,t[10]=b*a+x*u+E*f+w*y,t[11]=b*o+x*c+E*p+w*m,b=n[12],x=n[13],E=n[14],w=n[15],t[12]=b*i+x*s+E*h+w*g,t[13]=b*r+x*l+E*d+w*v,t[14]=b*a+x*u+E*f+w*y,t[15]=b*o+x*c+E*p+w*m,t}function ot(t,e,n){var i,r,a,o,s,l,u,c,h,d,f,p,g=n[0],v=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*v+e[8]*y+e[12],t[13]=e[1]*g+e[5]*v+e[9]*y+e[13],t[14]=e[2]*g+e[6]*v+e[10]*y+e[14],t[15]=e[3]*g+e[7]*v+e[11]*y+e[15]):(i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=d,t[10]=f,t[11]=p,t[12]=i*g+s*v+h*y+e[12],t[13]=r*g+l*v+d*y+e[13],t[14]=a*g+u*v+f*y+e[14],t[15]=o*g+c*v+p*y+e[15]),t}function st(t,e,n){var i=n[0],r=n[1],a=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function lt(t,e,n,i){var r,a,o,s,l,u,c,h,d,f,p,g,v,y,m,b,x,w,k,M,S,N,T,A,O=i[0],P=i[1],C=i[2],R=Math.hypot(O,P,C);return R<E?null:(O*=R=1/R,P*=R,C*=R,r=Math.sin(n),o=1-(a=Math.cos(n)),s=e[0],l=e[1],u=e[2],c=e[3],h=e[4],d=e[5],f=e[6],p=e[7],g=e[8],v=e[9],y=e[10],m=e[11],b=O*O*o+a,x=P*O*o+C*r,w=C*O*o-P*r,k=O*P*o-C*r,M=P*P*o+a,S=C*P*o+O*r,N=O*C*o+P*r,T=P*C*o-O*r,A=C*C*o+a,t[0]=s*b+h*x+g*w,t[1]=l*b+d*x+v*w,t[2]=u*b+f*x+y*w,t[3]=c*b+p*x+m*w,t[4]=s*k+h*M+g*S,t[5]=l*k+d*M+v*S,t[6]=u*k+f*M+y*S,t[7]=c*k+p*M+m*S,t[8]=s*N+h*T+g*A,t[9]=l*N+d*T+v*A,t[10]=u*N+f*T+y*A,t[11]=c*N+p*T+m*A,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ut(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+u*i,t[5]=o*r+c*i,t[6]=s*r+h*i,t[7]=l*r+d*i,t[8]=u*r-a*i,t[9]=c*r-o*i,t[10]=h*r-s*i,t[11]=d*r-l*i,t}function ct(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r-u*i,t[1]=o*r-c*i,t[2]=s*r-h*i,t[3]=l*r-d*i,t[8]=a*i+u*r,t[9]=o*i+c*r,t[10]=s*i+h*r,t[11]=l*i+d*r,t}function ht(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+u*i,t[1]=o*r+c*i,t[2]=s*r+h*i,t[3]=l*r+d*i,t[4]=u*r-a*i,t[5]=c*r-o*i,t[6]=h*r-s*i,t[7]=d*r-l*i,t}function dt(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function ft(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pt(t,e,n){var i,r,a,o=n[0],s=n[1],l=n[2],u=Math.hypot(o,s,l);return u<E?null:(o*=u=1/u,s*=u,l*=u,i=Math.sin(e),a=1-(r=Math.cos(e)),t[0]=o*o*a+r,t[1]=s*o*a+l*i,t[2]=l*o*a-s*i,t[3]=0,t[4]=o*s*a-l*i,t[5]=s*s*a+r,t[6]=l*s*a+o*i,t[7]=0,t[8]=o*l*a+s*i,t[9]=s*l*a-o*i,t[10]=l*l*a+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function gt(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vt(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function yt(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mt(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=i+i,l=r+r,u=a+a,c=i*s,h=i*l,d=i*u,f=r*l,p=r*u,g=a*u,v=o*s,y=o*l,m=o*u;return t[0]=1-(f+g),t[1]=h+m,t[2]=d-y,t[3]=0,t[4]=h-m,t[5]=1-(c+g),t[6]=p+v,t[7]=0,t[8]=d+y,t[9]=p-v,t[10]=1-(c+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function bt(t,e){var n=new w(3),i=-e[0],r=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=i*i+r*r+a*a+o*o;return h>0?(n[0]=2*(s*o+c*i+l*a-u*r)/h,n[1]=2*(l*o+c*r+u*i-s*a)/h,n[2]=2*(u*o+c*a+s*r-l*i)/h):(n[0]=2*(s*o+c*i+l*a-u*r),n[1]=2*(l*o+c*r+u*i-s*a),n[2]=2*(u*o+c*a+s*r-l*i)),mt(t,e,n),t}function xt(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Et(t,e){var n=e[0],i=e[1],r=e[2],a=e[4],o=e[5],s=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(l,u,c),t}function wt(t,e){var n=new w(3);Et(n,e);var i=1/n[0],r=1/n[1],a=1/n[2],o=e[0]*i,s=e[1]*r,l=e[2]*a,u=e[4]*i,c=e[5]*r,h=e[6]*a,d=e[8]*i,f=e[9]*r,p=e[10]*a,g=o+c+p,v=0;return g>0?(v=2*Math.sqrt(g+1),t[3]=.25*v,t[0]=(h-f)/v,t[1]=(d-l)/v,t[2]=(s-u)/v):o>c&&o>p?(v=2*Math.sqrt(1+o-c-p),t[3]=(h-f)/v,t[0]=.25*v,t[1]=(s+u)/v,t[2]=(d+l)/v):c>p?(v=2*Math.sqrt(1+c-o-p),t[3]=(d-l)/v,t[0]=(s+u)/v,t[1]=.25*v,t[2]=(h+f)/v):(v=2*Math.sqrt(1+p-o-c),t[3]=(s-u)/v,t[0]=(d+l)/v,t[1]=(h+f)/v,t[2]=.25*v),t}function kt(t,e,n,i){var r=e[0],a=e[1],o=e[2],s=e[3],l=r+r,u=a+a,c=o+o,h=r*l,d=r*u,f=r*c,p=a*u,g=a*c,v=o*c,y=s*l,m=s*u,b=s*c,x=i[0],E=i[1],w=i[2];return t[0]=(1-(p+v))*x,t[1]=(d+b)*x,t[2]=(f-m)*x,t[3]=0,t[4]=(d-b)*E,t[5]=(1-(h+v))*E,t[6]=(g+y)*E,t[7]=0,t[8]=(f+m)*w,t[9]=(g-y)*w,t[10]=(1-(h+p))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Mt(t,e,n,i,r){var a=e[0],o=e[1],s=e[2],l=e[3],u=a+a,c=o+o,h=s+s,d=a*u,f=a*c,p=a*h,g=o*c,v=o*h,y=s*h,m=l*u,b=l*c,x=l*h,E=i[0],w=i[1],k=i[2],M=r[0],S=r[1],N=r[2],T=(1-(g+y))*E,A=(f+x)*E,O=(p-b)*E,P=(f-x)*w,C=(1-(d+y))*w,R=(v+m)*w,L=(p+b)*k,D=(v-m)*k,I=(1-(d+g))*k;return t[0]=T,t[1]=A,t[2]=O,t[3]=0,t[4]=P,t[5]=C,t[6]=R,t[7]=0,t[8]=L,t[9]=D,t[10]=I,t[11]=0,t[12]=n[0]+M-(T*M+P*S+L*N),t[13]=n[1]+S-(A*M+C*S+D*N),t[14]=n[2]+N-(O*M+R*S+I*N),t[15]=1,t}function St(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=n+n,s=i+i,l=r+r,u=n*o,c=i*o,h=i*s,d=r*o,f=r*s,p=r*l,g=a*o,v=a*s,y=a*l;return t[0]=1-h-p,t[1]=c+y,t[2]=d-v,t[3]=0,t[4]=c-y,t[5]=1-u-p,t[6]=f+g,t[7]=0,t[8]=d+v,t[9]=f-g,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Nt(t,e,n,i,r,a,o){var s=1/(n-e),l=1/(r-i),u=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*l,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(r+i)*l,t[10]=(o+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*u,t[15]=0,t}function Tt(t,e,n,i,r){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(a=1/(i-r),t[10]=(r+i)*a,t[14]=2*r*i*a):(t[10]=-1,t[14]=-2*i),t}k(),Y();var At=Tt;function Ot(t,e,n,i,r){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(a=1/(i-r),t[10]=r*a,t[14]=r*i*a):(t[10]=-1,t[14]=-i),t}function Pt(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(r+a);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-s)*l*.5,t[9]=(r-a)*u*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t}function Ct(t,e,n,i,r,a,o){var s=1/(e-n),l=1/(i-r),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=(o+a)*u,t[15]=1,t}var Rt=Ct;function Lt(t,e,n,i,r,a,o){var s=1/(e-n),l=1/(i-r),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=a*u,t[15]=1,t}function Dt(t,e,n,i){var r,a,o,s,l,u,c,h,d,f,p=e[0],g=e[1],v=e[2],y=i[0],m=i[1],b=i[2],x=n[0],w=n[1],k=n[2];return Math.abs(p-x)<E&&Math.abs(g-w)<E&&Math.abs(v-k)<E?tt(t):(c=p-x,h=g-w,d=v-k,r=m*(d*=f=1/Math.hypot(c,h,d))-b*(h*=f),a=b*(c*=f)-y*d,o=y*h-m*c,(f=Math.hypot(r,a,o))?(r*=f=1/f,a*=f,o*=f):(r=0,a=0,o=0),s=h*o-d*a,l=d*r-c*o,u=c*a-h*r,(f=Math.hypot(s,l,u))?(s*=f=1/f,l*=f,u*=f):(s=0,l=0,u=0),t[0]=r,t[1]=s,t[2]=c,t[3]=0,t[4]=a,t[5]=l,t[6]=h,t[7]=0,t[8]=o,t[9]=u,t[10]=d,t[11]=0,t[12]=-(r*p+a*g+o*v),t[13]=-(s*p+l*g+u*v),t[14]=-(c*p+h*g+d*v),t[15]=1,t)}function It(t,e,n,i){var r=e[0],a=e[1],o=e[2],s=i[0],l=i[1],u=i[2],c=r-n[0],h=a-n[1],d=o-n[2],f=c*c+h*h+d*d;f>0&&(c*=f=1/Math.sqrt(f),h*=f,d*=f);var p=l*d-u*h,g=u*c-s*d,v=s*h-l*c;return(f=p*p+g*g+v*v)>0&&(p*=f=1/Math.sqrt(f),g*=f,v*=f),t[0]=p,t[1]=g,t[2]=v,t[3]=0,t[4]=h*v-d*g,t[5]=d*p-c*v,t[6]=c*g-h*p,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=r,t[13]=a,t[14]=o,t[15]=1,t}function _t(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Bt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ft(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function jt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Gt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function zt(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t}function Vt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Wt(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],v=t[14],y=t[15],m=e[0],b=e[1],x=e[2],w=e[3],k=e[4],M=e[5],S=e[6],N=e[7],T=e[8],A=e[9],O=e[10],P=e[11],C=e[12],R=e[13],L=e[14],D=e[15];return Math.abs(n-m)<=E*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(i-b)<=E*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(r-x)<=E*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(a-w)<=E*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(o-k)<=E*Math.max(1,Math.abs(o),Math.abs(k))&&Math.abs(s-M)<=E*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(l-S)<=E*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(u-N)<=E*Math.max(1,Math.abs(u),Math.abs(N))&&Math.abs(c-T)<=E*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(h-A)<=E*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(d-O)<=E*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(f-P)<=E*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(p-C)<=E*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(g-R)<=E*Math.max(1,Math.abs(g),Math.abs(R))&&Math.abs(v-L)<=E*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(y-D)<=E*Math.max(1,Math.abs(y),Math.abs(D))}var Ut=at,Ht=jt;function Yt(){var t=new w(9);return w!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function $t(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Xt(t,e,n,i,r,a,o,s,l){var u=new w(9);return u[0]=t,u[1]=e,u[2]=n,u[3]=i,u[4]=r,u[5]=a,u[6]=o,u[7]=s,u[8]=l,u}function qt(){var t=new w(4);return w!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Kt(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function Zt(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=n[0],l=n[1],u=n[2],c=n[3];return t[0]=i*c+o*s+r*u-a*l,t[1]=r*c+o*l+a*s-i*u,t[2]=a*c+o*u+i*l-r*s,t[3]=o*c-i*s-r*l-a*u,t}function Qt(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=n*n+i*i+r*r+a*a,s=o?1/o:0;return t[0]=-n*s,t[1]=-i*s,t[2]=-r*s,t[3]=a*s,t}function Jt(t,e,n,i){var r=.5*Math.PI/180;e*=r,n*=r,i*=r;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(n),l=Math.cos(n),u=Math.sin(i),c=Math.cos(i);return t[0]=a*l*c-o*s*u,t[1]=o*s*c+a*l*u,t[2]=o*l*u-a*s*c,t[3]=o*l*c+a*s*u,t}var te=$,ee=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},ne=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},ie=Zt,re=function(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=n*n+i*i+r*r+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=a*o,t};function ae(){var t=new w(2);return w!=Float32Array&&(t[0]=0,t[1]=0),t}function oe(t,e){return t[0]=e[0],t[1]=e[1],t}function se(t,e,n){return t[0]=e,t[1]=n,t}function le(t){return"number"==typeof t}function ue(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function ce(t){return null==t}function he(t){return"string"==typeof t}k(),N(1,0,0),N(0,1,0),qt(),qt(),Yt(),ae();const de=function(t,e,n){return t<e?e:t>n?n:t};var fe=function(t,e){return fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},fe(t,e)};function pe(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}fe(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ge=function(){return ge=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},ge.apply(this,arguments)};function ve(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}function ye(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))}function me(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function be(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}function xe(t,e,n){if(n||2===arguments.length)for(var i,r=0,a=e.length;r<a;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}function Ee(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var we={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function ke(t){return Array.isArray(t)&&t.every((function(t){var e=t[0].toLowerCase();return we[e]===t.length-1&&"achlmqstvz".includes(e)}))}function Me(t){return ke(t)&&t.every((function(t){var e=t[0];return e===e.toUpperCase()}))}function Se(t){return Me(t)&&t.every((function(t){var e=t[0];return"ACLMQZ".includes(e)}))}var Ne={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Te(t){for(var e=t.pathValue[t.segmentStart],n=e.toLowerCase(),i=t.data;i.length>=we[n]&&("m"===n&&i.length>2?(t.segments.push([e].concat(i.splice(0,2))),n="l",e="m"===e?"l":"L"):t.segments.push([e].concat(i.splice(0,we[n]))),we[n]););}function Ae(t){var e=t.index,n=t.pathValue,i=n.charCodeAt(e);return 48===i?(t.param=0,void(t.index+=1)):49===i?(t.param=1,void(t.index+=1)):void(t.err='[path-util]: invalid Arc flag "'.concat(n[e],'", expecting 0 or 1 at index ').concat(e))}function Oe(t){return t>=48&&t<=57}function Pe(t){var e,n=t.max,i=t.pathValue,r=t.index,a=r,o=!1,s=!1,l=!1,u=!1;if(a>=n)t.err="[path-util]: Invalid path value at index ".concat(a,', "pathValue" is missing param');else if(43!==(e=i.charCodeAt(a))&&45!==e||(a+=1,e=i.charCodeAt(a)),Oe(e)||46===e){if(46!==e){if(o=48===e,a+=1,e=i.charCodeAt(a),o&&a<n&&e&&Oe(e))return void(t.err="[path-util]: Invalid path value at index ".concat(r,', "').concat(i[r],'" illegal number'));for(;a<n&&Oe(i.charCodeAt(a));)a+=1,s=!0;e=i.charCodeAt(a)}if(46===e){for(u=!0,a+=1;Oe(i.charCodeAt(a));)a+=1,l=!0;e=i.charCodeAt(a)}if(101===e||69===e){if(u&&!s&&!l)return void(t.err="[path-util]: Invalid path value at index ".concat(a,', "').concat(i[a],'" invalid float exponent'));if(a+=1,43!==(e=i.charCodeAt(a))&&45!==e||(a+=1),!(a<n&&Oe(i.charCodeAt(a))))return void(t.err="[path-util]: Invalid path value at index ".concat(a,', "').concat(i[a],'" invalid integer exponent'));for(;a<n&&Oe(i.charCodeAt(a));)a+=1}t.index=a,t.param=+t.pathValue.slice(r,a)}else t.err="[path-util]: Invalid path value at index ".concat(a,', "').concat(i[a],'" is not a number')}function Ce(t){for(var e,n=t.pathValue,i=t.max;t.index<i&&(10===(e=n.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e));)t.index+=1}function Re(t){var e,n=t.max,i=t.pathValue,r=t.index,a=i.charCodeAt(r),o=we[i[r].toLowerCase()];if(t.segmentStart=r,function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}(a))if(t.index+=1,Ce(t),t.data=[],o){for(;;){for(var s=o;s>0;s-=1){if(97!=(32|a)||3!==s&&4!==s?Pe(t):Ae(t),t.err.length)return;t.data.push(t.param),Ce(t),t.index<n&&44===i.charCodeAt(t.index)&&(t.index+=1,Ce(t))}if(t.index>=t.max)break;if(!((e=i.charCodeAt(t.index))>=48&&e<=57||43===e||45===e||46===e))break}Te(t)}else Te(t);else t.err='[path-util]: Invalid path value "'.concat(i[r],'" is not a path command')}var Le=function(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""};function De(t,e){var n=t[0],i=e.x1,r=e.y1,a=e.x2,o=e.y2,s=t.slice(1).map(Number),l=t;if("TQ".includes(n)||(e.qx=null,e.qy=null),"H"===n)l=["L",t[1],r];else if("V"===n)l=["L",i,t[1]];else if("S"===n){var u=2*i-a,c=2*r-o;e.x1=u,e.y1=c,l=["C",u,c].concat(s)}else if("T"===n){var h=2*i-e.qx,d=2*r-e.qy;e.qx=h,e.qy=d,l=["Q",h,d].concat(s)}else if("Q"===n){var f=s[0],p=s[1];e.qx=f,e.qy=p}return l}function Ie(t){if(Se(t))return[].concat(t);for(var e=function(t){if(Me(t))return[].concat(t);var e=function(t){if(ke(t))return[].concat(t);var e=new Le(t);for(Ce(e);e.index<e.max&&!e.err.length;)Re(e);return e.err?e.err:e.segments}(t),n=0,i=0,r=0,a=0;return e.map((function(t){var e,o=t.slice(1).map(Number),s=t[0],l=s.toUpperCase();if("M"===s)return n=o[0],i=o[1],r=n,a=i,["M",n,i];if(s!==l)switch(l){case"A":e=[l,o[0],o[1],o[2],o[3],o[4],o[5]+n,o[6]+i];break;case"V":e=[l,o[0]+i];break;case"H":e=[l,o[0]+n];break;default:var u=o.map((function(t,e){return t+(e%2?i:n)}));e=[l].concat(u)}else e=[l].concat(o);var c=e.length;switch(l){case"Z":n=r,i=a;break;case"H":n=e[1];break;case"V":i=e[1];break;default:n=e[c-2],i=e[c-1],"M"===l&&(r=n,a=i)}return e}))}(t),n=ge({},Ne),i=0;i<e.length;i+=1){e[i]=De(e[i],n);var r=e[i],a=r.length;n.x1=+r[a-2],n.y1=+r[a-1],n.x2=+r[a-4]||n.x1,n.y2=+r[a-3]||n.y1}return e}function _e(t,e,n){var i=t[0],r=t[1];return[i+(e[0]-i)*n,r+(e[1]-r)*n]}function Be(t,e,n,i,r){var a=ue([t,e],[n,i]),o={x:0,y:0};if("number"==typeof r)if(r<=0)o={x:t,y:e};else if(r>=a)o={x:n,y:i};else{var s=_e([t,e],[n,i],r/a);o={x:s[0],y:s[1]}}return{length:a,point:o,min:{x:Math.min(t,n),y:Math.min(e,i)},max:{x:Math.max(t,n),y:Math.max(e,i)}}}function Fe(t,e){var n=t.x,i=t.y,r=e.x,a=e.y,o=n*r+i*a,s=Math.sqrt((Math.pow(n,2)+Math.pow(i,2))*(Math.pow(r,2)+Math.pow(a,2)));return(n*a-i*r<0?-1:1)*Math.acos(o/s)}function je(t,e,n,i,r,a,o,s,l,u){var c=Math.abs,h=Math.sin,d=Math.cos,f=Math.sqrt,p=Math.PI,g=c(n),v=c(i),y=(r%360+360)%360*(p/180);if(t===s&&e===l)return{x:t,y:e};if(0===g||0===v)return Be(t,e,s,l,u).point;var m=(t-s)/2,b=(e-l)/2,x={x:d(y)*m+h(y)*b,y:-h(y)*m+d(y)*b},E=Math.pow(x.x,2)/Math.pow(g,2)+Math.pow(x.y,2)/Math.pow(v,2);E>1&&(g*=f(E),v*=f(E));var w=(Math.pow(g,2)*Math.pow(v,2)-Math.pow(g,2)*Math.pow(x.y,2)-Math.pow(v,2)*Math.pow(x.x,2))/(Math.pow(g,2)*Math.pow(x.y,2)+Math.pow(v,2)*Math.pow(x.x,2)),k=(a!==o?1:-1)*f(w=w<0?0:w),M=k*(g*x.y/v),S=k*(-v*x.x/g),N=d(y)*M-h(y)*S+(t+s)/2,T=h(y)*M+d(y)*S+(e+l)/2,A={x:(x.x-M)/g,y:(x.y-S)/v},O=Fe({x:1,y:0},A),P=Fe(A,{x:(-x.x-M)/g,y:(-x.y-S)/v});!o&&P>0?P-=2*p:o&&P<0&&(P+=2*p);var C=O+(P%=2*p)*u,R=g*d(C),L=v*h(C);return{x:d(y)*R-h(y)*L+N,y:h(y)*R+d(y)*L+T}}function Ge(t,e,n,i,r,a,o,s,l,u,c){var h,d=c.bbox,f=void 0===d||d,p=c.length,g=void 0===p||p,v=c.sampleSize,y=void 0===v?30:v,m="number"==typeof u,b=t,x=e,E=0,w=[b,x,E],k=[b,x],M={x:0,y:0},S=[{x:b,y:x}];m&&u<=0&&(M={x:b,y:x});for(var N=0;N<=y;N+=1){if(b=(h=je(t,e,n,i,r,a,o,s,l,N/y)).x,x=h.y,f&&S.push({x:b,y:x}),g&&(E+=ue(k,[b,x])),k=[b,x],m&&E>=u&&u>w[2]){var T=(E-u)/(E-w[2]);M={x:k[0]*(1-T)+w[0]*T,y:k[1]*(1-T)+w[1]*T}}w=[b,x,E]}return m&&u>=E&&(M={x:s,y:l}),{length:E,point:M,min:{x:Math.min.apply(null,S.map((function(t){return t.x}))),y:Math.min.apply(null,S.map((function(t){return t.y})))},max:{x:Math.max.apply(null,S.map((function(t){return t.x}))),y:Math.max.apply(null,S.map((function(t){return t.y})))}}}function ze(t,e,n,i,r,a,o,s,l){var u=1-l;return{x:Math.pow(u,3)*t+3*Math.pow(u,2)*l*n+3*u*Math.pow(l,2)*r+Math.pow(l,3)*o,y:Math.pow(u,3)*e+3*Math.pow(u,2)*l*i+3*u*Math.pow(l,2)*a+Math.pow(l,3)*s}}function Ve(t,e,n,i,r,a,o,s,l,u){var c,h=u.bbox,d=void 0===h||h,f=u.length,p=void 0===f||f,g=u.sampleSize,v=void 0===g?10:g,y="number"==typeof l,m=t,b=e,x=0,E=[m,b,x],w=[m,b],k={x:0,y:0},M=[{x:m,y:b}];y&&l<=0&&(k={x:m,y:b});for(var S=0;S<=v;S+=1){if(m=(c=ze(t,e,n,i,r,a,o,s,S/v)).x,b=c.y,d&&M.push({x:m,y:b}),p&&(x+=ue(w,[m,b])),w=[m,b],y&&x>=l&&l>E[2]){var N=(x-l)/(x-E[2]);k={x:w[0]*(1-N)+E[0]*N,y:w[1]*(1-N)+E[1]*N}}E=[m,b,x]}return y&&l>=x&&(k={x:o,y:s}),{length:x,point:k,min:{x:Math.min.apply(null,M.map((function(t){return t.x}))),y:Math.min.apply(null,M.map((function(t){return t.y})))},max:{x:Math.max.apply(null,M.map((function(t){return t.x}))),y:Math.max.apply(null,M.map((function(t){return t.y})))}}}function We(t,e,n,i,r,a,o){var s=1-o;return{x:Math.pow(s,2)*t+2*s*o*n+Math.pow(o,2)*r,y:Math.pow(s,2)*e+2*s*o*i+Math.pow(o,2)*a}}function Ue(t,e,n,i,r,a,o,s){var l,u=s.bbox,c=void 0===u||u,h=s.length,d=void 0===h||h,f=s.sampleSize,p=void 0===f?10:f,g="number"==typeof o,v=t,y=e,m=0,b=[v,y,m],x=[v,y],E={x:0,y:0},w=[{x:v,y}];g&&o<=0&&(E={x:v,y});for(var k=0;k<=p;k+=1){if(v=(l=We(t,e,n,i,r,a,k/p)).x,y=l.y,c&&w.push({x:v,y}),d&&(m+=ue(x,[v,y])),x=[v,y],g&&m>=o&&o>b[2]){var M=(m-o)/(m-b[2]);E={x:x[0]*(1-M)+b[0]*M,y:x[1]*(1-M)+b[1]*M}}b=[v,y,m]}return g&&o>=m&&(E={x:r,y:a}),{length:m,point:E,min:{x:Math.min.apply(null,w.map((function(t){return t.x}))),y:Math.min.apply(null,w.map((function(t){return t.y})))},max:{x:Math.max.apply(null,w.map((function(t){return t.x}))),y:Math.max.apply(null,w.map((function(t){return t.y})))}}}function He(t,e,n){for(var i,r,a,o,s,l,u,c,h,d=Ie(t),f="number"==typeof e,p=[],g=0,v=0,y=0,m=0,b=[],x=[],E=0,w={x:0,y:0},k=w,M=w,S=w,N=0,T=0,A=d.length;T<A;T+=1)p=(u="M"===(c=(h=d[T])[0]))?p:[g,v].concat(h.slice(1)),u?(k=w={x:y=h[1],y:m=h[2]},E=0,f&&e<.001&&(S=w)):"L"===c?(E=(i=Be(p[0],p[1],p[2],p[3],(e||0)-N)).length,w=i.min,k=i.max,M=i.point):"A"===c?(E=(r=Ge(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],(e||0)-N,n||{})).length,w=r.min,k=r.max,M=r.point):"C"===c?(E=(a=Ve(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],(e||0)-N,n||{})).length,w=a.min,k=a.max,M=a.point):"Q"===c?(E=(o=Ue(p[0],p[1],p[2],p[3],p[4],p[5],(e||0)-N,n||{})).length,w=o.min,k=o.max,M=o.point):"Z"===c&&(E=(s=Be((p=[g,v,y,m])[0],p[1],p[2],p[3],(e||0)-N)).length,w=s.min,k=s.max,M=s.point),f&&N<e&&N+E>=e&&(S=M),x.push(k),b.push(w),N+=E,g=(l="Z"!==c?h.slice(-2):[y,m])[0],v=l[1];return f&&e>=N&&(S={x:g,y:v}),{length:N,point:S,min:{x:Math.min.apply(null,b.map((function(t){return t.x}))),y:Math.min.apply(null,b.map((function(t){return t.y})))},max:{x:Math.max.apply(null,x.map((function(t){return t.x}))),y:Math.max.apply(null,x.map((function(t){return t.y})))}}}function Ye(t,e){return He(t,void 0,ge(ge({},e),{bbox:!1,length:!0})).length}function $e(t){return Array.isArray(t)}const Xe=function(t){if($e(t))return t.reduce((function(t,e){return Math.min(t,e)}),t[0])};function qe(t){if(!Array.isArray(t))return-1/0;var e=t.length;if(!e)return-1/0;for(var n=t[0],i=1;i<e;i++)n=Math.max(n,t[i]);return n}function Ke(t,e,n){return void 0===n&&(n=1e-5),t===e||Math.abs(t-e)<n}const Ze=function(t,e){return(t%e+e)%e};function Qe(t,e,n){if(t[n].length>7){t[n].shift();for(var i=t[n],r=n;i.length;)e[n]="A",t.splice(r+=1,0,["C"].concat(i.splice(0,6)));t.splice(n,1)}}function Je(t,e,n){return{x:t*Math.cos(n)-e*Math.sin(n),y:t*Math.sin(n)+e*Math.cos(n)}}function tn(t,e,n,i,r,a,o,s,l,u){var c,h,d,f,p,g=t,v=e,y=n,m=i,b=s,x=l,E=120*Math.PI/180,w=Math.PI/180*(+r||0),k=[];if(u)h=u[0],d=u[1],f=u[2],p=u[3];else{g=(c=Je(g,v,-w)).x,v=c.y;var M=(g-(b=(c=Je(b,x,-w)).x))/2,S=(v-(x=c.y))/2,N=M*M/(y*y)+S*S/(m*m);N>1&&(y*=N=Math.sqrt(N),m*=N);var T=y*y,A=m*m,O=(a===o?-1:1)*Math.sqrt(Math.abs((T*A-T*S*S-A*M*M)/(T*S*S+A*M*M)));f=O*y*S/m+(g+b)/2,p=O*-m*M/y+(v+x)/2,h=Math.asin(((v-p)/m*Math.pow(10,9)|0)/Math.pow(10,9)),d=Math.asin(((x-p)/m*Math.pow(10,9)|0)/Math.pow(10,9)),h=g<f?Math.PI-h:h,d=b<f?Math.PI-d:d,h<0&&(h=2*Math.PI+h),d<0&&(d=2*Math.PI+d),o&&h>d&&(h-=2*Math.PI),!o&&d>h&&(d-=2*Math.PI)}var P=d-h;if(Math.abs(P)>E){var C=d,R=b,L=x;d=h+E*(o&&d>h?1:-1),k=tn(b=f+y*Math.cos(d),x=p+m*Math.sin(d),y,m,r,0,o,R,L,[d,C,f,p])}P=d-h;var D=Math.cos(h),I=Math.sin(h),_=Math.cos(d),B=Math.sin(d),F=Math.tan(P/4),j=4/3*y*F,G=4/3*m*F,z=[g,v],V=[g+j*I,v-G*D],W=[b+j*B,x-G*_],U=[b,x];if(V[0]=2*z[0]-V[0],V[1]=2*z[1]-V[1],u)return V.concat(W,U,k);for(var H=[],Y=0,$=(k=V.concat(W,U,k)).length;Y<$;Y+=1)H[Y]=Y%2?Je(k[Y-1],k[Y],w).y:Je(k[Y],k[Y+1],w).x;return H}var en=function(t,e,n,i){return xe(xe([],_e([t,e],[n,i],.5),!0),[n,i,n,i],!1)};function nn(t,e){var n,i,r,a,o,s,l,u,c,h=t[0],d=t.slice(1).map(Number),f=d[0],p=d[1],g=e.x1,v=e.y1,y=e.x,m=e.y;switch("TQ".includes(h)||(e.qx=null,e.qy=null),h){case"M":return e.x=f,e.y=p,t;case"A":return n=[g,v].concat(d),["C"].concat(tn(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]));case"Q":return e.qx=f,e.qy=p,n=[g,v].concat(d),["C"].concat((i=n[0],r=n[1],[(u=1/3)*i+(c=2/3)*(a=n[2]),u*r+c*(o=n[3]),u*(s=n[4])+c*a,u*(l=n[5])+c*o,s,l]));case"L":return["C"].concat(en(g,v,f,p));case"Z":return g===y&&v===m?["C",g,v,y,m,y,m]:["C"].concat(en(g,v,y,m))}return t}function rn(t,e){if(void 0===e&&(e=!1),function(t){return Se(t)&&t.every((function(t){var e=t[0];return"MC".includes(e)}))}(t)){var n=[].concat(t);return e?[n,[]]:n}for(var i,r,a=Ie(t),o=ge({},Ne),s=[],l="",u=a.length,c=[],h=0;h<u;h+=1){a[h]&&(l=a[h][0]),s[h]=l;var d=nn(a[h],o);a[h]=d,Qe(a,s,h),u=a.length,"Z"===l&&c.push(h),r=(i=a[h]).length,o.x1=+i[r-2],o.y1=+i[r-1],o.x2=+i[r-4]||o.x1,o.y2=+i[r-3]||o.y1}return e?[a,c]:a}function an(t){return t.map((function(t,e,n){var i=e&&n[e-1].slice(-2).concat(t.slice(1)),r=e?Ve(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0;return{s:t,ss:e?r?function(t,e){void 0===e&&(e=.5);var n=t.slice(0,2),i=t.slice(2,4),r=t.slice(4,6),a=t.slice(6,8),o=_e(n,i,e),s=_e(i,r,e),l=_e(r,a,e),u=_e(o,s,e),c=_e(s,l,e),h=_e(u,c,e);return[["C"].concat(o,u,h),["C"].concat(c,l,a)]}(i):[t,t]:[t],l:r}}))}function on(t,e,n){var i=an(t),r=an(e),a=i.length,o=r.length,s=i.filter((function(t){return t.l})).length,l=r.filter((function(t){return t.l})).length,u=i.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/s||0,c=r.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/l||0,h=n||Math.max(a,o),d=[u,c],f=[h-a,h-o],p=0,g=[i,r].map((function(t,e){return t.l===h?t.map((function(t){return t.s})):t.map((function(t,n){return p=n&&f[e]&&t.l>=d[e],f[e]-=p?1:0,p?t.ss:[t.s]})).flat()}));return g[0].length===g[1].length?g:on(g[0],g[1],h)}function sn(t){return function(t){var e=0,n=0,i=0;return rn(t).map((function(t){var r;if("M"===t[0])return e=t[1],n=t[2],0;var a=t.slice(1),o=a[0],s=a[1],l=a[2],u=a[3],c=a[4],h=a[5];return i=function(t,e,n,i,r,a,o,s){return 3*((s-e)*(n+r)-(o-t)*(i+a)+i*(t-r)-n*(e-a)+s*(r+t/3)-o*(a+e/3))/20}(e,n,o,s,l,u,c,h),r=t.slice(-2),e=r[0],n=r[1],i})).reduce((function(t,e){return t+e}),0)}(t)>=0}function ln(t){var e=t.slice(1).map((function(e,n,i){return n?i[n-1].slice(-2).concat(e.slice(1)):t[0].slice(1).concat(e.slice(1))})).map((function(t){return t.map((function(e,n){return t[t.length-n-2*(1-n%2)]}))})).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map((function(t){return["C"].concat(t.slice(2))})))}function un(t){return t.map((function(t){return Array.isArray(t)?[].concat(t):t}))}function cn(t,e){var n=t.length-1,i=[],r=0,a=function(t){var e=t.length,n=e-1;return t.map((function(i,r){return t.map((function(i,a){var o,s=r+a;return 0===a||t[s]&&"M"===t[s][0]?(o=t[s],["M"].concat(o.slice(-2))):(s>=e&&(s-=n),t[s])}))}))}(t);return a.forEach((function(a,o){t.slice(1).forEach((function(i,a){r+=ue(t[(o+a)%n].slice(-2),e[a%n].slice(-2))})),i[o]=r,r=0})),a[i.indexOf(Math.min.apply(null,i))]}const hn=function(t){return void 0===t};var dn={}.toString;const fn=function(t,e){return dn.call(t)==="[object "+e+"]"},pn=function(t){return fn(t,"Boolean")};function gn(t){return"function"==typeof t}const vn=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function yn(t,e,n){return He(t,e,ge(ge({},n),{bbox:!1,length:!0})).point}function mn(){return mn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},mn.apply(null,arguments)}function bn(t,e,n,i){var r=mn(p(1&i?t.prototype:t),e,n);return 2&i&&"function"==typeof r?function(t){return r.apply(n,t)}:r}function xn(t,e,n,i){var r=t-n,a=e-i;return Math.sqrt(r*r+a*a)}function En(t,e){var n=Math.min.apply(Math,f(t)),i=Math.min.apply(Math,f(e));return{x:n,y:i,width:Math.max.apply(Math,f(t))-n,height:Math.max.apply(Math,f(e))-i}}function wn(t,e,n,i,r,a){return n*Math.cos(r)*Math.cos(a)-i*Math.sin(r)*Math.sin(a)+t}function kn(t,e,n,i,r,a){return n*Math.sin(r)*Math.cos(a)+i*Math.cos(r)*Math.sin(a)+e}function Mn(t,e,n,i,r,a,o){for(var s=function(t,e,n){return Math.atan(-e/t*Math.tan(n))}(n,i,r),l=1/0,u=-1/0,c=[a,o],h=2*-Math.PI;h<=2*Math.PI;h+=Math.PI){var d=s+h;a<o?a<d&&d<o&&c.push(d):o<d&&d<a&&c.push(d)}for(var f=0;f<c.length;f++){var p=wn(t,0,n,i,r,c[f]);p<l&&(l=p),p>u&&(u=p)}for(var g=function(t,e,n){return Math.atan(e/(t*Math.tan(n)))}(n,i,r),v=1/0,y=-1/0,m=[a,o],b=2*-Math.PI;b<=2*Math.PI;b+=Math.PI){var x=g+b;a<o?a<x&&x<o&&m.push(x):o<x&&x<a&&m.push(x)}for(var E=0;E<m.length;E++){var w=kn(0,e,n,i,r,m[E]);w<v&&(v=w),w>y&&(y=w)}return{x:l,y:v,width:u-l,height:y-v}}function Sn(t,e,n,i,r,a){var o=-1,s=1/0,l=[n,i],u=20;a&&a>200&&(u=a/10);for(var c=1/u,h=c/10,d=0;d<=u;d++){var p=d*c,g=[r.apply(void 0,f(t.concat([p]))),r.apply(void 0,f(e.concat([p])))],v=xn(l[0],l[1],g[0],g[1]);v<s&&(o=p,s=v)}if(0===o)return{x:t[0],y:e[0]};if(1===o){var y=t.length;return{x:t[y-1],y:e[y-1]}}s=1/0;for(var m=0;m<32&&!(h<1e-4);m++){var b=o-h,x=o+h,E=[r.apply(void 0,f(t.concat([b]))),r.apply(void 0,f(e.concat([b])))],w=xn(l[0],l[1],E[0],E[1]);if(b>=0&&w<s)o=b,s=w;else{var k=[r.apply(void 0,f(t.concat([x]))),r.apply(void 0,f(e.concat([x])))],M=xn(l[0],l[1],k[0],k[1]);x<=1&&M<s?(o=x,s=M):h*=.5}}return{x:r.apply(void 0,f(t.concat([o]))),y:r.apply(void 0,f(e.concat([o])))}}function Nn(t,e,n,i){return xn(t,e,n,i)}function Tn(t,e,n,i,r){return{x:(1-r)*t+r*n,y:(1-r)*e+r*i}}function An(t,e,n,i,r){var a=1-r;return a*a*a*t+3*e*r*a*a+3*n*r*r*a+i*r*r*r}function On(t,e,n,i){var r,a,o,s=-3*t+9*e-9*n+3*i,l=6*t-12*e+6*n,u=3*e-3*t,c=[];if(Ke(s,0))Ke(l,0)||(r=-u/l)>=0&&r<=1&&c.push(r);else{var h=l*l-4*s*u;Ke(h,0)?c.push(-l/(2*s)):h>0&&(a=(-l-(o=Math.sqrt(h)))/(2*s),(r=(-l+o)/(2*s))>=0&&r<=1&&c.push(r),a>=0&&a<=1&&c.push(a))}return c}function Pn(t,e,n,i,r,a,o,s){for(var l=[t,o],u=[e,s],c=On(t,n,r,o),h=On(e,i,a,s),d=0;d<c.length;d++)l.push(An(t,n,r,o,c[d]));for(var f=0;f<h.length;f++)u.push(An(e,i,a,s,h[f]));return En(l,u)}function Cn(t,e,n,i,r,a,o,s,l,u,c){var h=function(t,e,n,i,r,a,o,s,l,u,c){return Sn([t,n,r,o],[e,i,a,s],l,u,An,c)}(t,e,n,i,r,a,o,s,l,u,c);return xn(h.x,h.y,l,u)}function Rn(t){return function(t){if(t.length<2)return 0;for(var e=0,n=0;n<t.length-1;n++){var i=t[n],r=t[n+1];e+=xn(i[0],i[1],r[0],r[1])}return e}(t)}function Ln(t,e,n,i){var r=1-i;return r*r*t+2*i*r*e+i*i*n}function Dn(t,e,n){var i=t+n-2*e;if(Ke(i,0))return[.5];var r=(t-e)/i;return r<=1&&r>=0?[r]:[]}function In(t,e,n,i,r,a){var o=Dn(t,n,r)[0],s=Dn(e,i,a)[0],l=[t,r],u=[e,a];return void 0!==o&&l.push(Ln(t,n,r,o)),void 0!==s&&u.push(Ln(e,i,a,s)),En(l,u)}function _n(t,e,n,i,r,a,o,s){var l=function(t,e,n,i,r,a,o,s){return Sn([t,n,r],[e,i,a],o,s,Ln)}(t,e,n,i,r,a,o,s);return xn(l.x,l.y,o,s)}function Bn(){Bn=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n,i){return Object.defineProperty(t,e,{value:n,enumerable:!i,configurable:!i,writable:!i})}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(e,n,i,r){var a=n&&n.prototype instanceof f?n:f,o=Object.create(a.prototype);return u(o,"_invoke",function(e,n,i){var r=1;return function(a,o){if(3===r)throw Error("Generator is already running");if(4===r){if("throw"===a)throw o;return{value:t,done:!0}}for(i.method=a,i.arg=o;;){var s=i.delegate;if(s){var l=w(s,i);if(l){if(l===d)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(1===r)throw r=4,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=3;var u=h(e,n,i);if("normal"===u.type){if(r=i.done?4:2,u.arg===d)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r=4,i.method="throw",i.arg=u.arg)}}}(e,i,new S(r||[])),!0),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var d={};function f(){}function p(){}function g(){}var v={};u(v,o,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(N([])));m&&m!==n&&r.call(m,o)&&(v=m);var b=g.prototype=f.prototype=Object.create(v);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(a,o,s,l){var u=h(t[a],t,o);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==i(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(d).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;u(this,"_invoke",(function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}),!0)}function w(e,n){var i=n.method,r=e.i[i];if(r===t)return n.delegate=null,"throw"===i&&e.i.return&&(n.method="return",n.arg=t,w(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),d;var a=h(r,e.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,d;var o=a.arg;return o?o.done?(n[e.r]=o.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,d):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(t){this.tryEntries.push(t)}function M(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function N(e){if(null!=e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(i(e)+" is not iterable")}return p.prototype=g,u(b,"constructor",g),u(g,"constructor",p),p.displayName=u(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,l,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},x(E.prototype),u(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var o=new E(c(t,n,i,r),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(b),u(b,l,"Generator"),u(b,o,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.unshift(i);return function t(){for(;n.length;)if((i=n.pop())in e)return t.value=i,t.done=!1,t;return t.done=!0,t}},e.values=N,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(t){o.type="throw",o.arg=e,n.next=t}for(var r=n.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a[4],s=this.prev,l=a[1],u=a[2];if(-1===a[0])return i("end"),!1;if(!l&&!u)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=s){if(s<l)return this.method="next",this.arg=t,i(l),!0;if(s<u)return i(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i[0]>-1&&i[0]<=this.prev&&this.prev<i[2]){var r=i;break}}r&&("break"===t||"continue"===t)&&r[0]<=e&&e<=r[2]&&(r=null);var a=r?r[4]:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r[2],d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),M(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var i=n[4];if("throw"===i.type){var r=i.arg;M(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={i:N(e),r:n,n:i},"next"===this.method&&(this.arg=t),d}},e}function Fn(t,e,n,i,r,a,o){try{var s=t[a](o),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(i,r)}function jn(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function o(t){Fn(a,i,r,o,s,"next",t)}function s(t){Fn(a,i,r,o,s,"throw",t)}o(void 0)}))}}function Gn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=d(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function zn(t,e){if(null==t)return{};var n,i,r=function(t,e){if(null==t)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(-1!==e.indexOf(i))continue;n[i]=t[i]}return n}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var Vn={exports:{}};Vn.exports=function(){function t(t,n,r,a,o){e(t,n,r||0,a||t.length-1,o||i)}function e(t,i,r,a,o){for(;a>r;){if(a-r>600){var s=a-r+1,l=i-r+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);e(t,i,Math.max(r,Math.floor(i-l*c/s+h)),Math.min(a,Math.floor(i+(s-l)*c/s+h)),o)}var d=t[i],f=r,p=a;for(n(t,r,i),o(t[a],d)>0&&n(t,r,a);f<p;){for(n(t,f,p),f++,p--;o(t[f],d)<0;)f++;for(;o(t[p],d)>0;)p--}0===o(t[r],d)?n(t,r,p):n(t,++p,a),p<=i&&(r=p+1),i<=p&&(a=p-1)}}function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var a=e;a<n;a++){var o=t.children[a];l(r,t.leaf?i(o):o)}return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,n,i,r,a){for(var o=[n,i];o.length;)if(!((i=o.pop())-(n=o.pop())<=r)){var s=n+Math.ceil((i-n)/r/2)*r;t(e,s,n,i,a),o.push(n,s,s,i)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!p(t,e))return n;for(var i=this.toBBox,r=[];e;){for(var a=0;a<e.children.length;a++){var o=e.children[a],s=e.leaf?i(o):o;p(t,s)&&(e.leaf?n.push(o):f(t,s)?this._all(o,n):r.push(o))}e=r.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var r=e.children[i],a=e.leaf?this.toBBox(r):r;if(p(t,a)){if(e.leaf||f(t,a))return!0;n.push(r)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=g([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,i,r,o=this.data,s=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),i=l[l.length-1],n=u.pop(),r=!0),o.leaf){var c=a(t,o.children,e);if(-1!==c)return o.children.splice(c,1),l.push(o),this._condense(l),this}r||o.leaf||!f(o,s)?i?(n++,o=i.children[n],r=!1):o=null:(l.push(o),u.push(n),n=0,i=o,o=o.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,i){var r,a=n-e+1,s=this._maxEntries;if(a<=s)return o(r=g(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,i-1))),(r=g([])).leaf=!1,r.height=i;var l=Math.ceil(a/s),u=l*Math.ceil(Math.sqrt(s));v(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);v(t,c,h,l,this.compareMinY);for(var d=c;d<=h;d+=l){var f=Math.min(d+l-1,h);r.children.push(this._build(t,d,f,i-1))}}return o(r,this.toBBox),r},r.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var r=1/0,a=1/0,o=void 0,s=0;s<e.children.length;s++){var l=e.children[s],u=h(l),c=(d=t,f=l,(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-u);c<a?(a=c,r=u<r?u:r,o=l):c===a&&u<r&&(r=u,o=l)}e=o||e.children[0]}var d,f;return e},r.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),r=[],a=this._chooseSubtree(i,this.data,e,r);for(a.children.push(t),l(a,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},r.prototype._split=function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var a=this._chooseSplitIndex(n,r,i),s=g(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var i,r=1/0,a=1/0,o=e;o<=n-e;o++){var l=s(t,0,o,this.toBBox),u=s(t,o,n,this.toBBox),c=(f=l,p=u,g=void 0,v=void 0,y=void 0,m=void 0,g=Math.max(f.minX,p.minX),v=Math.max(f.minY,p.minY),y=Math.min(f.maxX,p.maxX),m=Math.min(f.maxY,p.maxY),Math.max(0,y-g)*Math.max(0,m-v)),d=h(l)+h(u);c<r?(r=c,i=o,a=d<a?d:a):c===r&&d<a&&(a=d,i=o)}var f,p,g,v,y,m;return i||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},r.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var r=this.toBBox,a=s(t,0,e,r),o=s(t,n-e,n,r),u=d(a)+d(o),c=e;c<n-e;c++){var h=t.children[c];l(a,t.leaf?r(h):h),u+=d(a)}for(var f=n-e-1;f>=e;f--){var p=t.children[f];l(o,t.leaf?r(p):p),u+=d(o)}return u},r.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)l(e[i],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}();var Wn=Vn.exports,Un=function(t){return t.GROUP="g",t.FRAGMENT="fragment",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh",t}({}),Hn=function(t){return t[t.ZERO=0]="ZERO",t[t.NEGATIVE_ONE=1]="NEGATIVE_ONE",t}({}),Yn=function(){return c((function t(){l(this,t),this.plugins=[]}),[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach((function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1)}))}}])}(),$n=function(){return c((function t(e){l(this,t),this.clipSpaceNearZ=Hn.NEGATIVE_ONE,this.plugins=[],this.config=s({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},e)}),[{key:"registerPlugin",value:function(t){-1===this.plugins.findIndex((function(e){return e===t}))&&this.plugins.push(t)}},{key:"unregisterPlugin",value:function(t){var e=this.plugins.findIndex((function(e){return e===t}));e>-1&&this.plugins.splice(e,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(t){return this.plugins.find((function(e){return e.name===t}))}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(t){Object.assign(this.config,t)}}])}(),Xn=O,qn=T,Kn=L,Zn=R,Qn=D,Jn=W,ti=function(){function t(){l(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return c(t,[{key:"update",value:function(t,e){qn(this.center,t),qn(this.halfExtents,e),Jn(this.min,this.center,this.halfExtents),Xn(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,e){Xn(this.center,e,t),Qn(this.center,this.center,.5),Jn(this.halfExtents,e,t),Qn(this.halfExtents,this.halfExtents,.5),qn(this.min,t),qn(this.max,e)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!t.isEmpty(e))if(t.isEmpty(this))this.setMinMax(e.getMin(),e.getMax());else{var n=this.center,i=n[0],r=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=i-s,h=i+s,d=r-l,f=r+l,p=a-u,g=a+u,v=e.center,y=v[0],m=v[1],b=v[2],x=e.halfExtents,E=x[0],w=x[1],k=x[2],M=y-E,S=y+E,N=m-w,T=m+w,A=b-k,O=b+k;M<c&&(c=M),S>h&&(h=S),N<d&&(d=N),T>f&&(f=T),A<p&&(p=A),O>g&&(g=O),n[0]=.5*(c+h),n[1]=.5*(d+f),n[2]=.5*(p+g),o[0]=.5*(h-c),o[1]=.5*(f-d),o[2]=.5*(g-p),this.min[0]=c,this.min[1]=d,this.min[2]=p,this.max[0]=h,this.max[1]=f,this.max[2]=g}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,i=this.halfExtents,r=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],p=e[10],g=Math.abs(o),v=Math.abs(s),y=Math.abs(l),m=Math.abs(u),b=Math.abs(c),x=Math.abs(h),E=Math.abs(d),w=Math.abs(f),k=Math.abs(p);n[0]=e[12]+o*r[0]+s*r[1]+l*r[2],n[1]=e[13]+u*r[0]+c*r[1]+h*r[2],n[2]=e[14]+d*r[0]+f*r[1]+p*r[2],i[0]=g*a[0]+v*a[1]+y*a[2],i[1]=m*a[0]+b*a[1]+x*a[2],i[2]=E*a[0]+w*a[1]+k*a[2],Jn(this.min,n,i),Xn(this.max,n,i)}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),i=t.getMax(),r=t.getMin();return n[0]<=i[0]&&e[0]>=r[0]&&n[1]<=i[1]&&e[1]>=r[1]&&n[2]<=i[2]&&e[2]>=r[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,i=Kn([0,0,0],this.getMin(),e.getMin()),r=Zn([0,0,0],this.getMax(),e.getMax());return n.setMinMax(i,r),n}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?qn([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?qn([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]}}])}(),ei=function(){return c((function t(e,n){l(this,t),this.distance=e||0,this.normal=n||N(0,1,0),this.updatePNVertexFlag()}),[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return _(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/H(this.normal);D(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,e,n){var i=this.distanceToPoint(t),r=i/(i-this.distanceToPoint(e)),a=r>=0&&r<=1;return a&&n&&F(n,t,e,r),a}}])}(),ni=function(t){return t[t.OUTSIDE=4294967295]="OUTSIDE",t[t.INSIDE=0]="INSIDE",t[t.INDETERMINATE=2147483647]="INDETERMINATE",t}({}),ii=function(){return c((function t(e){if(l(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new ei)}),[{key:"extractFromVPMatrix",value:function(t){var e=b(t,16),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],y=e[15];A(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-p,A(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+p,A(this.planes[2].normal,a+i,u+s,f+h),this.planes[2].distance=y+g,A(this.planes[3].normal,a-i,u-s,f-h),this.planes[3].distance=y-g,A(this.planes[4].normal,a-r,u-l,f-d),this.planes[4].distance=y-v,A(this.planes[5].normal,a+r,u+l,f+d),this.planes[5].distance=y+v,this.planes.forEach((function(t){t.normalize(),t.updatePNVertexFlag()}))}}])}(),ri=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;l(this,t),this.x=0,this.y=0,this.x=e,this.y=n}return c(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),ai=function(){function t(e,n,i,r){l(this,t),this.x=e,this.y=n,this.width=i,this.height=r,this.left=e,this.right=e+i,this.top=n,this.bottom=n+r}return c(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,n){var i=$(e.x,e.y,0,1),r=$(e.x+e.width,e.y,0,1),a=$(e.x,e.y+e.height,0,1),o=$(e.x+e.width,e.y+e.height,0,1),s=Y(),l=Y(),u=Y(),c=Y();X(s,i,n),X(l,r,n),X(u,a,n),X(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),p=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:p-d})}}])}(),oi="Method not implemented.",si="Use document.documentElement instead.";function li(t){return void 0===t?0:t>360||t<-360?t%360:t}var ui=k();function ci(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)&&3===t.length?i?M(t):T(ui,t):le(t)?i?N(t,e,n):A(ui,t,e,n):i?N(t[0],t[1]||e,t[2]||n):A(ui,t[0],t[1]||e,t[2]||n)}var hi=Math.PI/180;function di(t){return t*hi}var fi=180/Math.PI;function pi(t){return t*fi}var gi=Math.PI/2;function vi(t,e){return 16===e.length?function(t,e){var n,i,r=b(Et(k(),e),3),a=r[0],o=r[1],s=r[2],l=Math.asin(-e[2]/a);return l<gi?l>-gi?(n=Math.atan2(e[6]/o,e[10]/s),i=Math.atan2(e[1]/a,e[0]/a)):(i=0,n=-Math.atan2(e[4]/o,e[5]/o)):(i=0,n=Math.atan2(e[4]/o,e[5]/o)),t[0]=n,t[1]=l,t[2]=i,t}(t,e):function(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=i*i,s=r*r,l=a*a,u=n*n+o+s+l,c=n*a-i*r;return c>.499995*u?(t[0]=gi,t[1]=2*Math.atan2(i,n),t[2]=0):c<-.499995*u?(t[0]=-gi,t[1]=2*Math.atan2(i,n),t[2]=0):(t[0]=Math.asin(2*(n*r-a*i)),t[1]=Math.atan2(2*(n*a+i*r),1-2*(s+l)),t[2]=Math.atan2(2*(n*i+r*a),1-2*(o+s))),t}(t,e)}function yi(t){var e=t[0],n=t[1],i=t[3],r=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(i*i+r*r);if(e*r-n*i<0&&(e<r?a=-a:o=-o),a){var s=1/a;e*=s,n*=s}if(o){var l=1/o;i*=l,r*=l}var u=pi(Math.atan2(n,e));return[t[6],t[7],a,o,u]}var mi=q(),bi=q(),xi=Y(),Ei=[k(),k(),k()],wi=k();function ki(t,e,n,i,r){t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r}var Mi=function(t){return t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING",t}({}),Si=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC",t}({}),Ni=function(t){return t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE",t}({}),Ti="updated",Ai=2e-4,Oi=function(){return c((function t(){l(this,t),this.clipSpaceNearZ=Hn.NEGATIVE_ONE,this.eventEmitter=new x,this.matrix=q(),this.right=N(1,0,0),this.up=N(0,1,0),this.forward=N(0,0,1),this.position=N(0,0,1),this.focalPoint=N(0,0,0),this.distanceVector=N(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=q(),this.projectionMatrixInverse=q(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=Mi.EXPLORING,this.trackingMode=Si.DEFAULT,this.projectionMode=Ni.PERSPECTIVE,this.frustum=new ii,this.orthoMatrix=q()}),[{key:"isOrtho",value:function(){return this.projectionMode===Ni.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,e){return this.type=t,this.type===Mi.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Mi.TRACKING&&void 0!==e&&this.setTrackingMode(e),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==Mi.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return nt(q(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,e){var n=dt(q(),[t,e,0]);this.jitteredProjectionMatrix=at(q(),n,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===Ni.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===Ni.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,e,n,i,r,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.projectionMode===Ni.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===Ni.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===Ni.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Ni.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),i=n.x,r=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(i,r),this.setFocalPoint(i,r),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=N(o.x-i,o.y-r,0),l=_(s,this.right)/S(this.right),u=_(s,this.up)/S(this.up),c=b(this.getPosition(),2),h=c[0],d=c[1],f=b(this.getFocalPoint(),2),p=f[0],g=f[1];return this.setPosition(h-l,d-u),this.setFocalPoint(p-l,g-u),this}},{key:"setPerspective",value:function(t,e,n,i){var r;this.projectionMode=Ni.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=i;var a=this.near*Math.tan(di(.5*this.fov))/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(r=this.view)&&void 0!==r&&r.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c}return function(t,e,n,i,r,a,o){var s,l,u=2*a,c=n-e,h=i-r,d=u/c,f=u/h,p=(n+e)/c,g=(i+r)/h,v=o-a,y=o*a;arguments.length>7&&void 0!==arguments[7]&&arguments[7]?(s=-o/v,l=-y/v):(s=-(o+a)/v,l=-2*y/v),t[0]=d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=p,t[9]=g,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===Hn.ZERO),nt(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,e,n,i,r,a){var o;this.projectionMode=Ni.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=i,this.near=r,this.far=a;var s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,p=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d=(h+=g*this.view.offsetX)+g*this.view.width,p=(f-=v*this.view.offsetY)-v*this.view.height}return this.clipSpaceNearZ===Hn.NEGATIVE_ONE?Rt(this.projectionMatrix,h,d,f,p,r,a):Lt(this.projectionMatrix,h,d,f,p,r,a),nt(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var e=ci(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2]);return this._setPosition(e),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],i=N(0,1,0);if(this.focalPoint=ci(t,e,n),this.trackingMode===Si.CINEMATIC){var r=P(k(),this.focalPoint,this.position);t=r[0],e=r[1],n=r[2];var a=S(r),o=pi(Math.asin(e/a)),s=90+pi(Math.atan2(n,t)),l=q();ct(l,l,di(s)),ut(l,l,di(o)),i=j(k(),[0,1,0],l)}return nt(this.matrix,Dt(q(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<Ai&&(this.distance=Ai),this.dollyingStep=this.distance/100;var e=k();t=this.distance;var n=this.forward,i=this.focalPoint;return e[0]=t*n[0]+i[0],e[1]=t*n[1]+i[1],e[2]=t*n[2]+i[2],this._setPosition(e),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=li(t),this.computeMatrix(),this._getAxes(),this.type===Mi.ORBITING||this.type===Mi.EXPLORING?this._getPosition():this.type===Mi.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=li(t),this.computeMatrix(),this._getAxes(),this.type===Mi.ORBITING||this.type===Mi.EXPLORING?this._getPosition():this.type===Mi.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=li(t),this.computeMatrix(),this._getAxes(),this.type===Mi.ORBITING||this.type===Mi.EXPLORING?this._getPosition():this.type===Mi.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=Kt(qt(),[0,0,1],di(this.roll));tt(this.matrix);var e=Kt(qt(),[1,0,0],di((this.rotateWorld&&this.type!==Mi.TRACKING||this.type===Mi.TRACKING?1:-1)*this.elevation)),n=Kt(qt(),[0,1,0],di((this.rotateWorld&&this.type!==Mi.TRACKING||this.type===Mi.TRACKING?1:-1)*this.azimuth)),i=Zt(qt(),n,e);i=Zt(qt(),i,t);var r=St(q(),i);this.type===Mi.ORBITING||this.type===Mi.EXPLORING?(ot(this.matrix,this.matrix,this.focalPoint),at(this.matrix,this.matrix,r),ot(this.matrix,this.matrix,[0,0,this.distance])):this.type===Mi.TRACKING&&(ot(this.matrix,this.matrix,this.position),at(this.matrix,this.matrix,r))}},{key:"_setPosition",value:function(t,e,n){this.position=ci(t,e,n);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){T(this.right,ci(X(Y(),[1,0,0,0],this.matrix))),T(this.up,ci(X(Y(),[0,1,0,0],this.matrix))),T(this.forward,ci(X(Y(),[0,0,1,0],this.matrix))),I(this.right,this.right),I(this.up,this.up),I(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],i=S(this.distanceVector);if(0===i)return this.elevation=0,void(this.azimuth=0);this.type===Mi.TRACKING||this.rotateWorld?(this.elevation=pi(Math.asin(e/i)),this.azimuth=pi(Math.atan2(-t,-n))):(this.elevation=-pi(Math.asin(e/i)),this.azimuth=-pi(Math.atan2(-t,-n)))}},{key:"_getPosition",value:function(){T(this.position,ci(X(Y(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){G(this.distanceVector,[0,0,-this.distance],$t(Yt(),this.matrix)),O(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=P(k(),this.focalPoint,this.position),this.distance=S(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===Ni.ORTHOGRAPHIC){var t=this.position,e=Kt(qt(),[0,0,1],-this.roll*Math.PI/180);Mt(this.orthoMatrix,e,N((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),N(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=at(q(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(Ti)}}},{key:"rotate",value:function(t,e,n){throw new Error(oi)}},{key:"pan",value:function(t,e){throw new Error(oi)}},{key:"dolly",value:function(t){throw new Error(oi)}},{key:"createLandmark",value:function(t,e){throw new Error(oi)}},{key:"gotoLandmark",value:function(t,e){throw new Error(oi)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(oi)}}])}(),Pi=function(t){return t[t.Standard=0]="Standard",t}({}),Ci=function(t){return t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",t}({}),Ri={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ai(0,0,0,0)},Li=function(t){return t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_DISTANCE="<offset-distance>",t.DEFINED_PATH="<defined-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>",t}({});function Di(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ii(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function _i(){}var Bi=.7,Fi=1/Bi,ji="\\s*([+-]?\\d+)\\s*",Gi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Vi=/^#([0-9a-f]{3,8})$/,Wi=new RegExp(`^rgb\\(${ji},${ji},${ji}\\)$`),Ui=new RegExp(`^rgb\\(${zi},${zi},${zi}\\)$`),Hi=new RegExp(`^rgba\\(${ji},${ji},${ji},${Gi}\\)$`),Yi=new RegExp(`^rgba\\(${zi},${zi},${zi},${Gi}\\)$`),$i=new RegExp(`^hsl\\(${Gi},${zi},${zi}\\)$`),Xi=new RegExp(`^hsla\\(${Gi},${zi},${zi},${Gi}\\)$`),qi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ki(){return this.rgb().formatHex()}function Zi(){return this.rgb().formatRgb()}function Qi(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Vi.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ji(e):3===n?new er(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?tr(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?tr(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Wi.exec(t))?new er(e[1],e[2],e[3],1):(e=Ui.exec(t))?new er(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Hi.exec(t))?tr(e[1],e[2],e[3],e[4]):(e=Yi.exec(t))?tr(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=$i.exec(t))?sr(e[1],e[2]/100,e[3]/100,1):(e=Xi.exec(t))?sr(e[1],e[2]/100,e[3]/100,e[4]):qi.hasOwnProperty(t)?Ji(qi[t]):"transparent"===t?new er(NaN,NaN,NaN,0):null}function Ji(t){return new er(t>>16&255,t>>8&255,255&t,1)}function tr(t,e,n,i){return i<=0&&(t=e=n=NaN),new er(t,e,n,i)}function er(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function nr(){return`#${or(this.r)}${or(this.g)}${or(this.b)}`}function ir(){const t=rr(this.opacity);return`${1===t?"rgb(":"rgba("}${ar(this.r)}, ${ar(this.g)}, ${ar(this.b)}${1===t?")":`, ${t})`}`}function rr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ar(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function or(t){return((t=ar(t))<16?"0":"")+t.toString(16)}function sr(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ur(t,e,n,i)}function lr(t){if(t instanceof ur)return new ur(t.h,t.s,t.l,t.opacity);if(t instanceof _i||(t=Qi(t)),!t)return new ur;if(t instanceof ur)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,l=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=l<.5?a+r:2-a-r,o*=60):s=l>0&&l<1?0:o,new ur(o,s,l,t.opacity)}function ur(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function cr(t){return(t=(t||0)%360)<0?t+360:t}function hr(t){return Math.max(0,Math.min(1,t||0))}function dr(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function fr(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var o=e?e.apply(this,r):r[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,r);return n.cache=s.set(o,l)||s,l};return n.cache=new(fr.Cache||Map),fr.cacheList.push(n.cache),n}Di(_i,Qi,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ki,formatHex:Ki,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return lr(this).formatHsl()},formatRgb:Zi,toString:Zi}),Di(er,(function(t,e,n,i){return 1===arguments.length?((r=t)instanceof _i||(r=Qi(r)),r?new er((r=r.rgb()).r,r.g,r.b,r.opacity):new er):new er(t,e,n,null==i?1:i);var r}),Ii(_i,{brighter(t){return t=null==t?Fi:Math.pow(Fi,t),new er(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Bi:Math.pow(Bi,t),new er(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new er(ar(this.r),ar(this.g),ar(this.b),rr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nr,formatHex:nr,formatHex8:function(){return`#${or(this.r)}${or(this.g)}${or(this.b)}${or(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:ir,toString:ir})),Di(ur,(function(t,e,n,i){return 1===arguments.length?lr(t):new ur(t,e,n,null==i?1:i)}),Ii(_i,{brighter(t){return t=null==t?Fi:Math.pow(Fi,t),new ur(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Bi:Math.pow(Bi,t),new ur(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new er(dr(t>=240?t-240:t+120,r,i),dr(t,r,i),dr(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new ur(cr(this.h),hr(this.s),hr(this.l),rr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=rr(this.opacity);return`${1===t?"hsl(":"hsla("}${cr(this.h)}, ${100*hr(this.s)}%, ${100*hr(this.l)}%${1===t?")":`, ${t})`}`}})),fr.Cache=Map,fr.cacheList=[],fr.clearCache=function(){fr.cacheList.forEach((function(t){return t.clear()}))};var pr=function(t){return t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger",t}({}),gr=function(t){return t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther",t}({}),vr=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),yr=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),mr=[{name:"em",unit_type:pr.kEms},{name:"px",unit_type:pr.kPixels},{name:"deg",unit_type:pr.kDegrees},{name:"rad",unit_type:pr.kRadians},{name:"grad",unit_type:pr.kGradians},{name:"ms",unit_type:pr.kMilliseconds},{name:"s",unit_type:pr.kSeconds},{name:"rem",unit_type:pr.kRems},{name:"turn",unit_type:pr.kTurns}],br=function(t){return t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType",t}({}),xr=function(t){var e=1;switch(t){case pr.kPixels:case pr.kDegrees:case pr.kSeconds:break;case pr.kMilliseconds:e=.001;break;case pr.kRadians:e=180/Math.PI;break;case pr.kGradians:e=.9;break;case pr.kTurns:e=360}return e},Er=function(t){switch(t){case pr.kNumber:case pr.kInteger:return"";case pr.kPercentage:return"%";case pr.kEms:return"em";case pr.kRems:return"rem";case pr.kPixels:return"px";case pr.kDegrees:return"deg";case pr.kRadians:return"rad";case pr.kGradians:return"grad";case pr.kMilliseconds:return"ms";case pr.kSeconds:return"s";case pr.kTurns:return"turn"}return""},wr=function(){return c((function t(){l(this,t)}),[{key:"toString",value:function(){return this.buildCSSText(vr.kNo,yr.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=br.kUnitType&&this.getType()<=br.kClampType}}],[{key:"isAngle",value:function(t){return t===pr.kDegrees||t===pr.kRadians||t===pr.kGradians||t===pr.kTurns}},{key:"isLength",value:function(t){return t>=pr.kEms&&t<pr.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===pr.kPercentage||t===pr.kEms||t===pr.kRems}},{key:"isTime",value:function(t){return t===pr.kSeconds||t===pr.kMilliseconds}}])}(),kr=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).colorSpace=t,n}return m(e,t),c(e,[{key:"getType",value:function(){return br.kColorType}},{key:"to",value:function(t){return this}}])}(wr),Mr=function(t){return t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient",t}({}),Sr=function(t){function e(t,n){var i;return l(this,e),(i=v(this,e)).type=t,i.value=n,i}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(t,e,n){return n}},{key:"getType",value:function(){return br.kColorType}}])}(wr),Nr=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).value=t,n}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return br.kKeywordType}},{key:"buildCSSText",value:function(t,e,n){return n+this.value}}])}(wr),Tr=function(t){return function(t){switch(t){case gr.kUNumber:return pr.kNumber;case gr.kULength:return pr.kPixels;case gr.kUPercent:return pr.kPercentage;case gr.kUTime:return pr.kSeconds;case gr.kUAngle:return pr.kDegrees;default:return pr.kUnknown}}(function(t){switch(t){case pr.kNumber:case pr.kInteger:return gr.kUNumber;case pr.kPercentage:return gr.kUPercent;case pr.kPixels:return gr.kULength;case pr.kMilliseconds:case pr.kSeconds:return gr.kUTime;case pr.kDegrees:case pr.kRadians:case pr.kGradians:case pr.kTurns:return gr.kUAngle;default:return gr.kUOther}}(t))},Ar=function(t){function e(t){var n,i,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pr.kNumber;return l(this,e),n=v(this,e),i="string"==typeof a?(r=a)?"number"===r?pr.kNumber:"percent"===r||"%"===r?pr.kPercentage:function(t){return mr.find((function(e){return e.name===t})).unit_type}(r):pr.kUnknown:a,n.unit=i,n.value=t,n}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(t){var e=t;return this.value===e.value&&this.unit===e.unit}},{key:"getType",value:function(){return br.kUnitType}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=Tr(this.unit);if(n!==Tr(t)||n===pr.kUnknown)return null;var i=xr(this.unit)/xr(t);return new e(this.value*i,t)}},{key:"buildCSSText",value:function(t,e,n){var i;switch(this.unit){case pr.kUnknown:break;case pr.kInteger:i=Number(this.value).toFixed(0);break;case pr.kNumber:case pr.kPercentage:case pr.kEms:case pr.kRems:case pr.kPixels:case pr.kDegrees:case pr.kRadians:case pr.kGradians:case pr.kMilliseconds:case pr.kSeconds:case pr.kTurns:var r=this.value,a=Er(this.unit);if(r<-999999||r>999999){var o=Er(this.unit);i=!Number.isFinite(r)||Number.isNaN(r)?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e}(r,o):r+(o||"")}else i="".concat(r).concat(a)}return n+i}}])}(wr),Or=new Ar(0,"px");new Ar(1,"px");var Pr=new Ar(0,"deg"),Cr=function(t){function e(t,n,i){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return l(this,e),(r=v(this,e,["rgb"])).r=t,r.g=n,r.b=i,r.alpha=a,r.isNone=o,r}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(kr),Rr=new Nr("unset"),Lr={"":Rr,unset:Rr,initial:new Nr("initial"),inherit:new Nr("inherit")},Dr=new Cr(0,0,0,0,!0),Ir=new Cr(0,0,0,0),_r=fr((function(t,e,n,i){return new Cr(t,e,n,i)}),(function(t,e,n,i){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(i,")")})),Br=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pr.kNumber;return new Ar(t,e)};function Fr(t){var e=t.type,n=t.value;return"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")")}new Ar(50,"%");var jr=function(){var t=/^(linear\-gradient)/i,e=/^(repeating\-linear\-gradient)/i,n=/^(radial\-gradient)/i,i=/^(repeating\-radial\-gradient)/i,r=/^(conic\-gradient)/i,a=/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,o=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,s=/^(left|center|right|top|bottom)/i,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,d=/^\(/,f=/^\)/,p=/^,/,g=/^\#([0-9a-fA-F]+)/,v=/^([a-zA-Z]+)/,y=/^rgb/i,m=/^rgba/i,b=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,x="";function E(t){throw new Error("".concat(x,": ").concat(t))}function w(){return k("linear-gradient",t,S)||k("repeating-linear-gradient",e,S)||k("radial-gradient",n,N)||k("repeating-radial-gradient",i,N)||k("conic-gradient",r,N)}function k(t,e,n){return M(e,(function(e){var i=n();return i&&(B(p)||E("Missing comma before color stops")),{type:t,orientation:i,colorStops:C(R)}}))}function M(t,e){var n=B(t);if(n){B(d)||E("Missing (");var i=e(n);return B(f)||E("Missing )"),i}}function S(){return _("directional",a,1)||_("angular",h,1)}function N(){var t,e,n=T();return n&&((t=[]).push(n),e=x,B(p)&&((n=T())?t.push(n):x=e)),t}function T(){var t,e=function(){var t=_("shape",/^(circle)/i,0);return t&&(t.style=I()||A()),t}()||((t=_("shape",/^(ellipse)/i,0))&&(t.style=D()||A()),t);if(e)e.at=O();else{var n=A();if(n){e=n;var i=O();i&&(e.at=i)}else{var r=P();r&&(e={type:"default-radial",at:r})}}return e}function A(){return _("extent-keyword",o,1)}function O(){if(_("position",/^at/,0)){var t=P();return t||E("Missing positioning value"),t}}function P(){var t={x:D(),y:D()};if(t.x||t.y)return{type:"position",value:t}}function C(t){var e=t(),n=[];if(e)for(n.push(e);B(p);)(e=t())?n.push(e):E("One extra comma");return n}function R(){var t=_("hex",g,1)||M(m,(function(){return{type:"rgba",value:C(L)}}))||M(y,(function(){return{type:"rgb",value:C(L)}}))||_("literal",v,0);return t||E("Expected color definition"),t.length=D(),t}function L(){return B(b)[1]}function D(){return _("%",u,1)||_("position-keyword",s,1)||I()}function I(){return _("px",l,1)||_("em",c,1)}function _(t,e,n){var i=B(e);if(i)return{type:t,value:i[n]}}function B(t){var e=/^[\n\r\t\s]+/.exec(x);e&&F(e[0].length);var n=t.exec(x);return n&&F(n[0].length),n}function F(t){x=x.substring(t)}return function(t){return x=t,e=C(w),x.length>0&&E("Invalid input not EOF"),e;var e}}(),Gr=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,zr=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,Vr=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Wr=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,Ur={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},Hr=fr((function(t){var e;return e="angular"===t.type?Number(t.value):Ur[t.value]||0,Br(e,"deg")})),Yr=fr((function(t){var e=50,n=50,i="%",r="%";if("position"===(null==t?void 0:t.type)){var a=t.value,o=a.x,s=a.y;"position-keyword"===(null==o?void 0:o.type)&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),"position-keyword"===(null==s?void 0:s.type)&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),"px"!==(null==o?void 0:o.type)&&"%"!==(null==o?void 0:o.type)&&"em"!==(null==o?void 0:o.type)||(i=null==o?void 0:o.type,e=Number(o.value)),"px"!==(null==s?void 0:s.type)&&"%"!==(null==s?void 0:s.type)&&"em"!==(null==s?void 0:s.type)||(r=null==s?void 0:s.type,n=Number(s.value))}return{cx:Br(e,i),cy:Br(n,r)}})),$r=fr((function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return jr(t).map((function(t){var e=t.type,n=t.orientation,i=t.colorStops;!function(t){var e,n,i=t.length;t[i-1].length=null!==(e=t[i-1].length)&&void 0!==e?e:{type:"%",value:"100"},i>1&&(t[0].length=null!==(n=t[0].length)&&void 0!==n?n:{type:"%",value:"0"});for(var r=0,a=Number(t[0].length.value),o=1;o<i;o++){var s,l=null===(s=t[o].length)||void 0===s?void 0:s.value;if(!ce(l)&&!ce(a)){for(var u=1;u<o-r;u++)t[r+u].length={type:"%",value:"".concat(a+(Number(l)-a)*u/(o-r))};r=o,a=Number(l)}}}(i);var r,a=i.map((function(t){return{offset:Br(Number(t.length.value),"%"),color:Fr(t)}}));if("linear-gradient"===e)return new Sr(Mr.LinearGradient,{angle:n?Hr(n):Pr,steps:a});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var o,s=Yr(n[0].at),l=s.cx,u=s.cy;if(n[0].style){var c=n[0].style,h=c.type,d=c.value;"extent-keyword"===h?(Lr[r=d]||(Lr[r]=new Nr(r)),o=Lr[r]):o=Br(d,h)}return new Sr(Mr.RadialGradient,{cx:l,cy:u,size:o,steps:a})}}));var e=t[0];if("("===t[1]||"("===t[2])if("l"===e){var n=Gr.exec(t);if(n){var i,r=(null===(i=n[2].match(Wr))||void 0===i?void 0:i.map((function(t){return t.split(":")})))||[];return[new Sr(Mr.LinearGradient,{angle:Br(parseFloat(n[1]),"deg"),steps:r.map((function(t){var e=b(t,2),n=e[0],i=e[1];return{offset:Br(100*Number(n),"%"),color:i}}))})]}}else if("r"===e){var a=function(t){var e=zr.exec(t);if(e){var n,i=(null===(n=e[4].match(Wr))||void 0===n?void 0:n.map((function(t){return t.split(":")})))||[];return{cx:Br(50,"%"),cy:Br(50,"%"),steps:i.map((function(t){var e=b(t,2),n=e[0],i=e[1];return{offset:Br(100*Number(n),"%"),color:i}}))}}return null}(t);if(a){if(!he(a))return[new Sr(Mr.RadialGradient,a)];t=a}}else if("p"===e)return function(t){var e=Vr.exec(t);if(e){var n=e[1],i=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat"}return{image:i,repetition:n}}return null}(t)}));function Xr(t){return t&&!!t.image}function qr(t){return t&&!ce(t.r)&&!ce(t.g)&&!ce(t.b)}var Kr=fr((function(t){if(Xr(t))return s({repetition:"repeat"},t);if(ce(t)&&(t=""),"transparent"===t)return Ir;if("currentColor"===t)t="black";else if("none"===t)return Dr;var e=$r(t);if(e)return e;var n=Qi(t),i=[0,0,0,0];return null!==n&&(i[0]=n.r||0,i[1]=n.g||0,i[2]=n.b||0,i[3]=n.opacity),_r.apply(void 0,i)}));function Zr(t,e){if(qr(t)&&qr(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(de(e[n],0,255));return e[3]=de(e[3],0,1),"rgba(".concat(e.join(","),")")}]}function Qr(t,e){if(ce(e))return Br(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(t)>=0)return Br(Number(e),"px");if("deg".search(t)>=0)return Br(Number(e),"deg")}var n=[];e=e.replace(t,(function(t){return n.push(t),"U".concat(t)}));var i="U(".concat(t.source,")");return n.map((function(t){return Br(Number(e.replace(new RegExp("U".concat(t),"g"),"").replace(new RegExp(i,"g"),"*0")),t)}))[0]}var Jr=function(t){return Qr(new RegExp("px","g"),t)},ta=fr(Jr);fr((function(t){return Qr(new RegExp("%","g"),t)}));var ea=function(t){return le(t)||isFinite(Number(t))?Br(Number(t)||0,"px"):Qr(new RegExp("px|%|em|rem","g"),t)},na=fr(ea),ia=function(t){return Qr(new RegExp("deg|rad|grad|turn","g"),t)},ra=fr(ia);function aa(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=Tr(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=Er(t.unit)):(Ar.isLength(t.unit)||Ar.isLength(e.unit))&&(o=la(t,r,n),s=la(e,r,n),a="px"),[o,s,function(t){return i&&(t=Math.max(t,0)),t+a}]}function oa(t){var e=0;return t.unit===pr.kDegrees?e=t.value:t.unit===pr.kRadians?e=pi(Number(t.value)):t.unit===pr.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e}function sa(t,e){var n;return Array.isArray(t)?n=t.map((function(t){return Number(t)})):he(t)?n=t.split(" ").map((function(t){return Number(t)})):le(t)&&(n=[t]),2===e?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat(f(n),f(n)):n}function la(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===pr.kPixels)return Number(t.value);if(t.unit===pr.kPercentage&&n){var r=n.nodeName===Un.GROUP?n.getLocalBounds():n.getGeometryBounds();return(i?r.min[e]:0)+t.value/100*r.halfExtents[e]*2}return 0}var ua=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function ca(t){return t.toString()}var ha=function(t){return"number"==typeof t?Br(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?Br(Number(t)):Br(0)},da=fr(ha);function fa(t,e){return[t,e,ca]}function pa(t,e){return function(n,i){return[n,i,function(n){return ca(de(n,t,e))}]}}function ga(t,e){if(t.length===e.length)return[t,e,function(t){return t}]}function va(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=Ye(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength}function ya(t,e){return t[0]===e[0]&&t[1]===e[1]}function ma(t,e){var n=t.prePoint,i=t.currentPoint,r=t.nextPoint,a=Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2),o=Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2),s=Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||0===Math.sin(l)||Ke(l,0))return{xExtra:0,yExtra:0};var u=Math.abs(Math.atan2(r[1]-i[1],r[0]-i[0])),c=Math.abs(Math.atan2(r[0]-i[0],r[1]-i[1]));return u=u>Math.PI/2?Math.PI-u:u,c=c>Math.PI/2?Math.PI-c:c,{xExtra:Math.cos(l/2-u)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(c-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0}}function ba(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}fr((function(t){return he(t)?t.split(" ").map(da):t.map(da)}));var xa=function(t,e){var n=t.x*e.x+t.y*e.y,i=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/i)},Ea=function(t,e,n,i,r,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=di(i=Ze(i,360));if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2));f=f<0?0:f;var p=(r!==a?1:-1)*Math.sqrt(f),g=p*(e*h.y/n),v=p*(-n*h.x/e),y={x:Math.cos(l)*g-Math.sin(l)*v+(t.x+o.x)/2,y:Math.sin(l)*g+Math.cos(l)*v+(t.y+o.y)/2},m={x:(h.x-g)/e,y:(h.y-v)/n},b=xa({x:1,y:0},m),x=xa(m,{x:(-h.x-g)/e,y:(-h.y-v)/n});!a&&x>0?x-=2*Math.PI:a&&x<0&&(x+=2*Math.PI);var E=b+(x%=2*Math.PI)*s,w=e*Math.cos(E),k=n*Math.sin(E);return{x:Math.cos(l)*w-Math.sin(l)*k+y.x,y:Math.sin(l)*w+Math.cos(l)*k+y.y,ellipticalArcStartAngle:b,ellipticalArcEndAngle:b+x,ellipticalArcAngle:E,ellipticalArcCenter:y,resultantRx:e,resultantRy:n}};function wa(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.arcParams,r=i.rx,a=void 0===r?0:r,o=i.ry,s=void 0===o?0:o,l=i.xRotation,u=i.arcFlag,c=i.sweepFlag,h=Ea({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=Ea({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,p=d.y-h.y,g=Math.sqrt(f*f+p*p);return{x:-f/g,y:-p/g}}function ka(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Ma(t,e){return ka(t)*ka(e)?(t[0]*e[0]+t[1]*e[1])/(ka(t)*ka(e)):1}function Sa(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Ma(t,e))}function Na(t,e){var n=e[1],i=e[2],r=Ze(di(e[3]),2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(r)*(s-u)/2+Math.sin(r)*(l-c)/2,d=-1*Math.sin(r)*(s-u)/2+Math.cos(r)*(l-c)/2,f=h*h/(n*n)+d*d/(i*i);f>1&&(n*=Math.sqrt(f),i*=Math.sqrt(f));var p=n*n*(d*d)+i*i*(h*h),g=p?Math.sqrt((n*n*(i*i)-p)/p):1;a===o&&(g*=-1),isNaN(g)&&(g=0);var v=i?g*n*d/i:0,y=n?g*-i*h/n:0,m=(s+u)/2+Math.cos(r)*v-Math.sin(r)*y,b=(l+c)/2+Math.sin(r)*v+Math.cos(r)*y,x=[(h-v)/n,(d-y)/i],E=[(-1*h-v)/n,(-1*d-y)/i],w=Sa([1,0],x),k=Sa(x,E);return Ma(x,E)<=-1&&(k=Math.PI),Ma(x,E)>=1&&(k=0),0===o&&k>0&&(k-=2*Math.PI),1===o&&k<0&&(k+=2*Math.PI),{cx:m,cy:b,rx:ya(t,[u,c])?0:n,ry:ya(t,[u,c])?0:i,startAngle:w,endAngle:w+k,xRotation:r,arcFlag:a,sweepFlag:o}}var Ta=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Ie(t)}catch(n){e=Ie(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],i=t[e];if("M"===i[0]&&n){var r=n[0],a=[i[1],i[2]],o=void 0;"L"===r||"M"===r?o=[n[1],n[2]]:"C"!==r&&"A"!==r&&"Q"!==r||(o=[n[n.length-2],n[n.length-1]]),o&&ya(a,o)&&(t.splice(e,1),e--)}}}(e);var n=function(t){for(var e=!1,n=t.length,i=0;i<n;i++){var r=t[i][0];if("C"===r||"A"===r||"Q"===r){e=!0;break}}return e}(e),i=function(t){for(var e=[],n=[],i=[],r=0;r<t.length;r++){var a=t[r],o=a[0];"M"===o?(i.length&&(n.push(i),i=[]),i.push([a[1],a[2]])):"Z"===o?i.length&&(e.push(i),i=[]):i.push([a[1],a[2]])}return i.length>0&&n.push(i),{polygons:e,polylines:n}}(e),r=i.polygons,a=i.polylines,o=function(t){for(var e=[],n=null,i=null,r=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];i=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":r=[l[1],l[2]],a=s;break;case"A":var h=Na(n,l);c.arcParams=h}if("Z"===u)n=r,i=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]]}i&&"Z"===i[0]&&(i=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&ya(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=i?[i[i.length-2],i[i.length-1]]:null;c.nextPoint=f;var p=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];else if("Q"===u){var g=[l[1],l[2]];c.startTangent=[p[0]-g[0],p[1]-g[1]],c.endTangent=[n[0]-g[0],n[1]-g[1]]}else if("T"===u){var v=e[s-1],y=ba(v.currentPoint,p);"Q"===v.command?(c.command="Q",c.startTangent=[p[0]-y[0],p[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]])}else if("C"===u){var m=[l[1],l[2]],b=[l[3],l[4]];c.startTangent=[p[0]-m[0],p[1]-m[1]],c.endTangent=[n[0]-b[0],n[1]-b[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-b[0],m[1]-b[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[b[0]-m[0],b[1]-m[1]])}else if("S"===u){var x=e[s-1],E=ba(x.currentPoint,p),w=[l[1],l[2]];"C"===x.command?(c.command="C",c.startTangent=[p[0]-E[0],p[1]-E[1]],c.endTangent=[n[0]-w[0],n[1]-w[1]]):(c.command="SQ",c.startTangent=[p[0]-w[0],p[1]-w[1]],c.endTangent=[n[0]-w[0],n[1]-w[1]])}else if("A"===u){var k=wa(c,0),M=k.x,S=k.y,N=wa(c,1,!1),T=N.x,A=N.y;c.startTangent=[M,S],c.endTangent=[T,A]}e.push(c)}return e}(e),s=function(t){for(var e=[],n=[],i=[],r=0;r<t.length;r++){var a=t[r],o=a.currentPoint,s=a.params,l=a.prePoint,u=void 0;switch(a.command){case"Q":u=In(l[0],l[1],s[1],s[2],s[3],s[4]);break;case"C":u=Pn(l[0],l[1],s[1],s[2],s[3],s[4],s[5],s[6]);break;case"A":var c=a.arcParams;u=Mn(c.cx,c.cy,c.rx,c.ry,c.xRotation,c.startAngle,c.endAngle);break;default:e.push(o[0]),n.push(o[1])}u&&(a.box=u,e.push(u.x,u.x+u.width),n.push(u.y,u.y+u.height))}e=e.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0})),n=n.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0}));var h=Xe(e),d=Xe(n),f=qe(e),p=qe(n);if(0===i.length)return{x:h,y:d,width:f-h,height:p-d};for(var g=0;g<i.length;g++){var v=i[g],y=v.currentPoint;y[0]===h?h-=ma(v,0).xExtra:y[0]===f&&(f+=ma(v,0).xExtra),y[1]===d?d-=ma(v,0).yExtra:y[1]===p&&(p+=ma(v,0).yExtra)}return{x:h,y:d,width:f-h,height:p-d}}(o),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:r,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}}},Aa=fr(Ta);function Oa(t){return he(t)?Aa(t):Ta(t)}function Pa(t,e,n){var i=t.curve,r=e.curve;i&&0!==i.length||(i=rn(t.absolutePath,!1),t.curve=i),r&&0!==r.length||(r=rn(e.absolutePath,!1),e.curve=r);var a=[i,r];i.length!==r.length&&(a=on(i,r));var o=sn(a[0])!==sn(a[1])?ln(a[0]):un(a[0]);return[o,cn(a[1],o),function(t){return t}]}function Ca(t,e){return[t.points,e.points,function(t){return t}]}var Ra=null,La=/\s*(\w+)\(([^)]*)\)/g;function Da(t){return function(e){var n=0;return t.map((function(t){return t===Ra?e[n++]:t}))}}function Ia(t){return t}var _a={matrix:["NNNNNN",[Ra,Ra,0,0,Ra,Ra,0,0,0,0,1,0,Ra,Ra,0,1],Ia],matrix3d:["NNNNNNNNNNNNNNNN",Ia],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Da([Ra,Ra,new Ar(1)]),Ia],scaleX:["N",Da([Ra,new Ar(1),new Ar(1)]),Da([Ra,new Ar(1)])],scaleY:["N",Da([new Ar(1),Ra,new Ar(1)]),Da([new Ar(1),Ra])],scaleZ:["N",Da([new Ar(1),new Ar(1),Ra])],scale3d:["NNN",Ia],skew:["Aa",null,Ia],skewX:["A",null,Da([Ra,Pr])],skewY:["A",null,Da([Pr,Ra])],translate:["Tt",Da([Ra,Ra,Or]),Ia],translateX:["T",Da([Ra,Or,Or]),Da([Ra,Or])],translateY:["T",Da([Or,Ra,Or]),Da([Or,Ra])],translateZ:["L",Da([Or,Or,Ra])],translate3d:["TTL",Ia]};function Ba(t){for(var e=[],n=t.length,i=0;i<n;i++){var r=t[i],a=r[0],o=r.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!_a[a])return[];var s=o.map((function(t){return Br(t)}));e.push({t:a,d:s})}return e}function Fa(t){if(Array.isArray(t))return Ba(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],i=0;for(La.lastIndex=0;e=La.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var r=e[1],a=_a[r];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var l=[],u=0;u<s.length;u++){var c,h=o[u],d=s[u];if(void 0===(c=h?{A:function(t){return"0"===t.trim()?Pr:ra(t)},N:da,T:na,L:ta}[d.toUpperCase()](h):{a:Pr,n:l[0],t:Or}[d]))return[];l.push(c)}if(n.push({t:r,d:l}),La.lastIndex===t.length)return n}return[]}function ja(t){if(Array.isArray(t))return Ba(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],i=0;for(La.lastIndex=0;e=La.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var r=e[1],a=_a[r];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var l=[],u=0;u<s.length;u++){var c,h=o[u],d=s[u];if(void 0===(c=h?{A:function(t){return"0"===t.trim()?Pr:ia(t)},N:ha,T:ea,L:Jr}[d.toUpperCase()](h):{a:Pr,n:l[0],t:Or}[d]))return[];l.push(c)}if(n.push({t:r,d:l}),La.lastIndex===t.length)return n}return[]}function Ga(t){var e,n,i,r;switch(t.t){case"rotateX":return r=di(oa(t.d[0])),[1,0,0,0,0,Math.cos(r),Math.sin(r),0,0,-Math.sin(r),Math.cos(r),0,0,0,0,1];case"rotateY":return r=di(oa(t.d[0])),[Math.cos(r),0,-Math.sin(r),0,0,1,0,0,Math.sin(r),0,Math.cos(r),0,0,0,0,1];case"rotate":case"rotateZ":return r=di(oa(t.d[0])),[Math.cos(r),Math.sin(r),0,0,-Math.sin(r),Math.cos(r),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,i=t.d[2].value,r=di(oa(t.d[3]));var a=e*e+n*n+i*i;if(0===a)e=1,n=0,i=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,i/=o}var s=Math.sin(r/2),l=s*Math.cos(r/2),u=s*s;return[1-2*(n*n+i*i)*u,2*(e*n*u+i*l),2*(e*i*u-n*l),0,2*(e*n*u-i*l),1-2*(e*e+i*i)*u,2*(n*i*u+e*l),0,2*(e*i*u+n*l),2*(n*i*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=di(oa(t.d[0])),h=di(oa(t.d[1]));return[1,Math.tan(h),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return r=di(oa(t.d[0])),[1,0,0,0,Math.tan(r),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return r=di(oa(t.d[0])),[1,Math.tan(r),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=la(t.d[0],0,null)||0,n=la(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=la(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=la(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,i=la(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=la(t.d[0],0,null)||0,n=la(t.d[1],0,null)||0,i=la(t.d[2],0,null)||0,1];case"perspective":var d=la(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,d?-1/d:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map((function(t){return t.value}))}}function za(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function Va(t){var e=[0,0,0],n=[1,1,1],i=[0,0,0],r=[0,0,0,1],a=[0,0,0,1];return function(t,e,n,i,r,a){if(!function(t,e){var n=e[15];if(0===n)return!1;for(var i=1/n,r=0;r<16;r++)t[r]=e[r]*i;return!0}(mi,t))return!1;if(Z(bi,mi),bi[3]=0,bi[7]=0,bi[11]=0,bi[15]=1,Math.abs(rt(bi))<1e-8)return!1;var o,s,l=mi[3],u=mi[7],c=mi[11],h=mi[12],d=mi[13],f=mi[14],p=mi[15];if(0!==l||0!==u||0!==c){if(xi[0]=l,xi[1]=u,xi[2]=c,xi[3]=p,!nt(bi,bi))return!1;et(bi,bi),X(r,xi,bi)}else r[0]=r[1]=r[2]=0,r[3]=1;if(e[0]=h,e[1]=d,e[2]=f,s=mi,(o=Ei)[0][0]=s[0],o[0][1]=s[1],o[0][2]=s[2],o[1][0]=s[4],o[1][1]=s[5],o[1][2]=s[6],o[2][0]=s[8],o[2][1]=s[9],o[2][2]=s[10],n[0]=S(Ei[0]),I(Ei[0],Ei[0]),i[0]=_(Ei[0],Ei[1]),ki(Ei[1],Ei[1],Ei[0],1,-i[0]),n[1]=S(Ei[1]),I(Ei[1],Ei[1]),i[0]/=n[1],i[1]=_(Ei[0],Ei[2]),ki(Ei[2],Ei[2],Ei[0],1,-i[1]),i[2]=_(Ei[1],Ei[2]),ki(Ei[2],Ei[2],Ei[1],1,-i[2]),n[2]=S(Ei[2]),I(Ei[2],Ei[2]),i[1]/=n[2],i[2]/=n[2],B(wi,Ei[1],Ei[2]),_(Ei[0],wi)<0)for(var g=0;g<3;g++)n[g]*=-1,Ei[g][0]*=-1,Ei[g][1]*=-1,Ei[g][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+Ei[0][0]-Ei[1][1]-Ei[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Ei[0][0]+Ei[1][1]-Ei[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Ei[0][0]-Ei[1][1]+Ei[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Ei[0][0]+Ei[1][1]+Ei[2][2],0)),Ei[2][1]>Ei[1][2]&&(a[0]=-a[0]),Ei[0][2]>Ei[2][0]&&(a[1]=-a[1]),Ei[1][0]>Ei[0][1]&&(a[2]=-a[2])}(function(t){return 0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(Ga).reduce(za)}(t),e,n,i,r,a),[[e,n,i,a,r]]}var Wa=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],i=0;i<4;i++)for(var r=0;r<4;r++)for(var a=0;a<4;a++)n[i][r]+=e[i][a]*t[a][r];return n}return function(e,n,i,r,a){for(var o=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],s=0;s<4;s++)o[s][3]=a[s];for(var l=0;l<3;l++)for(var u=0;u<3;u++)o[3][l]+=e[u]*o[u][l];var c=r[0],h=r[1],d=r[2],f=r[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(h*h+d*d),p[0][1]=2*(c*h-d*f),p[0][2]=2*(c*d+h*f),p[1][0]=2*(c*h+d*f),p[1][1]=1-2*(c*c+d*d),p[1][2]=2*(h*d-c*f),p[2][0]=2*(c*d-h*f),p[2][1]=2*(h*d+c*f),p[2][2]=1-2*(c*c+h*h),o=t(o,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];i[2]&&(g[2][1]=i[2],o=t(o,g)),i[1]&&(g[2][1]=0,g[2][0]=i[0],o=t(o,g)),i[0]&&(g[2][0]=0,g[1][0]=i[0],o=t(o,g));for(var v=0;v<3;v++)for(var y=0;y<3;y++)o[v][y]*=n[v];return function(t){return 0===t[0][2]&&0===t[0][3]&&0===t[1][2]&&0===t[1][3]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]&&0===t[2][3]&&0===t[3][2]&&1===t[3][3]}(o)?[o[0][0],o[0][1],o[1][0],o[1][1],o[3][0],o[3][1]]:o[0].concat(o[1],o[2],o[3])}}();function Ua(t){return t.toFixed(6).replace(".000000","")}function Ha(t,e){var n,i;return t.decompositionPair!==e&&(t.decompositionPair=e,n=Va(t)),e.decompositionPair!==t&&(e.decompositionPair=t,i=Va(e)),null===n[0]||null===i[0]?[[!1],[!0],function(n){return n?e[0].d:t[0].d}]:(n[0].push(0),i[0].push(1),[n,i,function(t){var e=function(t,e,n){var i=function(t,e){for(var n=0,i=0;i<t.length;i++)n+=t[i]*e[i];return n}(t,e),r=[];if(1===(i=de(i,-1,1)))r=t;else for(var a=Math.acos(i),o=1*Math.sin(n*a)/Math.sqrt(1-i*i),s=0;s<4;s++)r.push(t[s]*(Math.cos(n*a)-i*o)+e[s]*o);return r}(n[0][3],i[0][3],t[5]);return Wa(t[0],t[1],t[2],e,t[4]).map(Ua).join(",")}])}function Ya(t){return t.replace(/[XY]/,"")}function $a(t){return t.replace(/(X|Y|Z|3d)?$/,"3d")}function Xa(t,e,n){var i=!1;if(!t.length||!e.length){t.length||(i=!0,t=e,e=[]);for(var r=function(){var n=t[a],i=n.t,r=n.d,o="scale"===i.substring(0,5)?1:0;e.push({t:i,d:r.map((function(t){return"number"==typeof t?Br(o):Br(o,t.unit)}))})},a=0;a<t.length;a++)r()}var o,s,l=[],u=[],c=[];if(t.length!==e.length){var h=Ha(t,e);l=[h[0]],u=[h[1]],c=[["matrix",[h[2]]]]}else for(var d=0;d<t.length;d++){var f=t[d].t,p=e[d].t,g=t[d].d,v=e[d].d,y=_a[f],m=_a[p],b=void 0;if(s=p,"perspective"===(o=f)&&"perspective"===s||!("matrix"!==o&&"matrix3d"!==o||"matrix"!==s&&"matrix3d"!==s)){var x=Ha([t[d]],[e[d]]);l.push(x[0]),u.push(x[1]),c.push(["matrix",[x[2]]])}else{if(f===p)b=f;else if(y[2]&&m[2]&&Ya(f)===Ya(p))b=Ya(f),g=y[2](g),v=m[2](v);else{if(!y[1]||!m[1]||$a(f)!==$a(p)){var E=Ha(t,e);l=[E[0]],u=[E[1]],c=[["matrix",[E[2]]]];break}b=$a(f),g=y[1](g),v=m[1](v)}for(var w=[],k=[],M=[],S=0;S<g.length;S++){var N=aa(g[S],v[S],n,!1,S);w[S]=N[0],k[S]=N[1],M.push(N[2])}l.push(w),u.push(k),c.push([b,M])}}if(i){var T=l;l=u,u=T}return[l,u,function(t){return t.map((function(t,e){var n=t.map((function(t,n){return c[e][1][n](t)})).join(",");return"matrix"===c[e][0]&&16===n.split(",").length&&(c[e][0]="matrix3d"),"matrix3d"===c[e][0]&&6===n.split(",").length&&(c[e][0]="matrix"),"".concat(c[e][0],"(").concat(n,")")})).join(" ")}]}var qa=fr((function(t){if(he(t)){if("text-anchor"===t)return[Br(0,"px"),Br(0,"px")];var e=t.split(" ");return 1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length?null:[na(Ka(e[0])),na(Ka(e[1]))]}return[Br(t[0]||0,"px"),Br(t[1]||0,"px")]}));function Ka(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t}var Za=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:Li.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:Li.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:Li.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:Li.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:Li.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:Li.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:Li.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:Li.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:Li.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:Li.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:Li.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:Li.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:Li.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:Li.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:Li.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:Li.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:Li.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:Li.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:Li.FILTER},{n:"clipPath",syntax:Li.DEFINED_PATH},{n:"textPath",syntax:Li.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:Li.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:Li.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:Li.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:Li.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:Li.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:Li.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:Li.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:Li.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:Li.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:Li.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:Li.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:Li.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Li.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Li.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:Li.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:Li.COORDINATE},{n:"y1",int:!0,l:!0,syntax:Li.COORDINATE},{n:"z1",int:!0,l:!0,syntax:Li.COORDINATE},{n:"x2",int:!0,l:!0,syntax:Li.COORDINATE},{n:"y2",int:!0,l:!0,syntax:Li.COORDINATE},{n:"z2",int:!0,l:!0,syntax:Li.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:Li.PATH,p:50},{n:"points",int:!0,l:!0,syntax:Li.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:Li.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:Li.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:Li.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:Li.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:Li.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:Li.NUMBER,d:function(t){return t===Un.PATH||t===Un.POLYGON||t===Un.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:Li.MARKER},{n:"markerEnd",syntax:Li.MARKER},{n:"markerMid",syntax:Li.MARKER},{n:"markerStartOffset",syntax:Li.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:Li.LENGTH,l:!0,int:!0,d:"0"}],Qa=new Set(Za.filter((function(t){return!!t.l})).map((function(t){return t.n}))),Ja={},to=function(){return c((function t(e){var n=this;l(this,t),this.runtime=e,Za.forEach((function(t){n.registerMetadata(t)}))}),[{key:"registerMetadata",value:function(t){[t.n].concat(f(t.a||[])).forEach((function(e){Ja[e]=t}))}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,r=t.parsedStyle.offsetPath;!function(t,e){var n=eo(t);for(var i in e)n.has(i)&&(t.parsedStyle[i]=e[i])}(t,e);var a=!!n.forceUpdateGeometry;if(!a)for(var o in e)if(Qa.has(o)){a=!0;break}var l,u=eo(t);u.has("fill")&&e.fill&&(t.parsedStyle.fill=Kr(e.fill)),u.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=Kr(e.stroke)),u.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=Kr(e.shadowColor)),u.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,i=[],r=0;e=n.exec(t);){if(e.index!==r)return[];if(r=e.index+e[0].length,ua.indexOf(e[1])>-1&&i.push({name:e[1],params:e[2].split(" ").map((function(t){return Qr(/deg|rad|grad|turn|px|%/g,t)||Kr(t)}))}),n.lastIndex===t.length)return i}return[]}(e.filter)),u.has("radius")&&!ce(e.radius)&&(t.parsedStyle.radius=sa(e.radius,4)),u.has("lineDash")&&!ce(e.lineDash)&&(t.parsedStyle.lineDash=sa(e.lineDash,"even")),u.has("points")&&e.points&&(t.parsedStyle.points={points:he(l=e.points)?l.split(" ").map((function(t){var e=b(t.split(","),2),n=e[0],i=e[1];return[Number(n),Number(i)]})):l,totalLength:0,segments:[]}),u.has("d")&&""===e.d&&(t.parsedStyle.d=s({},Ri)),u.has("d")&&e.d&&(t.parsedStyle.d=Oa(e.d)),u.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[Li.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),u.has("clipPath")&&!hn(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[Li.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),u.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[Li.DEFINED_PATH].calculator("offsetPath",r,e.offsetPath,t,this.runtime),u.has("transform")&&e.transform&&(t.parsedStyle.transform=Fa(e.transform)),u.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=qa(e.transformOrigin)),u.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[Li.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),u.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[Li.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),u.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[Li.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),u.has("zIndex")&&!ce(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[Li.Z_INDEX].postProcessor(t),u.has("offsetDistance")&&!ce(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[Li.OFFSET_DISTANCE].postProcessor(t),u.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[Li.TRANSFORM].postProcessor(t),u.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[Li.TRANSFORM_ORIGIN].postProcessor(t),a&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,n.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t))}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var i=t.geometry;i.contentBounds||(i.contentBounds=new ti),i.renderBounds||(i.renderBounds=new ti);var r=t.parsedStyle,a=n.update(r,t),o=a.cx,s=void 0===o?0:o,l=a.cy,u=void 0===l?0:l,c=a.cz,h=void 0===c?0:c,d=a.hwidth,f=void 0===d?0:d,p=a.hheight,g=void 0===p?0:p,v=a.hdepth,y=void 0===v?0:v,m=[Math.abs(f),Math.abs(g),y],b=r.stroke,x=r.lineWidth,E=void 0===x?1:x,w=r.increasedLineWidthForHitTesting,k=void 0===w?0:w,M=r.shadowType,S=void 0===M?"outer":M,N=r.shadowColor,T=r.filter,A=void 0===T?[]:T,P=r.transformOrigin,C=[s,u,h];i.contentBounds.update(C,m);var R=e===Un.POLYLINE||e===Un.POLYGON||e===Un.PATH?Math.SQRT2:.5;if(b&&!b.isNone){var L=((E||0)+(k||0))*R;m[0]+=L,m[1]+=L}if(i.renderBounds.update(C,m),N&&S&&"inner"!==S){var D=i.renderBounds,I=D.min,_=D.max,B=r.shadowBlur||0,F=r.shadowOffsetX||0,j=r.shadowOffsetY||0,G=I[0]-B+F,z=_[0]+B+F,V=I[1]-B+j,W=_[1]+B+j;I[0]=Math.min(I[0],G),_[0]=Math.max(_[0],z),I[1]=Math.min(I[1],V),_[1]=Math.max(_[1],W),i.renderBounds.setMinMax(I,_)}A.forEach((function(t){var e=t.name,n=t.params;if("blur"===e){var r=n[0].value;i.renderBounds.update(i.renderBounds.center,O(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[r,r,0]))}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=i.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,p=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],p),i.renderBounds.setMinMax(u,c)}})),t.geometry.dirty=!1;var U=g<0,H=(f<0?-1:1)*(P?la(P[0],0,t,!0):0),Y=(U?-1:1)*(P?la(P[1],1,t,!0):0);(H||Y)&&t.setOrigin(H,Y)}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===Un.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===Un.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}])}();function eo(t){return t.constructor.PARSED_STYLE_LIST}var no=function(){return c((function t(){l(this,t),this.mixer=fa}),[{key:"calculator",value:function(t,e,n,i){return oa(n)}}])}(),io=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i,r){return n instanceof Nr&&(n=null),r.sceneGraphService.updateDisplayObjectDependency(t,e,n,i),"clipPath"===t&&i.forEach((function(t){0===t.childNodes.length&&r.sceneGraphService.dirtifyToRoot(t)})),n}}])}(),ro=function(){return c((function t(){l(this,t),this.parser=Kr,this.mixer=Zr}),[{key:"calculator",value:function(t,e,n,i){return n instanceof Nr?"none"===n.value?Dr:Ir:n}}])}(),ao=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n){return n instanceof Nr?[]:n}}])}();function oo(t){var e=t.parsedStyle.fontSize;return ce(e)?null:e}var so=function(){return c((function t(){l(this,t),this.mixer=fa}),[{key:"calculator",value:function(t,e,n,i,r){if(le(n))return n;if(!Ar.isRelativeUnit(n.unit))return n.value;if(n.unit===pr.kPercentage)return 0;if(n.unit===pr.kEms){if(i.parentNode){var a=oo(i.parentNode);if(a)return a*n.value}return 0}if(n.unit===pr.kRems){var o;if(null!=i&&null!==(o=i.ownerDocument)&&void 0!==o&&o.documentElement){var s=oo(i.ownerDocument.documentElement);if(s)return s*n.value}return 0}}}])}(),lo=function(){return c((function t(){l(this,t),this.mixer=ga}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),uo=function(){return c((function t(){l(this,t),this.mixer=ga}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),co=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){var r;n instanceof Nr&&(n=null);var a=null===(r=n)||void 0===r?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a}}])}(),ho=function(){return c((function t(){l(this,t),this.mixer=fa}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),fo=function(){return c((function t(){l(this,t),this.mixer=pa(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,i=e.offsetDistance;if(n){var r=n.nodeName;if(r===Un.LINE||r===Un.PATH||r===Un.POLYLINE){var a=n.getPoint(i);a&&t.setLocalPosition(a.x,a.y)}}}}])}(),po=function(){return c((function t(){l(this,t),this.mixer=pa(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),go=function(){return c((function t(){l(this,t),this.parser=Oa,this.mixer=Pa}),[{key:"calculator",value:function(t,e,n){return n instanceof Nr&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ai(0,0,0,0)}:n}}])}(),vo=c((function t(){l(this,t),this.mixer=Ca})),yo=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).mixer=pa(0,1/0),t}return m(e,t),c(e)}(so),mo=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){return n instanceof Nr?"unset"===n.value?"":n.value:"".concat(n)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}])}(),bo=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){var r=i.getAttribute("text");if(r){var a=r;"capitalize"===n.value?a=r.charAt(0).toUpperCase()+r.slice(1):"lowercase"===n.value?a=r.toLowerCase():"uppercase"===n.value&&(a=r.toUpperCase()),i.parsedStyle.text=a}return n.value}}])}(),xo=new WeakMap,Eo="undefined"!=typeof window&&void 0!==window.document;function wo(t){return!!t.getAttribute}function ko(t,e){var n=Number(t.parsedStyle.zIndex||0),i=Number(e.parsedStyle.zIndex||0);if(n===i){var r=t.parentNode;if(r){var a=r.childNodes||[];return a.indexOf(t)-a.indexOf(e)}}return n-i}function Mo(t){var e=t;do{var n;if(null===(n=e.parsedStyle)||void 0===n?void 0:n.clipPath)return e;e=e.parentElement}while(null!==e);return null}function So(t,e){if(Eo)return document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}var No={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},To="object"==typeof performance&&performance.now?performance:Date;function Ao(t){return t.nodeName===Un.FRAGMENT||t.getRootNode().nodeName===Un.FRAGMENT}function Oo(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=!1,r=!1,a=!!e&&!e.isNone,o=!!n&&!n.isNone;return"visiblepainted"===t||"painted"===t||"auto"===t?(i=a,r=o):"visiblefill"===t||"fill"===t?i=!0:"visiblestroke"===t||"stroke"===t?r=!0:"visible"!==t&&"all"!==t||(i=!0,r=!0),[i,r]}var Po=1,Co="object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:{},Ro=Date.now(),Lo={},Do=Date.now(),Io=function(t){if("function"!=typeof t)throw new TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-Do,i=n>16?0:16-n,r=Po++;return Lo[r]=t,Object.keys(Lo).length>1||setTimeout((function(){Do=e;var t=Lo;Lo={},Object.keys(t).forEach((function(e){return t[e](Co.performance&&"function"==typeof Co.performance.now?Co.performance.now():Date.now()-Ro)}))}),i),r},_o=function(t){delete Lo[t]},Bo=function(t){return"string"!=typeof t?Io:""===t?Co.requestAnimationFrame:Co["".concat(t,"RequestAnimationFrame")]},Fo=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1}}(["","webkit","moz","ms","o"],(function(t){return!!Bo(t)})),jo=Bo(Fo),Go=function(t){return"string"!=typeof t?_o:""===t?Co.cancelAnimationFrame:Co["".concat(t,"CancelAnimationFrame")]||Co["".concat(t,"CancelRequestAnimationFrame")]}(Fo);Co.requestAnimationFrame=jo,Co.cancelAnimationFrame=Go;var zo=function(){return c((function t(){l(this,t),this.callbacks=[]}),[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e)}},{key:"promise",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map((function(t){return t.apply(void 0,e)})))}}])}(),Vo=function(){return c((function t(){l(this,t),this.callbacks=[]}),[{key:"tapPromise",value:function(t,e){this.callbacks.push(e)}},{key:"promise",value:(t=jn(Bn().mark((function t(){var e,n,i,r,a=arguments;return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=14;break}return t.next=3,(e=this.callbacks)[0].apply(e,a);case 3:n=t.sent,i=0;case 5:if(!(i<this.callbacks.length-1)){t.next=13;break}return r=this.callbacks[i],t.next=9,r(n);case 9:n=t.sent;case 10:i++,t.next=5;break;case 13:return t.abrupt("return",n);case 14:return t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})}]);var t}(),Wo=function(){return c((function t(){l(this,t),this.callbacks=[]}),[{key:"tap",value:function(t,e){this.callbacks.push(e)}},{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=arguments;this.callbacks.forEach((function(t){t.apply(void 0,i)}))}}])}(),Uo=function(){return c((function t(){l(this,t),this.callbacks=[]}),[{key:"tap",value:function(t,e){this.callbacks.push(e)}},{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var i=arguments,r=this.callbacks[0].apply(void 0,i),a=0;a<this.callbacks.length-1;a++)r=(0,this.callbacks[a])(r);return r}return null}}])}(),Ho=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Yo=/([\"\'])[^\'\"]+\1/;function $o(t,e,n){return tt(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t}var Xo=q(),qo=q(),Ko={scale:function(t){ft(Xo,[t[0].value,t[1].value,1])},scaleX:function(t){ft(Xo,[t[0].value,1,1])},scaleY:function(t){ft(Xo,[1,t[0].value,1])},scaleZ:function(t){ft(Xo,[1,1,t[0].value])},scale3d:function(t){ft(Xo,[t[0].value,t[1].value,t[2].value])},translate:function(t){dt(Xo,[t[0].value,t[1].value,0])},translateX:function(t){dt(Xo,[t[0].value,0,0])},translateY:function(t){dt(Xo,[0,t[0].value,0])},translateZ:function(t){dt(Xo,[0,0,t[0].value])},translate3d:function(t){dt(Xo,[t[0].value,t[1].value,t[2].value])},rotate:function(t){yt(Xo,di(oa(t[0])))},rotateX:function(t){gt(Xo,di(oa(t[0])))},rotateY:function(t){vt(Xo,di(oa(t[0])))},rotateZ:function(t){yt(Xo,di(oa(t[0])))},rotate3d:function(t){pt(Xo,di(oa(t[3])),[t[0].value,t[1].value,t[2].value])},skew:function(t){$o(Xo,di(t[0].value),di(t[1].value))},skewX:function(t){$o(Xo,di(t[0].value),0)},skewY:function(t){$o(Xo,0,di(t[0].value))},matrix:function(t){J(Xo,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1)},matrix3d:function(e){J.apply(t,[Xo].concat(f(e.map((function(t){return t.value})))))}},Zo=N(1,1,1),Qo=k(),Jo={translate:function(t,e){rl.sceneGraphService.setLocalScale(t,Zo,!1),rl.sceneGraphService.setLocalEulerAngles(t,Qo,void 0,void 0,!1),rl.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),rl.sceneGraphService.dirtifyLocal(t,t.transformable)}};function ts(t,e){if(t.length){if(1===t.length&&Jo[t[0].t])return void Jo[t[0].t](e,t[0].d);for(var n=tt(qo),i=0;i<t.length;i++){var r=t[i],a=r.t,o=r.d,s=Ko[a];s&&(s(o),Ut(n,n,Xo))}e.setLocalTransform(n)}else e.resetLocalTransform();return e.getLocalTransform()}var es=function(){return c((function t(){l(this,t),this.parser=ja,this.mixer=Xa}),[{key:"calculator",value:function(t,e,n,i){return n instanceof Nr?[]:n}},{key:"postProcessor",value:function(t){ts(t.parsedStyle.transform,t)}}])}(),ns=function(){return c((function t(){l(this,t)}),[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===pr.kPixels&&e[1].unit===pr.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds()}}])}(),is=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){return n.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,i=e.sortable;n&&(n.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=Ci.Z_INDEX_CHANGED)}}}])}(),rs=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,i=void 0===n?0:n,r=t.cy,a=void 0===r?0:r,o=t.r,s=void 0===o?0:o;return{cx:i,cy:a,hwidth:s,hheight:s}}}])}(),as=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,i=void 0===n?0:n,r=t.cy,a=void 0===r?0:r,o=t.rx,s=void 0===o?0:o,l=t.ry;return{cx:i,cy:a,hwidth:s,hheight:void 0===l?0:l}}}])}(),os=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){var e=t.x1,n=t.y1,i=t.x2,r=t.y2,a=Math.min(e,i),o=Math.max(e,i),s=Math.min(n,r),l=(o-a)/2,u=(Math.max(n,r)-s)/2;return{cx:a+l,cy:s+u,hwidth:l,hheight:u}}}])}(),ss=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){var e=t.d.rect,n=e.x,i=e.y,r=e.width/2,a=e.height/2;return{cx:n+r,cy:i+a,hwidth:r,hheight:a}}}])}(),ls=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){if(t.points&&$e(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,f(e.map((function(t){return t[0]})))),i=Math.max.apply(Math,f(e.map((function(t){return t[0]})))),r=Math.min.apply(Math,f(e.map((function(t){return t[1]})))),a=Math.max.apply(Math,f(e.map((function(t){return t[1]})))),o=(i-n)/2,s=(a-r)/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),us=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.x,i=void 0===n?0:n,r=t.y,a=void 0===r?0:r,o=t.src,s=t.width,l=void 0===s?0:s,u=t.height,c=l,h=void 0===u?0:u;return o&&!he(o)&&(c||(c=o.width,t.width=c),h||(h=o.height,t.height=h)),{cx:i+c/2,cy:a+h/2,hwidth:c/2,hheight:h/2}}}])}(),cs=function(){return c((function t(e){l(this,t),this.globalRuntime=e}),[{key:"isReadyToMeasure",value:function(t,e){return t.text}},{key:"update",value:function(t,e){var n,i=t.text,r=t.textAlign,a=void 0===r?"start":r,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,p=t.x,g=void 0===p?0:p,v=t.y,y=void 0===v?0:v;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var m=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(i,t,m);t.metrics=b;var x=b.width/2,E=b.height/2,w=g+x;"center"===a||"middle"===a?w+=s/2-x:"right"!==a&&"end"!==a||(w+=s-2*x);var k=y-E;return"middle"===u?k+=E:"top"===u||"hanging"===u?k+=2*E:"alphabetic"===u||"bottom"!==u&&"ideographic"!==u||(k+=0),h&&(w+=h),f&&(k+=f),{cx:w,cy:k,hwidth:x,hheight:E}}}])}(),hs=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),ds=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.x,i=void 0===n?0:n,r=t.y,a=void 0===r?0:r,o=t.width,s=void 0===o?0:o,l=t.height,u=void 0===l?0:l;return{cx:i+s/2,cy:a+u/2,hwidth:s/2,hheight:u/2}}}])}(),fs=function(){return c((function t(e){l(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ri,this.page=new ri,this.canvas=new ri,this.viewport=new ri,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}),[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(oi)}}])}(),ps=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).client=new ri,t.movement=new ri,t.offset=new ri,t.global=new ri,t.screen=new ri,t}return m(e,t),c(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw new Error(oi)}}])}(fs),gs=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).width=0,t.height=0,t.isPrimary=!1,t}return m(e,t),c(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(ps),vs=function(t){function e(){return l(this,e),v(this,e,arguments)}return m(e,t),c(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(ps),ys=function(t){function e(t,n){var i;return l(this,e),(i=v(this,e,[null])).type=t,i.detail=n,Object.assign(i,n),i}return m(e,t),c(e)}(fs),ms=new WeakMap,bs=function(){return c((function t(){l(this,t),this.emitter=new x}),[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this}},{key:"addEventListener",value:function(t,e,n){var i=!1,r=!1;if(pn(n))i=n;else if(n){var a=n.capture;i=void 0!==a&&a;var o=n.once;r=void 0!==o&&o}i&&(t+="capture"),e=gn(e)?e:e.handleEvent;var s=gn(e)?void 0:e;return r?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,e,n){var i;if(!this.emitter)return this;(pn(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=gn(e)?e:null===(i=e)||void 0===i?void 0:i.handleEvent;var r=gn(e)?void 0:e;return this.emitter.off(t,e,r),this}},{key:"emit",value:function(t,e){this.dispatchEvent(new ys(t,e))}},{key:"dispatchEvent",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=ms.get(this);if(i||(i=this.document?this:this.defaultView?this.defaultView:null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView)&&ms.set(this,i),i){if(t.manager=i.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],n||(t.target=this),t.manager.dispatchEvent(t,t.type,n)}else this.emitter.emit(t.type,t);return!t.defaultPrevented}}])}(),xs=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return m(e,t),c(e,[{key:"textContent",get:function(){var t="";this.nodeName===Un.TEXT&&(t+=this.style.text);var e,n=Gn(this.childNodes);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.nodeName===Un.TEXT?t+=i.nodeValue:t+=i.textContent}}catch(t){n.e(t)}finally{n.f()}return t},set:function(t){var e=this;this.childNodes.slice().forEach((function(t){e.removeChild(t)})),this.nodeName===Un.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(t){throw new Error(oi)}},{key:"lookupNamespaceURI",value:function(t){throw new Error(oi)}},{key:"lookupPrefix",value:function(t){throw new Error(oi)}},{key:"normalize",value:function(){throw new Error(oi)}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n=t,i=this,r=[n],a=[i];null!==(o=n.parentNode)&&void 0!==o?o:i.parentNode;){var o;n=n.parentNode?(r.push(n.parentNode),n.parentNode):n,i=i.parentNode?(a.push(i.parentNode),i.parentNode):i}if(n!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=r.length>a.length?r:a,l=s===r?a:r;if(s[s.length-l.length]===l[0])return s===r?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;return f.indexOf(h)<f.indexOf(d)?l===r?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:s===r?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var i=n.childNodes.length-1;i>=0;i--)e.push(n.childNodes[i])}}}],[{key:"isNode",value:function(t){return!!t.childNodes}}])}(bs);xs.DOCUMENT_POSITION_DISCONNECTED=1,xs.DOCUMENT_POSITION_PRECEDING=2,xs.DOCUMENT_POSITION_FOLLOWING=4,xs.DOCUMENT_POSITION_CONTAINS=8,xs.DOCUMENT_POSITION_CONTAINED_BY=16,xs.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var Es=function(){return c((function t(e,n){var i=this;l(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=q(),this.tmpVec3=k(),this.onPointerDown=function(t){var e=i.createPointerEvent(t);if(i.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)i.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;i.dispatchEvent(e,n?"rightdown":"mousedown")}i.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),i.freeEvent(e)},this.onPointerUp=function(t){var e=To.now(),n=i.createPointerEvent(t,void 0,void 0,i.context.config.alwaysTriggerPointerEventOnCanvas?i.rootTarget:void 0);if(i.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)i.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var r=2===n.button;i.dispatchEvent(n,r?"rightup":"mouseup")}var a=i.trackingData(t.pointerId),o=i.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,i.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)i.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;i.notifyTarget(n,u?"rightupoutside":"mouseupoutside")}xs.isNode(l)&&(l=l.parentNode)}delete a.pressTargetsByButton[t.button],s=l}if(s){var c,h=i.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=i.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(i.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||i.dispatchEvent(h,"click"),i.dispatchEvent(h,"pointertap")),i.freeEvent(h)}i.freeEvent(n)},this.onPointerMove=function(t){var e=i.createPointerEvent(t,void 0,void 0,i.context.config.alwaysTriggerPointerEventOnCanvas?i.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,r=i.trackingData(t.pointerId),a=i.findMountedTarget(r.overTargets);if(r.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=i.createPointerEvent(t,o,a||void 0);if(i.dispatchEvent(s,"pointerout"),n&&i.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=i.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,i.notifyTarget(l),n&&i.notifyTarget(l,"mouseleave"),xs.isNode(l.target)&&(l.target=l.target.parentNode);i.freeEvent(l)}i.freeEvent(s)}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=i.clonePointerEvent(e,u);i.dispatchEvent(c,"pointerover"),n&&i.dispatchEvent(c,"mouseover");for(var h=a&&xs.isNode(a)&&a.parentNode;h&&h!==(xs.isNode(i.rootTarget)&&i.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(xs.isNode(i.rootTarget)&&i.rootTarget.parentNode)){var d=i.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(xs.isNode(i.rootTarget)&&i.rootTarget.parentNode);)d.currentTarget=d.target,i.notifyTarget(d),n&&i.notifyTarget(d,"mouseenter"),xs.isNode(d.target)&&(d.target=d.target.parentNode);i.freeEvent(d)}i.freeEvent(c)}i.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&i.dispatchEvent(e,"touchmove"),n&&(i.dispatchEvent(e,"mousemove"),i.cursor=i.getCursor(e.target)),r.overTargets=e.composedPath(),i.freeEvent(e)},this.onPointerOut=function(t){var e=i.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,r=i.findMountedTarget(e.overTargets),a=i.createPointerEvent(t,"pointerout",r||void 0);i.dispatchEvent(a),n&&i.dispatchEvent(a,"mouseout");var o=i.createPointerEvent(t,"pointerleave",r||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(xs.isNode(i.rootTarget)&&i.rootTarget.parentNode);)o.currentTarget=o.target,i.notifyTarget(o),n&&i.notifyTarget(o,"mouseleave"),xs.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,i.freeEvent(a),i.freeEvent(o)}i.cursor=null},this.onPointerOver=function(t){var e=i.trackingData(t.pointerId),n=i.createPointerEvent(t),r="mouse"===n.pointerType||"pen"===n.pointerType;i.dispatchEvent(n,"pointerover"),r&&i.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(i.cursor=i.getCursor(n.target));var a=i.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(xs.isNode(i.rootTarget)&&i.rootTarget.parentNode);)a.currentTarget=a.target,i.notifyTarget(a),r&&i.notifyTarget(a,"mouseenter"),xs.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),i.freeEvent(n),i.freeEvent(a)},this.onPointerUpOutside=function(t){var e=i.trackingData(t.pointerId),n=i.findMountedTarget(e.pressTargetsByButton[t.button]),r=i.createPointerEvent(t);if(n){for(var a=n;a;)r.currentTarget=a,i.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType||"mouse"!==r.pointerType&&"pen"!==r.pointerType||i.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),xs.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button]}i.freeEvent(r)},this.onWheel=function(t){var e=i.createWheelEvent(t);i.dispatchEvent(e),i.freeEvent(e)},this.onClick=function(t){if(i.context.config.useNativeClickEvent){var e=i.createPointerEvent(t);i.dispatchEvent(e),i.freeEvent(e)}},this.onPointerCancel=function(t){var e=i.createPointerEvent(t,void 0,void 0,i.context.config.alwaysTriggerPointerEventOnCanvas?i.rootTarget:void 0);i.dispatchEvent(e),i.freeEvent(e)},this.globalRuntime=e,this.context=n}),[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,i=this.context.contextService.getDomElement();if(i&&t){var r=i.offsetWidth,a=i.offsetHeight;r&&a&&(e=t.width/r,n=t.height/a)}return{scaleX:e,scaleY:n,bbox:t}}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,i=e.scaleY,r=e.bbox;return new ri((t.x-((null==r?void 0:r.left)||0))/n,(t.y-((null==r?void 0:r.top)||0))/i)}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,i=e.scaleY,r=e.bbox;return new ri((t.x+((null==r?void 0:r.left)||0))*n,(t.y+((null==r?void 0:r.top)||0))*i)}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,i=this.rootTarget.defaultView.getCamera(),r=this.context.config,a=r.width,o=r.height,s=i.getPerspectiveInverse(),l=i.getWorldTransform(),u=at(this.tmpMatrix,l,s),c=A(this.tmpVec3,e/a*2-1,2*(1-n/o)-1,0);return j(c,c,u),new ri(c[0],c[1])}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),i=e.getViewTransform(),r=at(this.tmpMatrix,n,i),a=A(this.tmpVec3,t.x,t.y,0);j(this.tmpVec3,this.tmpVec3,r);var o=this.context.config,s=o.width,l=o.height;return new ri((a[0]+1)/2*s,(1-(a[1]+1)/2)*l)}},{key:"setPickHandler",value:function(t){this.pickHandler=t}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,i=e.length;n<i;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var i=this.rootTarget.defaultView||null;t.currentTarget=i,this.notifyListeners(t,e)}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e)}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var i=n.length-1;i>=1;i--)if(t.currentTarget=n[i],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var r=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=r+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var i=0;i<2048&&t!==this.rootTarget;i++)xs.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,i=this.context.config,r=i.width,a=i.height,o=i.disableHitTesting;return e<0||n<0||e>r||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,i=null==e?void 0:e.target;if(null!==(n=i)&&void 0!==n&&n.shadowRoot&&(i=e.composedPath()[0]),i){if(i===t)return!0;if(t&&t.contains)return t.contains(i)}return!(null==e||!e.composedPath)&&e.composedPath().indexOf(t)>-1}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var i=n[e],r=this.nativeHTMLMap.get(i);if(r)return r}return null}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY})}},{key:"createPointerEvent",value:function(t,e,n,i){var r=this.allocateEvent(gs);this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t;var a=this.getExistedHTML(r),o=this.context.contextService.getDomElement();return r.target=null!=n?n:a||this.isNativeEventFromCanvas(o,r.nativeEvent)&&this.pickTarget(r)||i,"string"==typeof e&&(r.type=e),r}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(vs);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),i=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(i,e.nativeEvent)&&this.pickTarget(e),e}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(vs);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(gs);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset)}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=To.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport)}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,i=n._events[e];if(i)if("fn"in i)i.once&&n.removeListener(e,i.fn,void 0,!0),i.fn.call(t.currentTarget||i.context,t);else for(var r=0;r<i.length&&!t.propagationImmediatelyStopped;r++)i[r].once&&n.removeListener(e,i[r].fn,void 0,!0),i[r].fn.call(t.currentTarget||i[r].context,t)}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var i=t[n];if(!(i===this.rootTarget||xs.isNode(i)&&i.parentNode===e))break;e=t[n]}return e}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=wo(e)&&e.getAttribute("cursor");if(n)return n;e=xs.isNode(e)&&e.parentNode}}}])}(),ws=function(){return c((function t(){l(this,t)}),[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||rl.offscreenCanvas)this.canvas=t||rl.offscreenCanvas,this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(t){}try{return document.createElement("canvas")}catch(t){}return null}}])}(),ks=function(t){return t[t.CAMERA_CHANGED=0]="CAMERA_CHANGED",t[t.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",t[t.NONE=2]="NONE",t}({}),Ms=function(){return c((function t(e,n){l(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Wo,initAsync:new zo,dirtycheck:new Uo,cull:new Uo,beginFrame:new Wo,beforeRender:new Wo,render:new Wo,afterRender:new Wo,endFrame:new Wo,destroy:new Wo,pick:new Vo,pickSync:new Uo,pointerDown:new Wo,pointerUp:new Wo,pointerMove:new Wo,pointerOut:new Wo,pointerOver:new Wo,pointerWheel:new Wo,pointerCancel:new Wo,click:new Wo},this.globalRuntime=e,this.context=n}),[{key:"init",value:function(t){var e=this,n=s(s({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach((function(t){t.apply(n,e.globalRuntime)})),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then((function(){e.inited=!0,t()})).catch((function(t){}))}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(ks.CAMERA_CHANGED)}},{key:"render",value:function(t,e,n){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var r=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(r.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),r.renderReasons.size&&this.inited){r.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var a=1===r.renderReasons.size&&r.renderReasons.has(ks.CAMERA_CHANGED),o=!t.disableRenderHooks||!(t.disableRenderHooks&&a);o&&this.renderDisplayObject(r.root,t,r),this.hooks.beginFrame.call(e),o&&r.renderListCurrentFrame.forEach((function(t){i.hooks.beforeRender.call(t),i.hooks.render.call(t),i.hooks.afterRender.call(t)})),this.hooks.endFrame.call(e),r.renderListCurrentFrame=[],r.renderReasons.clear(),n()}}},{key:"renderDisplayObject",value:function(t,e,n){var i=this,r=e.renderer.getConfig(),a=r.enableDirtyCheck,o=r.enableCulling;function s(t){var e=t.renderable,r=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t;if(s){var l=o?i.hooks.cull.call(s,i.context.camera):s;l&&(i.stats.rendered+=1,n.renderListCurrentFrame.push(l))}e.dirty=!1,r.renderOrder=i.zIndexCounter,i.zIndexCounter+=1,i.stats.total+=1,r.dirty&&(i.sort(t,r),r.dirty=!1,r.dirtyChildren=[],r.dirtyReason=void 0)}for(var l=[t];l.length>0;){var u,c=l.pop();s(c);for(var h=(null===(u=c.sortable)||void 0===u||null===(u=u.sorted)||void 0===u?void 0:u.length)>0?c.sortable.sorted:c.childNodes,d=h.length-1;d>=0;d--)l.push(h[d])}}},{key:"sort",value:function(t,e){var n,i;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==Ci.Z_INDEX_CHANGED?e.dirtyChildren.forEach((function(n){var i=e.sorted.indexOf(n);if(i>-1&&e.sorted.splice(i,1),t.childNodes.indexOf(n)>-1)if(0===e.sorted.length)e.sorted.push(n);else{var r=function(t,e){for(var n=0,i=t.length;n<i;){var r=n+i>>>1;ko(t[r],e)<0?n=r+1:i=r}return n}(e.sorted,n);e.sorted.splice(r,0,n)}})):e.sorted=t.childNodes.slice().sort(ko),(null===(i=e.sorted)||void 0===i?void 0:i.length)>0&&0===t.childNodes.filter((function(t){return t.parsedStyle.zIndex})).length&&(e.sorted=[])}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(ks.DISPLAY_OBJECT_CHANGED)}}])}(),Ss=/\[\s*(.*)=(.*)\s*\]/,Ns=function(){return c((function t(){l(this,t)}),[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find((function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.find((function(e){return e.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var i=this.getAttribute(t),r=i.name,a=i.value;return r?e.find((function(t){return e!==t&&("name"===r?t.name===a:n.attributeToString(t,r)===a)})):null}return e.find((function(n){return e!==n&&n.nodeName===t}))}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll((function(i){return e!==i&&((null==i?void 0:i.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.findAll((function(i){return e!==i&&i.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var i=this.getAttribute(t),r=i.name,a=i.value;return r?e.findAll((function(t){return e!==t&&("name"===r?t.name===a:n.attributeToString(t,r)===a)})):[]}return e.findAll((function(n){return e!==n&&n.nodeName===t}))}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),i=n.name,r=n.value;return"name"===i?e.name===r:this.attributeToString(e,i)===r}return e.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var e=t.match(Ss),n="",i="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),i=e[2].replace(/"/g,"")),{name:n,value:i}}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return ce(n)?"":n.toString?n.toString():""}}])}(),Ts=function(t){return t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.MOUNTED="DOMNodeInsertedIntoDocument",t.REMOVED="removed",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.REPARENT="reparent",t.DESTROY="destroy",t.BOUNDS_CHANGED="bounds-changed",t.CULLED="culled",t}({}),As=function(t){function e(t,n,i,r,a,o,s,u){var c;return l(this,e),(c=v(this,e,[null])).relatedNode=n,c.prevValue=i,c.newValue=r,c.attrName=a,c.attrChange=o,c.prevParsedValue=s,c.newParsedValue=u,c.type=t,c}return m(e,t),c(e)}(fs);function Os(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}As.ADDITION=2,As.MODIFICATION=1,As.REMOVAL=3;var Ps,Cs,Rs,Ls=new As(Ts.REPARENT,null,"","","",0,"",""),Ds=ae(),Is=k(),_s=N(1,1,1),Bs=q(),Fs=ae(),js=k(),Gs=q(),zs=qt(),Vs=k(),Ws=qt(),Us=k(),Hs=k(),Ys=k(),$s=q(),Xs=qt(),qs=qt(),Ks=qt(),Zs={affectChildren:!0},Qs=function(){return c((function t(e){l(this,t),this.pendingEvents=new Map,this.boundsChangedEvent=new ys(Ts.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e}),[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e)}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e)}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e)}},{key:"attach",value:function(t,e,n){var i,r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var a=t.nodeName===Un.FRAGMENT,o=Ao(e);t.parentNode=e;var s=a?t.childNodes:[t];le(n)?s.forEach((function(t){e.childNodes.splice(n,0,t),t.parentNode=e})):s.forEach((function(t){e.childNodes.push(t),t.parentNode=e}));var l=e.sortable;if((null!=l&&null!==(i=l.sorted)&&void 0!==i&&i.length||l.dirty||t.parsedStyle.zIndex)&&(-1===l.dirtyChildren.indexOf(t)&&l.dirtyChildren.push(t),l.dirty=!0,l.dirtyReason=Ci.ADDED),!o){if(a)this.dirtifyFragment(t);else{var u=t.transformable;u&&this.dirtifyWorld(t,u)}r&&t.dispatchEvent(Ls)}}},{key:"detach",value:function(t){var e,n;if(t.parentNode){var i=t.transformable,r=t.parentNode.sortable;(null!=r&&null!==(e=r.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===r.dirtyChildren.indexOf(t)&&r.dirtyChildren.push(t),r.dirty=!0,r.dirtyReason=Ci.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),i&&this.dirtifyWorld(t,i),t.parentNode=null}}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"setOrigin",value:function(t,e){"number"==typeof e&&(e=[e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0]);var n=t.transformable;if(e[0]!==n.origin[0]||e[1]!==n.origin[1]||e[2]!==n.origin[2]){var i=n.origin;i[0]=e[0],i[1]=e[1],i[2]=e[2]||0,this.dirtifyLocal(t,n)}}},{key:"rotate",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){var i=zs;Jt(i,e[0],e[1],e[2]);var r=this.getRotation(t),a=this.getRotation(t.parentNode);ee(Ks,a),Qt(Ks,Ks),Zt(i,Ks,i),Zt(n.localRotation,i,r),re(n.localRotation,n.localRotation),this.dirtifyLocal(t,n)}else this.rotateLocal(t,e)}},{key:"rotateLocal",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;Jt(qs,e[0],e[1],e[2]),ie(n.localRotation,n.localRotation,qs),this.dirtifyLocal(t,n)}},{key:"setEulerAngles",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){Jt(n.localRotation,e[0],e[1],e[2]);var i=this.getRotation(t.parentNode);ee(Xs,Qt(zs,i)),ie(n.localRotation,n.localRotation,Xs),this.dirtifyLocal(t,n)}else this.setLocalEulerAngles(t,e)}},{key:"setLocalEulerAngles",value:function(t,e){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var i=t.transformable;Jt(i.localRotation,e[0],e[1],e[2]),n&&this.dirtifyLocal(t,i)}},{key:"translateLocal",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;V(e,Is)||(z(e,e,n.localRotation),O(n.localPosition,n.localPosition,e),this.dirtifyLocal(t,n))}},{key:"setPosition",value:function(t,e){var n,i=t.transformable;if(Ys[0]=e[0],Ys[1]=e[1],Ys[2]=null!==(n=e[2])&&void 0!==n?n:0,!V(this.getPosition(t),Ys)){if(T(i.position,Ys),null!==t.parentNode&&t.parentNode.transformable){var r=t.parentNode.transformable;Z($s,r.worldTransform),nt($s,$s),j(i.localPosition,Ys,$s)}else T(i.localPosition,Ys);this.dirtifyLocal(t,i)}}},{key:"setLocalPosition",value:function(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.transformable;Hs[0]=e[0],Hs[1]=e[1],Hs[2]=null!==(n=e[2])&&void 0!==n?n:0,V(r.localPosition,Hs)||(T(r.localPosition,Hs),i&&this.dirtifyLocal(t,r))}},{key:"scaleLocal",value:function(t,e){var n,i=t.transformable;C(i.localScale,i.localScale,A(js,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtifyLocal(t,i)}},{key:"setLocalScale",value:function(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.transformable;A(js,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:r.localScale[2]),V(js,r.localScale)||(T(r.localScale,js),i&&this.dirtifyLocal(t,r))}},{key:"translate",value:function(t,e){"number"==typeof e&&(e=A(js,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)),V(e,Is)||(O(js,this.getPosition(t),e),this.setPosition(t,js))}},{key:"setRotation",value:function(t,e,n,i,r){var a=t.transformable;if("number"==typeof e&&(e=te(e,n,i,r)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);ee(zs,o),Qt(zs,zs),Zt(a.localRotation,zs,e),re(a.localRotation,a.localRotation),this.dirtifyLocal(t,a)}else this.setLocalRotation(t,e)}},{key:"setLocalRotation",value:function(t,e,n,i,r){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];"number"==typeof e&&(e=ne(zs,e,n,i,r));var o=t.transformable;ee(o.localRotation,e),a&&this.dirtifyLocal(t,o)}},{key:"setLocalSkew",value:function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];"number"==typeof e&&(e=se(Fs,e,n));var r=t.transformable;oe(r.localSkew,e),i&&this.dirtifyLocal(t,r)}},{key:"dirtifyLocal",value:function(t,e){Ao(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtifyWorld(t,e))}},{key:"dirtifyWorld",value:function(t,e){e.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,e),this.dirtifyToRoot(t,!0)}},{key:"dirtifyFragment",value:function(t){var e=t.transformable;e&&(e.frozen=!1,e.dirtyFlag=!0,e.localDirtyFlag=!0);var n=t.renderable;n&&(n.renderBoundsDirty=!0,n.boundsDirty=!0,n.dirty=!0);for(var i=t.childNodes.length,r=0;r<i;r++)this.dirtifyFragment(t.childNodes[r]);t.nodeName===Un.FRAGMENT&&this.pendingEvents.set(t,!1)}},{key:"triggerPendingEvents",value:function(){var t=this,e=new Set,n=function(n,i){n.isConnected&&!e.has(n)&&n.nodeName!==Un.FRAGMENT&&(t.boundsChangedEvent.detail=i,t.boundsChangedEvent.target=n,n.isMutationObserved?n.dispatchEvent(t.boundsChangedEvent):n.ownerDocument.defaultView.dispatchEvent(t.boundsChangedEvent,!0),e.add(n))};this.pendingEvents.forEach((function(t,e){e.nodeName!==Un.FRAGMENT&&(Zs.affectChildren=t,t?e.forEach((function(t){n(t,Zs)})):n(e,Zs))})),e.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"dirtifyToRoot",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t;for(n.renderable&&(n.renderable.dirty=!0);n;)Os(n),n=n.parentNode;e&&t.forEach((function(t){Os(t)})),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,e)}},{key:"updateDisplayObjectDependency",value:function(t,e,n,i){if(e&&e!==n){var r=this.displayObjectDependencyMap.get(e);if(r&&r[t]){var a=r[t].indexOf(i);r[t].splice(a,1)}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(i)}}},{key:"informDependentDisplayObjects",value:function(t){var e=this,n=this.displayObjectDependencyMap.get(t);n&&Object.keys(n).forEach((function(t){n[t].forEach((function(n){e.dirtifyToRoot(n,!0),n.dispatchEvent(new As(Ts.ATTR_MODIFIED,n,e,e,t,As.MODIFICATION,e,e)),n.isCustomElement&&n.isConnected&&n.attributeChangedCallback&&n.attributeChangedCallback(t,e,e)}))}))}},{key:"getPosition",value:function(t){var e=t.transformable;return xt(e.position,this.getWorldTransform(t,e))}},{key:"getRotation",value:function(t){var e=t.transformable;return wt(e.rotation,this.getWorldTransform(t,e))}},{key:"getScale",value:function(t){var e=t.transformable;return Et(e.scaling,this.getWorldTransform(t,e))}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return e.localDirtyFlag||e.dirtyFlag?(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,e),e.worldTransform):e.worldTransform}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"calcLocalTransform",value:function(t){if(0!==t.localSkew[0]||0!==t.localSkew[1]){Mt(t.localTransform,t.localRotation,t.localPosition,N(1,1,1),t.origin),0===t.localSkew[0]&&0===t.localSkew[1]||(tt(Gs),Gs[4]=Math.tan(t.localSkew[0]),Gs[1]=Math.tan(t.localSkew[1]),at(t.localTransform,t.localTransform,Gs));var e=Mt(Gs,ne(zs,0,0,0,1),A(js,1,1,1),t.localScale,t.origin);at(t.localTransform,t.localTransform,e)}else{var n=t.localTransform,i=t.localPosition,r=t.localRotation,a=t.localScale,o=t.origin,s=0!==i[0]||0!==i[1]||0!==i[2],l=1!==r[3]||0!==r[0]||0!==r[1]||0!==r[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?Mt(n,r,i,a,o):s?dt(n,i):tt(n)}}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.localTransform}},{key:"setLocalTransform",value:function(t,e){var n=xt(Vs,e),i=wt(Ws,e),r=Et(Us,e);this.setLocalScale(t,r,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,i,void 0,void 0,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,_s,!1),this.setLocalPosition(t,Is,!1),this.setLocalEulerAngles(t,Is,void 0,void 0,!1),this.setLocalSkew(t,Ds,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=this.getGeometryBounds(t,e);if(!ti.isEmpty(i)){var r=n||new ti;return r.setFromTransformedAABB(i,this.getWorldTransform(t)),r}return null}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&rl.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new ti}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.renderable;if(!i.boundsDirty&&!n&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&n&&i.renderBounds)return i.renderBounds;var r=n?i.renderBounds:i.bounds,a=this.getTransformedGeometryBounds(t,n,r);if(t.childNodes.forEach((function(t){var i=e.getBounds(t,n);i&&(a?a.add(i):(a=r||new ti).update(i.center,i.halfExtents))})),a||(a=new ti),n){var o=Mo(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents)}}return n?(i.renderBounds=a,i.renderBoundsDirty=!1):(i.bounds=a,i.boundsDirty=!1),a}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=Bs;t.parentNode.transformable&&(e=nt(Gs,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!ti.isEmpty(n)){var i=new ti;return i.setFromTransformedAABB(n,e),i}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var e,n,i=this.getGeometryBounds(t);ti.isEmpty(i)||(n=new ti).setFromTransformedAABB(i,this.getWorldTransform(t));var r=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=b(n.getMin(),2),o=a[0],s=a[1],l=b(n.getMax(),2),u=l[0],c=l[1];return new ai(o+((null==r?void 0:r.left)||0),s+((null==r?void 0:r.top)||0),u-o,c-s)}return new ai((null==r?void 0:r.left)||0,(null==r?void 0:r.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(t,e){var n=this;if(!e.dirtyFlag){e.dirtyFlag=!0,e.frozen=!1,t.childNodes.forEach((function(t){var e=t.transformable;e.dirtyFlag||n.dirtifyWorldInternal(t,e)}));var i=t.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}}},{key:"syncHierarchy",value:function(t){var e=t.transformable;if(!e.frozen){e.frozen=!0,(e.localDirtyFlag||e.dirtyFlag)&&this.sync(t,e);for(var n=t.childNodes,i=0;i<n.length;i++)this.syncHierarchy(n[i])}}},{key:"sync",value:function(t,e){if(e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.dirtyFlag){var n=t.parentNode,i=n&&n.transformable;null!==n&&i?at(e.worldTransform,i.worldTransform,e.localTransform):Z(e.worldTransform,e.localTransform),e.dirtyFlag=!1}}},{key:"unfreezeParentToRoot",value:function(t){for(var e=t.parentNode;e;){var n=e.transformable;n&&(n.frozen=!1),e=e.parentNode}}}])}(),Js={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},tl=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,el=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),nl=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),il=function(){return c((function t(e){var n=this;l(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!(!t||!nl.exec(e)&&!el.exec(t))},this.trimByKinsokuShorui=function(t){var e=f(t),n=e[e.length-2];if(!n)return t;var i=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=i+e[e.length-1],e},this.runtime=e}),[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),r=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});r.font=t;var a=Js.MetricsString+Js.BaselineSymbol,o=Math.ceil(r.measureText(a).width),s=Math.ceil(r.measureText(Js.BaselineSymbol).width),l=Js.HeightMultiplier*s;s=s*Js.BaselineMultiplier|0,i.width=o,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,o,l),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(a,0,s);var u=r.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,p=!1;for(d=0;d<s;++d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){p=!0;break}if(p)break;f+=h}for(n.ascent=s-d,f=c-h,p=!1,d=l;d>s;--d){for(var v=0;v<h;v+=4)if(255!==u[f+v]){p=!0;break}if(p)break;f-=h}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n}},{key:"measureText",value:function(t,e,n){var i=e.fontSize,r=void 0===i?16:i,a=e.wordWrap,o=void 0!==a&&a,s=e.lineHeight,l=e.lineWidth,u=void 0===l?1:l,c=e.textBaseline,h=void 0===c?"alphabetic":c,d=e.textAlign,f=void 0===d?"start":d,p=e.letterSpacing,g=void 0===p?0:p,v=e.textPath;e.textPathSide,e.textPathStartOffset;var y=e.leading,m=void 0===y?0:y,b=function(t){for(var e=t.fontSize,n=void 0===e?16:e,i=t.fontFamily,r=void 0===i?"sans-serif":i,a=t.fontStyle,o=void 0===a?"normal":a,s=t.fontVariant,l=void 0===s?"normal":s,u=t.fontWeight,c=void 0===u?"normal":u,h=le(n)&&"".concat(n,"px")||"16px",d=r.split(","),f=d.length-1;f>=0;f--){var p=d[f].trim();!Yo.test(p)&&Ho.indexOf(p)<0&&(p='"'.concat(p,'"')),d[f]=p}return"".concat(o," ").concat(l," ").concat(c," ").concat(h," ").concat(d.join(","))}(e),x=this.measureFont(b,n);0===x.fontSize&&(x.fontSize=r,x.ascent=r);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=b,e.isOverflowing=!1;var w=(o?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),k=new Array(w.length),M=0;if(!v){for(var S=0;S<w.length;S++){var N=E.measureText(w[S]).width+(w[S].length-1)*g;k[S]=N,M=Math.max(M,N)}var T=M+u,A=s||x.fontSize+u,O=Math.max(A,x.fontSize+u)+(w.length-1)*(A+m),P=0;return"middle"===h?P=-O/2:"bottom"===h||"alphabetic"===h||"ideographic"===h?P=-O:"top"!==h&&"hanging"!==h||(P=0),{font:b,width:T,height:O,lines:w,lineWidths:k,lineHeight:A+=m,maxLineWidth:M,fontProperties:x,lineMetrics:k.map((function(t,e){var n=0;return"center"===f||"middle"===f?n-=t/2:"right"!==f&&"end"!==f||(n-=t),new ai(n-u/2,P+e*A,t+u,A)}))}}v.getTotalLength();for(var C=0;C<w.length;C++)E.measureText(w[C]).width,w[C].length}},{key:"wordWrap",value:function(t,e,n){var i=this,r=this,a=e.wordWrapWidth,o=void 0===a?0:a,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=o+l,p="";"ellipsis"===h?p="...":h&&"clip"!==h&&(p=h);var g=Array.from(t),v=[],y=0,m=0,b=-1,x={},E=function(t){return i.getFromCache(t,l,x,d)},w=E(p);function k(t,e,n,i){for(;E(t)<i&&e<g.length-1&&!r.isNewline(g[e+1]);)t+=g[e+=1];for(;E(t)>i&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e}}function M(t,e){if(!(w<=0||w>f))if(v[t]){var n=k(v[t],e,b+1,f-w);v[t]=n.lineTxt+p}else v[t]=p}for(var S=0;S<g.length;S++){var N=g[S],T=g[S-1],A=g[S+1],O=E(N);if(this.isNewline(N)){if(y+1>=c){e.isOverflowing=!0,S<g.length-1&&M(y,S-1);break}b=S-1,m=0,v[y+=1]=""}else{if(m>0&&m+O>f){var P=k(v[y],S-1,b+1,f);if(P.txtLastCharIndex!==S-1){if(v[y]=P.lineTxt,P.txtLastCharIndex===g.length-1)break;S=P.txtLastCharIndex+1,N=g[S],T=g[S-1],A=g[S+1],O=E(N)}if(y+1>=c){e.isOverflowing=!0,M(y,S-1);break}if(b=S-1,m=0,v[y+=1]="",this.isBreakingSpace(N))continue;this.canBreakInLastChar(N)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[y]||"",E)),this.shouldBreakByKinsokuShorui(N,A)&&(v=this.trimByKinsokuShorui(v),m+=E(T||""))}m+=O,v[y]=(v[y]||"")+N}}return v.join("\n")}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&Js.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return"string"==typeof t&&Js.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var e=f(t),n=e[e.length-2],i=this.findBreakableIndex(n);if(-1===i||!n)return e;var r=n.slice(i,i+1),a=i+1,o=i+(this.isBreakingSpace(r)?0:1);return e[e.length-1]+=n.slice(a,n.length),e[e.length-2]=n.slice(0,o),e}},{key:"canBreakInLastChar",value:function(t){return!t||!tl.test(t)}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce((function(t,n){return t+e(n)}),0)}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!tl.test(t[e]))return e;return-1}},{key:"getFromCache",value:function(t,e,n,i){var r=n[t];if("number"!=typeof r){var a=t.length*e;r=i.measureText(t).width+a,n[t]=r}return r}}])}(),rl={},al=(Cs=new us,Rs=new ls,a(a(a(a(a(a(a(a(a(a(Ps={},Un.FRAGMENT,null),Un.CIRCLE,new rs),Un.ELLIPSE,new as),Un.RECT,Cs),Un.IMAGE,Cs),Un.GROUP,new hs),Un.LINE,new os),Un.TEXT,new cs(rl)),Un.POLYLINE,Rs),Un.POLYGON,Rs),a(a(a(Ps,Un.PATH,new ss),Un.HTML,new ds),Un.MESH,null)),ol=function(t){var e=new ro,n=new so;return a(a(a(a(a(a(a(a(a(a(t={},Li.PERCENTAGE,null),Li.NUMBER,new ho),Li.ANGLE,new no),Li.DEFINED_PATH,new io),Li.PAINT,e),Li.COLOR,e),Li.FILTER,new ao),Li.LENGTH,n),Li.LENGTH_PERCENTAGE,n),Li.LENGTH_PERCENTAGE_12,new lo),a(a(a(a(a(a(a(a(a(a(t,Li.LENGTH_PERCENTAGE_14,new uo),Li.COORDINATE,new so),Li.OFFSET_DISTANCE,new fo),Li.OPACITY_VALUE,new po),Li.PATH,new go),Li.LIST_OF_POINTS,new vo),Li.SHADOW_BLUR,new yo),Li.TEXT,new mo),Li.TEXT_TRANSFORM,new bo),Li.TRANSFORM,new es),a(a(a(t,Li.TRANSFORM_ORIGIN,new ns),Li.Z_INDEX,new is),Li.MARKER,new co)}();rl.CameraContribution=Oi,rl.AnimationTimeline=null,rl.EasingFunction=null,rl.offscreenCanvasCreator=new ws,rl.sceneGraphSelector=new Ns,rl.sceneGraphService=new Qs(rl),rl.textService=new il(rl),rl.geometryUpdaterFactory=al,rl.CSSPropertySyntaxFactory=ol,rl.styleValueRegistry=new to(rl),rl.layoutRegistry=null,rl.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},rl.enableStyleSyntax=!0,rl.enableSizeAttenuation=!1;var sl=0,ll=new As(Ts.INSERTED,null,"","","",0,"",""),ul=new As(Ts.REMOVED,null,"","","",0,"",""),cl=new ys(Ts.DESTROY),hl=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).entity=sl++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:Pi.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return m(e,t),c(e,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter((function(t){return""!==t}))}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}},{key:"cloneNode",value:function(t){throw new Error(oi)}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw new Error("Cannot append a destroyed element.");return rl.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(Ao(this)||t.nodeName!==Un.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(ll.relatedNode=this,t.dispatchEvent(ll)),t}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n)}else this.appendChild(t);return t}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e}},{key:"removeChild",value:function(t){var e;return ul.relatedNode=this,t.dispatchEvent(ul),null!==(e=t.ownerDocument)&&void 0!==e&&e.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),rl.sceneGraphService.detach(t),t}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e)}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy()}}},{key:"matches",value:function(t){return rl.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return rl.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return rl.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return rl.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return rl.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return rl.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return rl.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var e=this;do{if(rl.sceneGraphService.matches(t,e))return e;e=e.parentElement}while(null!==e);return null}},{key:"find",value:function(t){var e=this,n=null;return this.forEach((function(i){return i===e||!t(i)||(n=i,!1)})),n}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach((function(i){i!==e&&t(i)&&n.push(i)})),n}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];i.forEach((function(n,i){var r;return null===(r=t.parentNode)||void 0===r?void 0:r.appendChild(n,e+i+1)}))}}},{key:"before",value:function(){if(this.parentNode){for(var t,e=this.parentNode.childNodes.indexOf(this),n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=i[0],o=i.slice(1);this.parentNode.appendChild(a,e),(t=a).after.apply(t,f(o))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e){return t.appendChild(e)}))}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e,n){return t.appendChild(e,n)}))}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(cl),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return rl.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return rl.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return rl.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return rl.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return rl.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t]}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,e,n,i){this.attributes[t]=e}},{key:"getAttributeNS",value:function(t,e){throw new Error(oi)}},{key:"getAttributeNode",value:function(t){throw new Error(oi)}},{key:"getAttributeNodeNS",value:function(t,e){throw new Error(oi)}},{key:"hasAttributeNS",value:function(t,e){throw new Error(oi)}},{key:"removeAttributeNS",value:function(t,e){throw new Error(oi)}},{key:"removeAttributeNode",value:function(t){throw new Error(oi)}},{key:"setAttributeNS",value:function(t,e,n){throw new Error(oi)}},{key:"setAttributeNode",value:function(t){throw new Error(oi)}},{key:"setAttributeNodeNS",value:function(t){throw new Error(oi)}},{key:"toggleAttribute",value:function(t,e){throw new Error(oi)}}])}(xs);function dl(t){return!(null==t||!t.nodeName)}var fl=rl.globalThis.Proxy?rl.globalThis.Proxy:function(){},pl=new As(Ts.ATTR_MODIFIED,null,null,null,null,As.MODIFICATION,null,null),gl=k(),vl=qt(),yl=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||Un.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),rl.enableStyleSyntax&&(n.style=new fl({setProperty:function(t,e){n.setAttribute(t,e)},getPropertyValue:function(t){return n.getAttribute(t)},removeProperty:function(t){n.removeAttribute(t)},item:function(){return""}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e)},set:function(t,e,i){return n.setAttribute(e,i),!0}})),n}return m(e,t),c(e,[{key:"destroy",value:function(){bn(e,"destroy",this,3)([]),this.getAnimations().forEach((function(t){t.cancel()}))}},{key:"cloneNode",value:function(t,e){var n=s({},this.attributes);for(var i in n){var r=n[i];dl(r)&&"clipPath"!==i&&"offsetPath"!==i&&"textPath"!==i&&(n[i]=r.cloneNode(t)),e&&(n[i]=e(i,r))}var a=new this.constructor(s(s({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach((function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n)}})),a}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};rl.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.renderable.dirty=!0}},{key:"setAttribute",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];hn(n)||(i||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:r}),bn(e,"setAttribute",this,3)([t,n]))}},{key:"internalSetAttribute",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.renderable,r=this.attributes[t],o=this.parsedStyle[t];rl.styleValueRegistry.processProperties(this,a({},t,e),n),i.dirty=!0;var s,l=this.parsedStyle[t];this.isConnected&&(pl.relatedNode=this,pl.prevValue=r,pl.newValue=e,pl.attrName=t,pl.prevParsedValue=o,pl.newParsedValue=l,this.isMutationObserved?this.dispatchEvent(pl):(pl.target=this,this.ownerDocument.defaultView.dispatchEvent(pl,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(s=this.attributeChangedCallback)||void 0===s||s.call(this,t,r,e,o,l))}},{key:"getBBox",value:function(){var t=this.getBounds(),e=b(t.getMin(),2),n=e[0],i=e[1],r=b(t.getMax(),2),a=r[0],o=r[1];return new ai(n,i,a-n,o-i)}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return rl.sceneGraphService.setOrigin(this,ci(t,e,n,!1)),this}},{key:"getOrigin",value:function(){return rl.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return rl.sceneGraphService.setPosition(this,ci(t,e,n,!1)),this}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return rl.sceneGraphService.setLocalPosition(this,ci(t,e,n,!1)),this}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return rl.sceneGraphService.translate(this,ci(t,e,n,!1)),this}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return rl.sceneGraphService.translateLocal(this,ci(t,e,n,!1)),this}},{key:"getPosition",value:function(){return rl.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return rl.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n)}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(t=ci(t,e=e||t,n=n||t,!1)),rl.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(t=ci(t,e=e||t,n=n||t,!1)),rl.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return rl.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return rl.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){return pi(b(vi(gl,rl.sceneGraphService.getWorldTransform(this)),3)[2])}},{key:"getLocalEulerAngles",value:function(){return pi(b(vi(gl,rl.sceneGraphService.getLocalRotation(this)),3)[2])}},{key:"setEulerAngles",value:function(t){return rl.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return rl.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,e,n){return ce(e)&&ce(n)?rl.sceneGraphService.rotateLocal(this,0,0,t):rl.sceneGraphService.rotateLocal(this,t,e,n),this}},{key:"rotate",value:function(t,e,n){return ce(e)&&ce(n)?rl.sceneGraphService.rotate(this,0,0,t):rl.sceneGraphService.rotate(this,t,e,n),this}},{key:"setRotation",value:function(t,e,n,i){return rl.sceneGraphService.setRotation(this,t,e,n,i),this}},{key:"setLocalRotation",value:function(t,e,n,i){return rl.sceneGraphService.setLocalRotation(this,t,e,n,i),this}},{key:"setLocalSkew",value:function(t,e){return rl.sceneGraphService.setLocalSkew(this,t,e),this}},{key:"getRotation",value:function(){return rl.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return rl.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return rl.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return rl.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return rl.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return rl.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){rl.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,e){var n,i=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return i?i.play(this,t,e):null}},{key:"isVisible",value:function(){var t;return"hidden"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return"none"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)}},{key:"isCulled",value:function(){return!(!this.cullable||!this.cullable.enable||this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,f(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,f(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n[0],a=n[1];return r?vn(r)?(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),this):2===n.length?(this.setAttribute(r,a),this):this.attributes[r]:this.attributes}},{key:"getMatrix",value:function(t){var e=t||this.getWorldTransform(),n=b(xt(gl,e),2),i=n[0],r=n[1],a=b(Et(gl,e),2),o=a[0],s=a[1],l=wt(vl,e),u=b(vi(gl,l),3),c=u[0],h=u[2];return function(t,e,n,i,r){var a=Math.cos(t),o=Math.sin(t);return Xt(i*a,r*o,0,-i*o,r*a,0,e,n,1)}(c||h,i,r,o,s)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var e=b(yi(t),5),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4];this.setEulerAngles(o).setPosition(n,i).setLocalScale(r,a)}},{key:"setLocalMatrix",value:function(t){var e=b(yi(t),5),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4];this.setLocalEulerAngles(o).setLocalPosition(n,i).setLocalScale(r,a)}},{key:"show",value:function(){this.forEach((function(t){t.style.visibility="visible"}))}},{key:"hide",value:function(){this.forEach((function(t){t.style.visibility="hidden"}))}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,e){return this.appendChild(t,e)}},{key:"set",value:function(t,e){this.config[t]=e}},{key:"get",value:function(t){return this.config[t]}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}}])}(hl);yl.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var ml=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:Un.CIRCLE},t)])}return m(e,t),c(e)}(yl);ml.PARSED_STYLE_LIST=new Set([].concat(f(yl.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var bl=["style"],xl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,bl);return l(this,e),(t=v(this,e,[s({style:i},r)])).isCustomElement=!0,t}return m(e,t),c(e)}(yl);xl.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var El=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:Un.ELLIPSE},t)])}return m(e,t),c(e)}(yl);El.PARSED_STYLE_LIST=new Set([].concat(f(yl.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),(function(t){function e(){return l(this,e),v(this,e,[{type:Un.FRAGMENT}])}return m(e,t),c(e)}(yl)).PARSED_STYLE_LIST=new Set(["class","className"]);var wl=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:Un.GROUP},t)])}return m(e,t),c(e)}(yl);wl.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var kl=["style"],Ml=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,kl);return l(this,e),(t=v(this,e,[s({type:Un.HTML,style:i},r)])).cullable.enable=!1,t}return m(e,t),c(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=nt(q(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!ti.isEmpty(e)){var n=new ti;return n.setFromTransformedAABB(e,t),n}}return this.getBounds()}}])}(yl);Ml.PARSED_STYLE_LIST=new Set([].concat(f(yl.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var Sl=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:Un.IMAGE},t)])}return m(e,t),c(e)}(yl);Sl.PARSED_STYLE_LIST=new Set([].concat(f(yl.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var Nl=["style"],Tl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,Nl);l(this,e),(t=v(this,e,[s({type:Un.LINE,style:s({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},r)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd;return o&&dl(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&dl(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&dl(i)&&(this.markerStartAngle=0,i.remove()),r&&dl(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t&&(i&&dl(i)&&(this.markerEndAngle=0,i.remove()),r&&dl(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1)))}},{key:"transformMarker",value:function(t){var e,n,i,r,a,o,s,l=this.parsedStyle,u=l.markerStart,c=l.markerEnd,h=l.markerStartOffset,d=l.markerEndOffset,f=l.x1,p=l.x2,g=l.y1,v=l.y2,y=t?u:c;y&&dl(y)&&(t?(r=f,a=g,n=p-f,i=v-g,o=h||0,s=this.markerStartAngle):(r=p,a=v,n=f-p,i=g-v,o=d||0,s=this.markerEndAngle),e=Math.atan2(i,n),y.setLocalEulerAngles(180*e/Math.PI+s),y.setLocalPosition(r+Math.cos(e)*o,a+Math.sin(e)*o))}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,i=Tn(n.x1,n.y1,n.x2,n.y2,t),r=i.x,a=i.y,o=j(k(),N(r,a,0),e?this.getWorldTransform():this.getLocalTransform());return new ri(o[0],o[1])}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle;return Nn(t.x1,t.y1,t.x2,t.y2)}}])}(yl);Tl.PARSED_STYLE_LIST=new Set([].concat(f(yl.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var Al=["style"],Ol=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,Al);l(this,e),(t=v(this,e,[s({type:Un.PATH,style:i,initialParsedStyle:{miterLimit:4,d:s({},Ri)}},r)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd,c=a.markerMid;return o&&dl(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),c&&dl(c)&&t.placeMarkerMid(c),u&&dl(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&dl(i)&&(this.markerStartAngle=0,i.remove()),r&&dl(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t?(i&&dl(i)&&(this.markerEndAngle=0,i.remove()),r&&dl(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(r)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,i=e.markerEnd,r=e.markerStartOffset,a=e.markerEndOffset,o=t?n:i;if(o&&dl(o)){var s,l,u,c,h,d,f;if(t){var p=b(this.getStartTangent(),2),g=p[0],v=p[1];c=v[0],h=v[1],l=g[0]-v[0],u=g[1]-v[1],d=r||0,f=this.markerStartAngle}else{var y=b(this.getEndTangent(),2),m=y[0],x=y[1];c=x[0],h=x[1],l=m[0]-x[0],u=m[1]-x[1],d=a||0,f=this.markerEndAngle}s=Math.atan2(u,l),o.setLocalEulerAngles(180*s/Math.PI+f),o.setLocalPosition(c+Math.cos(s)*d,h+Math.sin(s)*d)}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach((function(t){t.remove()})),t&&dl(t))for(var n=1;n<e.length-1;n++){var i=b(e[n].currentPoint,2),r=i[0],a=i[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(r,a)}}},{key:"getTotalLength",value:function(){return va(this)}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=yn(this.parsedStyle.d.absolutePath,t),i=n.x,r=n.y,a=j(k(),N(i,r,0),e?this.getWorldTransform():this.getLocalTransform());return new ri(a[0],a[1])}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*va(this),e)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,i=t[1].currentPoint,r=t[1].startTangent;e=[],r?(e.push([n[0]-r[0],n[1]-r[1]]),e.push([n[0],n[1]])):(e.push([i[0],i[1]]),e.push([n[0],n[1]]))}return e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var i=t[e-2].currentPoint,r=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?(n.push([r[0]-a[0],r[1]-a[1]]),n.push([r[0],r[1]])):(n.push([i[0],i[1]]),n.push([r[0],r[1]]))}return n}}])}(yl);Ol.PARSED_STYLE_LIST=new Set([].concat(f(yl.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var Pl=["style"],Cl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,Pl);l(this,e),(t=v(this,e,[s({type:Un.POLYGON,style:i,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},r)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd,c=a.markerMid;return o&&dl(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),c&&dl(c)&&t.placeMarkerMid(c),u&&dl(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&dl(i)&&(this.markerStartAngle=0,i.remove()),r&&dl(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t?(i&&dl(i)&&(this.markerEndAngle=0,i.remove()),r&&dl(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(r)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,i=e.markerEnd,r=e.markerStartOffset,a=e.markerEndOffset,o=(e.points||{}).points,s=t?n:i;if(s&&dl(s)&&o){var l,u,c,h,d,f,p;if(h=o[0][0],d=o[0][1],t)u=o[1][0]-o[0][0],c=o[1][1]-o[0][1],f=r||0,p=this.markerStartAngle;else{var g=o.length;this.parsedStyle.isClosed?(u=o[g-1][0]-o[0][0],c=o[g-1][1]-o[0][1]):(h=o[g-1][0],d=o[g-1][1],u=o[g-2][0]-o[g-1][0],c=o[g-2][1]-o[g-1][1]),f=a||0,p=this.markerEndAngle}l=Math.atan2(c,u),s.setLocalEulerAngles(180*l/Math.PI+p),s.setLocalPosition(h+Math.cos(l)*f,d+Math.sin(l)*f)}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach((function(t){t.remove()})),this.markerMidList=[],t&&dl(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var i=e[n][0],r=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(i,r)}}}])}(yl);Cl.PARSED_STYLE_LIST=new Set([].concat(f(yl.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var Rl=["style"],Ll=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,i=zn(t,Rl);return l(this,e),v(this,e,[s({type:Un.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i)])}return m(e,t),c(e,[{key:"getTotalLength",value:function(){return 0===(t=this).parsedStyle.points.totalLength&&(t.parsedStyle.points.totalLength=Rn(t.parsedStyle.points.points)),t.parsedStyle.points.totalLength;var t}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var i,r,a=[],o=0,s=this.getTotalLength();n.forEach((function(t,e){n[e+1]&&((i=[0,0])[0]=o/s,r=Nn(t[0],t[1],n[e+1][0],n[e+1][1]),o+=r,i[1]=o/s,a.push(i))})),this.parsedStyle.points.segments=a}var l=0,u=0;this.parsedStyle.points.segments.forEach((function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n)}));var c=Tn(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=j(k(),N(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new ri(f[0],f[1])}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n}}])}(Cl);Ll.PARSED_STYLE_LIST=new Set([].concat(f(Cl.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var Dl=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:Un.RECT},t)])}return m(e,t),c(e)}(yl);Dl.PARSED_STYLE_LIST=new Set([].concat(f(yl.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var Il=["style"],_l=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,i=zn(t,Il);return l(this,e),v(this,e,[s({type:Un.TEXT,style:s({fill:"black"},n)},i)])}return m(e,t),c(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(yl);_l.PARSED_STYLE_LIST=new Set([].concat(f(yl.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var Bl=function(){return c((function t(){l(this,t),this.registry={},this.define(Un.CIRCLE,ml),this.define(Un.ELLIPSE,El),this.define(Un.RECT,Dl),this.define(Un.IMAGE,Sl),this.define(Un.LINE,Tl),this.define(Un.GROUP,wl),this.define(Un.PATH,Ol),this.define(Un.POLYGON,Cl),this.define(Un.POLYLINE,Ll),this.define(Un.TEXT,_l),this.define(Un.HTML,Ml)}),[{key:"define",value:function(t,e){this.registry[t]=e}},{key:"get",value:function(t){return this.registry[t]}}])}(),Fl=function(t){function e(){var t;l(this,e),(t=v(this,e)).defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new rl.AnimationTimeline(t)}catch(t){}var n={};return Za.forEach((function(t){var e=t.n,i=t.inh,r=t.d;i&&r&&(n[e]=gn(r)?r(Un.GROUP):r)})),t.documentElement=new wl({id:"g-root",style:n}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return m(e,t),c(e,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(t,e){if("svg"===t)return this.documentElement;var n=this.defaultView.customElements.get(t);n||(console.warn("Unsupported tagName: ",t),n="tspan"===t?_l:wl);var i=new n(e);return i.ownerDocument=this,i}},{key:"createElementNS",value:function(t,e,n){return this.createElement(e,n)}},{key:"cloneNode",value:function(t){throw new Error(oi)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}}},{key:"elementsFromBBox",value:function(t,e,n,i){var r=this.defaultView.context.rBushRoot.search({minX:t,minY:e,maxX:n,maxY:i}),a=[];return r.forEach((function(t){var e=t.displayObject,n=e.parsedStyle.pointerEvents,i=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(void 0===n?"auto":n);(!i||i&&e.isVisible())&&!e.isCulled()&&e.isInteractive()&&a.push(e)})),a.sort((function(t,e){return e.sortable.renderOrder-t.sortable.renderOrder})),a}},{key:"elementFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),i=n.x,r=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(i<0||r<0||i>o||r>s)return null;var l=this.defaultView.viewport2Client({x:i,y:r}),u=l.x,c=l.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:e,viewportX:i,viewportY:r,clientX:u,clientY:c},picked:[]}).picked;return h&&h[0]||this.documentElement}},{key:"elementFromPoint",value:(i=jn(Bn().mark((function t(e,n){var i,r,a,o,s,l,u,c,h,d,f;return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.defaultView.canvas2Viewport({x:e,y:n}),r=i.x,a=i.y,o=this.defaultView.getConfig(),s=o.width,l=o.height,!(r<0||a<0||r>s||a>l)){t.next=4;break}return t.abrupt("return",null);case 4:return u=this.defaultView.viewport2Client({x:r,y:a}),c=u.x,h=u.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:r,viewportY:a,clientX:c,clientY:h},picked:[]});case 7:return d=t.sent,f=d.picked,t.abrupt("return",f&&f[0]||this.documentElement);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"elementsFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),i=n.x,r=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(i<0||r<0||i>o||r>s)return[];var l=this.defaultView.viewport2Client({x:i,y:r}),u=l.x,c=l.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:e,viewportX:i,viewportY:r,clientX:u,clientY:c},picked:[]}).picked;return h[h.length-1]!==this.documentElement&&h.push(this.documentElement),h}},{key:"elementsFromPoint",value:(n=jn(Bn().mark((function t(e,n){var i,r,a,o,s,l,u,c,h,d,f;return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.defaultView.canvas2Viewport({x:e,y:n}),r=i.x,a=i.y,o=this.defaultView.getConfig(),s=o.width,l=o.height,!(r<0||a<0||r>s||a>l)){t.next=4;break}return t.abrupt("return",[]);case 4:return u=this.defaultView.viewport2Client({x:r,y:a}),c=u.x,h=u.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:r,viewportY:a,clientX:c,clientY:h},picked:[]});case 7:return d=t.sent,(f=d.picked)[f.length-1]!==this.documentElement&&f.push(this.documentElement),t.abrupt("return",f);case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"appendChild",value:function(t,e){throw new Error(si)}},{key:"insertBefore",value:function(t,e){throw new Error(si)}},{key:"removeChild",value:function(t,e){throw new Error(si)}},{key:"replaceChild",value:function(t,e,n){throw new Error(si)}},{key:"append",value:function(){throw new Error(si)}},{key:"prepend",value:function(){throw new Error(si)}},{key:"getElementById",value:function(t){return this.documentElement.getElementById(t)}},{key:"getElementsByName",value:function(t){return this.documentElement.getElementsByName(t)}},{key:"getElementsByTagName",value:function(t){return this.documentElement.getElementsByTagName(t)}},{key:"getElementsByClassName",value:function(t){return this.documentElement.getElementsByClassName(t)}},{key:"querySelector",value:function(t){return this.documentElement.querySelector(t)}},{key:"querySelectorAll",value:function(t){return this.documentElement.querySelectorAll(t)}},{key:"find",value:function(t){return this.documentElement.find(t)}},{key:"findAll",value:function(t){return this.documentElement.findAll(t)}}]);var n,i}(xs),jl=function(){function t(e){l(this,t),this.strategies=e}return c(t,[{key:"apply",value:function(e){var n=e.camera,i=e.renderingService,r=e.renderingContext,a=this.strategies;i.hooks.cull.tap(t.tag,(function(t){if(t){var e=t.cullable;return 0===a.length?e.visible=r.unculledEntities.indexOf(t.entity)>-1:e.visible=a.every((function(e){return e.isVisible(n,t)})),!t.isCulled()&&t.isVisible()?t:(t.dispatchEvent(new ys(Ts.CULLED)),null)}return t})),i.hooks.afterRender.tap(t.tag,(function(t){t.cullable.visibilityPlaneMask=-1}))}}])}();jl.tag="Culling";var Gl=function(){function t(){var e=this;l(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new gs(null),this.rootWheelEvent=new vs(null),this.onPointerMove=function(t){var n,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView;if(!i.supportsTouchEvents||"touch"!==t.pointerType){var r,a=Gn(e.normalizeToPointerEvent(t,i));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=e.bootstrapEvent(e.rootPointerEvent,o,i,t);e.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var n,i,r=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=Gn(e.normalizeToPointerEvent(t,r));try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.bootstrapEvent(e.rootPointerEvent,o,r,t);e.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}}return c(t,[{key:"apply",value:function(e){var n=this;this.context=e;var i=e.renderingService,r=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler((function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null})),i.hooks.pointerWheel.tap(t.tag,(function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e)})),i.hooks.pointerDown.tap(t.tag,(function(t){if(!r.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,r);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var i,a=Gn(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=n.bootstrapEvent(n.rootPointerEvent,o,r,t);n.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}n.setCursor(n.context.eventService.cursor)}})),i.hooks.pointerUp.tap(t.tag,(function(t){if(!r.supportsTouchEvents||"touch"!==t.pointerType){var e,i=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(i,t)?"":"outside",o=Gn(n.normalizeToPointerEvent(t,r));try{for(o.s();!(e=o.n()).done;){var s=e.value,l=n.bootstrapEvent(n.rootPointerEvent,s,r,t);l.type+=a,n.context.eventService.mapEvent(l)}}catch(t){o.e(t)}finally{o.f()}n.setCursor(n.context.eventService.cursor)}})),i.hooks.pointerMove.tap(t.tag,this.onPointerMove),i.hooks.pointerOver.tap(t.tag,this.onPointerMove),i.hooks.pointerOut.tap(t.tag,this.onPointerMove),i.hooks.click.tap(t.tag,this.onClick),i.hooks.pointerCancel.tap(t.tag,(function(t){var e,i=Gn(n.normalizeToPointerEvent(t,r));try{for(i.s();!(e=i.n()).done;){var a=e.value,o=n.bootstrapEvent(n.rootPointerEvent,a,r,t);n.context.eventService.mapEvent(o)}}catch(t){i.e(t)}finally{i.f()}n.setCursor(n.context.eventService.cursor)}))}},{key:"bootstrapEvent",value:function(t,e,n,i){t.view=n,t.originalEvent=null,t.nativeEvent=i,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=r.x,o=r.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=i.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=No[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),i=n.x,r=n.y;e.viewport.x=i,e.viewport.y=r;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=To.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var i=0;i<t.changedTouches.length;i++){var r=t.changedTouches[i];hn(r.button)&&(r.button=0),hn(r.buttons)&&(r.buttons=1),hn(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),hn(r.width)&&(r.width=r.radiusX||1),hn(r.height)&&(r.height=r.radiusY||1),hn(r.tiltX)&&(r.tiltX=0),hn(r.tiltY)&&(r.tiltY=0),hn(r.pointerType)&&(r.pointerType="touch"),hn(r.pointerId)&&(r.pointerId=r.identifier||0),hn(r.pressure)&&(r.pressure=r.force||.5),hn(r.twist)&&(r.twist=0),hn(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,r.type=t.type,n.push(r)}else if(e.isMouseEvent(t)){var a=t;hn(a.isPrimary)&&(a.isPrimary=!0),hn(a.width)&&(a.width=1),hn(a.height)&&(a.height=1),hn(a.tiltX)&&(a.tiltX=0),hn(a.tiltY)&&(a.tiltY=0),hn(a.pointerType)&&(a.pointerType="mouse"),hn(a.pointerId)&&(a.pointerId=1),hn(a.pressure)&&(a.pressure=.5),hn(a.twist)&&(a.twist=0),hn(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}else n.push(t);return n}}])}();Gl.tag="Event";var zl=[Un.CIRCLE,Un.ELLIPSE,Un.IMAGE,Un.RECT,Un.LINE,Un.POLYLINE,Un.POLYGON,Un.TEXT,Un.PATH,Un.HTML],Vl=function(){return c((function t(){l(this,t)}),[{key:"isVisible",value:function(t,e){var n,i=e.cullable;if(!i.enable)return!0;var r=e.getRenderBounds();if(ti.isEmpty(r))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return i.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,r,o||ni.INDETERMINATE,a.planes),i.visible=i.visibilityPlaneMask!==ni.OUTSIDE,i.visible}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,i){if(n===ni.OUTSIDE||n===ni.INSIDE)return n;for(var r=ni.INSIDE,a=zl.indexOf(t.nodeName)>-1,o=0,s=i.length;o<s;++o){var l=1<<o;if(n&l&&(!a||4!==o&&5!==o)){var u=i[o],c=u.normal,h=u.distance;if(_(c,e.getPositiveFarPoint(i[o]))+h<0)return ni.OUTSIDE;_(c,e.getNegativeFarPoint(i[o]))+h<0&&(r|=l)}}return r}}])}(),Wl=function(){function t(){l(this,t),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return c(t,[{key:"apply",value:function(e){var n,i=this,r=e.renderingService,a=e.renderingContext,o=e.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var l=function(t){t.target.renderable.dirty=!0,r.dirtify()},u=function(t){i.syncTasks.set(t.target,t.detail.affectChildren),r.dirtify()},c=function(t){var e=t.target;rl.enableSizeAttenuation&&rl.styleValueRegistry.updateSizeAttenuation(e,s.getCamera().getZoom())},h=function(t){var e=t.target,n=e.rBushNode;n.aabb&&i.rBush.remove(n.aabb),i.syncTasks.delete(e),rl.sceneGraphService.dirtifyToRoot(e),r.dirtify()};r.hooks.init.tap(t.tag,(function(){s.addEventListener(Ts.MOUNTED,c),s.addEventListener(Ts.UNMOUNTED,h),s.addEventListener(Ts.ATTR_MODIFIED,l),s.addEventListener(Ts.BOUNDS_CHANGED,u)})),r.hooks.destroy.tap(t.tag,(function(){s.removeEventListener(Ts.MOUNTED,c),s.removeEventListener(Ts.UNMOUNTED,h),s.removeEventListener(Ts.ATTR_MODIFIED,l),s.removeEventListener(Ts.BOUNDS_CHANGED,u),i.syncTasks.clear()}));var d=null!==(n=rl.globalThis.requestIdleCallback)&&void 0!==n?n:jo.bind(rl.globalThis);r.hooks.endFrame.tap(t.tag,(function(){i.isFirstTimeRendering?(i.isFirstTimeRendering=!1,i.syncing=!0,d((function(){i.syncRTree(!0),i.isFirstTimeRenderingFinished=!0}))):i.syncRTree()}))}},{key:"syncNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isConnected){var n=t.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var i=t.getRenderBounds();if(i){var r=t.renderable;e&&(r.dirtyRenderBounds||(r.dirtyRenderBounds=new ti),r.dirtyRenderBounds.update(i.center,i.halfExtents));var a=b(i.getMin(),2),o=a[0],s=a[1],l=b(i.getMax(),2),u=l[0],c=l[1];n.aabb||(n.aabb={}),n.aabb.displayObject=t,n.aabb.minX=o,n.aabb.minY=s,n.aabb.maxX=u,n.aabb.maxY=c}return n.aabb&&!(isNaN(n.aabb.maxX)||isNaN(n.aabb.maxX)||isNaN(n.aabb.minX)||isNaN(n.aabb.minY))?n.aabb:void 0}}},{key:"syncRTree",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var n=[],i=new Set,r=function(r){if(!i.has(r)&&r.renderable){var a=t.syncNode(r,e);a&&(n.push(a),i.add(r))}};this.syncTasks.forEach((function(t,e){t&&e.forEach(r);for(var n=e;n;)r(n),n=n.parentElement})),this.rBush.load(n),n.length=0,this.syncing=!1}}}])}();Wl.tag="Prepare";var Ul=function(t){return t.READY="ready",t.BEFORE_RENDER="beforerender",t.RERENDER="rerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle",t.RENDERER_CHANGED="rendererchanged",t}({}),Hl=new ys(Ts.MOUNTED),Yl=new ys(Ts.UNMOUNTED),$l=new ys(Ul.BEFORE_RENDER),Xl=new ys(Ul.RERENDER),ql=new ys(Ul.AFTER_RENDER),Kl=function(t){function e(t){var n;l(this,e),(n=v(this,e)).Element=yl,n.inited=!1,n.context={};var i=t.container,r=t.canvas,a=t.renderer,o=t.width,u=t.height,c=t.background,h=t.cursor,d=t.supportsMutipleCanvasesInOneContainer,f=t.cleanUpOnDestroy,p=void 0===f||f,g=t.offscreenCanvas,y=t.devicePixelRatio,m=t.requestAnimationFrame,b=t.cancelAnimationFrame,x=t.createImage,E=t.supportsTouchEvents,w=t.supportsPointerEvents,k=t.isTouchEvent,M=t.isMouseEvent,S=t.dblClickSpeed,N=o,T=u,A=y||Eo&&window.devicePixelRatio||1;return A=A>=1?Math.ceil(A):1,r&&(N=o||function(t){var e=So(t,"width");return"auto"===e?t.offsetWidth:parseFloat(e)}(r)||r.width/A,T=u||function(t){var e=So(t,"height");return"auto"===e?t.offsetHeight:parseFloat(e)}(r)||r.height/A),n.customElements=new Bl,n.devicePixelRatio=A,n.requestAnimationFrame=null!=m?m:jo.bind(rl.globalThis),n.cancelAnimationFrame=null!=b?b:Go.bind(rl.globalThis),n.supportsTouchEvents=null!=E?E:"ontouchstart"in rl.globalThis,n.supportsPointerEvents=null!=w?w:!!rl.globalThis.PointerEvent,n.isTouchEvent=null!=k?k:function(t){return n.supportsTouchEvents&&t instanceof rl.globalThis.TouchEvent},n.isMouseEvent=null!=M?M:function(t){return!rl.globalThis.MouseEvent||t instanceof rl.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(t instanceof rl.globalThis.PointerEvent))},g&&(rl.offscreenCanvas=g),n.document=new Fl,n.document.defaultView=n,d||function(t,e,n){if(t){var i="string"==typeof t?document.getElementById(t):t;xo.has(i)&&xo.get(i).destroy(n),xo.set(i,e)}}(i,n,p),n.initRenderingContext(s(s({},t),{},{width:N,height:T,background:null!=c?c:"transparent",cursor:null!=h?h:"default",cleanUpOnDestroy:p,devicePixelRatio:A,requestAnimationFrame:n.requestAnimationFrame,cancelAnimationFrame:n.cancelAnimationFrame,supportsTouchEvents:n.supportsTouchEvents,supportsPointerEvents:n.supportsPointerEvents,isTouchEvent:n.isTouchEvent,isMouseEvent:n.isMouseEvent,dblClickSpeed:null!=S?S:200,createImage:null!=x?x:function(){return new window.Image}})),n.initDefaultCamera(N,T,a.clipSpaceNearZ),n.initRenderer(a,!0),n}return m(e,t),c(e,[{key:"initRenderingContext",value:function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(t,e,n){var i=this,r=new rl.CameraContribution;r.clipSpaceNearZ=n,r.setType(Mi.EXPLORING,Si.DEFAULT).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(t/-2,t/2,e/2,e/-2,.1,1e3),r.canvas=this,r.eventEmitter.on(Ti,(function(){i.context.renderingContext.renderReasons.add(ks.CAMERA_CHANGED),rl.enableSizeAttenuation&&i.getConfig().renderer.getConfig().enableSizeAttenuation&&i.updateSizeAttenuation()})),this.context.camera=r}},{key:"updateSizeAttenuation",value:function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach((function(e){rl.styleValueRegistry.updateSizeAttenuation(e,t)}))}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise((function(e){t.resolveReadyPromise=function(){e(t)}})),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;fr.clearCache(),e||this.dispatchEvent(new ys(Ul.BEFORE_DESTROY)),this.frameId&&this.cancelAnimationFrame(this.frameId);var n=this.getRoot();t&&(this.unmountChildren(n),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),e||this.dispatchEvent(new ys(Ul.AFTER_DESTROY));var i=function(t){t.currentTarget=null,t.manager=null,t.target=null,t.relatedNode=null};i(Hl),i(Yl),i($l),i(Xl),i(ql),i(pl),i(ll),i(ul),i(cl)}},{key:"changeSize",value:function(t,e){this.resize(t,e)}},{key:"resize",value:function(t,e){var n=this.context.config;n.width=t,n.height=e,this.getContextService().resize(t,e);var i=this.context.camera,r=i.getProjectionMode();i.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),r===Ni.ORTHOGRAPHIC?i.setOrthographic(t/-2,t/2,e/2,e/-2,i.getNear(),i.getFar()):i.setAspect(t/e),this.dispatchEvent(new ys(Ul.RESIZE,{width:t,height:e}))}},{key:"appendChild",value:function(t,e){return this.document.documentElement.appendChild(t,e)}},{key:"insertBefore",value:function(t,e){return this.document.documentElement.insertBefore(t,e)}},{key:"removeChild",value:function(t){return this.document.documentElement.removeChild(t)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(t){var e=this;t&&($l.detail=t,ql.detail=t),this.dispatchEvent($l),this.getRenderingService().render(this.getConfig(),t,(function(){e.dispatchEvent(Xl)})),this.dispatchEvent(ql)}},{key:"run",value:function(){var t=this,e=function(n,i){t.render(i),t.frameId=t.requestAnimationFrame(e)};e()}},{key:"initRenderer",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new Wn,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new Gl,new Wl,new jl([new Vl])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(s(s({},rl),this.context)),this.context.renderingService=new Ms(rl,this.context),this.context.eventService=new Es(rl,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,n,!0)):this.context.contextService.initAsync().then((function(){e.initRenderingService(t,n)})).catch((function(t){console.error(t)}))}},{key:"initRenderingService",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context.renderingService.init((function(){e.inited=!0,n?i?e.requestAnimationFrame((function(){e.dispatchEvent(new ys(Ul.READY))})):e.dispatchEvent(new ys(Ul.READY)):e.dispatchEvent(new ys(Ul.RENDERER_CHANGED)),e.readyPromise&&e.resolveReadyPromise(),n||e.getRoot().forEach((function(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0,e.dirty=!0)})),e.mountChildren(e.getRoot()),t.getConfig().enableAutoRendering&&e.run()}))}},{key:"loadRendererContainerModule",value:function(t){var e=this;t.getPlugins().forEach((function(t){t.context=e.context,t.init(rl)}))}},{key:"setRenderer",value:function(t){var e=this.getConfig();if(e.renderer!==t){var n=e.renderer;e.renderer=t,this.destroy(!1,!0),f((null==n?void 0:n.getPlugins())||[]).reverse().forEach((function(t){t.destroy(rl)})),this.initRenderer(t)}}},{key:"setCursor",value:function(t){this.getConfig().cursor=t,this.getContextService().applyCursorStyle(t)}},{key:"unmountChildren",value:function(t){var e=this;t.childNodes.forEach((function(t){e.unmountChildren(t)})),this.inited&&(t.isMutationObserved?t.dispatchEvent(Yl):(Yl.target=t,this.dispatchEvent(Yl,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()}},{key:"mountChildren",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ao(t);this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,n||(t.isMutationObserved?t.dispatchEvent(Hl):(Hl.target=t,this.dispatchEvent(Hl,!0)))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach((function(t){e.mountChildren(t,n)})),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()}},{key:"mountFragment",value:function(t){this.mountChildren(t,!1)}},{key:"client2Viewport",value:function(t){return this.getEventService().client2Viewport(t)}},{key:"viewport2Client",value:function(t){return this.getEventService().viewport2Client(t)}},{key:"viewport2Canvas",value:function(t){return this.getEventService().viewport2Canvas(t)}},{key:"canvas2Viewport",value:function(t){return this.getEventService().canvas2Viewport(t)}},{key:"getPointByClient",value:function(t,e){return this.client2Viewport({x:t,y:e})}},{key:"getClientByPoint",value:function(t,e){return this.viewport2Client({x:t,y:e})}}])}(bs),Zl=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).landmarks=[],t}return m(e,t),c(e,[{key:"rotate",value:function(t,e,n){if(this.relElevation=li(e),this.relAzimuth=li(t),this.relRoll=li(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Mi.EXPLORING){var i=Kt(qt(),[1,0,0],di((this.rotateWorld?1:-1)*this.relElevation)),r=Kt(qt(),[0,1,0],di((this.rotateWorld?1:-1)*this.relAzimuth)),a=Kt(qt(),[0,0,1],di(this.relRoll)),o=Zt(qt(),r,i);o=Zt(qt(),o,a);var s=St(q(),o);ot(this.matrix,this.matrix,[0,0,-this.distance]),at(this.matrix,this.matrix,s),ot(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===Mi.ORBITING||this.type===Mi.EXPLORING?this._getPosition():this.type===Mi.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(t,e){var n=ci(t,e,0),i=M(this.position);return O(i,i,D(k(),this.right,n[0])),O(i,i,D(k(),this.up,n[1])),this._setPosition(i),this.triggerUpdate(),this}},{key:"dolly",value:function(t){var e=this.forward,n=M(this.position),i=this.dollyingStep,r=this.distance+t*this.dollyingStep;return i=Math.max(Math.min(r,this.maxDistance),this.minDistance)-this.distance,n[0]+=i*e[0],n[1]+=i*e[1],n[2]+=i*e[2],this._setPosition(n),this.type===Mi.ORBITING||this.type===Mi.EXPLORING?this._getDistance():this.type===Mi.TRACKING&&O(this.focalPoint,n,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(t){var e,n,i,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=a.position,s=void 0===o?this.position:o,l=a.focalPoint,u=void 0===l?this.focalPoint:l,c=a.roll,h=a.zoom,d=new rl.CameraContribution;d.setType(this.type,void 0),d.setPosition(s[0],null!==(e=s[1])&&void 0!==e?e:this.position[1],null!==(n=s[2])&&void 0!==n?n:this.position[2]),d.setFocalPoint(u[0],null!==(i=u[1])&&void 0!==i?i:this.focalPoint[1],null!==(r=u[2])&&void 0!==r?r:this.focalPoint[2]),d.setRoll(null!=c?c:this.roll),d.setZoom(null!=h?h:this.zoom);var f={name:t,matrix:K(d.getWorldTransform()),right:M(d.right),up:M(d.up),forward:M(d.forward),position:M(d.getPosition()),focalPoint:M(d.getFocalPoint()),distanceVector:M(d.getDistanceVector()),distance:d.getDistance(),dollyingStep:d.getDollyingStep(),azimuth:d.getAzimuth(),elevation:d.getElevation(),roll:d.getRoll(),relAzimuth:d.relAzimuth,relElevation:d.relElevation,relRoll:d.relRoll,zoom:d.getZoom()};return this.landmarks.push(f),f}},{key:"gotoLandmark",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=he(t)?this.landmarks.find((function(e){return e.name===t})):t;if(i){var r=le(n)?{duration:n}:n,a=r.easing,o=void 0===a?"linear":a,s=r.duration,l=void 0===s?100:s,u=r.easingFunction,c=void 0===u?void 0:u,h=r.onfinish,d=void 0===h?void 0:h,f=r.onframe,p=void 0===f?void 0:f;this.cancelLandmarkAnimation();var g,v=i.position,y=i.focalPoint,m=i.zoom,b=i.roll,x=c||rl.EasingFunction(o),E=function(){e.setFocalPoint(y),e.setPosition(v),e.setRoll(b),e.setZoom(m),e.computeMatrix(),e.triggerUpdate(),null==d||d()};if(0===l)return E();var w=function(t){void 0===g&&(g=t);var n=t-g;if(n>=l)E();else{var i,r,a=x(n/l),o=k(),s=k();if(F(o,e.focalPoint,y,a),F(s,e.position,v,a),r=e.roll*(1-a)+b*a,i=e.zoom*(1-a)+m*a,e.setFocalPoint(o),e.setPosition(s),e.setRoll(r),e.setZoom(i),U(o,y)+U(s,v)<=.01&&void 0===m&&void 0===b)return E();e.computeMatrix(),e.triggerUpdate(),n<l&&(null==p||p(a),e.landmarkAnimationID=e.canvas.requestAnimationFrame(w))}};this.canvas.requestAnimationFrame(w)}}}])}(Oi);rl.CameraContribution=Zl,new WeakMap;var Ql=function(t){function e(t,n,i,r){var a;return l(this,e),(a=v(this,e,[t])).currentTime=i,a.timelineTime=r,a.target=n,a.type="finish",a.bubbles=!1,a.currentTarget=n,a.defaultPrevented=!1,a.eventPhase=a.AT_TARGET,a.timeStamp=Date.now(),a.currentTime=i,a.timelineTime=r,a}return m(e,t),c(e)}(fs),Jl=0,tu=function(){return c((function t(e,n){var i;l(this,t),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=n,this.id="".concat(Jl++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number(null===(i=this.effect)||void 0===i?void 0:i.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}),[{key:"pending",get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var t=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise((function(e,n){t.resolveReadyPromise=function(){e(t)},t.rejectReadyPromise=function(){n(new Error)}})),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var t=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise((function(e,n){t.resolveFinishedPromise=function(){e(t)},t.rejectFinishedPromise=function(){n(new Error)}})),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){var e;(t=Number(t),isNaN(t))||(this.timeline.restart(),this._paused||null===this._startTime||(this._startTime=Number(null===(e=this.timeline)||void 0===e?void 0:e.currentTime)-t/this.playbackRate),this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this)))}},{key:"startTime",get:function(){return this._startTime},set:function(t){if(null!==t){if(this.updatePromises(),t=Number(t),isNaN(t))return;if(this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var e=this.currentTime;this._playbackRate=t,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==e&&(this.currentTime=e),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||"running"===this.playState||!this._finishedFlag}},{key:"updatePromises",value:function(){var t=this.oldPlayState,e=this.pending?"pending":this.playState;return this.readyPromise&&e!==t&&("idle"===e?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===t?this.resolveReadyPromise():"pending"===e&&(this.readyPromise=void 0)),this.finishedPromise&&e!==t&&("idle"===e?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===e?this.resolveFinishedPromise():"finished"===t&&(this.finishedPromise=void 0)),this.oldPlayState=e,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var t=this;if(this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var e=new Ql(null,this,this.currentTime,null);setTimeout((function(){t.oncancel(e)}))}}},{key:"reverse",value:function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),null!==t&&(this.currentTime=t),this.updatePromises()}},{key:"updatePlaybackRate",value:function(t){this.playbackRate=t}},{key:"targetAnimations",value:function(){var t;return(null===(t=this.effect)||void 0===t?void 0:t.target).getAnimations()}},{key:"markTarget",value:function(){var t=this.targetAnimations();-1===t.indexOf(this)&&t.push(this)}},{key:"unmarkTarget",value:function(){var t=this.targetAnimations(),e=t.indexOf(this);-1!==e&&t.splice(e,1)}},{key:"tick",value:function(t,e){this._idle||this._paused||(null===this._startTime?e&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(t))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else{if(!(this._totalDuration<1/0))throw new Error("Unable to rewind negative playback rate animation with infinite duration");this.currentTime=this._totalDuration}}},{key:"persist",value:function(){throw new Error(oi)}},{key:"addEventListener",value:function(t,e,n){throw new Error(oi)}},{key:"removeEventListener",value:function(t,e,n){throw new Error(oi)}},{key:"dispatchEvent",value:function(t){throw new Error(oi)}},{key:"commitStyles",value:function(){throw new Error(oi)}},{key:"ensureAlive",value:function(){var t,e;this.playbackRate<0&&0===this.currentTime?this._inEffect=!(null===(t=this.effect)||void 0===t||!t.update(-1)):this._inEffect=!(null===(e=this.effect)||void 0===e||!e.update(this.currentTime)),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(t,e){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!e&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(t){var e=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new Ql(null,this,this.currentTime,t);setTimeout((function(){e.onfinish&&e.onfinish(n)}))}this._finishedFlag=!0}}else{if(this.onframe&&"running"===this.playState){var i=new Ql(null,this,this.currentTime,t);this.onframe(i)}this._finishedFlag=!1}}}])}(),eu=.1,nu="function"==typeof Float32Array,iu=function(t,e){return 1-3*e+3*t},ru=function(t,e){return 3*e-6*t},au=function(t){return 3*t},ou=function(t,e,n){return((iu(e,n)*t+ru(e,n))*t+au(e))*t},su=function(t,e,n){return 3*iu(e,n)*t*t+2*ru(e,n)*t+au(e)},lu=function(t,e,n,i){if(!(t>=0&&t<=1&&n>=0&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&n===i)return function(t){return t};for(var r=nu?new Float32Array(11):new Array(11),a=0;a<11;++a)r[a]=ou(a*eu,t,n);return function(a){return 0===a||1===a?a:ou(function(e){for(var i=0,a=1;10!==a&&r[a]<=e;++a)i+=eu;--a;var o=i+(e-r[a])/(r[a+1]-r[a])*eu,s=su(o,t,n);return s>=.001?function(t,e,n,i){for(var r=0;r<4;++r){var a=su(e,n,i);if(0===a)return e;e-=(ou(e,n,i)-t)/a}return e}(e,o,t,n):0===s?o:function(t,e,n,i,r){var a,o,s=0;do{(a=ou(o=e+(n-e)/2,i,r)-t)>0?n=o:e=o}while(Math.abs(a)>1e-7&&++s<10);return o}(e,i,i+eu,t,n)}(a),e,i)}},uu=function(t){return Math.pow(t,2)},cu=function(t){return Math.pow(t,3)},hu=function(t){return Math.pow(t,4)},du=function(t){return Math.pow(t,5)},fu=function(t){return Math.pow(t,6)},pu=function(t){return 1-Math.cos(t*Math.PI/2)},gu=function(t){return 1-Math.sqrt(1-t*t)},vu=function(t){return t*t*(3*t-2)},yu=function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)},mu=function(t){var e=b(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],2),n=e[0],i=void 0===n?1:n,r=e[1],a=void 0===r?.5:r,o=de(Number(i),1,10),s=de(Number(a),.1,2);return 0===t||1===t?t:-o*Math.pow(2,10*(t-1))*Math.sin((t-1-s/(2*Math.PI)*Math.asin(1/o))*(2*Math.PI)/s)},bu=function(t){var e=arguments.length>2?arguments[2]:void 0,n=b(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],4),i=n[0],r=void 0===i?1:i,a=n[1],o=void 0===a?100:a,s=n[2],l=void 0===s?10:s,u=n[3],c=void 0===u?0:u;r=de(r,.1,1e3),o=de(o,.1,1e3),l=de(l,.1,1e3),c=de(c,.1,1e3);var h=Math.sqrt(o/r),d=l/(2*Math.sqrt(o*r)),f=d<1?h*Math.sqrt(1-d*d):0,p=d<1?(d*h-c)/f:-c+h,g=e?e*t/1e3:t;return g=d<1?Math.exp(-g*d*h)*(1*Math.cos(f*g)+p*Math.sin(f*g)):(1+p*g)*Math.exp(-g*h),0===t||1===t?t:1-g},xu=function(t){var e=b(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],2),n=e[0],i=void 0===n?10:n;return("start"===e[1]?Math.ceil:Math.floor)(de(t,0,1)*i)/i},Eu=function(t){var e=b(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],4),n=e[0],i=e[1],r=e[2],a=e[3];return lu(n,i,r,a)(t)},wu=lu(.42,0,1,1),ku=function(t){return function(e){return 1-t(1-e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],arguments.length>2?arguments[2]:void 0)}},Mu=function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return e<.5?t(2*e,n,i)/2:1-t(-2*e+2,n,i)/2}},Su=function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return e<.5?(1-t(1-2*e,n,i))/2:(t(2*e-1,n,i)+1)/2}},Nu={steps:xu,"step-start":function(t){return xu(t,[1,"start"])},"step-end":function(t){return xu(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":Eu,ease:function(t){return Eu(t,[.25,.1,.25,1])},in:wu,out:ku(wu),"in-out":Mu(wu),"out-in":Su(wu),"in-quad":uu,"out-quad":ku(uu),"in-out-quad":Mu(uu),"out-in-quad":Su(uu),"in-cubic":cu,"out-cubic":ku(cu),"in-out-cubic":Mu(cu),"out-in-cubic":Su(cu),"in-quart":hu,"out-quart":ku(hu),"in-out-quart":Mu(hu),"out-in-quart":Su(hu),"in-quint":du,"out-quint":ku(du),"in-out-quint":Mu(du),"out-in-quint":Su(du),"in-expo":fu,"out-expo":ku(fu),"in-out-expo":Mu(fu),"out-in-expo":Su(fu),"in-sine":pu,"out-sine":ku(pu),"in-out-sine":Mu(pu),"out-in-sine":Su(pu),"in-circ":gu,"out-circ":ku(gu),"in-out-circ":Mu(gu),"out-in-circ":Su(gu),"in-back":vu,"out-back":ku(vu),"in-out-back":Mu(vu),"out-in-back":Su(vu),"in-bounce":yu,"out-bounce":ku(yu),"in-out-bounce":Mu(yu),"out-in-bounce":Su(yu),"in-elastic":mu,"out-elastic":ku(mu),"in-out-elastic":Mu(mu),"out-in-elastic":Su(mu),spring:bu,"spring-in":bu,"spring-out":ku(bu),"spring-in-out":Mu(bu),"spring-out-in":Su(bu)},Tu=function(t){return t};function Au(t,e){return function(n){if(n>=1)return 1;var i=1/t;return(n+=e*i)-n%i}}var Ou="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",Pu=new RegExp("cubic-bezier\\(".concat(Ou,",").concat(Ou,",").concat(Ou,",").concat(Ou,"\\)")),Cu=/steps\(\s*(\d+)\s*\)/,Ru=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function Lu(t){var e=Pu.exec(t);if(e)return lu.apply(void 0,f(e.slice(1).map(Number)));var n=Cu.exec(t);if(n)return Au(Number(n[1]),0);var i,r,a=Ru.exec(t);return a?Au(Number(a[1]),{start:1,middle:.5,end:0}[a[2]]):Nu[(i=t,(r=i,"-"===(r=r.replace(/([A-Z])/g,(function(t){return"-".concat(t.toLowerCase())}))).charAt(0)?r.substring(1):r).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim())]||Nu.linear}function Du(t){return"offset"!==t&&"easing"!==t&&"composite"!==t&&"computedOffset"!==t}var Iu=function(t,e,n){return function(i){var r=Bu(t,e,i);return le(r)?r:n(r)}};function _u(t,e,n,i){var r=Ja[t];if(r&&r.syntax&&r.int){var a=rl.styleValueRegistry.getPropertySyntax(r.syntax);if(a){var o=a.parser,s=o?o(e,i):e,l=o?o(n,i):n,u=a.mixer(s,l,i);if(u){var c=Iu.apply(void 0,f(u));return function(t){return 0===t?e:1===t?n:c(t)}}}}return Iu(!1,!0,(function(t){return t?n:e}))}function Bu(t,e,n){if("number"==typeof t&&"number"==typeof e)return t*(1-n)+e*n;if("boolean"==typeof t&&"boolean"==typeof e||"string"==typeof t&&"string"==typeof e)return n<.5?t:e;if(Array.isArray(t)&&Array.isArray(e)){for(var i=t.length,r=e.length,a=Math.max(i,r),o=[],s=0;s<a;s++)o.push(Bu(t[s<i?s:i-1],e[s<r?s:r-1],n));return o}throw new Error("Mismatched interpolation arguments ".concat(t,":").concat(e))}var Fu=function(){return c((function t(){l(this,t),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=Tu,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}),[{key:"easing",get:function(){return this._easing},set:function(t){this.easingFunction=Lu(t),this._easing=t}}])}();function ju(t,e){if(null===t)return[];Array.isArray(t)||(t=function(t){var e=[];for(var n in t)if(!(n in["easing","offset","composite"])){var i=t[n];Array.isArray(i)||(i=[i]);for(var r=i.length,a=0;a<r;a++){if(!e[a]){var o={};"offset"in t&&(o.offset=Number(t.offset)),"easing"in t&&(o.easing=t.easing),"composite"in t&&(o.composite=t.composite),e[a]=o}void 0!==i[a]&&null!==i[a]&&(e[a][n]=i[a])}}return e.sort((function(t,e){return(t.computedOffset||0)-(e.computedOffset||0)})),e}(t));for(var n=t.map((function(t){var n={};for(var i in null!=e&&e.composite&&(n.composite="auto"),t){var r=t[i];if("offset"===i){if(null!==r){if(r=Number(r),!isFinite(r))throw new Error("Keyframe offsets must be numbers.");if(r<0||r>1)throw new Error("Keyframe offsets must be between 0 and 1.");n.computedOffset=r}}else if("composite"===i&&-1===["replace","add","accumulate","auto"].indexOf(r))throw new Error("".concat(r," compositing is not supported"));n[i]=r}return void 0===n.offset&&(n.offset=null),void 0===n.easing&&(n.easing=(null==e?void 0:e.easing)||"linear"),void 0===n.composite&&(n.composite="auto"),n})),i=!0,r=-1/0,a=0;a<n.length;a++){var o=n[a].offset;if(ce(o))i=!1;else{if(o<r)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");r=o}}return n=n.filter((function(t){return Number(t.offset)>=0&&Number(t.offset)<=1})),i||function(){var t,e,i=n.length;n[i-1].computedOffset=Number(null!==(t=n[i-1].offset)&&void 0!==t?t:1),i>1&&(n[0].computedOffset=Number(null!==(e=n[0].offset)&&void 0!==e?e:0));for(var r=0,a=Number(n[0].computedOffset),o=1;o<i;o++){var s=n[o].computedOffset;if(!ce(s)&&!ce(a)){for(var l=1;l<o-r;l++)n[r+l].computedOffset=a+(Number(s)-a)*l/(o-r);r=o,a=Number(s)}}}(),n}var Gu="backwards|forwards|both|none".split("|"),zu="reverse|alternate|alternate-reverse".split("|");var Vu=function(){return c((function t(e,n,i){var r,a=this;l(this,t),this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=function(t,e){return function(t,e){var n=new Fu;return e&&(n.fill="both",n.duration="auto"),"number"!=typeof t||isNaN(t)?void 0!==t&&Object.keys(t).forEach((function(e){if(void 0!==t[e]&&null!==t[e]&&"auto"!==t[e]){if(("number"==typeof n[e]||"duration"===e)&&("number"!=typeof t[e]||isNaN(t[e])))return;if("fill"===e&&-1===Gu.indexOf(t[e]))return;if("direction"===e&&-1===zu.indexOf(t[e]))return;n[e]=t[e]}})):n.duration=t,n}(t=function(t){return"number"==typeof t&&(t=isNaN(t)?{duration:"auto"}:{duration:t}),t}(null!=t?t:{duration:"auto"}),e)}(i,!1),this.timing.effect=this,this.timing.activeDuration=(r=this.timing,Math.abs(function(t){var e;return 0===t.duration||0===t.iterations?0:("auto"===t.duration?0:Number(t.duration))*(null!==(e=t.iterations)&&void 0!==e?e:1)}(r)/(r.playbackRate||1))),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=ju(n,this.timing),this.interpolations=function(t,e,n){var i=function(t,e){for(var n={},i=0;i<t.length;i++)for(var r in t[i])if(Du(r)){var a={offset:t[i].offset,computedOffset:t[i].computedOffset,easing:t[i].easing,easingFunction:Lu(t[i].easing)||e.easingFunction,value:t[i][r]};n[r]=n[r]||[],n[r].push(a)}return n}(t,e),r=function(t,e){var n=[];for(var i in t)for(var r=t[i],a=0;a<r.length-1;a++){var o=a,s=a+1,l=r[o].computedOffset,u=r[s].computedOffset,c=l,h=u;0===a&&(c=-1/0,0===u&&(s=o)),a===r.length-2&&(h=1/0,1===l&&(o=s)),n.push({applyFrom:c,applyTo:h,startOffset:r[o].computedOffset,endOffset:r[s].computedOffset,easingFunction:r[o].easingFunction,property:i,interpolation:_u(i,r[o].value,r[s].value,e)})}return n.sort((function(t,e){return t.startOffset-e.startOffset})),n}(i,n);return function(t,e){if(null!==e)r.filter((function(t){return e>=t.applyFrom&&e<t.applyTo})).forEach((function(n){var i=e-n.startOffset,r=n.endOffset-n.startOffset,a=0===r?0:i/r;t.setAttribute(n.property,n.interpolation(a),!1,!1)}));else for(var n in i)Du(n)&&t.setAttribute(n,null)}}(this.normalizedKeyframes,this.timing,this.target);var o=rl.globalThis.Proxy;this.computedTiming=o?new o(this.timing,{get:function(t,e){return"duration"===e?"auto"===t.duration?0:t.duration:"fill"===e?"auto"===t.fill?"none":t.fill:"localTime"===e?a.animation&&a.animation.currentTime||null:"currentIteration"===e?a.animation&&"running"===a.animation.playState?t.currentIteration||0:null:"progress"===e?a.animation&&"running"===a.animation.playState?t.progress||0:null:t[e]},set:function(){return!0}}):this.timing}),[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(t){return null!==t&&(this.timeFraction=function(t,e,n){var i=function(t,e,n){if(null===e)return 0;var i=n.endTime;return e<Math.min(n.delay,i)?1:e>=Math.min(n.delay+t+n.endDelay,i)?2:3}(t,e,n),r=function(t,e,n,i,r){switch(i){case 1:return"backwards"===e||"both"===e?0:null;case 3:return n-r;case 2:return"forwards"===e||"both"===e?t:null;case 0:return null}}(t,n.fill,e,i,n.delay);if(null===r)return null;var a="auto"===n.duration?0:n.duration,o=function(t,e,n,i,r){var a=r;return 0===t?1!==e&&(a+=n):a+=i/t,a}(a,i,n.iterations,r,n.iterationStart),s=function(t,e,n,i,r,a){var o=t===1/0?e%1:t%1;return 0!==o||2!==n||0===i||0===r&&0!==a||(o=1),o}(o,n.iterationStart,i,n.iterations,r,a),l=function(t,e,n,i){return 2===t&&e===1/0?1/0:1===n?Math.floor(i)-1:Math.floor(i)}(i,n.iterations,s,o),u=function(t,e,n){var i=t;if("normal"!==t&&"reverse"!==t){var r=e;"alternate-reverse"===t&&(r+=1),i="normal",r!==1/0&&r%2!=0&&(i="reverse")}return"normal"===i?n:1-n}(n.direction,l,s);return n.currentIteration=l,n.progress=u,n.easingFunction(u)}(this.timing.activeDuration,t,this.timing),null!==this.timeFraction)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(t){this.normalizedKeyframes=ju(t)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(t){var e=this;Object.keys(t||{}).forEach((function(n){e.timing[n]=t[n]}))}}])}();function Wu(t,e){return Number(t.id)-Number(e.id)}var Uu=function(){return c((function t(e){var n=this;l(this,t),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(t){n.currentTime=t,n.discardAnimations(),0===n.animations.length?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(t){var e=n.rafCallbacks;n.rafCallbacks=[],t<Number(n.currentTime)&&(t=Number(n.currentTime)),n.animations.sort(Wu),n.animations=n.tick(t,!0,n.animations)[0],e.forEach((function(e){e[1](t)})),n.applyPendingEffects()},this.document=e}),[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(t,e,n){var i=new Vu(t,e,n),r=new tu(i,this);return this.animations.push(r),this.restartWebAnimationsNextTick(),r.updatePromises(),r.play(),r.updatePromises(),r}},{key:"applyDirtiedAnimation",value:function(t){var e=this;if(!this.inTick){t.markTarget();var n=t.targetAnimations();n.sort(Wu),this.tick(Number(this.currentTime),!1,n.slice())[1].forEach((function(t){var n=e.animations.indexOf(t);-1!==n&&e.animations.splice(n,1)})),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame((function(){})),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach((function(t){null==t||t.applyInterpolations()})),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter((function(t){return t.updatePromises()}))}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter((function(t){return"finished"!==t.playState&&"idle"!==t.playState}))}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(t){var e=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([e,t]),e}},{key:"requestAnimationFrame",value:function(t){var e=this;return this.rAF((function(n){e.updateAnimationsPromises(),t(n),e.updateAnimationsPromises()}))}},{key:"tick",value:function(t,e,n){var i,r,a=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var o=[],s=[],l=[],u=[];return n.forEach((function(n){n.tick(t,e),n._inEffect?(s.push(n.effect),n.markTarget()):(o.push(n.effect),n.unmarkTarget()),n._needsTick&&(a.ticking=!0);var i=n._inEffect||n._needsTick;n._inTimeline=i,i?l.push(n):u.push(n)})),(i=this.pendingEffects).push.apply(i,o),(r=this.pendingEffects).push.apply(r,s),this.ticking&&this.requestAnimationFrame((function(){})),this.inTick=!1,[l,u]}}])}();rl.EasingFunction=Lu,rl.AnimationTimeline=Uu;const Hu=function(t){return ce(t)?"":t.toString()},Yu=function(t){var e=Hu(t);return e.charAt(0).toUpperCase()+e.substring(1)},$u=function(t){return"object"==typeof t&&null!==t},Xu=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)};var qu=function(t,e){if(t===e)return!0;if(!t||!e)return!1;if(he(t)||he(e))return!1;if(Xu(t)||Xu(e)){if(t.length!==e.length)return!1;for(var n=!0,i=0;i<t.length&&(n=qu(t[i],e[i]));i++);return n}if($u(t)||$u(e)){var r=Object.keys(t),a=Object.keys(e);if(r.length!==a.length)return!1;for(n=!0,i=0;i<r.length&&(n=qu(t[r[i]],e[r[i]]));i++);return n}return!1};const Ku=qu,Zu={duration:500},Qu={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};var Ju,tc,ec,nc,ic,rc,ac,oc,sc,lc;!function(t){t.NodeAdded="NodeAdded",t.NodeUpdated="NodeUpdated",t.NodeRemoved="NodeRemoved",t.EdgeAdded="EdgeAdded",t.EdgeUpdated="EdgeUpdated",t.EdgeRemoved="EdgeRemoved",t.ComboAdded="ComboAdded",t.ComboUpdated="ComboUpdated",t.ComboRemoved="ComboRemoved"}(Ju||(Ju={})),function(t){t.DRAW="draw",t.COLLAPSE="collapse",t.EXPAND="expand",t.TRANSFORM="transform"}(tc||(tc={})),function(t){t.CLICK="canvas:click",t.DBLCLICK="canvas:dblclick",t.POINTER_OVER="canvas:pointerover",t.POINTER_LEAVE="canvas:pointerleave",t.POINTER_ENTER="canvas:pointerenter",t.POINTER_MOVE="canvas:pointermove",t.POINTER_OUT="canvas:pointerout",t.POINTER_DOWN="canvas:pointerdown",t.POINTER_UP="canvas:pointerup",t.CONTEXT_MENU="canvas:contextmenu",t.DRAG_START="canvas:dragstart",t.DRAG="canvas:drag",t.DRAG_END="canvas:dragend",t.DRAG_ENTER="canvas:dragenter",t.DRAG_OVER="canvas:dragover",t.DRAG_LEAVE="canvas:dragleave",t.DROP="canvas:drop",t.WHEEL="canvas:wheel"}(ec||(ec={})),function(t){t.CLICK="combo:click",t.DBLCLICK="combo:dblclick",t.POINTER_OVER="combo:pointerover",t.POINTER_LEAVE="combo:pointerleave",t.POINTER_ENTER="combo:pointerenter",t.POINTER_MOVE="combo:pointermove",t.POINTER_OUT="combo:pointerout",t.POINTER_DOWN="combo:pointerdown",t.POINTER_UP="combo:pointerup",t.CONTEXT_MENU="combo:contextmenu",t.DRAG_START="combo:dragstart",t.DRAG="combo:drag",t.DRAG_END="combo:dragend",t.DRAG_ENTER="combo:dragenter",t.DRAG_OVER="combo:dragover",t.DRAG_LEAVE="combo:dragleave",t.DROP="combo:drop"}(nc||(nc={})),function(t){t.CLICK="click",t.DBLCLICK="dblclick",t.POINTER_OVER="pointerover",t.POINTER_LEAVE="pointerleave",t.POINTER_ENTER="pointerenter",t.POINTER_MOVE="pointermove",t.POINTER_OUT="pointerout",t.POINTER_DOWN="pointerdown",t.POINTER_UP="pointerup",t.CONTEXT_MENU="contextmenu",t.DRAG_START="dragstart",t.DRAG="drag",t.DRAG_END="dragend",t.DRAG_ENTER="dragenter",t.DRAG_OVER="dragover",t.DRAG_LEAVE="dragleave",t.DROP="drop",t.KEY_DOWN="keydown",t.KEY_UP="keyup",t.WHEEL="wheel",t.PINCH="pinch"}(ic||(ic={})),function(t){t.KEY_DOWN="keydown",t.KEY_UP="keyup"}(rc||(rc={})),function(t){t.CLICK="edge:click",t.DBLCLICK="edge:dblclick",t.POINTER_OVER="edge:pointerover",t.POINTER_LEAVE="edge:pointerleave",t.POINTER_ENTER="edge:pointerenter",t.POINTER_MOVE="edge:pointermove",t.POINTER_OUT="edge:pointerout",t.POINTER_DOWN="edge:pointerdown",t.POINTER_UP="edge:pointerup",t.CONTEXT_MENU="edge:contextmenu",t.DRAG_ENTER="edge:dragenter",t.DRAG_OVER="edge:dragover",t.DRAG_LEAVE="edge:dragleave",t.DROP="edge:drop"}(ac||(ac={})),function(t){t.BEFORE_CANVAS_INIT="beforecanvasinit",t.AFTER_CANVAS_INIT="aftercanvasinit",t.BEFORE_SIZE_CHANGE="beforesizechange",t.AFTER_SIZE_CHANGE="aftersizechange",t.BEFORE_ELEMENT_CREATE="beforeelementcreate",t.AFTER_ELEMENT_CREATE="afterelementcreate",t.BEFORE_ELEMENT_UPDATE="beforeelementupdate",t.AFTER_ELEMENT_UPDATE="afterelementupdate",t.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",t.AFTER_ELEMENT_DESTROY="afterelementdestroy",t.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",t.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",t.BEFORE_DRAW="beforedraw",t.AFTER_DRAW="afterdraw",t.BEFORE_RENDER="beforerender",t.AFTER_RENDER="afterrender",t.BEFORE_ANIMATE="beforeanimate",t.AFTER_ANIMATE="afteranimate",t.BEFORE_LAYOUT="beforelayout",t.AFTER_LAYOUT="afterlayout",t.BEFORE_STAGE_LAYOUT="beforestagelayout",t.AFTER_STAGE_LAYOUT="afterstagelayout",t.BEFORE_TRANSFORM="beforetransform",t.AFTER_TRANSFORM="aftertransform",t.BATCH_START="batchstart",t.BATCH_END="batchend",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.BEFORE_RENDERER_CHANGE="beforerendererchange",t.AFTER_RENDERER_CHANGE="afterrendererchange"}(oc||(oc={})),function(t){t.UNDO="undo",t.REDO="redo",t.CANCEL="cancel",t.ADD="add",t.CLEAR="clear",t.CHANGE="change"}(sc||(sc={})),function(t){t.CLICK="node:click",t.DBLCLICK="node:dblclick",t.POINTER_OVER="node:pointerover",t.POINTER_LEAVE="node:pointerleave",t.POINTER_ENTER="node:pointerenter",t.POINTER_MOVE="node:pointermove",t.POINTER_OUT="node:pointerout",t.POINTER_DOWN="node:pointerdown",t.POINTER_UP="node:pointerup",t.CONTEXT_MENU="node:contextmenu",t.DRAG_START="node:dragstart",t.DRAG="node:drag",t.DRAG_END="node:dragend",t.DRAG_ENTER="node:dragenter",t.DRAG_OVER="node:dragover",t.DRAG_LEAVE="node:dragleave",t.DROP="node:drop"}(lc||(lc={}));const uc="combo",cc="tree";var hc;!function(t){t.NODE="node",t.EDGE="edge",t.COMBO="combo",t.THEME="theme",t.PALETTE="palette",t.LAYOUT="layout",t.BEHAVIOR="behavior",t.PLUGIN="plugin",t.ANIMATION="animation",t.TRANSFORM="transform",t.SHAPE="shape"}(hc||(hc={}));const dc={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function fc(t,e){var n;const i=null===(n=dc[t])||void 0===n?void 0:n[e];if(i)return i}function pc(t){return`[G6 v5.0.49] ${t}`}const gc={mute:!1,debug:t=>{!gc.mute&&console.debug(pc(t))},info:t=>{!gc.mute&&console.info(pc(t))},warn:t=>{!gc.mute&&console.warn(pc(t))},error:t=>{!gc.mute&&console.error(pc(t))}};function vc(t){const{theme:e}=t;if(!e)return{};return fc(hc.THEME,e)||(gc.warn(`The theme of ${e} is not registered.`),{})}function yc(t,e){if(Array.isArray(t)&&0===t.length)return null;const n=Array.isArray(t)?t[0]:t,i=Array.isArray(t)?t.slice(1):e||[];return new Proxy(n,{get:(t,e)=>"function"!=typeof t[e]||["onframe","onfinish"].includes(e)?"finished"===e?Promise.all([n.finished,...i.map((t=>t.finished))]):Reflect.get(t,e):(...n)=>{t[e](...n),i.forEach((t=>{var i;return null===(i=t[e])||void 0===i?void 0:i.call(t,...n)}))},set:(t,e,n)=>(["onframe","onfinish"].includes(e)||i.forEach((t=>{t[e]=n})),Reflect.set(t,e,n))})}function mc(t){const e=t.reduce(((t,e)=>(Object.entries(e).forEach((([e,n])=>{void 0===t[e]?t[e]=[n]:t[e].push(n)})),t)),{});Object.entries(e).forEach((([n,i])=>{(i.length!==t.length||i.some((t=>ce(t)))||i.every((t=>!["sourceNode","targetNode","childrenNode"].includes(n)&&Ku(t,i[0]))))&&delete e[n]}));const n=Object.entries(e).reduce(((t,[e,n])=>(n.forEach(((n,i)=>{t[i]?t[i][e]=n:t[i]={[e]:n}})),t)),[]);return 0!==t.length&&0===n.length&&n.push({_:0},{_:0}),n}function bc(t){switch(t){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function xc(t,e){const{animation:n}=t;if(!1===n||!1===e)return!1;const i=Object.assign({},Zu);return vn(n)&&Object.assign(i,n),vn(e)&&Object.assign(i,e),i}function Ec(t,e,n,i=[]){if(!i&&0===t&&0===e&&0===n)return null;if(Array.isArray(i)){let r=-1;const a=[];for(let o=0;o<i.length;o++){const s=i[o];if("translate"===s[0]){if(s[1]===t&&s[2]===e)return null;r=o,a.push(["translate",t,e])}else if("translate3d"===s[0]){if(s[1]===t&&s[2]===e&&s[3]===n)return null;r=o,a.push(["translate3d",t,e,null!=n?n:0])}else a.push(s)}return-1===r&&a.splice(0,0,le(n)?["translate3d",t,e,null!=n?n:0]:["translate",t,e]),0===a.length?null:a}const r=i?i.replace(/translate(3d)?\([^)]*\)/g,""):"";return 0===n?`translate(${t}, ${e})${r}`:`translate3d(${t}, ${e}, ${n})${r}`}const wc=(t,e,n)=>{if(!n.length)return null;const[i,r]=e;let a;const o=n.map((e=>{var{fields:n,shape:o,states:s}=e,l=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["fields","shape","states"]);const u=(e=>{var n;if(e){const a=t.getShape(e);if(!a)return null;const o=`get${Yu(e)}Style`,s=(null===(n=null==t?void 0:t[o])||void 0===n?void 0:n.bind(t))||(t=>t);return{shape:a,fromStyle:(null==s?void 0:s(i))||{},toStyle:(null==s?void 0:s(r))||{}}}return{shape:t,fromStyle:i,toStyle:r}})(o);if(!u)return null;const{shape:c,fromStyle:h,toStyle:d}=u,f=[{},{}];if(n.forEach((t=>{var e,n;Object.assign(f[0],{[t]:null!==(e=h[t])&&void 0!==e?e:bc(t)}),Object.assign(f[1],{[t]:null!==(n=d[t])&&void 0!==n?n:bc(t)})})),f.some((t=>Object.keys(t).some((t=>["x","y","z"].includes(t)))))){const{x:t=0,y:e=0,z:n,transform:i=""}=c.attributes||{};f.forEach((r=>{var a,o,s;r.transform=Ec(null!==(a=r.x)&&void 0!==a?a:t,null!==(o=r.y)&&void 0!==o?o:e,null!==(s=r.z)&&void 0!==s?s:n,i)}))}const p=c.animate(mc(f),l);return void 0===o&&(a=p),p})).filter(Boolean),s=a||(null==o?void 0:o[0]);return s?yc(s,o.filter((t=>t!=t))):null},kc=[{fields:["x","y"]}],Mc=kc,Sc=[{fields:["sourceNode","targetNode"]}],Nc=Sc,Tc=[{fields:["childrenNode","x","y"]}],Ac=Tc;var Oc=Object.prototype.hasOwnProperty;const Pc=function(t,e){if(!e||!$e(t))return{};for(var n,i={},r=gn(e)?e:function(t){return t[e]},a=0;a<t.length;a++){var o=t[a];n=r(o),Oc.call(i,n)?i[n].push(o):i[n]=[o]}return i},Cc=function(t,e,n){var i,r,a,o,s=0;n||(n={});var l=function(){s=!1===n.leading?0:Date.now(),i=null,o=t.apply(r,a),i||(r=a=null)},u=function(){var u=Date.now();s||!1!==n.leading||(s=u);var c=e-(u-s);return r=this,a=arguments,c<=0||c>e?(i&&(clearTimeout(i),i=null),s=u,o=t.apply(r,a),i||(r=a=null)):i||!1===n.trailing||(i=setTimeout(l,c)),o};return u.cancel=function(){clearTimeout(i),s=0,i=r=a=null},u};var Rc=function(t){if("object"!=typeof t||null===t)return t;var e;if($e(t)){e=[];for(var n=0,i=t.length;n<i;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Rc(t[n]):e[n]=t[n]}else for(var r in e={},t)"object"==typeof t[r]&&null!=t[r]?e[r]=Rc(t[r]):e[r]=t[r];return e};const Lc=Rc;function Dc(t){return t instanceof Float32Array||!(!Array.isArray(t)||2!==t.length&&3!==t.length)&&t.every((t=>"number"==typeof t))}function Ic(t,e,n){return t>=e&&t<=n}function _c(t=0){if(Array.isArray(t)){const[e=0,n=e,i=e,r=n]=t;return[e,n,i,r]}return[t,t,t,t]}function Bc(t=0){const e=_c(t);return e[0]+e[2]}function Fc(t){return t.max[0]-t.min[0]}function jc(t){return t.max[1]-t.min[1]}function Gc(t){return[Fc(t),jc(t)]}function zc(t,e){const n=Dc(t)?Vc(t):t.getShape("key").getBounds();return e?Wc(n,e):n}function Vc(t){const[e,n,i=0]=t,r=new ti;return r.setMinMax([e,n,i],[e,n,i]),r}function Wc(t,e){const[n,i,r,a]=_c(e),[o,s,l]=t.min,[u,c,h]=t.max,d=new ti;return d.setMinMax([o-a,s-n,l],[u+i,c+r,h]),d}function Uc(t){if(0===t.length)return new ti;if(1===t.length)return t[0];const e=new ti;e.setMinMax(t[0].min,t[0].max);for(let n=1;n<t.length;n++){const i=t[n];e.setMinMax([Math.min(e.min[0],i.min[0]),Math.min(e.min[1],i.min[1]),Math.min(e.min[2],i.min[2])],[Math.max(e.max[0],i.max[0]),Math.max(e.max[1],i.max[1]),Math.max(e.max[2],i.max[2])])}return e}function Hc(t,e){return Ic(t[0],e.min[0],e.max[0])&&Ic(t[1],e.min[1],e.max[1])}function Yc(t,e,n=!1){const{min:[i,r],max:[a,o]}=e,s=(t[1]===r||t[1]===o)&&(n||Ic(t[0],i,a)),l=(t[0]===i||t[0]===a)&&(n||Ic(t[1],r,o));return s||l}function $c(t,e){const{center:n}=e;return t[0]===n[0]&&t[1]===n[1]}function Xc(t,e){const[n,i]=t,[r,a]=e.min,[o,s]=e.max,l=n-r,u=o-n,c=i-a,h=s-i,d=Math.min(l,u,c,h);return d===l?"left":d===u?"right":d===c?"top":d===h?"bottom":"left"}function qc(t,e){const n=Lc(t);if(Hc(t,e))switch(Xc(t,e)){case"left":n[0]=e.min[0];break;case"right":n[0]=e.max[0];break;case"top":n[1]=e.min[1];break;case"bottom":n[1]=e.max[1]}else{const[i,r]=t,[a,o]=e.min,[s,l]=e.max;n[0]=Ic(i,a,s)?i:i<a?a:s,n[1]=Ic(r,o,l)?r:r<o?o:l}return n}var Kc=function(t,e){return t===e},Zc=function(){function t(t,e){void 0===e&&(e=null),this.value=t,this.next=e}return t.prototype.toString=function(t){return t?t(this.value):"".concat(this.value)},t}(),Qc=function(){function t(t){void 0===t&&(t=Kc),this.head=null,this.tail=null,this.compare=t}return t.prototype.prepend=function(t){var e=new Zc(t,this.head);return this.head=e,this.tail||(this.tail=e),this},t.prototype.append=function(t){var e=new Zc(t);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},t.prototype.delete=function(t){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,t);)e=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare(n.next.value,t)?(e=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,t)&&(this.tail=n),e},t.prototype.find=function(t){var e=t.value,n=void 0===e?void 0:e,i=t.callback,r=void 0===i?void 0:i;if(!this.head)return null;for(var a=this.head;a;){if(r&&r(a.value))return a;if(void 0!==n&&this.compare(a.value,n))return a;a=a.next}return null},t.prototype.deleteTail=function(){var t=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,t;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,t},t.prototype.deleteHead=function(){if(!this.head)return null;var t=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),t},t.prototype.fromArray=function(t){var e=this;return t.forEach((function(t){return e.append(t)})),this},t.prototype.toArray=function(){for(var t=[],e=this.head;e;)t.push(e),e=e.next;return t},t.prototype.reverse=function(){for(var t=this.head,e=null,n=null;t;)n=t.next,t.next=e,e=t,t=n;this.tail=this.head,this.head=e},t.prototype.toString=function(t){return void 0===t&&(t=void 0),this.toArray().map((function(e){return e.toString(t)})).toString()},t}();const Jc=Qc;!function(){function t(){this.linkedList=new Jc}t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},t.prototype.enqueue=function(t){this.linkedList.append(t)},t.prototype.dequeue=function(){var t=this.linkedList.deleteHead();return t?t.value:null},t.prototype.toString=function(t){return this.linkedList.toString(t)}}();var th=function(t,e,n){void 0===e&&(e=[]);var i=e.filter((function(e){return e.source===t||e.target===t}));return"target"===n?i.filter((function(e){return e.source===t})).map((function(t){return t.target})):"source"===n?i.filter((function(e){return e.target===t})).map((function(t){return t.source})):i.map((function(e){return e.source===t?e.target:e.source}))};const eh=function(t){var e={},n=t.nodes,i=void 0===n?[]:n,r=t.edges,a=void 0===r?[]:r;return i.forEach((function(t){e[t.id]={degree:0,inDegree:0,outDegree:0}})),a.forEach((function(t){e[t.source].degree++,e[t.source].outDegree++,e[t.target].degree++,e[t.target].inDegree++})),e};var nh={}.toString;const ih=function(t,e){return nh.call(t)==="[object "+e+"]"},rh=function(t){return ih(t,"Function")},ah=function(t){return Array.isArray?Array.isArray(t):ih(t,"Array")};Object.keys;var oh=Array.prototype;oh.splice,oh.indexOf,Array.prototype.splice;Object.prototype.hasOwnProperty;Number.isInteger&&Number.isInteger,Math.PI,Math.PI;const sh=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return function(t,e){var n,i;if(t)if(ah(t))for(var r=0,a=t.length;r<a&&!1!==e(t[r],r);r++);else if(i=typeof(n=t),null!==n&&"object"===i||"function"===i)for(var o in t)if(t.hasOwnProperty(o)&&!1===e(t[o],o))break}(t,(function(n,i){rh(t)&&"prototype"===i||e.push(n)})),e};Object.prototype;var lh=function(t){if("object"!=typeof t||null===t)return t;var e;if(ah(t)){e=[];for(var n=0,i=t.length;n<i;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=lh(t[n]):e[n]=t[n]}else for(var r in e={},t)"object"==typeof t[r]&&null!=t[r]?e[r]=lh(t[r]):e[r]=t[r];return e};const uh=lh;var ch;Object.prototype.hasOwnProperty,Object.prototype.hasOwnProperty,function(t,e){if(!rh(t))throw new TypeError("Expected a function");var n=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var a=e?e.apply(this,i):i[0],o=n.cache;if(o.has(a))return o.get(a);var s=t.apply(this,i);return o.set(a,s),s};n.cache=new Map}((function(t,e){void 0===e&&(e={});var n,i=e.fontSize,r=e.fontFamily,a=e.fontWeight,o=e.fontStyle,s=e.fontVariant;return ch||(ch=document.createElement("canvas").getContext("2d")),ch.font=[o,s,a,i+"px",r].join(" "),ch.measureText((n=t,ih(n,"String")?t:"")).width}),(function(t,e){return void 0===e&&(e={}),function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,r++)i[r]=a[o];return i}([t],sh(e)).join("")})),function(){function t(){this.map={}}t.prototype.has=function(t){return void 0!==this.map[t]},t.prototype.get=function(t,e){var n=this.map[t];return void 0===n?e:n},t.prototype.set=function(t,e){this.map[t]=e},t.prototype.clear=function(){this.map={}},t.prototype.delete=function(t){delete this.map[t]},t.prototype.size=function(){return Object.keys(this.map).length}}();function hh(t,e,n,i){if(t===e)return[t];if(i[e])return i[e];for(var r=[],a=0,o=n[e];a<o.length;a++){var s=hh(t,o[a],n,i);if(!s)return;for(var l=0,u=s;l<u.length;l++){var c=u[l];ah(c)?r.push(xe(xe([],c,!0),[e],!1)):r.push([c,e])}}return i[e]=r,i[e]}var dh,fh=function(t,e,n,i,r){var a=function(t,e,n,i){var r=t.nodes,a=void 0===r?[]:r,o=t.edges,s=void 0===o?[]:o,l=[],u={},c={},h={};a.forEach((function(t,n){var i=t.id;l.push(i),c[i]=1/0,i===e&&(c[i]=0)}));for(var d=a.length,f=function(t){var e=function(t,e,n){for(var i,r=1/0,a=0;a<e.length;a++){var o=e[a].id;!n[o]&&t[o]<=r&&(r=t[o],i=e[a])}return i}(c,a,u),r=e.id;if(u[r]=!0,c[r]===1/0)return"continue";var o=[];o=n?function(t,e){return e.filter((function(e){return e.source===t}))}(r,s):function(t,e){return e.filter((function(e){return e.source===t||e.target===t}))}(r,s),o.forEach((function(t){var n=t.target,a=t.source,o=n===r?a:n,s=i&&t[i]?t[i]:1;c[o]>c[e.id]+s?(c[o]=c[e.id]+s,h[o]=[e.id]):c[o]===c[e.id]+s&&h[o].push(e.id)}))},p=0;p<d;p++)f();h[e]=[e];var g={};for(var v in c)c[v]!==1/0&&hh(e,v,h,g);var y={};for(var v in g)y[v]=g[v][0];return{length:c,path:y,allPath:g}}(t,e,i,r),o=a.length,s=a.path,l=a.allPath;return{length:o[n],path:s[n],allPath:l[n]}};!function(){function t(t){this.arr=t}t.prototype.getArr=function(){return this.arr||[]},t.prototype.add=function(e){var n,i=e.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new t(i);if(!(null==i?void 0:i.length))return new t(this.arr);if(this.arr.length===i.length){var r=[];for(var a in this.arr)r[a]=this.arr[a]+i[a];return new t(r)}},t.prototype.subtract=function(e){var n,i=e.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new t(i);if(!(null==i?void 0:i.length))return new t(this.arr);if(this.arr.length===i.length){var r=[];for(var a in this.arr)r[a]=this.arr[a]-i[a];return new t(r)}},t.prototype.avg=function(e){var n=[];if(0!==e)for(var i in this.arr)n[i]=this.arr[i]/e;return new t(n)},t.prototype.negate=function(){var e=[];for(var n in this.arr)e[n]=-this.arr[n];return new t(e)},t.prototype.squareEuclideanDistance=function(t){var e,n=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var i=0;for(var r in this.arr)i+=Math.pow(this.arr[r]-t.arr[r],2);return i}},t.prototype.euclideanDistance=function(t){var e,n=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var i=0;for(var r in this.arr)i+=Math.pow(this.arr[r]-t.arr[r],2);return Math.sqrt(i)}console.error("The two vectors are unequal in length.")},t.prototype.normalize=function(){var e=[],n=uh(this.arr);n.sort((function(t,e){return t-e}));var i=n[n.length-1],r=n[0];for(var a in this.arr)e[a]=(this.arr[a]-r)/(i-r);return new t(e)},t.prototype.norm2=function(){var t;if(!(null===(t=this.arr)||void 0===t?void 0:t.length))return 0;var e=0;for(var n in this.arr)e+=Math.pow(this.arr[n],2);return Math.sqrt(e)},t.prototype.dot=function(t){var e,n=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var i=0;for(var r in this.arr)i+=this.arr[r]*t.arr[r];return i}console.error("The two vectors are unequal in length.")},t.prototype.equal=function(t){var e,n=t.arr;if((null===(e=this.arr)||void 0===e?void 0:e.length)!==(null==n?void 0:n.length))return!1;for(var i in this.arr)if(this.arr[i]!==n[i])return!1;return!0}}(),function(t){t.EuclideanDistance="euclideanDistance"}(dh||(dh={})),function(){function t(t){this.count=t.length,this.parent={};for(var e=0,n=t;e<n.length;e++){var i=n[e];this.parent[i]=i}}t.prototype.find=function(t){for(;this.parent[t]!==t;)t=this.parent[t];return t},t.prototype.union=function(t,e){var n=this.find(t),i=this.find(e);n!==i&&(n<i?(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]):(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]))},t.prototype.connected=function(t,e){return this.find(t)===this.find(e)}}();var ph=function(t,e){return t-e};!function(){function t(t){void 0===t&&(t=ph),this.compareFn=t,this.list=[]}t.prototype.getLeft=function(t){return 2*t+1},t.prototype.getRight=function(t){return 2*t+2},t.prototype.getParent=function(t){return 0===t?null:Math.floor((t-1)/2)},t.prototype.isEmpty=function(){return this.list.length<=0},t.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},t.prototype.delMin=function(){var t=this.top(),e=this.list.pop();return this.list.length>0&&(this.list[0]=e,this.moveDown(0)),t},t.prototype.insert=function(t){if(null!==t){this.list.push(t);var e=this.list.length-1;return this.moveUp(e),!0}return!1},t.prototype.moveUp=function(t){for(var e=this.getParent(t);t&&t>0&&this.compareFn(this.list[e],this.list[t])>0;){var n=this.list[e];this.list[e]=this.list[t],this.list[t]=n,t=e,e=this.getParent(t)}},t.prototype.moveDown=function(t){var e,n=t,i=this.getLeft(t),r=this.getRight(t),a=this.list.length;null!==i&&i<a&&this.compareFn(this.list[n],this.list[i])>0?n=i:null!==r&&r<a&&this.compareFn(this.list[n],this.list[r])>0&&(n=r),t!==n&&(e=[this.list[n],this.list[t]],this.list[t]=e[0],this.list[n]=e[1],this.moveDown(n))}}();var gh="-1",vh=function(t,e,n,i){void 0===t&&(t=-1),void 0===e&&(e=-1),void 0===n&&(n=-1),void 0===i&&(i="-1"),this.id=t,this.from=e,this.to=n,this.label=i},yh=function(){function t(t,e){void 0===t&&(t=-1),void 0===e&&(e=gh),this.id=t,this.label=e,this.edges=[],this.edgeMap={}}return t.prototype.addEdge=function(t){this.edges.push(t),this.edgeMap[t.id]=t},t}(),mh=function(){function t(t,e,n){void 0===t&&(t=-1),void 0===e&&(e=!0),void 0===n&&(n=!1),this.id=t,this.edgeIdAutoIncrease=e,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=n}return t.prototype.getNodeNum=function(){return this.nodes.length},t.prototype.addNode=function(t,e){if(!this.nodeMap[t]){var n=new yh(t,e);this.nodes.push(n),this.nodeMap[t]=n,this.nodeLabelMap[e]||(this.nodeLabelMap[e]=[]),this.nodeLabelMap[e].push(t)}},t.prototype.addEdge=function(t,e,n,i){if((this.edgeIdAutoIncrease||void 0===t)&&(t=this.counter++),!(this.nodeMap[e]&&this.nodeMap[n]&&this.nodeMap[n].edgeMap[t])){var r=new vh(t,e,n,i);if(this.edges.push(r),this.edgeMap[t]=r,this.nodeMap[e].addEdge(r),this.edgeLabelMap[i]||(this.edgeLabelMap[i]=[]),this.edgeLabelMap[i].push(r),!this.directed){var a=new vh(t,n,e,i);this.nodeMap[n].addEdge(a),this.edgeLabelMap[i].push(a)}}},t}(),bh=function(){function t(t,e,n,i,r){this.fromNode=t,this.toNode=e,this.nodeEdgeNodeLabel={nodeLabel1:n||gh,edgeLabel:i||"-1",nodeLabel2:r||gh}}return t.prototype.equalTo=function(t){return this.fromNode===t.formNode&&this.toNode===t.toNode&&this.nodeEdgeNodeLabel===t.nodeEdgeNodeLabel},t.prototype.notEqualTo=function(t){return!this.equalTo(t)},t}(),xh=function(){function t(){this.rmpath=[],this.dfsEdgeList=[]}return t.prototype.equalTo=function(t){var e=this.dfsEdgeList.length;if(e!==t.length)return!1;for(var n=0;n<e;n++)if(this.dfsEdgeList[n]!==t[n])return!1;return!0},t.prototype.notEqualTo=function(t){return!this.equalTo(t)},t.prototype.pushBack=function(t,e,n,i,r){return this.dfsEdgeList.push(new bh(t,e,n,i,r)),this.dfsEdgeList},t.prototype.toGraph=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var n=new mh(t,!0,e);return this.dfsEdgeList.forEach((function(t){var e=t.fromNode,i=t.toNode,r=t.nodeEdgeNodeLabel,a=r.nodeLabel1,o=r.edgeLabel,s=r.nodeLabel2;a!==gh&&n.addNode(e,a),s!==gh&&n.addNode(i,s),a!==gh&&s!==a&&n.addEdge(void 0,e,i,o)})),n},t.prototype.buildRmpath=function(){this.rmpath=[];for(var t=void 0,e=this.dfsEdgeList.length-1;e>=0;e--){var n=this.dfsEdgeList[e],i=n.fromNode,r=n.toNode;i<r&&(void 0===t||r===t)&&(this.rmpath.push(e),t=i)}return this.rmpath},t.prototype.getNodeNum=function(){var t={};return this.dfsEdgeList.forEach((function(e){t[e.fromNode]||(t[e.fromNode]=!0),t[e.toNode]||(t[e.toNode]=!0)})),Object.keys(t).length},t}(),Eh=function(){function t(t){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],t){for(;t;){var e=t.edge;this.edges.push(e),this.nodesUsed[e.from]=1,this.nodesUsed[e.to]=1,this.edgesUsed[e.id]=1,t=t.preNode}this.edges=this.edges.reverse()}}return t.prototype.hasNode=function(t){return 1===this.nodesUsed[t.id]},t.prototype.hasEdge=function(t){return 1===this.edgesUsed[t.id]},t}();function wh(t){if(void 0!==t.id)return t.id;if(void 0!==t.source&&void 0!==t.target)return`${t.source}-${t.target}`;throw new Error(pc("The datum does not have available id."))}function kh(t){return t.combo}function Mh(t,e){const n={nodes:(t.nodes||[]).map(wh),edges:(t.edges||[]).map(wh),combos:(t.combos||[]).map(wh)};return e?Object.values(n).flat():n}!function(){function t(t){var e=t.graphs,n=t.minSupport,i=void 0===n?2:n,r=t.minNodeNum,a=void 0===r?1:r,o=t.maxNodeNum,s=void 0===o?4:o,l=t.top,u=void 0===l?10:l,c=t.directed,h=void 0!==c&&c,d=t.verbose,f=void 0!==d&&d;this.graphs=e,this.dfsCode=new xh,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=i,this.top=u,this.directed=h,this.counter=0,this.maxNodeNum=s,this.minNodeNum=a,this.verbose=f,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}t.prototype.findForwardRootEdges=function(t,e){var n=this,i=[],r=t.nodeMap;return e.edges.forEach((function(t){(n.directed||e.label<=r[t.to].label)&&i.push(t)})),i},t.prototype.findBackwardEdge=function(t,e,n,i){if(!this.directed&&e===n)return null;for(var r=t.nodeMap,a=r[n.to].edges,o=a.length,s=0;s<o;s++){var l=a[s];if(!i.hasEdge(l)&&l.to===e.from)if(this.directed){if(r[e.from].label<r[n.to].label||r[e.from].label===r[n.to].label&&e.label<=l.label)return l}else if(e.label<l.label||e.label===l.label&&r[e.to].label<=r[n.to].label)return l}return null},t.prototype.findForwardPureEdges=function(t,e,n,i){for(var r=[],a=e.to,o=t.nodeMap[a].edges,s=o.length,l=0;l<s;l++){var u=o[l],c=t.nodeMap[u.to];n<=c.label&&!i.hasNode(c)&&r.push(u)}return r},t.prototype.findForwardRmpathEdges=function(t,e,n,i){for(var r=[],a=t.nodeMap,o=a[e.to].label,s=a[e.from].edges,l=s.length,u=0;u<l;u++){var c=s[u],h=a[c.to].label;e.to===c.to||n>h||i.hasNode(a[c.to])||(e.label<c.label||e.label===c.label&&o<=h)&&r.push(c)}return r},t.prototype.getSupport=function(t){var e={};return t.forEach((function(t){e[t.graphId]||(e[t.graphId]=!0)})),Object.keys(e).length},t.prototype.findMinLabel=function(t){var e=void 0;return Object.keys(t).forEach((function(n){var i=t[n],r=i.nodeLabel1,a=i.edgeLabel,o=i.nodeLabel2;e?(r<e.nodeLabel1||r===e.nodeLabel1&&a<e.edgeLabel||r===e.nodeLabel1&&a===e.edgeLabel&&o<e.nodeLabel2)&&(e={nodeLabel1:r,edgeLabel:a,nodeLabel2:o}):e={nodeLabel1:r,edgeLabel:a,nodeLabel2:o}})),e},t.prototype.isMin=function(){var t=this,e=this.dfsCode;if(this.verbose&&console.log("isMin checking",e),1===e.dfsEdgeList.length)return!0;var n=this.directed,i=e.toGraph(-1,n),r=i.nodeMap,a=new xh,o={};i.nodes.forEach((function(e){t.findForwardRootEdges(i,e).forEach((function(t){var n=r[t.to],a="".concat(e.label,"-").concat(t.label,"-").concat(n.label);o[a]||(o[a]={projected:[],nodeLabel1:e.label,edgeLabel:t.label,nodeLabel2:n.label});var s={graphId:i.id,edge:t,preNode:null};o[a].projected.push(s)}))}));var s=this.findMinLabel(o);if(s){a.dfsEdgeList.push(new bh(0,1,s.nodeLabel1,s.edgeLabel,s.nodeLabel2));var l="".concat(s.nodeLabel1,"-").concat(s.edgeLabel,"-").concat(s.nodeLabel2);return function o(s){for(var l=a.buildRmpath(),u=a.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,c=a.dfsEdgeList[l[0]].toNode,h={},d=!1,f=0,p=n?-1:0,g=function(e){if(d)return"break";s.forEach((function(n){var r=new Eh(n),o=t.findBackwardEdge(i,r.edges[l[e]],r.edges[l[0]],r);o&&(h[o.label]||(h[o.label]={projected:[],edgeLabel:o.label}),h[o.label].projected.push({graphId:i.id,edge:h,preNode:n}),f=a.dfsEdgeList[l[e]].fromNode,d=!0)}))},v=l.length-1;v>p&&"break"!==g(v);v--);if(d){var y=t.findMinLabel(h);a.dfsEdgeList.push(new bh(c,f,gh,y.edgeLabel,gh));var m=a.dfsEdgeList.length-1;return t.dfsCode.dfsEdgeList[m]===a.dfsEdgeList[m]&&o(h[y.edgeLabel].projected)}var b={};d=!1;var x=0;s.forEach((function(e){var n=new Eh(e),a=t.findForwardPureEdges(i,n.edges[l[0]],u,n);a.length>0&&(d=!0,x=c,a.forEach((function(t){var n="".concat(t.label,"-").concat(r[t.to].label);b[n]||(b[n]={projected:[],edgeLabel:t.label,nodeLabel2:r[t.to].label}),b[n].projected.push({graphId:i.id,edge:t,preNode:e})})))}));var E=l.length,w=function(e){if(d)return"break";var n=l[e];s.forEach((function(e){var o=new Eh(e),s=t.findForwardRmpathEdges(i,o.edges[n],u,o);s.length>0&&(d=!0,x=a.dfsEdgeList[n].fromNode,s.forEach((function(t){var n="".concat(t.label,"-").concat(r[t.to].label);b[n]||(b[n]={projected:[],edgeLabel:t.label,nodeLabel2:r[t.to].label}),b[n].projected.push({graphId:i.id,edge:t,preNode:e})})))}))};for(v=0;v<E&&"break"!==w(v);v++);if(!d)return!0;var k=t.findMinLabel(b);a.dfsEdgeList.push(new bh(x,c+1,gh,k.edgeLabel,k.nodeLabel2));var M=a.dfsEdgeList.length-1;return e.dfsEdgeList[M]===a.dfsEdgeList[M]&&o(b["".concat(k.edgeLabel,"-").concat(k.nodeLabel2)].projected)}(o[l].projected)}},t.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var t=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(uh(t))}},t.prototype.subGraphMining=function(t){var e=this;if(!(this.getSupport(t)<this.minSupport)&&this.isMin()){this.report();var n=this.dfsCode.getNodeNum(),i=this.dfsCode.buildRmpath(),r=this.dfsCode.dfsEdgeList[i[0]].toNode,a=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,o={},s={};t.forEach((function(t){for(var l=e.graphs[t.graphId],u=l.nodeMap,c=new Eh(t),h=i.length-1;h>=0;h--){var d=e.findBackwardEdge(l,c.edges[i[h]],c.edges[i[0]],c);if(d){var f="".concat(e.dfsCode.dfsEdgeList[i[h]].fromNode,"-").concat(d.label);s[f]||(s[f]={projected:[],toNodeId:e.dfsCode.dfsEdgeList[i[h]].fromNode,edgeLabel:d.label}),s[f].projected.push({graphId:t.graphId,edge:d,preNode:t})}}if(!(n>=e.maxNodeNum)){e.findForwardPureEdges(l,c.edges[i[0]],a,c).forEach((function(e){var n="".concat(r,"-").concat(e.label,"-").concat(u[e.to].label);o[n]||(o[n]={projected:[],fromNodeId:r,edgeLabel:e.label,nodeLabel2:u[e.to].label}),o[n].projected.push({graphId:t.graphId,edge:e,preNode:t})}));var p=function(n){e.findForwardRmpathEdges(l,c.edges[i[n]],a,c).forEach((function(r){var a="".concat(e.dfsCode.dfsEdgeList[i[n]].fromNode,"-").concat(r.label,"-").concat(u[r.to].label);o[a]||(o[a]={projected:[],fromNodeId:e.dfsCode.dfsEdgeList[i[n]].fromNode,edgeLabel:r.label,nodeLabel2:u[r.to].label}),o[a].projected.push({graphId:t.graphId,edge:r,preNode:t})}))};for(h=0;h<i.length;h++)p(h)}})),Object.keys(s).forEach((function(t){var n=s[t],i=n.toNodeId,a=n.edgeLabel;e.dfsCode.dfsEdgeList.push(new bh(r,i,"-1",a,"-1")),e.subGraphMining(s[t].projected),e.dfsCode.dfsEdgeList.pop()})),Object.keys(o).forEach((function(t){var n=o[t],i=n.fromNodeId,a=n.edgeLabel,s=n.nodeLabel2;e.dfsCode.dfsEdgeList.push(new bh(i,r+1,gh,a,s)),e.subGraphMining(o[t].projected),e.dfsCode.dfsEdgeList.pop()}))}},t.prototype.generate1EdgeFrequentSubGraphs=function(){var t=this.graphs,e=this.directed,n=this.minSupport,i=this.frequentSize1Subgraphs,r={},a={},o={},s={};return Object.keys(t).forEach((function(n){var i=t[n],l=i.nodeMap;i.nodes.forEach((function(t,i){var u=t.label,c="".concat(n,"-").concat(u);if(!o[c]){var h=r[u]||0;h++,r[u]=h}o[c]={graphKey:n,label:u},t.edges.forEach((function(t){var i=u,r=l[t.to].label;if(!e&&i>r){var o=r;r=i,i=o}var c=t.label,h="".concat(n,"-").concat(i,"-").concat(c,"-").concat(r),d="".concat(i,"-").concat(c,"-").concat(r);if(!a[d]){var f=a[d]||0;f++,a[d]=f}s[h]={graphId:n,nodeLabel1:i,edgeLabel:c,nodeLabel2:r}}))}))})),Object.keys(r).forEach((function(t){if(!(r[t]<n)){var e={nodes:[],edges:[]};e.nodes.push({id:"0",label:t}),i.push(e)}})),i},t.prototype.run=function(){var t=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var e=this.graphs,n=(this.directed,{});Object.keys(e).forEach((function(i){var r=e[i],a=r.nodeMap;r.nodes.forEach((function(e){t.findForwardRootEdges(r,e).forEach((function(t){var r=a[t.to],o="".concat(e.label,"-").concat(t.label,"-").concat(r.label);n[o]||(n[o]={projected:[],nodeLabel1:e.label,edgeLabel:t.label,nodeLabel2:r.label});var s={graphId:i,edge:t,preNode:null};n[o].projected.push(s)}))}))})),Object.keys(n).forEach((function(e){var i=n[e],r=i.projected,a=i.nodeLabel1,o=i.edgeLabel,s=i.nodeLabel2;t.dfsCode.dfsEdgeList.push(new bh(0,1,a,o,s)),t.subGraphMining(r),t.dfsCode.dfsEdgeList.pop()}))}}}(),function(){function t(t){void 0===t&&(t=10),this.linkedList=new Jc,this.maxStep=t}Object.defineProperty(t.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},t.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},t.prototype.push=function(t){this.linkedList.prepend(t),this.length>this.maxStep&&this.linkedList.deleteTail()},t.prototype.pop=function(){var t=this.linkedList.deleteHead();return t?t.value:null},t.prototype.toArray=function(){return this.linkedList.toArray().map((function(t){return t.value}))},t.prototype.clear=function(){for(;!this.isEmpty();)this.pop()}}();const Sh=(t,e,n)=>{var i;switch(n.type){case"degree":{const r=new Map;return null===(i=t.nodes)||void 0===i||i.forEach((t=>{const i=e(wh(t),n.direction).length;r.set(wh(t),i)})),r}case"betweenness":return Th(t,n.directed,n.weightPropertyName);case"closeness":return Ah(t,n.directed,n.weightPropertyName);case"eigenvector":return Ph(t,n.directed);case"pagerank":return Oh(t,n.epsilon,n.linkProb);default:return Nh(t)}},Nh=t=>{var e;const n=new Map;return null===(e=t.nodes)||void 0===e||e.forEach((t=>{n.set(wh(t),0)})),n},Th=(t,e,n)=>{const i=Nh(t),{nodes:r=[]}=t;return r.forEach((a=>{r.forEach((r=>{if(a!==r){const{allPath:o}=fh(t,wh(a),wh(r),e,n),s=o.length;o.flat().forEach((t=>{t!==wh(a)&&t!==wh(r)&&i.set(t,i.get(t)+1/s)}))}}))})),i},Ah=(t,e,n)=>{const i=new Map,{nodes:r=[]}=t;return r.forEach((a=>{const o=r.reduce(((i,r)=>{if(a!==r){const{length:o}=fh(t,wh(a),wh(r),e,n);i+=o}return i}),0);i.set(wh(a),1/o)})),i},Oh=(t,e,n)=>{var i;const r=new Map,a=function(t,e,n){"number"!=typeof e&&(e=1e-6),"number"!=typeof n&&(n=.85);for(var i,r=1,a=0,o=1e3,s=t.nodes,l=void 0===s?[]:s,u=t.edges,c=void 0===u?[]:u,h=l.length,d={},f={},p=0;p<h;++p)d[v=(E=l[p]).id]=1/h,f[v]=1/h;for(var g=eh(t);o>0&&r>e;){for(a=0,p=0;p<h;++p){var v=(E=l[p]).id;if(i=0,0===g[E.id].inDegree)d[v]=0;else{for(var y=th(v,c,"source"),m=0;m<y.length;++m){var b=y[m],x=g[b].outDegree;x>0&&(i+=f[b]/x)}d[v]=n*i,a+=d[v]}}for(a=(1-a)/h,r=0,p=0;p<h;++p){var E;i=d[v=(E=l[p]).id]+a,r+=Math.abs(i-f[v]),f[v]=i}o-=1}return f}(t,e,n);return null===(i=t.nodes)||void 0===i||i.forEach((t=>{r.set(wh(t),a[wh(t)])})),r},Ph=(t,e)=>{const{nodes:n=[]}=t,i=Ch(t,e),r=Rh(i,n.length),a=new Map;return n.forEach(((t,e)=>{a.set(wh(t),r[e])})),a},Ch=(t,e)=>{const{nodes:n=[],edges:i=[]}=t,r=Array(n.length).fill(null).map((()=>Array(n.length).fill(0)));return i.forEach((({source:t,target:i})=>{const a=n.findIndex((e=>wh(e)===t)),o=n.findIndex((t=>wh(t)===i));e?r[a][o]=1:(r[a][o]=1,r[o][a]=1)})),r},Rh=(t,e,n=100,i=1e-6)=>{let r=Array(e).fill(1),a=1/0;for(let o=0;o<n&&a>i;o++){const n=Array(e).fill(0);for(let i=0;i<e;i++)for(let a=0;a<e;a++)n[i]+=t[i][a]*r[a];const i=Math.sqrt(n.reduce(((t,e)=>t+e*e),0));for(let t=0;t<e;t++)n[t]/=i;a=Math.sqrt(n.reduce(((t,e,n)=>t+(e-r[n])*e),0)),r=n}return r};function Lh(t,e,n,i=Ku){const r=new Map(t.map((t=>[n(t),t]))),a=new Map(e.map((t=>[n(t),t]))),o=new Set(r.keys()),s=new Set(a.keys()),l=[],u=[],c=[],h=[];return s.forEach((t=>{o.has(t)?i(r.get(t),a.get(t))?h.push(a.get(t)):u.push(a.get(t)):l.push(a.get(t))})),o.forEach((t=>{s.has(t)||c.push(r.get(t))})),{enter:l,exit:c,keep:h,update:u}}function Dh(t,e,n){t.forEach((t=>{(t=>{n&&!n(t)||(t.style.visibility=e)})(t)}))}class Ih{constructor(t){this.extensions=[],this.extensionMap={},this.context=t}setExtensions(t){const e=function(t,e,n){const i={},r=t=>(t in i||(i[t]=0),`${e}-${t}-${i[t]++}`);return n.map((e=>"string"==typeof e?{type:e,key:r(e)}:"function"==typeof e?e.call(t):e.key?e:Object.assign(Object.assign({},e),{key:r(e.type)})))}(this.context.graph,this.category,t),{enter:n,update:i,exit:r,keep:a}=Lh(this.extensions,e,(t=>t.key));this.createExtensions(n),this.updateExtensions([...i,...a]),this.destroyExtensions(r),this.extensions=e}createExtension(t){const{category:e}=this,{key:n,type:i}=t,r=fc(e,i);if(!r)return gc.warn(`The extension ${i} of ${e} is not registered.`);const a=new r(this.context,t);a.initialized=!0,this.extensionMap[n]=a}createExtensions(t){t.forEach((t=>this.createExtension(t)))}updateExtension(t){const{key:e}=t,n=this.extensionMap[e];n&&n.update(t)}updateExtensions(t){t.forEach((t=>this.updateExtension(t)))}destroyExtension(t){const e=this.extensionMap[t];e&&(e.initialized&&!e.destroyed&&e.destroy(),delete this.extensionMap[t])}destroyExtensions(t){t.forEach((({key:t})=>this.destroyExtension(t)))}destroy(){this.destroyExtensions(this.extensions),this.context={},this.extensions=[],this.extensionMap={}}}class _h{constructor(t,e){this.events=[],this.initialized=!1,this.destroyed=!1,this.context=t,this.options=e}update(t){this.options=Object.assign(this.options,t)}destroy(){this.context={},this.options={},this.destroyed=!0}}class Bh extends _h{}class Fh extends Bh{constructor(t,e){super(t,Object.assign({},Fh.defaultOptions,e)),this.isOverlapping=(t,e)=>e.some((e=>t.intersects(e))),this.occupiedBounds=[],this.detectLabelCollision=t=>{const e=this.context.viewport,n={show:[],hide:[]};return this.occupiedBounds=[],t.forEach((t=>{const i=t.getShape("label").getRenderBounds();e.isInViewport(i,!0)&&!this.isOverlapping(i,this.occupiedBounds)?(n.show.push(t),this.occupiedBounds.push(Wc(i,this.options.padding))):n.hide.push(t)})),n},this.hideLabelIfExceedViewport=(t,e)=>{const{exit:n}=Lh(t,e,(t=>t.id));null==n||n.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(t,e)=>{const{model:n}=this.context,i=n.getData(),r=n.getRelatedEdgesData.bind(n);return t.map((t=>(this.nodeCentralities.has(t.id)||(this.nodeCentralities=Sh(i,r,e)),{node:t,centrality:this.nodeCentralities.get(t.id)}))).sort(((t,e)=>e.centrality-t.centrality)).map((t=>t.node))},this.sortLabelElementsInView=t=>{const{sort:e,sortNode:n,sortCombo:i,sortEdge:r}=this.options,{model:a}=this.context;if(gn(e))return t.sort(((t,n)=>e(a.getElementDataById(t.id),a.getElementDataById(n.id))));const{node:o=[],edge:s=[],combo:l=[]}=Pc(t,(t=>t.type));return[...gn(i)?l.sort(((t,e)=>i(...a.getComboData([t.id,e.id])))):l,...gn(n)?o.sort(((t,e)=>n(...a.getNodeData([t.id,e.id])))):this.sortNodesByCentrality(o,n),...gn(r)?s.sort(((t,e)=>r(...a.getEdgeData([t.id,e.id])))):s]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=t=>{var e;if("zIndex"===(null===(e=t.data)||void 0===e?void 0:e.stage))return;if(!this.validate(t))return void(this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear()));const n=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,n),this.labelElementsInView=n;const i=this.sortLabelElementsInView(this.labelElementsInView),{show:r,hide:a}=this.detectLabelCollision(i);for(let t=r.length-1;t>=0;t--)this.showLabel(r[t]);a.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=t=>{const e=t.getShape("label");e&&Dh(e,"hidden"),this.hiddenElements.set(t.id,t)},this.showLabel=t=>{const e=t.getShape("label");e&&Dh(e,"visible"),t.toFront(),this.hiddenElements.delete(t.id)},this.onTransform=Cc(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=t=>{this.enableToggle&&this.onToggleVisibility(t)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=t=>{this.onToggleVisibility(t),this.enableToggle=!0},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){const{elementMap:t}=this.context.element,e=[];for(const n in t){const i=t[n];i.isVisible()&&i.getShape("label")&&e.push(i)}return e}getLabelElementsInView(){const t=this.context.viewport;return this.getLabelElements().filter((e=>t.isInViewport(e.getShape("key").getRenderBounds())))}bindEvents(){const{graph:t}=this.context;t.on(oc.BEFORE_RENDER,this.onBeforeRender),t.on(oc.AFTER_RENDER,this.onAfterRender),t.on(oc.AFTER_DRAW,this.toggle),t.on(oc.AFTER_LAYOUT,this.toggle),t.on(oc.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(oc.BEFORE_RENDER,this.onBeforeRender),t.off(oc.AFTER_RENDER,this.onAfterRender),t.off(oc.AFTER_DRAW,this.toggle),t.off(oc.AFTER_LAYOUT,this.toggle),t.off(oc.AFTER_TRANSFORM,this.onTransform)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}Fh.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};const jh=function(t){if(!$u(t)||!fn(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};function Gh(t,e){if(Object.hasOwn)return Object.hasOwn(t,e);if(null==t)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)}function zh(t,e,n,i){for(var r in n=n||0,i=i||5,e)if(Gh(e,r)){var a=e[r];null!==a&&jh(a)?(jh(t[r])||(t[r]={}),n<i?zh(t[r],a,n+1,i):t[r]=e[r]):$e(a)?(t[r]=[],t[r]=t[r].concat(a)):void 0!==a&&(t[r]=a)}}const Vh=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0;i<e.length;i+=1)zh(t,e[i]);return t},Wh=[0,0,0];function Uh(t,e){return t.map(((t,n)=>t+e[n]))}function Hh(t,e){return t.map(((t,n)=>t-e[n]))}function Yh(t,e){return"number"==typeof e?t.map((t=>t*e)):t.map(((t,n)=>t*e[n]))}function $h(t,e){return"number"==typeof e?t.map((t=>t/e)):t.map(((t,n)=>t/e[n]))}function Xh(t,e){return t.map((t=>t*e))}function qh(t,e){return Math.sqrt(t.reduce(((t,n,i)=>t+Math.pow(n-e[i]||0,2)),0))}function Kh(t,e){return t.reduce(((t,n,i)=>t+Math.abs(n-e[i])),0)}function Zh(t){const e=t.reduce(((t,e)=>t+Math.pow(e,2)),0);return t.map((t=>t/Math.sqrt(e)))}function Qh(t,e,n=!1){const i=t[0]*e[1]-t[1]*e[0];let r=Math.acos(Yh(t,e).reduce(((t,e)=>t+e),0)/(qh(t,Wh)*qh(e,Wh)));return n&&i<0&&(r=2*Math.PI-r),r}function Jh(t,e=!0){return e?[-t[1],t[0]]:[t[1],-t[0]]}function td(t,e){return t.map((t=>t%e))}function ed(t){return[t[0],t[1]]}function nd(t){return 2===t.length?[t[0],t[1],0]:t}function id(t){const[e,n]=t;return e||n?Math.atan2(n,e):0}function rd(t,e){const[n,i]=t,[r,a]=e;return function(t,e){const n=nd(t),i=nd(e);return[n[1]*i[2]-n[2]*i[1],n[2]*i[0]-n[0]*i[2],n[0]*i[1]-n[1]*i[0]]}(Hh(n,i),Hh(r,a)).every((t=>0===t))}function ad(t,e,n=!1){if(rd(t,e))return;const[i,r]=t,[a,o]=e,s=((i[0]-a[0])*(a[1]-o[1])-(i[1]-a[1])*(a[0]-o[0]))/((i[0]-r[0])*(a[1]-o[1])-(i[1]-r[1])*(a[0]-o[0])),l=o[0]-a[0]?(i[0]-a[0]+s*(r[0]-i[0]))/(o[0]-a[0]):(i[1]-a[1]+s*(r[1]-i[1]))/(o[1]-a[1]);return n||Ic(s,0,1)&&Ic(l,0,1)?[i[0]+s*(r[0]-i[0]),i[1]+s*(r[1]-i[1])]:void 0}function od(t){if(Array.isArray(t))return Ic(t[0],0,1)&&Ic(t[1],0,1)?t:[.5,.5];const e=t.split("-");return[e.includes("left")?0:e.includes("right")?1:.5,e.includes("top")?0:e.includes("bottom")?1:.5]}function sd(t){const{x:e=0,y:n=0,z:i=0}=t.style||{};return[+e,+n,+i]}function ld(t){const{x:e,y:n,z:i}=t.style||{};return void 0!==e||void 0!==n||void 0!==i}function ud(t,e="center"){return function(t,e){const[n,i]=e,{min:r,max:a}=t;return[r[0]+n*(a[0]-r[0]),r[1]+i*(a[1]-r[1])]}(t,od(e))}function cd(t){var e;return[t.x,t.y,null!==(e=t.z)&&void 0!==e?e:0]}function hd(t){var e;return{x:t[0],y:t[1],z:null!==(e=t[2])&&void 0!==e?e:0}}function dd(t,e=0){return t.map((t=>parseFloat(t.toFixed(e))))}function fd(t,e,n,i=!1){if(Ku(t,e))return t;const r=Zh(i?Hh(t,e):Hh(e,t)),a=[r[0]*n,r[1]*n];return Uh(ed(t),a)}function pd(t,e){return t[1]===e[1]}function gd(t,e,n){return rd([t,e],[e,n])}function vd(t,e){return[2*e[0]-t[0],2*e[1]-t[1]]}function yd(t,e,n,i=!0,r=!1){for(let a=0;a<n.length;a++){let o=n[a],s=n[(a+1)%n.length];i&&(o=Uh(e,o),s=Uh(e,s));const l=ad([e,r?vd(t,e):t],[o,s]);if(l)return{point:l,line:[o,s]}}return{point:e,line:void 0}}function md(t,e,n=!1){const i=e.center,r=Hh(n?vd(t,i):t,e.center),a=Math.atan2(r[1],r[0]);if(isNaN(a))return i;const o=Fc(e)/2,s=jc(e)/2;return[i[0]+o*Math.cos(a),i[1]+s*Math.sin(a)]}function bd(t,e){const[n,i]=e[0],[r,a]=e[1],[o,s]=t,l=r-n,u=a-i;if(0===l&&0===u)return[n,i];let c=((o-n)*l+(s-i)*u)/(l*l+u*u);return c>1?c=1:c<0&&(c=0),[n+c*l,i+c*u]}function xd(t,e=!0){const n=function(t){return $h(t.reduce(((t,e)=>Uh(t,e)),[0,0]),t.length)}(t);return t.sort((([t,i],[r,a])=>{const o=Math.atan2(i-n[1],t-n[0]),s=Math.atan2(a-n[1],r-n[0]);return e?s-o:o-s}))}function Ed(t,e){return[t,[t[0],e[1]],e,[e[0],t[1]]]}class wd{constructor(t,e,n){if(this.phase=e,this.pointerByTouch=[],this.initialDistance=null,this.emitter=t,wd.instance)return wd.callbacks[this.phase].push(n),wd.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),wd.instance=this,wd.callbacks[this.phase].push(n)}bindEvents(){const{emitter:t}=this;t.on(ic.POINTER_DOWN,this.onPointerDown),t.on(ic.POINTER_MOVE,this.onPointerMove),t.on(ic.POINTER_UP,this.onPointerUp)}updatePointerPosition(t,e,n){const i=this.pointerByTouch.findIndex((e=>e.pointerId===t));i>=0&&(this.pointerByTouch[i]={x:e,y:n,pointerId:t})}onPointerDown(t){const{x:e,y:n}=t.client||{};if(void 0!==e&&void 0!==n&&(this.pointerByTouch.push({x:e,y:n,pointerId:t.pointerId}),"touch"===t.pointerType&&2===this.pointerByTouch.length)){wd.isPinching=!0;const e=this.pointerByTouch[0].x-this.pointerByTouch[1].x,n=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(e*e+n*n),wd.callbacks.pinchstart.forEach((e=>e(t,{scale:0})))}}onPointerMove(t){if(2!==this.pointerByTouch.length||null===this.initialDistance)return;const{x:e,y:n}=t.client||{};if(void 0===e||void 0===n)return;this.updatePointerPosition(t.pointerId,e,n);const i=this.pointerByTouch[0].x-this.pointerByTouch[1].x,r=this.pointerByTouch[0].y-this.pointerByTouch[1].y,a=Math.sqrt(i*i+r*r)/this.initialDistance;wd.callbacks.pinchmove.forEach((e=>e(t,{scale:5*(a-1)})))}onPointerUp(t){var e;wd.callbacks.pinchend.forEach((e=>e(t,{scale:0}))),wd.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],null===(e=wd.instance)||void 0===e||e.tryDestroy()}destroy(){this.emitter.off(ic.POINTER_DOWN,this.onPointerDown),this.emitter.off(ic.POINTER_MOVE,this.onPointerMove),this.emitter.off(ic.POINTER_UP,this.onPointerUp),wd.instance=null}off(t,e){const n=wd.callbacks[t].indexOf(e);n>-1&&wd.callbacks[t].splice(n,1),this.tryDestroy()}tryDestroy(){Object.values(wd.callbacks).every((t=>0===t.length))&&this.destroy()}}wd.isPinching=!1,wd.instance=null,wd.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};const kd=t=>t.map((t=>he(t)?t.toLocaleLowerCase():t));class Md{constructor(t){this.map=new Map,this.boundHandlePinch=()=>{},this.recordKey=new Set,this.onKeyDown=t=>{(null==t?void 0:t.key)&&(this.recordKey.add(t.key),this.trigger(t))},this.onKeyUp=t=>{(null==t?void 0:t.key)&&this.recordKey.delete(t.key)},this.onWheel=t=>{this.triggerExtendKey(ic.WHEEL,t)},this.onDrag=t=>{this.triggerExtendKey(ic.DRAG,t)},this.handlePinch=(t,e)=>{this.triggerExtendKey(ic.PINCH,Object.assign(Object.assign({},t),e))},this.onFocus=()=>{this.recordKey.clear()},this.emitter=t,this.bindEvents()}bind(t,e){0!==t.length&&(t.includes(ic.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new wd(this.emitter,"pinchmove",this.boundHandlePinch)),this.map.set(t,e))}unbind(t,e){this.map.forEach(((n,i)=>{Ku(i,t)&&(e&&e!==n||this.map.delete(i))}))}unbindAll(){this.map.clear()}match(t){const e=kd(Array.from(this.recordKey)).sort(),n=kd(t).sort();return Ku(e,n)}bindEvents(){var t;const{emitter:e}=this;e.on(ic.KEY_DOWN,this.onKeyDown),e.on(ic.KEY_UP,this.onKeyUp),e.on(ic.WHEEL,this.onWheel),e.on(ic.DRAG,this.onDrag),null===(t=globalThis.addEventListener)||void 0===t||t.call(globalThis,"focus",this.onFocus)}trigger(t){this.map.forEach(((e,n)=>{this.match(n)&&e(t)}))}triggerExtendKey(t,e){this.map.forEach(((n,i)=>{i.includes(t)&&Ku(Array.from(this.recordKey),i.filter((e=>e!==t)))&&n(e)}))}destroy(){var t,e;this.unbindAll(),this.emitter.off(ic.KEY_DOWN,this.onKeyDown),this.emitter.off(ic.KEY_UP,this.onKeyUp),this.emitter.off(ic.WHEEL,this.onWheel),this.emitter.off(ic.DRAG,this.onDrag),null===(t=this.pinchHandler)||void 0===t||t.off("pinchmove",this.boundHandlePinch),null===(e=globalThis.removeEventListener)||void 0===e||e.call(globalThis,"blur",this.onFocus)}}class Sd extends Bh{constructor(t,e){super(t,Vh({},Sd.defaultOptions,e)),this.shortcut=new Md(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;const{canvas:e,graph:n}=this.context,i=Object.assign({},this.options.style);this.options.style.lineWidth&&(i.lineWidth=+this.options.style.lineWidth/n.getZoom()),this.rectShape=new Dl({id:"g6-brush-select",style:i}),e.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var e;if(!this.startPoint)return;const{immediately:n,mode:i}=this.options;this.endPoint=Nd(t),null===(e=this.rectShape)||void 0===e||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),n&&"default"===i&&this.updateElementsStates(Ed(this.startPoint,this.endPoint))}onPointerUp(t){this.startPoint&&(this.endPoint?(this.endPoint=Nd(t),this.updateElementsStates(Ed(this.startPoint,this.endPoint)),this.clearBrush()):this.clearBrush())}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:t}=this.context,e=Object.values(t.getData()).reduce(((t,e)=>Object.assign({},t,e.reduce(((t,e)=>{var n;const i=null===(n=e.states||[])||void 0===n?void 0:n.filter((t=>t!==this.options.state));return t[wh(e)]=i,t}),{}))),{});t.setElementState(e,this.options.animation)}updateElementsStates(t){const{graph:e}=this.context,{enableElements:n,state:i,mode:r,onSelect:a}=this.options,o=this.selector(e,t,n);let s={};switch(r){case"union":o.forEach((t=>{s[t]=[...e.getElementState(t),i]}));break;case"diff":o.forEach((t=>{const n=e.getElementState(t);s[t]=n.includes(i)?n.filter((t=>t!==i)):[...n,i]}));break;case"intersect":o.forEach((t=>{const n=e.getElementState(t);s[t]=n.includes(i)?[i]:[]}));break;default:o.forEach((t=>{s[t]=[i]}))}gn(a)&&(s=a(s)),e.setElementState(s,this.options.animation)}selector(t,e,n){if(!n||0===n.length)return[];const i=[],r=t.getData();if(n.forEach((n=>{r[`${n}s`].forEach((n=>{const r=wh(n);"hidden"!==t.getElementVisibility(r)&&function(t,e,n,i){const r=t[0],a=t[1];let o=!1;void 0===n&&(n=0),void 0===i&&(i=e.length);const s=i-n;for(let t=0,i=s-1;t<s;i=t++){const s=e[t+n][0],l=e[t+n][1],u=e[i+n][0],c=e[i+n][1];l>a!=c>a&&r<(u-s)*(a-l)/(c-l)+s&&(o=!o)}return o}(t.getElementPosition(r),e)&&i.push(r)}))})),n.includes("edge")){const t=r.edges;null==t||t.forEach((t=>{const{source:e,target:n}=t;i.includes(e)&&i.includes(n)&&i.push(wh(t))}))}return i}clearBrush(){var t;null===(t=this.rectShape)||void 0===t||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:t}=this.options,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter((t=>"drag"!==t)))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}bindEvents(){const{graph:t}=this.context;t.on(ic.POINTER_DOWN,this.onPointerDown),t.on(ic.POINTER_MOVE,this.onPointerMove),t.on(ic.POINTER_UP,this.onPointerUp),t.on(ec.CLICK,this.clearStates)}unbindEvents(){const{graph:t}=this.context;t.off(ic.POINTER_DOWN,this.onPointerDown),t.off(ic.POINTER_MOVE,this.onPointerMove),t.off(ic.POINTER_UP,this.onPointerUp),t.off(ec.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=Vh(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}Sd.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const Nd=t=>[t.canvas.x,t.canvas.y],Td=.8,Ad=["node","edge","combo"];function Od(t,e,n,i,r=0){"TB"===i&&e(t,r);const a=n(t);if(a)for(const t of a)Od(t,e,n,i,r+1);"BT"===i&&e(t,r)}function Pd(t,e,n,i,r="both"){if("combo"===e||"node"===e)return Cd(t,n,i,r);const a=t.getEdgeData(n);if(!a)return[];const o=Cd(t,a.source,i-1,r),s=Cd(t,a.target,i-1,r);return Array.from(new Set([...o,...s,n]))}function Cd(t,e,n,i="both"){const r=new Set,a=new Set,o=new Set;return function(t,e,n){const i=[[t,0]];for(;i.length;){const[t,r]=i.shift();e(t,r);const a=n(t);if(a)for(const t of a)i.push([t,r+1])}}(e,((e,r)=>{r>n||(o.add(e),t.getRelatedEdgesData(e,i).forEach((t=>{const e=wh(t);!a.has(e)&&r<n&&(o.add(e),a.add(e))})))}),(e=>t.getRelatedEdgesData(e,i).map((t=>t.source===e?t.target:t.source)).filter((t=>!r.has(t)&&(r.add(t),!0))))),Array.from(o)}function Rd(t){return t.states||[]}var Ld=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class Dd extends Bh{constructor(t,e){super(t,Object.assign({},Dd.defaultOptions,e)),this.onClickSelect=t=>Ld(this,void 0,void 0,(function*(){var e,n;this.validate(t)&&(yield this.updateState(t),null===(n=(e=this.options).onClick)||void 0===n||n.call(e,t))})),this.onClickCanvas=t=>Ld(this,void 0,void 0,(function*(){var e,n;this.validate(t)&&(yield this.clearState(),null===(n=(e=this.options).onClick)||void 0===n||n.call(e,t))})),this.shortcut=new Md(t.graph),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Ad.forEach((e=>{t.on(`${e}:${ic.CLICK}`,this.onClickSelect)})),t.on(ec.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:t,trigger:e}=this.options;return t&&this.shortcut.match(e)}getNeighborIds(t){const{target:e,targetType:n}=t,{graph:i}=this.context,{degree:r}=this.options;return Pd(i,n,e.id,"function"==typeof r?r(t):r).filter((t=>t!==e.id))}updateState(t){return Ld(this,void 0,void 0,(function*(){const{state:e,unselectedState:n,neighborState:i,animation:r}=this.options;if(!e&&!i&&!n)return;const{target:a}=t,{graph:o}=this.context,s=Rd(o.getElementData(a.id)).includes(e)?"unselect":"select",l={},u=this.isMultipleSelect,c=[a.id],h=this.getNeighborIds(t);if(u)if(Object.assign(l,this.getDataStates()),"select"===s){const t=(t,e)=>{t.forEach((t=>{const i=new Set(o.getElementState(t));i.add(e),i.delete(n),l[t]=Array.from(i)}))};t(c,e),t(h,i),n&&Object.keys(l).forEach((t=>{const r=l[t];r.includes(e)||r.includes(i)||r.includes(n)||l[t].push(n)}))}else{const t=l[a.id];l[a.id]=t.filter((t=>t!==e&&t!==i)),t.includes(n)||l[a.id].push(n),h.forEach((t=>{l[t]=l[t].filter((t=>t!==i)),l[t].includes(e)||l[t].push(n)}))}else if("select"===s){Object.assign(l,this.getClearStates(!!n));const t=(t,e)=>{t.forEach((t=>{l[t]||(l[t]=o.getElementState(t)),l[t].push(e)}))};t(c,e),t(h,i),n&&Object.keys(l).forEach((t=>{c.includes(t)||h.includes(t)||l[t].push(n)}))}else Object.assign(l,this.getClearStates());yield o.setElementState(l,r)}))}getDataStates(){const{graph:t}=this.context,{nodes:e,edges:n,combos:i}=t.getData(),r={};return[...e,...n,...i].forEach((t=>{r[wh(t)]=Rd(t)})),r}getClearStates(t=!1){const{graph:e}=this.context,{state:n,unselectedState:i,neighborState:r}=this.options,a=new Set([n,i,r]),{nodes:o,edges:s,combos:l}=e.getData(),u={};return[...o,...s,...l].forEach((e=>{const n=Rd(e),i=n.filter((t=>!a.has(t)));(t||i.length!==n.length)&&(u[wh(e)]=i)})),u}clearState(){return Ld(this,void 0,void 0,(function*(){const{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)}))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Ad.forEach((e=>{t.off(`${e}:${ic.CLICK}`,this.onClickSelect)})),t.off(ec.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}function Id(t){var e;return!!(null===(e=t.style)||void 0===e?void 0:e.collapsed)}Dd.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};const _d=function(t,e,n){for(var i=0,r=he(e)?e.split("."):e;t&&i<r.length;)t=t[r[i++]];return void 0===t||i<r.length?n:t},Bd=function(t,e,n){var i=t,r=he(e)?e.split("."):e;return r.forEach((function(t,e){e<r.length-1?(vn(i[t])||(i[t]=le(r[e+1])?[]:{}),i=i[t]):i[t]=n})),t};function Fd(t,e){if(!t.startsWith(e))return!1;const n=t[e.length];return n>="A"&&n<="Z"}function jd(t,e,n=!0){if(!e)return t;if(!Fd(t,e))return t;const i=t.slice(e.length);return n?function(t){var e=Hu(t);return e.charAt(0).toLowerCase()+e.substring(1)}(i):i}function Gd(t,e){const n=Object.entries(t).reduce(((t,[n,i])=>("className"===n||"class"===n||Fd(n,e)&&Object.assign(t,{[jd(n,e)]:i}),t)),{});if("opacity"in t){const i=function(t,e){return`${e}${Yu(t)}`}("opacity",e),r=t.opacity;if(i in t){const e=t[i];Object.assign(n,{opacity:r*e})}else Object.assign(n,{opacity:r})}return n}function zd(t,e){const n=e.length;return Object.keys(t).reduce(((i,r)=>(r.startsWith(e)&&(i[r.slice(n)]=t[r]),i)),{})}function Vd(t,e){const n="string"==typeof e?[e]:e,i={};return Object.keys(t).forEach((e=>{n.find((t=>e.startsWith(t)))||(i[e]=t[e])})),i}function Wd(t=0){if("number"==typeof t)return[t,t,t];const[e,n=e,i=e]=t;return[e,n,i]}function Ud(t,e){const{datum:n,graph:i}=e;return"function"==typeof t?t.call(i,n):Object.fromEntries(Object.entries(t).map((([t,e])=>"function"==typeof e?[t,e.call(i,n)]:[t,e])))}function Hd(t,e){const n=(null==t?void 0:t.style)||{},i=(null==e?void 0:e.style)||{};for(const t in n)t in i||(i[t]=n[t]);return Object.assign({},t,e,{style:i})}function Yd(t){if(t)return"string"==typeof t||"function"==typeof t||Array.isArray(t)?{type:"group",field:t=>t.id,color:t,invert:!1}:t}function $d(t){const e="string"==typeof t?fc("palette",t):t;if("function"!=typeof e)return e}function Xd(t,e){let n=2*t;return"string"==typeof e?n=t*Number(e.replace("%",""))/100:"number"==typeof e&&(n=e),isNaN(n)&&(n=2*t),n}function qd(t,e,n=1,i=!1){const r=i?n:1;return Xd((t.max[0]-t.min[0])*r,e)}var Kd={}.toString;var Zd=Object.prototype;var Qd=Object.prototype.hasOwnProperty;const Jd=function(t){if(ce(t))return!0;if(Xu(t))return!t.length;var e=function(t){return Kd.call(t).replace(/^\[object /,"").replace(/]$/,"")}(t);if("Map"===e||"Set"===e)return!t.size;if(function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Zd)}(t))return!Object.keys(t).length;for(var n in t)if(Qd.call(t,n))return!1;return!0};class tf extends xl{constructor(t){nf(t.style),super(t),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(t,e,n,i,r){var a,o,s,l,u,c,h,d;const f=this.shapeMap[t];if(!1===n)return void(f&&(null===(a=null==r?void 0:r.beforeDestroy)||void 0===a||a.call(r,f),i.removeChild(f),delete this.shapeMap[t],null===(o=null==r?void 0:r.afterDestroy)||void 0===o||o.call(r,f)));const p="string"==typeof e?fc(hc.SHAPE,e):e;if(!p)throw new Error(pc(`Shape ${e} not found`));if(!f||f.destroyed||!(f instanceof p)){f&&(null===(s=null==r?void 0:r.beforeDestroy)||void 0===s||s.call(r,f),null==f||f.destroy(),null===(l=null==r?void 0:r.afterDestroy)||void 0===l||l.call(r,f)),null===(u=null==r?void 0:r.beforeCreate)||void 0===u||u.call(r);const e=new p({className:t,style:n});return i.appendChild(e),this.shapeMap[t]=e,null===(c=null==r?void 0:r.afterCreate)||void 0===c||c.call(r,e),e}return null===(h=null==r?void 0:r.beforeUpdate)||void 0===h||h.call(r,f),av(f,n),null===(d=null==r?void 0:r.afterUpdate)||void 0===d||d.call(r,f),f}update(t={}){const e=Object.assign({},this.attributes,t);nf(e),function(t,e){const{zIndex:n,transform:i,transformOrigin:r,visibility:a,cursor:o,clipPath:s,component:l}=e,u=Ug(e,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(t.attributes,u),i&&t.setAttribute("transform",i),le(n)&&t.setAttribute("zIndex",n),r&&t.setAttribute("transformOrigin",r),a&&t.setAttribute("visibility",a),o&&t.setAttribute("cursor",o),s&&t.setAttribute("clipPath",s),l&&t.setAttribute("component",l)}(this,e),this.render(e,this),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return function(t){const{x:e,y:n,z:i,class:r,className:a,transform:o,transformOrigin:s,zIndex:l,visibility:u}=t;return function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(t,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,e){if(0===t.length)return null;const n=[];if(void 0!==t[0].x||void 0!==t[0].y||void 0!==t[0].z){const{x:e=0,y:n=0,z:i=0}=this.attributes;t.forEach((t=>{const{x:r=e,y:a=n,z:o=i}=t;Object.assign(t,{transform:o?[["translate3d",r,a,o]]:[["translate",r,a]]})}))}const i=super.animate(t,e);if(i&&(ef(this,i),n.push(i)),Array.isArray(t)&&t.length>0){const i=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some((t=>!i.includes(t)))){Object.entries(this.shapeMap).forEach((([i,r])=>{const a=this[`get${Yu(i)}Style`];if(gn(a)){const i=t.map((t=>a.call(this,Object.assign(Object.assign({},this.attributes),t)))),o=r.animate(mc(i),e);o&&(ef(r,o),n.push(o))}}));const i=(i,r)=>{if(!Jd(i)){const a=this[`get${Yu(r)}Style`];if(gn(a)){const r=t.map((t=>a.call(this,Object.assign(Object.assign({},this.attributes),t))));Object.entries(r[0]).map((([t])=>{const a=r.map((e=>e[t])),o=i[t];if(o){const t=o.animate(mc(a),e);t&&(ef(o,t),n.push(t))}}))}}};this.compositeShapes.forEach((([t,e])=>{const n=zd(this.shapeMap,e);i(n,t)}))}}return yc(n)}getShape(t){return this.shapeMap[t]}setVisibility(){const{visibility:t}=this.attributes;Dh(this,t)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function ef(t,e){null==e||e.finished.then((()=>{const n=t.activeAnimations.findIndex((t=>t===e));n>-1&&t.activeAnimations.splice(n,1)}))}function nf(t){if(!t)return{};if("x"in t||"y"in t||"z"in t){const{x:e=0,y:n=0,z:i,transform:r}=t,a=Ec(e,n,i,r);a&&(t.transform=a)}return t}class rf extends tf{constructor(t){super(Hd({style:rf.defaultStyleProps},t))}isTextStyle(t){return Fd(t,"label")}isBackgroundStyle(t){return Fd(t,"background")}getTextStyle(t){const e=this.getGraphicStyle(t),{padding:n}=e;return Vd(function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["padding"]),"background")}getBackgroundStyle(t){if(!1===t.background)return!1;const e=this.getGraphicStyle(t),{wordWrap:n,wordWrapWidth:i,padding:r}=e,a=Gd(e,"background"),{min:[o,s],center:[l,u],halfExtents:[c,h]}=this.shapeMap.text.getGeometryBounds(),[d,f,p,g]=_c(r),v=2*c+g+f,{width:y,height:m}=a;y&&m?Object.assign(a,{x:l-Number(y)/2,y:u-Number(m)/2}):Object.assign(a,{x:o-g,y:s-d,width:n?Math.min(v,i+g+f):v,height:2*h+d+p});const{radius:b}=a;if("string"==typeof b&&b.endsWith("%")){const t=Number(b.replace("%",""))/100;a.radius=Math.min(+a.width,+a.height)*t}return a}render(t=this.parsedAttributes,e=this){this.upsert("text",_l,this.getTextStyle(t),e),this.upsert("background",Dl,this.getBackgroundStyle(t),e)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}rf.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class af extends tf{constructor(t){super(Hd({style:af.defaultStyleProps},t))}getBadgeStyle(t){return this.getGraphicStyle(t)}render(t=this.parsedAttributes,e=this){this.upsert("label",rf,this.getBadgeStyle(t),e)}getGeometryBounds(){const t=this.getShape("label");return(t.getShape("background")||t.getShape("text")).getGeometryBounds()}}af.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};const of={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};const sf=t=>{if(t.length<2)return[["M",0,0],["L",0,0]];const e=t[0],n=t[1],i=t[t.length-1],r=t[t.length-2];t.unshift(r,i),t.push(e,n);const a=[["M",i[0],i[1]]];for(let e=1;e<t.length-2;e+=1){const[n,i]=t[e-1],[r,o]=t[e],[s,l]=t[e+1],[u,c]=e!==t.length-2?t[e+2]:[s,l],h=r+(s-n)/6,d=o+(l-i)/6,f=s-(u-r)/6,p=l-(c-o)/6;a.push(["C",h,d,f,p,s,l])}return a};class lf extends tf{constructor(t){super(Hd({style:lf.defaultStyleProps},t))}getLabelStyle(t){if(!t.label||!t.d||0===t.d.length)return!1;const e=Gd(this.getGraphicStyle(t),"label"),{maxWidth:n,offsetX:i,offsetY:r,autoRotate:a,placement:o,closeToPath:s}=e,l=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),u=this.shapeMap.key,c=null==u?void 0:u.getRenderBounds();return Object.assign(function(t,e,n,i,r,a,o){const[s,l]=ud(t,e),u={textAlign:"left"===e?"right":"right"===e?"left":"center",textBaseline:"top"===e?"bottom":"bottom"===e?"top":"middle",transform:[["translate",s+n,l+i]]};if("center"===e||!r)return u;const c=function(t){const e=[],n="string"==typeof t?function(t){const e=t.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),n=[];let i="",r={};for(;e.length>0;){let t=e.shift();t in of?i=t:e.unshift(t),r={type:i},of[i].forEach((n=>{t=e.shift(),r[n]=t})),"M"===i?i="L":"m"===i&&(i="l");const[a,...o]=Object.values(r);n.push([a,...o.map(Number)])}return n}(t):t;return n.forEach((t=>{const n=t[0];if("Z"!==n)if("A"!==n)for(let n=1;n<t.length;n+=2)e.push([t[n],t[n+1],0]);else{const n=t.length;e.push([t[n-2],t[n-1],0])}else e.push(e[0])})),e}(a);if(!c||c.length<=3)return u;const h=c.map(((t,e)=>{const n=t,i=c[(e+1)%c.length];return Ku(n,i)?null:[n,i]})).filter(Boolean),d=function(t,e){let n=1/0,i=[[0,0],[0,0]];return e.forEach((e=>{const r=function(t,e){return qh(t,bd(t,e))}(t,e);r<n&&(n=r,i=e)})),i}([s,l],h),f=bd([s,l],d);if(f&&d&&(u.transform=[["translate",f[0]+n,f[1]+i]],o)){const t=Math.atan((d[0][1]-d[1][1])/(d[0][0]-d[1][0]));u.transform.push(["rotate",t/Math.PI*180]),u.textAlign="center","right"!==e&&"left"!==e||(u.textBaseline=t>0?"right"===e?"bottom":"top":"right"===e?"top":"bottom")}return u}(c,o,i,r,s,t.d,a),{wordWrapWidth:qd(c,n)},l)}getKeyStyle(t){return this.getGraphicStyle(t)}render(t,e){this.upsert("key",Ol,this.getKeyStyle(t),e),this.upsert("label",rf,this.getLabelStyle(t),e)}}lf.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};class uf extends Sl{constructor(t){super(t),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},hf=this,this.isMutationObserved=!0,this.addEventListener(Ts.MOUNTED,this.onMounted),this.addEventListener(Ts.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:t,clipPath:e,width:n=0,height:i=0}=this.attributes;if(t&&n&&i){const[r,a]=this.getBounds().min,o={x:r,y:a,radius:t,width:n,height:i};if(e)Object.assign(this.parsedStyle.clipPath.style,o);else{const t=new Dl({style:o});this.style.clipPath=t}}else e&&(this.style.clipPath=null)}}const cf=new WeakMap;let hf=null;const df=t=>{if(hf&&function(t){const e=[];let n=t.parentNode;for(;n;)e.push(n),n=n.parentNode;return e}(hf).includes(t)){const e=cf.get(t);e?e.includes(hf)||e.push(hf):cf.set(t,[hf])}},ff=t=>{const e=cf.get(t);e&&e.forEach((t=>t.handleRadius()))};class pf extends tf{constructor(t){super(t)}isImage(){const{src:t}=this.attributes;return!!t}getIconStyle(t=this.attributes){const{width:e=0,height:n=0}=t,i=this.getGraphicStyle(t);return this.isImage()?Object.assign({x:-e/2,y:-n/2},i):Object.assign({textBaseline:"middle",textAlign:"center"},i)}render(t=this.attributes,e=this){this.upsert("icon",this.isImage()?uf:_l,this.getIconStyle(t),e)}}class gf extends tf{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(t,e){const n=super.animate(t,e);return n&&(n.onframe=()=>this.onframe(),n.finished.then((()=>this.onframe()))),n}}var vf=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n};class yf extends gf{constructor(t){super(Hd({style:yf.defaultStyleProps},t)),this.type="node"}getSize(t=this.attributes){const{size:e}=t;return Wd(e)}getKeyStyle(t){const e=this.getGraphicStyle(t);return Object.assign(Vd(e,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;const e=Gd(this.getGraphicStyle(t),"label"),{placement:n,maxWidth:i,offsetX:r,offsetY:a}=e,o=vf(e,["placement","maxWidth","offsetX","offsetY"]),s=this.getShape("key").getLocalBounds();return Object.assign(iv(s,n,r,a),{wordWrapWidth:qd(s,i)},o)}getHaloStyle(t){if(!1===t.halo)return!1;const e=this.getKeyStyle(t),{fill:n}=e,i=vf(e,["fill"]),r=Gd(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign(Object.assign({},i),{stroke:n}),r)}getIconStyle(t){if(!1===t.icon||!t.iconText&&!t.iconSrc)return!1;const e=Gd(this.getGraphicStyle(t),"icon");return Object.assign(function(t,e){const n=Wd(t);let i={};return e.text&&!e.fontSize&&(i={fontSize:.5*Math.min(...n)}),!e.src||e.width&&e.height||(i={width:.5*n[0],height:.5*n[1]}),i}(t.size,e),e)}getBadgesStyle(t){var e;const n=zd(this.shapeMap,"badge-"),i={};if(Object.keys(n).forEach((t=>{i[t]=!1})),!1===t.badge||!(null===(e=t.badges)||void 0===e?void 0:e.length))return i;const{badges:r=[],badgePalette:a,opacity:o=1}=t,s=vf(t,["badges","badgePalette","opacity"]),l=$d(a),u=Gd(this.getGraphicStyle(s),"badge");return r.forEach(((t,e)=>{i[e]=Object.assign(Object.assign({backgroundFill:l?l[e%(null==l?void 0:l.length)]:void 0,opacity:o},u),this.getBadgeStyle(t))})),i}getBadgeStyle(t){const e=this.getShape("key"),{placement:n="top",offsetX:i,offsetY:r}=t,a=vf(t,["placement","offsetX","offsetY"]),o=iv(e.getLocalBounds(),n,i,r,!0);return Object.assign(Object.assign({},o),a)}getPortsStyle(t){var e;const n=this.getPorts(),i={};if(Object.keys(n).forEach((t=>{i[t]=!1})),!1===t.port||!(null===(e=t.ports)||void 0===e?void 0:e.length))return i;const r=Gd(this.getGraphicStyle(t),"port"),{ports:a=[]}=t;return a.forEach(((e,n)=>{const a=e.key||n,o=Object.assign(Object.assign({},r),e);if(Zg(o))i[a]=!1;else{const[n,r]=this.getPortXY(t,e);i[a]=Object.assign({transform:[["translate",n,r]]},o)}})),i}getPortXY(t,e){const{placement:n="left"}=e,i=this.getShape("key");return qg(function(t,e){if(!t)return e.getLocalBounds();const n=t.canvas.getLayer(),i=e.cloneNode();Dh(i,"hidden"),n.appendChild(i);const r=i.getLocalBounds();return i.destroy(),r}(this.context,i),n)}getPorts(){return zd(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t,e=!1){return function(t,e,n=!1){return yd(t,ud(e,"center"),[ud(e,"left-top"),ud(e,"right-top"),ud(e,"right-bottom"),ud(e,"left-bottom")],!1,n).point}(t,this.getShape("key").getBounds(),e)}drawHaloShape(t,e){const n=this.getHaloStyle(t),i=this.getShape("key");this.upsert("halo",i.constructor,n,e)}drawIconShape(t,e){const n=this.getIconStyle(t);this.upsert("icon",pf,n,e),df(this)}drawBadgeShapes(t,e){const n=this.getBadgesStyle(t);Object.keys(n).forEach((t=>{const i=n[t];this.upsert(`badge-${t}`,af,i,e)}))}drawPortShapes(t,e){const n=this.getPortsStyle(t);Object.keys(n).forEach((t=>{const i=n[t],r=`port-${t}`;this.upsert(r,ml,i,e)}))}drawLabelShape(t,e){const n=this.getLabelStyle(t);this.upsert("label",rf,n,e)}_drawKeyShape(t,e){return this.drawKeyShape(t,e)}render(t=this.parsedAttributes,e=this){this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&ff(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}yf.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};class mf extends yf{constructor(t){super(Hd({style:mf.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",ml,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{r:Math.min(...this.getSize(t))/2})}getIconStyle(t){const e=super.getIconStyle(t),{r:n}=this.getShape("key").attributes,i=2*n*Td;return!!e&&Object.assign({width:i,height:i},e)}getIntersectPoint(t,e=!1){return md(t,this.getShape("key").getBounds(),e)}}mf.defaultStyleProps={size:32};class bf extends yf{constructor(t){super(t)}get parsedAttributes(){return this.attributes}drawKeyShape(t,e){return this.upsert("key",Cl,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{points:this.getPoints(t)})}getIntersectPoint(t,e=!1){var n,i;const{points:r}=this.getShape("key").attributes;return yd(t,[+((null===(n=this.attributes)||void 0===n?void 0:n.x)||0),+((null===(i=this.attributes)||void 0===i?void 0:i.y)||0)],r,!0,e).point}}class xf extends bf{constructor(t){super(t)}getPoints(t){const[e,n]=this.getSize(t);return function(t,e){return[[0,-e/2],[t/2,0],[0,e/2],[-t/2,0]]}(e,n)}}class Ef extends mf{constructor(t){super(Hd({style:Ef.defaultStyleProps},t))}parseOuterR(){const{size:t}=this.parsedAttributes;return Math.min(...Wd(t))/2}parseInnerR(){const{innerR:t}=this.parsedAttributes;return he(t)?parseInt(t)/100*this.parseOuterR():t}drawDonutShape(t,e){const{donuts:n}=t;if(!(null==n?void 0:n.length))return;const i=n.map((t=>le(t)?{value:t}:t)),r=Gd(this.getGraphicStyle(t),"donut"),a=$d(t.donutPalette);if(!a)return;const o=i.reduce(((t,e)=>{var n;return t+(null!==(n=e.value)&&void 0!==n?n:0)}),0),s=this.parseOuterR(),l=this.parseInnerR();let u=0;i.forEach(((t,n)=>{const{value:c=0,color:h=a[n%a.length]}=t,d=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(t,["value","color"]),f=360*(0===o?1/i.length:c/o);this.upsert(`round${n}`,Ol,Object.assign(Object.assign(Object.assign({},r),{d:kf(s,l,u,u+f),fill:h}),d),e),u+=f}))}render(t,e=this){super.render(t,e),this.drawDonutShape(t,e)}}Ef.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const wf=(t,e,n,i)=>[t+Math.sin(i)*n,e-Math.cos(i)*n],kf=(t=0,e=0,n,i)=>{const[r,a]=[0,0];return Math.abs(n-i)%360<1e-6?((t,e,n,i)=>i<=0||n<=i?[["M",t-n,e],["A",n,n,0,1,1,t+n,e],["A",n,n,0,1,1,t-n,e],["Z"]]:[["M",t-n,e],["A",n,n,0,1,1,t+n,e],["A",n,n,0,1,1,t-n,e],["Z"],["M",t+i,e],["A",i,i,0,1,0,t-i,e],["A",i,i,0,1,0,t+i,e],["Z"]])(r,a,t,e):((t,e,n,i,r,a)=>{const[o,s]=[r/360*2*Math.PI,a/360*2*Math.PI],l=[wf(t,e,i,o),wf(t,e,n,o),wf(t,e,n,s),wf(t,e,i,s)],u=s-o>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",n,n,0,u,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",i,i,0,u,0,l[0][0],l[0][1]],["Z"]]})(r,a,t,e,n,i)};class Mf extends yf{constructor(t){super(Hd({style:Mf.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",El,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[n,i]=this.getSize(t);return Object.assign(Object.assign({},e),{rx:n/2,ry:i/2})}getIconStyle(t){const e=super.getIconStyle(t),{rx:n,ry:i}=this.getShape("key").attributes,r=2*Math.min(+n,+i)*Td;return!!e&&Object.assign({width:r,height:r},e)}getIntersectPoint(t,e=!1){return md(t,this.getShape("key").getBounds(),e)}}Mf.defaultStyleProps={size:[45,35]};class Sf extends bf{constructor(t){super(t)}getOuterR(t){return t.outerR||Math.min(...this.getSize(t))/2}getPoints(t){return[[0,e=this.getOuterR(t)],[e*Math.sqrt(3)/2,e/2],[e*Math.sqrt(3)/2,-e/2],[0,-e],[-e*Math.sqrt(3)/2,-e/2],[-e*Math.sqrt(3)/2,e/2]];var e}getIconStyle(t){const e=super.getIconStyle(t),n=this.getOuterR(t)*Td;return!!e&&Object.assign({width:n,height:n},e)}}function Nf(t,e){var n=e.cx,i=void 0===n?0:n,r=e.cy,a=void 0===r?0:r,o=e.r;t.arc(i,a,o,0,2*Math.PI,!1)}function Tf(t,e){var n=e.cx,i=void 0===n?0:n,r=e.cy,a=void 0===r?0:r,o=e.rx,s=e.ry;if(t.ellipse)t.ellipse(i,a,o,s,0,0,2*Math.PI,!1);else{var l=o>s?o:s,u=o>s?1:o/s,c=o>s?s/o:1;t.save(),t.scale(u,c),t.arc(i,a,l,0,2*Math.PI)}}function Af(t,e){var n,i,r=e.x1,a=e.y1,o=e.x2,s=e.y2,l=e.markerStart,u=e.markerEnd,c=e.markerStartOffset,h=e.markerEndOffset,d=0,f=0,p=0,g=0,v=0;l&&dl(l)&&c&&(n=o-r,i=s-a,v=Math.atan2(i,n),d=Math.cos(v)*(c||0),f=Math.sin(v)*(c||0)),u&&dl(u)&&h&&(n=r-o,i=a-s,v=Math.atan2(i,n),p=Math.cos(v)*(h||0),g=Math.sin(v)*(h||0)),t.moveTo(r+d,a+f),t.lineTo(o+p,s+g)}function Of(t,e){var n,i,r=e.markerStart,a=e.markerEnd,o=e.markerStartOffset,s=e.markerEndOffset,l=e.d,u=l.absolutePath,c=l.segments,h=0,d=0,f=0,p=0,g=0;if(r&&dl(r)&&o){var v=b(r.parentNode.getStartTangent(),2),y=v[0],m=v[1];n=y[0]-m[0],i=y[1]-m[1],g=Math.atan2(i,n),h=Math.cos(g)*(o||0),d=Math.sin(g)*(o||0)}if(a&&dl(a)&&s){var x=b(a.parentNode.getEndTangent(),2),E=x[0],w=x[1];n=E[0]-w[0],i=E[1]-w[1],g=Math.atan2(i,n),f=Math.cos(g)*(s||0),p=Math.sin(g)*(s||0)}for(var k=0;k<u.length;k++){var M=u[k],S=M[0],N=u[k+1],T=0===k&&(0!==h||0!==d),A=(k===u.length-1||N&&("M"===N[0]||"Z"===N[0]))&&0!==f&&0!==p,O=b(T?[h,d]:[0,0],2),P=O[0],C=O[1],R=b(A?[f,p]:[0,0],2),L=R[0],D=R[1];switch(S){case"M":t.moveTo(M[1]+P,M[2]+C);break;case"L":t.lineTo(M[1]+L,M[2]+D);break;case"Q":t.quadraticCurveTo(M[1],M[2],M[3]+L,M[4]+D);break;case"C":t.bezierCurveTo(M[1],M[2],M[3],M[4],M[5]+L,M[6]+D);break;case"A":var I=c[k].arcParams,_=I.cx,B=I.cy,F=I.rx,j=I.ry,G=I.startAngle,z=I.endAngle,V=I.xRotation,W=I.sweepFlag;if(t.ellipse)t.ellipse(_,B,F,j,V,G,z,!!(1-W));else{var U=F>j?F:j,H=F>j?1:F/j,Y=F>j?j/F:1;t.translate(_,B),t.rotate(V),t.scale(H,Y),t.arc(0,0,U,G,z,!!(1-W)),t.scale(1/H,1/Y),t.rotate(-V),t.translate(-_,-B)}A&&t.lineTo(M[6]+f,M[7]+p);break;case"Z":t.closePath()}}}function Pf(t,e){var n,i,r=e.markerStart,a=e.markerEnd,o=e.markerStartOffset,s=e.markerEndOffset,l=e.points.points,u=l.length,c=l[0][0],h=l[0][1],d=l[u-1][0],f=l[u-1][1],p=0,g=0,v=0,y=0,m=0;r&&dl(r)&&o&&(n=l[1][0]-l[0][0],i=l[1][1]-l[0][1],m=Math.atan2(i,n),p=Math.cos(m)*(o||0),g=Math.sin(m)*(o||0)),a&&dl(a)&&s&&(n=l[u-1][0]-l[0][0],i=l[u-1][1]-l[0][1],m=Math.atan2(i,n),v=Math.cos(m)*(s||0),y=Math.sin(m)*(s||0)),t.moveTo(c+(p||v),h+(g||y));for(var b=1;b<u-1;b++){var x=l[b];t.lineTo(x[0],x[1])}t.lineTo(d,f)}function Cf(t,e){var n,i,r=e.markerStart,a=e.markerEnd,o=e.markerStartOffset,s=e.markerEndOffset,l=e.points.points,u=l.length,c=l[0][0],h=l[0][1],d=l[u-1][0],f=l[u-1][1],p=0,g=0,v=0,y=0,m=0;r&&dl(r)&&o&&(n=l[1][0]-l[0][0],i=l[1][1]-l[0][1],m=Math.atan2(i,n),p=Math.cos(m)*(o||0),g=Math.sin(m)*(o||0)),a&&dl(a)&&s&&(n=l[u-2][0]-l[u-1][0],i=l[u-2][1]-l[u-1][1],m=Math.atan2(i,n),v=Math.cos(m)*(s||0),y=Math.sin(m)*(s||0)),t.moveTo(c+p,h+g);for(var b=1;b<u-1;b++){var x=l[b];t.lineTo(x[0],x[1])}t.lineTo(d+v,f+y)}function Rf(t,e){var n=e.x,i=void 0===n?0:n,r=e.y,a=void 0===r?0:r,o=e.radius,s=e.width,l=e.height,u=s,c=l;if(o&&o.some((function(t){return 0!==t}))){var h=s>0?1:-1,d=l>0?1:-1,f=h+d===0,p=b(o.map((function(t){return de(t,0,Math.min(Math.abs(u)/2,Math.abs(c)/2))})),4),g=p[0],v=p[1],y=p[2],m=p[3];t.moveTo(h*g+i,a),t.lineTo(u-h*v+i,a),0!==v&&t.arc(u-h*v+i,d*v+a,v,-d*Math.PI/2,h>0?0:Math.PI,f),t.lineTo(u+i,c-d*y+a),0!==y&&t.arc(u-h*y+i,c-d*y+a,y,h>0?0:Math.PI,d>0?Math.PI/2:1.5*Math.PI,f),t.lineTo(h*m+i,c+a),0!==m&&t.arc(h*m+i,c-d*m+a,m,d>0?Math.PI/2:-Math.PI/2,h>0?Math.PI:0,f),t.lineTo(i,d*g+a),0!==g&&t.arc(h*g+i,d*g+a,g,h>0?Math.PI:0,d>0?1.5*Math.PI:Math.PI/2,f)}else t.rect(i,a,u,c)}var Lf=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).name="canvas-path-generator",t}return m(e,t),c(e,[{key:"init",value:function(){var t,e=(a(a(a(a(a(a(a(a(a(a(t={},Un.CIRCLE,Nf),Un.ELLIPSE,Tf),Un.RECT,Rf),Un.LINE,Af),Un.POLYLINE,Cf),Un.POLYGON,Pf),Un.PATH,Of),Un.TEXT,void 0),Un.GROUP,void 0),Un.IMAGE,void 0),a(a(a(t,Un.HTML,void 0),Un.MESH,void 0),Un.FRAGMENT,void 0));this.context.pathGeneratorFactory=e}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(Yn),Df=k(),If=k(),_f=k(),Bf=q(),Ff=function(){function t(){var e=this;l(this,t),this.isHit=function(t,n,i,r){var a=e.context.pointInPathPickerFactory[t.nodeName];if(a){var o=nt(Bf,i),s=j(If,A(_f,n[0],n[1],0),o);if(a(t,new ri(s[0],s[1]),r,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,n){var i=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),r=e.context.pathGeneratorFactory[t.nodeName];return r&&(i.beginPath(),r(i,t.parsedStyle),i.closePath()),i.isPointInPath(n.x,n.y)}}return c(t,[{key:"apply",value:function(e,n){var i,r=this,a=e.renderingService,o=e.renderingContext;this.context=e,this.runtime=n;var s=null===(i=o.root)||void 0===i?void 0:i.ownerDocument;a.hooks.pick.tapPromise(t.tag,function(){var t=jn(Bn().mark((function t(e){return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.pick(s,e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),a.hooks.pickSync.tap(t.tag,(function(t){return r.pick(s,t)}))}},{key:"pick",value:function(t,e){var n,i=e.topmost,r=e.position,a=r.x,o=r.y,s=A(Df,a,o,0),l=[],u=Gn(t.elementsFromBBox(s[0],s[1],s[0],s[1]));try{for(u.s();!(n=u.n()).done;){var c=n.value,h=c.getWorldTransform();if(this.isHit(c,s,h,!1)){var d=Mo(c);if(d){var f=d.parsedStyle.clipPath;if(this.isHit(f,s,f.getWorldTransform(),!0)){if(i)return e.picked=[c],e;l.push(c)}}else{if(i)return e.picked=[c],e;l.push(c)}}}}catch(t){u.e(t)}finally{u.f()}return e.picked=l,e}}])}();function jf(t,e,n){var i=t.parsedStyle,r=i.cx,a=void 0===r?0:r,o=i.cy,s=void 0===o?0:o,l=i.r,u=i.fill,c=i.stroke,h=i.lineWidth,d=void 0===h?1:h,f=i.increasedLineWidthForHitTesting,p=void 0===f?0:f,g=i.pointerEvents,v=void 0===g?"auto":g,y=(d+p)/2,m=xn(a,s,e.x,e.y),x=b(Oo(v,u,c),2),E=x[0],w=x[1];return E&&w||n?m<=l+y:E?m<=l:!!w&&m>=l-y&&m<=l+y}function Gf(t,e,n,i){return t/(n*n)+e/(i*i)}function zf(t,e,n){var i=t.parsedStyle,r=i.cx,a=void 0===r?0:r,o=i.cy,s=void 0===o?0:o,l=i.rx,u=i.ry,c=i.fill,h=i.stroke,d=i.lineWidth,f=void 0===d?1:d,p=i.increasedLineWidthForHitTesting,g=void 0===p?0:p,v=i.pointerEvents,y=void 0===v?"auto":v,m=e.x,x=e.y,E=b(Oo(y,c,h),2),w=E[0],k=E[1],M=(f+g)/2,S=(m-a)*(m-a),N=(x-s)*(x-s);return w&&k||n?Gf(S,N,l+M,u+M)<=1:w?Gf(S,N,l,u)<=1:!!k&&Gf(S,N,l-M,u-M)>=1&&Gf(S,N,l+M,u+M)<=1}function Vf(t,e,n,i,r,a){return r>=t&&r<=t+n&&a>=e&&a<=e+i}function Wf(t,e,n,i,r,a,o,s){var l=(Math.atan2(s-e,o-t)+2*Math.PI)%(2*Math.PI),u={x:t+n*Math.cos(l),y:e+n*Math.sin(l)};return xn(u.x,u.y,o,s)<=a/2}function Uf(t,e,n,i,r,a,o){var s=Math.min(t,n),l=Math.max(t,n),u=Math.min(e,i),c=Math.max(e,i),h=r/2;return a>=s-h&&a<=l+h&&o>=u-h&&o<=c+h&&function(t,e,n,i,r,a){var o=[n-t,i-e];if(function(t,e){return t[0]===e[0]&&t[1]===e[1]}(o,[0,0]))return Math.sqrt((r-t)*(r-t)+(a-e)*(a-e));var s=[-o[1],o[0]];!function(t,e){var n=e[0],i=e[1],r=n*n+i*i;r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r}(s,s);var l=[r-t,a-e];return Math.abs(function(t,e){return t[0]*e[0]+t[1]*e[1]}(l,s))}(t,e,n,i,a,o)<=r/2}function Hf(t,e,n,i,r){var a=t.length;if(a<2)return!1;for(var o=0;o<a-1;o++)if(Uf(t[o][0],t[o][1],t[o+1][0],t[o+1][1],e,n,i))return!0;if(r){var s=t[0],l=t[a-1];if(Uf(s[0],s[1],l[0],l[1],e,n,i))return!0}return!1}function Yf(t){return Math.abs(t)<1e-6?0:t<0?-1:1}function $f(t,e,n){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])&&Math.min(t[0],e[0])<=n[0]&&n[0]<=Math.max(t[0],e[0])&&Math.min(t[1],e[1])<=n[1]&&n[1]<=Math.max(t[1],e[1])}function Xf(t,e,n){var i=!1,r=t.length;if(r<=2)return!1;for(var a=0;a<r;a++){var o=t[a],s=t[(a+1)%r];if($f(o,s,[e,n]))return!0;Yf(o[1]-n)>0!=Yf(s[1]-n)>0&&Yf(e-(n-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(i=!i)}return i}function qf(t,e,n){for(var i=!1,r=0;r<t.length&&!(i=Xf(t[r],e,n));r++);return i}function Kf(t,e,n){var i=t.parsedStyle,r=i.x1,a=i.y1,o=i.x2,s=i.y2,l=i.lineWidth,u=void 0===l?1:l,c=i.increasedLineWidthForHitTesting,h=void 0===c?0:c,d=i.pointerEvents;return!(!b(Oo(void 0===d?"auto":d,i.fill,i.stroke),2)[1]&&!n||!u)&&Uf(r,a,o,s,u+h,e.x,e.y)}function Zf(t,e,n,i,r,a){var o=t.parsedStyle,s=o.lineWidth,l=void 0===s?1:s,u=o.increasedLineWidthForHitTesting,c=void 0===u?0:u,h=o.stroke,d=o.fill,f=o.d,p=o.pointerEvents,g=void 0===p?"auto":p,v=f.segments,y=f.hasArc,m=f.polylines,x=f.polygons,E=b(Oo(g,(null==x?void 0:x.length)&&d,h),2),w=E[0],k=E[1],M=va(t),S=!1;return w||n?S=y?i(t,e):qf(x,e.x,e.y)||qf(m,e.x,e.y):((k||n)&&(S=function(t,e,n,i,r){for(var a=!1,o=e/2,s=0;s<t.length;s++){var l=t[s],u=l.currentPoint,c=l.params,h=l.prePoint,d=l.box;if(!d||Vf(d.x-o,d.y-o,d.width+e,d.height+e,n,i))switch(l.command){case"L":case"Z":if(a=Uf(h[0],h[1],u[0],u[1],e,n,i))return!0;break;case"Q":if(a=_n(h[0],h[1],c[1],c[2],c[3],c[4],n,i)<=e/2)return!0;break;case"C":if(a=Cn(h[0],h[1],c[1],c[2],c[3],c[4],c[5],c[6],n,i,r)<=e/2)return!0;break;case"A":l.cubicParams||(l.cubicParams=tn(h[0],h[1],c[1],c[2],c[3],c[4],c[5],c[6],c[7],void 0));for(var f=l.cubicParams,p=h,g=0;g<f.length;g+=6){var v=Cn(p[0],p[1],f[g],f[g+1],f[g+2],f[g+3],f[g+4],f[g+5],n,i,r);if(p=[f[g+4],f[g+5]],a=v<=e/2)return!0}}}return a}(v,l+c,e.x,e.y,M)),S)}function Qf(t,e,n){var i=t.parsedStyle,r=i.stroke,a=i.fill,o=i.lineWidth,s=void 0===o?1:o,l=i.increasedLineWidthForHitTesting,u=void 0===l?0:l,c=i.points,h=i.pointerEvents,d=b(Oo(void 0===h?"auto":h,a,r),2),f=d[0],p=!1;return(d[1]||n)&&(p=Hf(c.points,s+u,e.x,e.y,!0)),p||!f&&!n||(p=Xf(c.points,e.x,e.y)),p}function Jf(t,e,n){var i=t.parsedStyle,r=i.lineWidth,a=void 0===r?1:r,o=i.increasedLineWidthForHitTesting,s=void 0===o?0:o,l=i.points,u=i.pointerEvents;return!(!b(Oo(void 0===u?"auto":u,i.fill,i.stroke),2)[1]&&!n||!a)&&Hf(l.points,a+s,e.x,e.y,!1)}function tp(t,e,n,i,r){var a=t.parsedStyle,o=a.radius,s=a.fill,l=a.stroke,u=a.lineWidth,c=void 0===u?1:u,h=a.increasedLineWidthForHitTesting,d=void 0===h?0:h,f=a.x,p=void 0===f?0:f,g=a.y,v=void 0===g?0:g,y=a.width,m=a.height,x=a.pointerEvents,E=b(Oo(void 0===x?"auto":x,s,l),2),w=E[0],k=E[1],M=c+d;if(o&&o.some((function(t){return 0!==t}))){var S=!1;return(k||n)&&(S=function(t,e,n,i,r,a,o,s){var l=b(r,4),u=l[0],c=l[1],h=l[2],d=l[3];return Uf(t+u,e,t+n-c,e,a,o,s)||Uf(t+n,e+c,t+n,e+i-h,a,o,s)||Uf(t+n-h,e+i,t+d,e+i,a,o,s)||Uf(t,e+i-d,t,e+u,a,o,s)||Wf(t+n-c,e+c,c,Math.PI,Math.PI,a,o,s)||Wf(t+n-h,e+i-h,h,0,Math.PI,a,o,s)||Wf(t+d,e+i-d,d,Math.PI,Math.PI,a,o,s)||Wf(t+u,e+u,u,Math.PI,Math.PI,a,o,s)}(p,v,y,m,o.map((function(t){return de(t,0,Math.min(Math.abs(y)/2,Math.abs(m)/2))})),M,e.x,e.y)),S||!w&&!n||(S=i(t,e)),S}var N=M/2;return w&&k||n?Vf(p-N,v-N,y+N,m+N,e.x,e.y):w?Vf(p,v,y,m,e.x,e.y):!!k&&function(t,e,n,i,r,a,o){var s=r/2;return Vf(t-s,e-s,n,r,a,o)||Vf(t+n-s,e-s,r,i,a,o)||Vf(t+s,e+i-s,n,r,a,o)||Vf(t-s,e+s,r,i,a,o)}(p,v,y,m,M,e.x,e.y)}function ep(t,e,n,i,r,a){var o=t.parsedStyle,l=o.pointerEvents,u=void 0===l?"auto":l,c=o.x,h=void 0===c?0:c,d=o.y,f=void 0===d?0:d,p=o.width,g=o.height;if("non-transparent-pixel"===u){var v=r.config.offscreenCanvas,y=a.offscreenCanvasCreator.getOrCreateCanvas(v),m=a.offscreenCanvasCreator.getOrCreateContext(v,{willReadFrequently:!0});return y.width=p,y.height=g,r.defaultStyleRendererFactory[Un.IMAGE].render(m,s(s({},t.parsedStyle),{},{x:0,y:0}),t,void 0,void 0,void 0),m.getImageData(e.x-h,e.y-f,1,1).data.every((function(t){return 0!==t}))}return!0}function np(t,e,n,i){var r=t.getGeometryBounds();return e.x>=r.min[0]&&e.y>=r.min[1]&&e.x<=r.max[0]&&e.y<=r.max[1]}Ff.tag="CanvasPicker";var ip=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).name="canvas-picker",t}return m(e,t),c(e,[{key:"init",value:function(){var t,e=(a(a(a(a(a(a(a(a(a(a(t={},Un.CIRCLE,jf),Un.ELLIPSE,zf),Un.RECT,tp),Un.LINE,Kf),Un.POLYLINE,Jf),Un.POLYGON,Qf),Un.PATH,Zf),Un.TEXT,np),Un.GROUP,null),Un.IMAGE,ep),a(a(t,Un.HTML,null),Un.MESH,null));this.context.pointInPathPickerFactory=e,this.addRenderingPlugin(new Ff)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(Yn);function rp(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var ap=0;function op(t){return"__private_"+ap+++"_"+t}var sp=function(){return c((function t(){l(this,t),this.cacheStore=new Map}),[{key:"onRefAdded",value:function(t){}},{key:"has",value:function(t){return this.cacheStore.has(t)}},{key:"put",value:function(t,e,n){return!this.cacheStore.has(t)&&(this.cacheStore.set(t,{value:e,counter:new Set([n])}),this.onRefAdded(n),!0)}},{key:"get",value:function(t,e){var n=this.cacheStore.get(t);return n?(n.counter.has(e)||(n.counter.add(e),this.onRefAdded(e)),n.value):null}},{key:"update",value:function(t,e,n){var i=this.cacheStore.get(t);return!!i&&(i.value=s(s({},i.value),e),i.counter.has(n)||(i.counter.add(n),this.onRefAdded(n)),!0)}},{key:"release",value:function(t,e){var n=this.cacheStore.get(t);return!!n&&(n.counter.delete(e),n.counter.size<=0&&this.cacheStore.delete(t),!0)}},{key:"releaseRef",value:function(t){var e=this;Array.from(this.cacheStore.keys()).forEach((function(n){e.release(n,t)}))}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])}(),lp=[],up=[],cp=function(){function t(){l(this,t)}return c(t,null,[{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.api;t.rafId&&(e.cancelAnimationFrame(t.rafId),t.rafId=null)}},{key:"executeTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.api;lp.length<=0&&up.length<=0||(up.forEach((function(t){return t()})),up=lp.splice(0,t.TASK_NUM_PER_FRAME),t.rafId=e.requestAnimationFrame((function(){t.executeTask(e)})))}},{key:"sliceImage",value:function(e,n,i,r){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:t.api,s=e.naturalWidth||e.width,l=e.naturalHeight||e.height,u=n-a,c=i-a,h=Math.ceil(s/u),d=Math.ceil(l/c),f={tileSize:[n,i],gridSize:[d,h],tiles:Array(d).fill(null).map((function(){return Array(h).fill(null)}))},p=function(t){for(var a=function(a){lp.push((function(){var h=a*u,d=t*c,p=[Math.min(n,s-h),Math.min(i,l-d)],g=p[0],v=p[1],y=o.createCanvas();y.width=n,y.height=i,y.getContext("2d").drawImage(e,h,d,g,v,0,0,g,v),f.tiles[t][a]={x:h,y:d,tileX:a,tileY:t,data:y},r()}))},d=0;d<h;d++)a(d)},g=0;g<d;g++)p(g);return t.stop(),t.executeTask(),f}}])}();cp.TASK_NUM_PER_FRAME=10;var hp=new sp;hp.onRefAdded=function(t){var e=this;t.addEventListener(Ts.DESTROY,(function(){e.releaseRef(t)}),{once:!0})};var dp=function(){return c((function t(e,n){l(this,t),this.gradientCache={},this.patternCache={},this.context=e,this.runtime=n}),[{key:"getImageSync",value:function(t,e,n){var i=he(t)?t:t.src;if(hp.has(i)){var r=hp.get(i,e);if(r.img.complete)return null==n||n(r),r}return this.getOrCreateImage(t,e).then((function(t){null==n||n(t)})).catch((function(t){console.error(t)})),null}},{key:"getOrCreateImage",value:function(t,e){var n=this,i=he(t)?t:t.src;if(!he(t)&&!hp.has(i)){var r={img:t,size:[t.naturalWidth||t.width,t.naturalHeight||t.height],tileSize:fp(t)};hp.put(i,r,e)}if(hp.has(i)){var a=hp.get(i,e);return a.img.complete?Promise.resolve(a):new Promise((function(t,e){a.img.addEventListener("load",(function(){a.size=[a.img.naturalWidth||a.img.width,a.img.naturalHeight||a.img.height],a.tileSize=fp(a.img),t(a)})),a.img.addEventListener("error",(function(t){e(t)}))}))}return new Promise((function(t,r){var a=n.context.config.createImage();if(a){var o={img:a,size:[0,0],tileSize:fp(a)};hp.put(i,o,e),a.onload=function(){o.size=[a.naturalWidth||a.width,a.naturalHeight||a.height],o.tileSize=fp(o.img),t(o)},a.onerror=function(t){r(t)},a.crossOrigin="Anonymous",a.src=i}}))}},{key:"createDownSampledImage",value:(e=jn(Bn().mark((function t(e,n){var i,r,a,o,l,u,c,h,d,f,p,g,v,y;return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getOrCreateImage(e,n);case 2:if(void 0===(i=t.sent).downSamplingRate){t.next=5;break}return t.abrupt("return",i);case 5:if(r=this.context.config.enableLargeImageOptimization,o=(a="boolean"==typeof r?{}:r).maxDownSampledImageSize,l=void 0===o?2048:o,u=a.downSamplingRateThreshold,c=void 0===u?.5:u,h=this.runtime.globalThis.createImageBitmap,d=b(i.size,2),f=d[0],p=d[1],g=i.img,v=Math.min((l+l)/(f+p),Math.max(.01,Math.min(c,.5))),y=s(s({},i),{},{downSamplingRate:v}),hp.update(i.img.src,y,n),!h){t.next=25;break}return t.prev=14,t.next=17,h(i.img,{resizeWidth:f*v,resizeHeight:p*v});case 17:g=t.sent,t.next=23;break;case 20:t.prev=20,t.t0=t.catch(14),v=1;case 23:t.next=26;break;case 25:v=1;case 26:return y=s(s({},this.getImageSync(e,n)),{},{downSampled:g,downSamplingRate:v}),hp.update(i.img.src,y,n),t.abrupt("return",y);case 29:case"end":return t.stop()}}),t,this,[[14,20]])}))),function(t,n){return e.apply(this,arguments)})},{key:"createImageTiles",value:(t=jn(Bn().mark((function t(e,n,i,r){var a,o,l,u,c;return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getOrCreateImage(e,r);case 2:return a=t.sent,o=r.ownerDocument.defaultView,l=o.requestAnimationFrame,u=o.cancelAnimationFrame,cp.api={requestAnimationFrame:l,cancelAnimationFrame:u,createCanvas:function(){return ws.createCanvas()}},c=s(s({},a),cp.sliceImage(a.img,a.tileSize[0],a.tileSize[0],i)),hp.update(a.img.src,c,r),t.abrupt("return",c);case 8:case"end":return t.stop()}}),t,this)}))),function(e,n,i,r){return t.apply(this,arguments)})},{key:"releaseImage",value:function(t,e){hp.release(he(t)?t:t.src,e)}},{key:"releaseImageRef",value:function(t){hp.releaseRef(t)}},{key:"getOrCreatePatternSync",value:function(t,e,n,i,r,a,o){var s=this.generatePatternKey(e);if(s&&this.patternCache[s])return this.patternCache[s];var l,u=e.image,c=e.repetition,h=e.transform,d=!1;if(he(u)){var f=this.getImageSync(u,t,o);l=null==f?void 0:f.img}else i?(l=i,d=!0):l=u;var p,g=l&&n.createPattern(l,c);return g&&(p=h?ts(Fa(h),new yl({})):tt(q()),d&&st(p,p,[1/r,1/r,1]),g.setTransform({a:p[0],b:p[1],c:p[4],d:p[5],e:p[12]+a[0],f:p[13]+a[1]})),s&&g&&(this.patternCache[s]=g),g}},{key:"getOrCreateGradient",value:function(t,e){var n=this.generateGradientKey(t),i=t.type,r=t.steps,a=t.min,o=t.width,s=t.height,l=t.angle,u=t.cx,c=t.cy,h=t.size;if(this.gradientCache[n])return this.gradientCache[n];var d=null;if(i===Mr.LinearGradient){var f=function(t,e,n,i){var r=di(i.value),a=0+e/2,o=0+n/2,s=Math.abs(e*Math.cos(r))+Math.abs(n*Math.sin(r));return{x1:t[0]+a-Math.cos(r)*s/2,y1:t[1]+o-Math.sin(r)*s/2,x2:t[0]+a+Math.cos(r)*s/2,y2:t[1]+o+Math.sin(r)*s/2}}(a,o,s,l),p=f.x1,g=f.y1,v=f.x2,y=f.y2;d=e.createLinearGradient(p,g,v,y)}else if(i===Mr.RadialGradient){var m=function(t,e,n,i,r,a){var o=i.value,s=r.value;i.unit===pr.kPercentage&&(o=i.value/100*e),r.unit===pr.kPercentage&&(s=r.value/100*n);var l=Math.max(ue([0,0],[o,s]),ue([0,n],[o,s]),ue([e,n],[o,s]),ue([e,0],[o,s]));return a&&(a instanceof Ar?l=a.value:a instanceof Nr&&("closest-side"===a.value?l=Math.min(o,e-o,s,n-s):"farthest-side"===a.value?l=Math.max(o,e-o,s,n-s):"closest-corner"===a.value&&(l=Math.min(ue([0,0],[o,s]),ue([0,n],[o,s]),ue([e,n],[o,s]),ue([e,0],[o,s]))))),{x:o+t[0],y:s+t[1],r:l}}(a,o,s,u,c,h),b=m.x,x=m.y,E=m.r;d=e.createRadialGradient(b,x,0,b,x,E)}return d&&(r.forEach((function(t){var e,n=t.offset,i=t.color;n.unit===pr.kPercentage&&(null===(e=d)||void 0===e||e.addColorStop(n.value/100,i.toString()))})),this.gradientCache[n]=d),this.gradientCache[n]}},{key:"generateGradientKey",value:function(t){var e=t.type,n=t.min,i=t.width,r=t.height,a=t.steps,o=t.angle,s=t.cx,l=t.cy,u=t.size;return"gradient-".concat(e,"-").concat((null==o?void 0:o.toString())||0,"-").concat((null==s?void 0:s.toString())||0,"-").concat((null==l?void 0:l.toString())||0,"-").concat((null==u?void 0:u.toString())||0,"-").concat(n[0],"-").concat(n[1],"-").concat(i,"-").concat(r,"-").concat(a.map((function(t){var e=t.offset,n=t.color;return"".concat(e).concat(n)})).join("-"))}},{key:"generatePatternKey",value:function(t){var e=t.image,n=t.repetition;return he(e)?"pattern-".concat(e,"-").concat(n):"rect"===e.nodeName?"pattern-".concat(e.entity,"-").concat(n):void 0}}]);var t,e}();function fp(t){if(!t.complete)return[0,0];var e=t.naturalWidth||t.width,n=t.naturalHeight||t.height,i=256;return[256,512].forEach((function(t){Math.ceil(n/t)*Math.ceil(e/t)<1e3&&(i=t)})),[i,i]}dp.isSupportTile=!!ws.createCanvas();var pp=function(){function t(){l(this,t)}return c(t,[{key:"apply",value:function(e){var n=e.renderingService,i=e.renderingContext,r=e.imagePool,a=i.root.ownerDocument.defaultView,o=function(t,e,n){var i=t.parsedStyle,r=i.width,a=i.height;r&&!a?t.setAttribute("height",n/e*r):!r&&a&&t.setAttribute("width",e/n*a)},s=function(t){var e=t.target,i=e.nodeName,a=e.attributes;if(i===Un.IMAGE){var s=a.src,l=a.keepAspectRatio;r.getImageSync(s,e,(function(t){var i=t.img,r=i.width,a=i.height;l&&o(e,r,a),e.renderable.dirty=!0,n.dirtify()}))}},l=function(t){var e=t.target,i=t.attrName,a=t.prevValue,s=t.newValue;e.nodeName===Un.IMAGE&&"src"===i&&(a!==s&&r.releaseImage(a,e),he(s)&&r.getOrCreateImage(s,e).then((function(t){var i=t.img,r=i.width,a=i.height;e.attributes.keepAspectRatio&&o(e,r,a),e.renderable.dirty=!0,n.dirtify()})).catch((function(){})))};n.hooks.init.tap(t.tag,(function(){a.addEventListener(Ts.MOUNTED,s),a.addEventListener(Ts.ATTR_MODIFIED,l)})),n.hooks.destroy.tap(t.tag,(function(){a.removeEventListener(Ts.MOUNTED,s),a.removeEventListener(Ts.ATTR_MODIFIED,l)}))}}])}();pp.tag="LoadImage";var gp=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).name="image-loader",t}return m(e,t),c(e,[{key:"init",value:function(t){this.context.imagePool=new dp(this.context,t),this.addRenderingPlugin(new pp)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Yn),vp=op("renderState"),yp=function(){function t(e){l(this,t),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,vp,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=q(),this.dprMatrix=q(),this.tmpMat4=q(),this.vec3a=k(),this.vec3b=k(),this.vec3c=k(),this.vec3d=k(),this.canvasRendererPluginOptions=e}return c(t,[{key:"apply",value:function(e,n){var i=this;this.context=e;var r=this.context,a=r.config,o=r.camera,s=r.renderingService,l=r.renderingContext,u=r.rBushRoot,c=r.pathGeneratorFactory,h=a.renderer.getConfig().enableRenderingOptimization;a.renderer.getConfig().enableDirtyCheck=!1,a.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=u,this.pathGeneratorFactory=c;var d=e.contextService,p=l.root.ownerDocument.defaultView,g=function(t){var e=t.target.rBushNode;e.aabb&&i.removedRBushNodeAABBs.push(e.aabb)},v=function(t){var e=t.target.rBushNode;e.aabb&&i.removedRBushNodeAABBs.push(e.aabb)};s.hooks.init.tap(t.tag,(function(){p.addEventListener(Ts.UNMOUNTED,g),p.addEventListener(Ts.CULLED,v);var t=d.getDPR(),e=a.width,n=a.height,r=d.getContext();i.clearRect(r,0,0,e*t,n*t,a.background)})),s.hooks.destroy.tap(t.tag,(function(){p.removeEventListener(Ts.UNMOUNTED,g),p.removeEventListener(Ts.CULLED,v),i.renderQueue=[],i.removedRBushNodeAABBs=[],rp(i,vp)[vp]={restoreStack:[],prevObject:null,currentContext:null}})),s.hooks.beginFrame.tap(t.tag,(function(){var t,e=d.getContext(),n=d.getDPR(),r=a.width,o=a.height,l=i.canvasRendererPluginOptions,u=l.dirtyObjectNumThreshold,c=l.dirtyObjectRatioThreshold,h=s.getStats(),f=h.total,g=h.rendered,v=g/f;i.clearFullScreen=i.clearFullScreenLastFrame||!(null!==(t=p.context.renderingPlugins[1])&&void 0!==t&&t.isFirstTimeRenderingFinished)||s.disableDirtyRectangleRendering()||g>u&&v>c,e&&("function"==typeof e.resetTransform?e.resetTransform():e.setTransform(1,0,0,1,0,0),i.clearFullScreen&&i.clearRect(e,0,0,r*n,o*n,a.background))}));var y=function(t,e){for(var r=[t];r.length>0;){var a,o=r.pop();o.isVisible()&&!o.isCulled()&&(h?i.renderDisplayObjectOptimized(o,e,i.context,rp(i,vp)[vp],n):i.renderDisplayObject(o,e,i.context,rp(i,vp)[vp],n));for(var s=(null===(a=o.sortable)||void 0===a||null===(a=a.sorted)||void 0===a?void 0:a.length)>0?o.sortable.sorted:o.childNodes,l=s.length-1;l>=0;l--)r.push(s[l])}};s.hooks.endFrame.tap(t.tag,(function(){if(0!==l.root.childNodes.length){h=a.renderer.getConfig().enableRenderingOptimization,rp(i,vp)[vp]={restoreStack:[],prevObject:null,currentContext:rp(i,vp)[vp].currentContext},rp(i,vp)[vp].currentContext.clear(),i.clearFullScreenLastFrame=!1;var t=d.getContext(),e=d.getDPR();if(ft(i.dprMatrix,[e,e,1]),at(i.vpMatrix,i.dprMatrix,o.getOrthoMatrix()),i.clearFullScreen)h?(t.save(),y(l.root,t),t.restore()):y(l.root,t),i.removedRBushNodeAABBs=[];else{var r=i.safeMergeAABB.apply(i,[i.mergeDirtyAABBs(i.renderQueue)].concat(f(i.removedRBushNodeAABBs.map((function(t){var e=t.minX,n=t.minY,i=t.maxX,r=t.maxY,a=new ti;return a.setMinMax([e,n,0],[i,r,0]),a})))));if(i.removedRBushNodeAABBs=[],ti.isEmpty(r))return void(i.renderQueue=[]);var s=i.convertAABB2Rect(r),u=s.x,c=s.y,g=s.width,v=s.height,m=j(i.vec3a,[u,c,0],i.vpMatrix),b=j(i.vec3b,[u+g,c,0],i.vpMatrix),x=j(i.vec3c,[u,c+v,0],i.vpMatrix),E=j(i.vec3d,[u+g,c+v,0],i.vpMatrix),w=Math.min(m[0],b[0],E[0],x[0]),k=Math.min(m[1],b[1],E[1],x[1]),M=Math.max(m[0],b[0],E[0],x[0]),S=Math.max(m[1],b[1],E[1],x[1]),N=Math.floor(w),T=Math.floor(k),A=Math.ceil(M-w),O=Math.ceil(S-k);t.save(),i.clearRect(t,N,T,A,O,a.background),t.beginPath(),t.rect(N,T,A,O),t.clip(),t.setTransform(i.vpMatrix[0],i.vpMatrix[1],i.vpMatrix[4],i.vpMatrix[5],i.vpMatrix[12],i.vpMatrix[13]),a.renderer.getConfig().enableDirtyRectangleRenderingDebug&&p.dispatchEvent(new ys(Ul.DIRTY_RECTANGLE,{dirtyRect:{x:N,y:T,width:A,height:O}})),i.searchDirtyObjects(r).sort((function(t,e){return t.sortable.renderOrder-e.sortable.renderOrder})).forEach((function(e){e&&e.isVisible()&&!e.isCulled()&&i.renderDisplayObject(e,t,i.context,rp(i,vp)[vp],n)})),t.restore(),i.renderQueue.forEach((function(t){i.saveDirtyAABB(t)})),i.renderQueue=[]}rp(i,vp)[vp].restoreStack.forEach((function(){t.restore()})),rp(i,vp)[vp].restoreStack=[]}else i.clearFullScreenLastFrame=!0})),s.hooks.render.tap(t.tag,(function(t){i.clearFullScreen||i.renderQueue.push(t)}))}},{key:"clearRect",value:function(t,e,n,i,r,a){t.clearRect(e,n,i,r),a&&(t.fillStyle=a,t.fillRect(e,n,i,r))}},{key:"renderDisplayObjectOptimized",value:function(t,e,n,i,r){var a=t.nodeName,o=!1,s=this.context.styleRendererFactory[a],l=this.pathGeneratorFactory[a],u=t.parsedStyle.clipPath;if(u){(!i.prevObject||!Vt(u.getWorldTransform(),i.prevObject.getWorldTransform()))&&(this.applyWorldTransform(e,u),i.prevObject=null);var c=this.pathGeneratorFactory[u.nodeName];c&&(e.save(),o=!0,e.beginPath(),c(e,u.parsedStyle),e.closePath(),e.clip())}if(s){(!i.prevObject||!Vt(t.getWorldTransform(),i.prevObject.getWorldTransform()))&&this.applyWorldTransform(e,t);var h=!i.prevObject;if(!h){var d=i.prevObject.nodeName;h=a===Un.TEXT?d!==Un.TEXT:a===Un.IMAGE?d!==Un.IMAGE:d===Un.TEXT||d===Un.IMAGE}s.applyStyleToContext(e,t,h,i),i.prevObject=t}l&&(e.beginPath(),l(e,t.parsedStyle),a!==Un.LINE&&a!==Un.PATH&&a!==Un.POLYLINE&&e.closePath()),s&&s.drawToContext(e,t,rp(this,vp)[vp],this,r),o&&e.restore(),t.renderable.dirty=!1}},{key:"renderDisplayObject",value:function(t,e,n,i,r){var a=t.nodeName,o=i.restoreStack[i.restoreStack.length-1];!o||t.compareDocumentPosition(o)&xs.DOCUMENT_POSITION_CONTAINS||(e.restore(),i.restoreStack.pop());var s=this.context.styleRendererFactory[a],l=this.pathGeneratorFactory[a],u=t.parsedStyle.clipPath;if(u){this.applyWorldTransform(e,u);var c=this.pathGeneratorFactory[u.nodeName];c&&(e.save(),i.restoreStack.push(t),e.beginPath(),c(e,u.parsedStyle),e.closePath(),e.clip())}s&&(this.applyWorldTransform(e,t),e.save(),this.applyAttributesToContext(e,t)),l&&(e.beginPath(),l(e,t.parsedStyle),a!==Un.LINE&&a!==Un.PATH&&a!==Un.POLYLINE&&e.closePath()),s&&(s.render(e,t.parsedStyle,t,n,this,r),e.restore()),t.renderable.dirty=!1}},{key:"applyAttributesToContext",value:function(t,e){var n=e.parsedStyle,i=n.stroke,r=n.fill,a=n.opacity,o=n.lineDash,s=n.lineDashOffset;o&&t.setLineDash(o),ce(s)||(t.lineDashOffset=s),ce(a)||(t.globalAlpha*=a),ce(i)||Array.isArray(i)||i.isNone||(t.strokeStyle=e.attributes.stroke),ce(r)||Array.isArray(r)||r.isNone||(t.fillStyle=e.attributes.fill)}},{key:"convertAABB2Rect",value:function(t){var e=t.getMin(),n=t.getMax(),i=Math.floor(e[0]),r=Math.floor(e[1]);return{x:i,y:r,width:Math.ceil(n[0])-i,height:Math.ceil(n[1])-r}}},{key:"mergeDirtyAABBs",value:function(t){var e=new ti;return t.forEach((function(t){var n=t.getRenderBounds();e.add(n);var i=t.renderable.dirtyRenderBounds;i&&e.add(i)})),e}},{key:"searchDirtyObjects",value:function(t){var e=b(t.getMin(),2),n=e[0],i=e[1],r=b(t.getMax(),2),a=r[0],o=r[1];return this.rBush.search({minX:n,minY:i,maxX:a,maxY:o}).map((function(t){return t.displayObject}))}},{key:"saveDirtyAABB",value:function(t){var e=t.renderable;e.dirtyRenderBounds||(e.dirtyRenderBounds=new ti);var n=t.getRenderBounds();n&&e.dirtyRenderBounds.update(n.center,n.halfExtents)}},{key:"applyWorldTransform",value:function(t,e,n){n?(Z(this.tmpMat4,e.getLocalTransform()),at(this.tmpMat4,n,this.tmpMat4),at(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(Z(this.tmpMat4,e.getWorldTransform()),at(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var t=new ti,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return n.forEach((function(e){t.add(e)})),t}}])}();function mp(t,e,n,i,r,a,o){var s,l;if("rect"===t.image.nodeName){var u=t.image.parsedStyle,c=u.width,h=u.height;l=i.contextService.getDPR();var d=i.config.offscreenCanvas;(s=a.offscreenCanvasCreator.getOrCreateCanvas(d)).width=c*l,s.height=h*l;var f=a.offscreenCanvasCreator.getOrCreateContext(d),p={restoreStack:[],prevObject:null,currentContext:new Map};t.image.forEach((function(t){r.renderDisplayObject(t,f,i,p,a)})),p.restoreStack.forEach((function(){f.restore()}))}return o.getOrCreatePatternSync(e,t,n,s,l,e.getGeometryBounds().min,(function(){e.renderable.dirty=!0,i.renderingService.dirtify()}))}function bp(t,e,n,i){var r;if(t.type===Mr.LinearGradient||t.type===Mr.RadialGradient){var a=e.getGeometryBounds(),o=a&&2*a.halfExtents[0]||1,l=a&&2*a.halfExtents[1]||1,u=a&&a.min||[0,0];r=i.getOrCreateGradient(s(s({type:t.type},t.value),{},{min:u,width:o,height:l}),n)}return r}yp.tag="CanvasRenderer";var xp=["shadowBlur","shadowOffsetX","shadowOffsetY"],Ep=["lineCap","lineJoin","miterLimit"],wp={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},kp={};function Mp(t,e,n,i){var r=i.has(e)?i.get(e):wp[e];return r!==n&&("lineDash"===e?t.setLineDash(n):t[e]=n,i.set(e,n)),r}var Sp=function(t){function e(){return l(this,e),v(this,e,arguments)}return m(e,t),c(e,[{key:"render",value:function(t,e,n,i,r,a){var o=e.fill,s=e.fillRule,l=e.opacity,u=void 0===l?1:l,c=e.fillOpacity,h=void 0===c?1:c,d=e.stroke,f=e.strokeOpacity,p=void 0===f?1:f,g=e.lineWidth,v=void 0===g?1:g,y=e.lineCap,m=e.lineJoin,b=e.shadowType,x=e.shadowColor,E=e.shadowBlur,w=e.filter,k=e.miterLimit,M=o&&!o.isNone,S=d&&!d.isNone&&v>0,N=0===(null==o?void 0:o.alpha),T=!(!w||!w.length),A=!ce(x)&&E>0,O=n.nodeName,P="inner"===b,C=S&&A&&(O===Un.PATH||O===Un.LINE||O===Un.POLYLINE||N||P);M&&(t.globalAlpha=u*h,C||Np(n,t,A),Tp(t,n,o,s,i,r,a,this.imagePool),C||this.clearShadowAndFilter(t,T,A)),S&&(t.globalAlpha=u*p,t.lineWidth=v,ce(k)||(t.miterLimit=k),ce(y)||(t.lineCap=y),ce(m)||(t.lineJoin=m),C&&(P&&(t.globalCompositeOperation="source-atop"),Np(n,t,!0),P&&(Ap(t,n,d,i,r,a,this.imagePool),t.globalCompositeOperation=wp.globalCompositeOperation,this.clearShadowAndFilter(t,T,!0))),Ap(t,n,d,i,r,a,this.imagePool))}},{key:"clearShadowAndFilter",value:function(t,e,n){if(n&&(t.shadowColor="transparent",t.shadowBlur=0),e){var i=t.filter;!ce(i)&&i.indexOf("drop-shadow")>-1&&(t.filter=i.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(function(){return c((function t(e){l(this,t),this.imagePool=e}),[{key:"applyAttributesToContext",value:function(t,e){}},{key:"render",value:function(t,e,n,i,r,a){}},{key:"applyCommonStyleToContext",value:function(t,e,n,i){var r=n?kp:i.prevObject.parsedStyle,a=e.parsedStyle;(n||a.opacity!==r.opacity)&&Mp(t,"globalAlpha",ce(a.opacity)?wp.globalAlpha:a.opacity,i.currentContext),(n||a.blend!==r.blend)&&Mp(t,"globalCompositeOperation",ce(a.blend)?wp.globalCompositeOperation:a.blend,i.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(t,e,n,i){var r=n?kp:i.prevObject.parsedStyle,a=e.parsedStyle,o=a.lineWidth,s=void 0===o?wp.lineWidth:o,l=a.fill&&!a.fill.isNone;if(a.stroke&&!a.stroke.isNone&&s>0){(n||e.attributes.stroke!==i.prevObject.attributes.stroke)&&Mp(t,"strokeStyle",ce(a.stroke)||Array.isArray(a.stroke)||a.stroke.isNone?wp.strokeStyle:e.attributes.stroke,i.currentContext),(n||a.lineWidth!==r.lineWidth)&&Mp(t,"lineWidth",ce(a.lineWidth)?wp.lineWidth:a.lineWidth,i.currentContext),(n||a.lineDash!==r.lineDash)&&Mp(t,"lineDash",a.lineDash||wp.lineDash,i.currentContext),(n||a.lineDashOffset!==r.lineDashOffset)&&Mp(t,"lineDashOffset",ce(a.lineDashOffset)?wp.lineDashOffset:a.lineDashOffset,i.currentContext);for(var u=0;u<Ep.length;u++){var c=Ep[u];(n||a[c]!==r[c])&&Mp(t,c,ce(a[c])?wp[c]:a[c],i.currentContext)}}l&&(n||e.attributes.fill!==i.prevObject.attributes.fill)&&Mp(t,"fillStyle",ce(a.fill)||Array.isArray(a.fill)||a.fill.isNone?wp.fillStyle:e.attributes.fill,i.currentContext)}},{key:"applyStyleToContext",value:function(t,e,n,i){var r=e.nodeName;this.applyCommonStyleToContext(t,e,n,i),r===Un.IMAGE||this.applyStrokeFillStyleToContext(t,e,n,i)}},{key:"applyShadowAndFilterStyleToContext",value:function(t,e,n,i){var r=e.parsedStyle;if(n){Mp(t,"shadowColor",r.shadowColor.toString(),i.currentContext);for(var a=0;a<xp.length;a++){var o=xp[a];Mp(t,o,r[o]||wp[o],i.currentContext)}}r.filter&&r.filter.length&&Mp(t,"filter",e.attributes.filter,i.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(e){Mp(t,"shadowColor",wp.shadowColor,i.currentContext);for(var a=0;a<xp.length;a++){var o=xp[a];Mp(t,o,wp[o],i.currentContext)}}if(n)if(e&&r){var s=t.filter;!ce(s)&&s.indexOf("drop-shadow")>-1&&Mp(t,"filter",s.replace(/drop-shadow\([^)]*\)/,"").trim()||wp.filter,i.currentContext)}else Mp(t,"filter",wp.filter,i.currentContext)}},{key:"fillToContext",value:function(t,e,n,i,r){var a=this,o=e.parsedStyle,s=o.fill,l=o.fillRule,u=null;if(Array.isArray(s)&&s.length>0)s.forEach((function(i){var r=Mp(t,"fillStyle",bp(i,e,t,a.imagePool),n.currentContext);u=null!=u?u:r,l?t.fill(l):t.fill()}));else{if(Xr(s)){var c=mp(s,e,t,e.ownerDocument.defaultView.context,i,r,this.imagePool);c&&(t.fillStyle=c,u=!0)}l?t.fill(l):t.fill()}null!==u&&Mp(t,"fillStyle",u,n.currentContext)}},{key:"strokeToContext",value:function(t,e,n,i,r){var a=this,o=e.parsedStyle.stroke,s=null;if(Array.isArray(o)&&o.length>0)o.forEach((function(i){var r=Mp(t,"strokeStyle",bp(i,e,t,a.imagePool),n.currentContext);s=null!=s?s:r,t.stroke()}));else{if(Xr(o)){var l=mp(o,e,t,e.ownerDocument.defaultView.context,i,r,this.imagePool);if(l){var u=Mp(t,"strokeStyle",l,n.currentContext);s=null!=s?s:u}}t.stroke()}null!==s&&Mp(t,"strokeStyle",s,n.currentContext)}},{key:"drawToContext",value:function(t,e,n,i,r){var a,o=e.nodeName,s=e.parsedStyle,l=s.opacity,u=void 0===l?wp.globalAlpha:l,c=s.fillOpacity,h=void 0===c?wp.fillOpacity:c,d=s.strokeOpacity,f=void 0===d?wp.strokeOpacity:d,p=s.lineWidth,g=void 0===p?wp.lineWidth:p,v=s.fill&&!s.fill.isNone,y=s.stroke&&!s.stroke.isNone&&g>0;if(v||y){var m=!ce(s.shadowColor)&&s.shadowBlur>0,b="inner"===s.shadowType,x=0===(null===(a=s.fill)||void 0===a?void 0:a.alpha),E=!(!s.filter||!s.filter.length),w=m&&y&&(o===Un.PATH||o===Un.LINE||o===Un.POLYLINE||x||b),k=null;if(v&&(w||this.applyShadowAndFilterStyleToContext(t,e,m,n),k=Mp(t,"globalAlpha",u*h,n.currentContext),this.fillToContext(t,e,n,i,r),w||this.clearShadowAndFilterStyleForContext(t,m,E,n)),y){var M=!1,S=Mp(t,"globalAlpha",u*f,n.currentContext);if(k=v?k:S,w&&(this.applyShadowAndFilterStyleToContext(t,e,m,n),M=!0,b)){var N=t.globalCompositeOperation;t.globalCompositeOperation="source-atop",this.strokeToContext(t,e,n,i,r),t.globalCompositeOperation=N,this.clearShadowAndFilterStyleForContext(t,m,E,n,!0)}this.strokeToContext(t,e,n,i,r),M&&this.clearShadowAndFilterStyleForContext(t,m,E,n)}null!==k&&Mp(t,"globalAlpha",k,n.currentContext)}}}])}());function Np(t,e,n){var i=t.parsedStyle,r=i.filter,a=i.shadowColor,o=i.shadowBlur,s=i.shadowOffsetX,l=i.shadowOffsetY;r&&r.length&&(e.filter=t.style.filter),n&&(e.shadowColor=a.toString(),e.shadowBlur=o||0,e.shadowOffsetX=s||0,e.shadowOffsetY=l||0)}function Tp(t,e,n,i,r,a,o,s){var l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Array.isArray(n)?n.forEach((function(n){t.fillStyle=bp(n,e,t,s),l||(i?t.fill(i):t.fill())})):(Xr(n)&&(t.fillStyle=mp(n,e,t,r,a,o,s)),l||(i?t.fill(i):t.fill()))}function Ap(t,e,n,i,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Array.isArray(n)?n.forEach((function(n){t.strokeStyle=bp(n,e,t,o),s||t.stroke()})):(Xr(n)&&(t.strokeStyle=mp(n,e,t,i,r,a,o)),s||t.stroke())}var Op=function(t){function e(){return l(this,e),v(this,e,arguments)}return m(e,t),c(e,[{key:"renderDownSampled",value:function(t,e,n,i){var r=i.src,a=i.imageCache;a.downSampled?t.drawImage(a.downSampled,Math.floor(i.drawRect[0]),Math.floor(i.drawRect[1]),Math.ceil(i.drawRect[2]),Math.ceil(i.drawRect[3])):this.imagePool.createDownSampledImage(r,n).then((function(){n.ownerDocument&&(n.renderable.dirty=!0,n.ownerDocument.defaultView.context.renderingService.dirtify())})).catch((function(t){console.error(t)}))}},{key:"renderTile",value:function(t,e,n,i){var r=i.src,a=i.imageCache,o=i.imageRect,s=i.drawRect,l=a.size,u=t.getTransform(),c=u.a,h=u.b,d=u.c,f=u.d,p=u.e,g=u.f;if(t.resetTransform(),null!=a&&a.gridSize){for(var v=[l[0]/o[2],l[1]/o[3]],y=[a.tileSize[0]/v[0],a.tileSize[1]/v[1]],m=[Math.floor((s[0]-o[0])/y[0]),Math.ceil((s[0]+s[2]-o[0])/y[0])],b=m[0],x=m[1],E=[Math.floor((s[1]-o[1])/y[1]),Math.ceil((s[1]+s[3]-o[1])/y[1])],w=E[1],k=E[0];k<=w;k++)for(var M=b;M<=x;M++){var S=a.tiles[k][M];if(S){var N=[Math.floor(o[0]+S.tileX*y[0]),Math.floor(o[1]+S.tileY*y[1]),Math.ceil(y[0]),Math.ceil(y[1])];t.drawImage(S.data,N[0],N[1],N[2],N[3])}}t.setTransform(c,h,d,f,p,g)}else this.imagePool.createImageTiles(r,[],(function(){n.ownerDocument&&(n.renderable.dirty=!0,n.ownerDocument.defaultView.context.renderingService.dirtify())}),n).catch((function(t){console.error(t)}))}},{key:"render",value:function(t,n,i){var r=n.x,a=void 0===r?0:r,o=n.y,s=void 0===o?0:o,l=n.width,u=n.height,c=n.src,h=n.shadowColor,d=n.shadowBlur,f=this.imagePool.getImageSync(c,i),p=null==f?void 0:f.img,g=l,v=u;if(p){var y,m,x,E,w,M,S,N,T,A,O,P,C,R,L;g||(g=p.width),v||(v=p.height),Np(i,t,!ce(h)&&d>0);try{var D=i.ownerDocument.defaultView.getContextService().getDomElement(),I=D.width,_=D.height,B=t.getTransform(),F=B.a,G=B.b,z=function(t,e){var n=j(k(),[t[0],t[1],0],e),i=j(k(),[t[0]+t[2],t[1],0],e),r=j(k(),[t[0],t[1]+t[3],0],e),a=j(k(),[t[0]+t[2],t[1]+t[3],0],e);return[Math.min(n[0],i[0],r[0],a[0]),Math.min(n[1],i[1],r[1],a[1]),Math.max(n[0],i[0],r[0],a[0])-Math.min(n[0],i[0],r[0],a[0]),Math.max(n[1],i[1],r[1],a[1])-Math.min(n[1],i[1],r[1],a[1])]}([a,s,g,v],Q(F,B.c,0,0,G,B.d,0,0,0,0,1,0,B.e,B.f,0,1)),V=(y=z,x=(m=b([0,0,I,_],4))[0],E=m[1],w=m[2],M=m[3],N=(S=b(y,4))[0],T=S[1],A=S[2],O=S[3],P=Math.max(x,N),C=Math.max(E,T),R=Math.min(x+w,N+A),L=Math.min(E+M,T+O),R<=P||L<=C?null:[P,C,R-P,L-C]);if(!V)return;if(!i.ownerDocument.defaultView.getConfig().enableLargeImageOptimization)return void e.renderFull(t,n,i,{image:p,drawRect:[a,s,g,v]});if(z[2]/f.size[0]<(f.downSamplingRate||.5))return void this.renderDownSampled(t,n,i,{src:c,imageCache:f,drawRect:[a,s,g,v]});if(!dp.isSupportTile)return void e.renderFull(t,n,i,{image:p,drawRect:[a,s,g,v]});this.renderTile(t,n,i,{src:c,imageCache:f,imageRect:z,drawRect:V})}catch(t){}}}},{key:"drawToContext",value:function(t,e,n,i,r){this.render(t,e.parsedStyle,e)}}],[{key:"renderFull",value:function(t,e,n,i){t.drawImage(i.image,Math.floor(i.drawRect[0]),Math.floor(i.drawRect[1]),Math.ceil(i.drawRect[2]),Math.ceil(i.drawRect[3]))}}])}(Sp),Pp=function(t){function e(){return l(this,e),v(this,e,arguments)}return m(e,t),c(e,[{key:"render",value:function(t,e,n,i,r,a){n.getBounds();var o=e.lineWidth,s=void 0===o?1:o,l=e.textAlign,u=void 0===l?"start":l,c=e.textBaseline,h=void 0===c?"alphabetic":c,d=e.lineJoin,f=void 0===d?"miter":d,p=e.miterLimit,g=void 0===p?10:p,v=e.letterSpacing,y=void 0===v?0:v,m=e.stroke,b=e.fill,x=e.fillRule,E=e.fillOpacity,w=void 0===E?1:E,k=e.strokeOpacity,M=void 0===k?1:k,S=e.opacity,N=void 0===S?1:S,T=e.metrics,A=e.x,O=void 0===A?0:A,P=e.y,C=void 0===P?0:P,R=e.dx,L=e.dy,D=e.shadowColor,I=e.shadowBlur,_=T.font,B=T.lines,F=T.height,j=T.lineHeight,G=T.lineMetrics;t.font=_,t.lineWidth=s,t.textAlign="middle"===u?"center":u;var z=h;"alphabetic"===z&&(z="bottom"),t.lineJoin=f,ce(g)||(t.miterLimit=g);var V=C;"middle"===h?V+=-F/2-j/2:"bottom"===h||"alphabetic"===h||"ideographic"===h?V+=-F:"top"!==h&&"hanging"!==h||(V+=-j);var W=O+(R||0);V+=L||0,1===B.length&&("bottom"===z?(z="middle",V-=.5*F):"top"===z&&(z="middle",V+=.5*F)),t.textBaseline=z,Np(n,t,!ce(D)&&I>0);for(var U=0;U<B.length;U++){var H=s/2+W;V+=j,ce(m)||m.isNone||!s||this.drawLetterSpacing(t,n,B[U],G[U],u,H,V,y,b,x,w,m,M,N,!0,i,r,a),ce(b)||this.drawLetterSpacing(t,n,B[U],G[U],u,H,V,y,b,x,w,m,M,N,!1,i,r,a)}}},{key:"drawLetterSpacing",value:function(t,e,n,i,r,a,o,s,l,u,c,h,d,f,p,g,v,y){if(0!==s){var m=t.textAlign;t.textAlign="left";var b=a;"center"===r||"middle"===r?b=a-i.width/2:"right"!==r&&"end"!==r||(b=a-i.width);for(var x=Array.from(n),E=t.measureText(n).width,w=0,k=0;k<x.length;++k){var M=x[k];p?this.strokeText(t,e,M,b,o,h,d,g,v,y):this.fillText(t,e,M,b,o,l,u,c,f,g,v,y),b+=E-(w=t.measureText(n.substring(k+1)).width)+s,E=w}t.textAlign=m}else p?this.strokeText(t,e,n,a,o,h,d,g,v,y):this.fillText(t,e,n,a,o,l,u,c,f,g,v,y)}},{key:"fillText",value:function(t,e,n,i,r,a,o,s,l,u,c,h){var d;Tp(t,e,a,o,u,c,h,this.imagePool,!0);var f=!ce(s)&&1!==s;f&&(d=t.globalAlpha,t.globalAlpha=s*l),t.fillText(n,i,r),f&&(t.globalAlpha=d)}},{key:"strokeText",value:function(t,e,n,i,r,a,o,s,l,u){var c;Ap(t,e,a,s,l,u,this.imagePool,!0);var h=!ce(o)&&1!==o;h&&(c=t.globalAlpha,t.globalAlpha=o),t.strokeText(n,i,r),h&&(t.globalAlpha=c)}},{key:"drawToContext",value:function(t,e,n,i,r){this.render(t,e.parsedStyle,e,e.ownerDocument.defaultView.context,i,r)}}])}(Sp),Cp=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),(t=v(this,e)).name="canvas-renderer",t.options=n,t}return m(e,t),c(e,[{key:"init",value:function(){var t,e=s({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),n=this.context.imagePool,i=new Sp(n),r=(a(a(a(a(a(a(a(a(a(a(t={},Un.CIRCLE,i),Un.ELLIPSE,i),Un.RECT,i),Un.IMAGE,new Op(n)),Un.TEXT,new Pp(n)),Un.LINE,i),Un.POLYLINE,i),Un.POLYGON,i),Un.PATH,i),Un.GROUP,void 0),a(a(a(t,Un.HTML,void 0),Un.MESH,void 0),Un.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=r,this.context.styleRendererFactory=r,this.addRenderingPlugin(new yp(e))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(Yn),Rp=function(){function t(){l(this,t)}return c(t,[{key:"apply",value:function(e,n){var i=this,r=e.renderingService,a=e.renderingContext,o=e.config;this.context=e;var s=a.root.ownerDocument.defaultView,l=function(t){r.hooks.pointerMove.call(t)},u=function(t){r.hooks.pointerUp.call(t)},c=function(t){r.hooks.pointerDown.call(t)},h=function(t){r.hooks.pointerOver.call(t)},d=function(t){r.hooks.pointerOut.call(t)},f=function(t){r.hooks.pointerCancel.call(t)},p=function(t){r.hooks.pointerWheel.call(t)},g=function(t){r.hooks.click.call(t)};r.hooks.init.tap(t.tag,(function(){var t=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="none",t.style.msTouchAction="none"):s.supportsPointerEvents&&(t.style.touchAction="none"),s.supportsPointerEvents?function(t){n.globalThis.document.addEventListener("pointermove",l,!0),t.addEventListener("pointerdown",c,!0),t.addEventListener("pointerleave",d,!0),t.addEventListener("pointerover",h,!0),n.globalThis.addEventListener("pointerup",u,!0),n.globalThis.addEventListener("pointercancel",f,!0)}(t):function(t){n.globalThis.document.addEventListener("mousemove",l,!0),t.addEventListener("mousedown",c,!0),t.addEventListener("mouseout",d,!0),t.addEventListener("mouseover",h,!0),n.globalThis.addEventListener("mouseup",u,!0)}(t),s.supportsTouchEvents&&function(t){t.addEventListener("touchstart",c,!0),t.addEventListener("touchend",u,!0),t.addEventListener("touchmove",l,!0),t.addEventListener("touchcancel",f,!0)}(t),o.useNativeClickEvent&&t.addEventListener("click",g,!0),t.addEventListener("wheel",p,{passive:!0,capture:!0})})),r.hooks.destroy.tap(t.tag,(function(){var t=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="",t.style.msTouchAction=""):s.supportsPointerEvents&&(t.style.touchAction=""),s.supportsPointerEvents?function(t){n.globalThis.document.removeEventListener("pointermove",l,!0),t.removeEventListener("pointerdown",c,!0),t.removeEventListener("pointerleave",d,!0),t.removeEventListener("pointerover",h,!0),n.globalThis.removeEventListener("pointerup",u,!0),n.globalThis.removeEventListener("pointercancel",f,!0)}(t):function(t){n.globalThis.document.removeEventListener("mousemove",l,!0),t.removeEventListener("mousedown",c,!0),t.removeEventListener("mouseout",d,!0),t.removeEventListener("mouseover",h,!0),n.globalThis.removeEventListener("mouseup",u,!0)}(t),s.supportsTouchEvents&&function(t){t.removeEventListener("touchstart",c,!0),t.removeEventListener("touchend",u,!0),t.removeEventListener("touchmove",l,!0),t.removeEventListener("touchcancel",f,!0)}(t),o.useNativeClickEvent&&t.removeEventListener("click",g,!0),t.removeEventListener("wheel",p,!0)}))}}])}();Rp.tag="DOMInteraction";var Lp=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).name="dom-interaction",t}return m(e,t),c(e,[{key:"init",value:function(){this.addRenderingPlugin(new Rp)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Yn),Dp=function(){function t(){l(this,t),this.displayObjectHTMLElementMap=new WeakMap}return c(t,[{key:"joinTransformMatrix",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return"matrix(".concat([t[0],t[1],t[4],t[5],t[12]+e[0],t[13]+e[1]].join(","),")")}},{key:"apply",value:function(e,n){var i=this,r=e.camera,a=e.renderingContext,o=e.renderingService;this.context=e;var s=a.root.ownerDocument.defaultView,l=s.context.eventService.nativeHTMLMap,u=function(t,e){e.style.transform=i.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())},c=function(t){var e=t.target;if(e.nodeName===Un.HTML){i.$camera||(i.$camera=i.createCamera(r));var n=i.getOrCreateEl(e);i.$camera.appendChild(n),Object.keys(e.attributes).forEach((function(t){i.updateAttribute(t,e)})),u(e,n),l.set(n,e)}},h=function(t){var e=t.target;if(e.nodeName===Un.HTML&&i.$camera){var n=i.getOrCreateEl(e);n&&(n.remove(),l.delete(n))}},d=function(t){var e=t.target;if(e.nodeName===Un.HTML){var n=t.attrName;i.updateAttribute(n,e)}},f=function(t){var e=t.target;(e.nodeName===Un.FRAGMENT?e.childNodes:[e]).forEach((function(t){if(t.nodeName===Un.HTML){var e=i.getOrCreateEl(t);u(t,e)}}))},p=function(){if(i.$camera){var t=i.context.config,e=t.width,n=t.height;i.$camera.parentElement.style.width="".concat(e||0,"px"),i.$camera.parentElement.style.height="".concat(n||0,"px")}};o.hooks.init.tap(t.tag,(function(){s.addEventListener(Ul.RESIZE,p),s.addEventListener(Ts.MOUNTED,c),s.addEventListener(Ts.UNMOUNTED,h),s.addEventListener(Ts.ATTR_MODIFIED,d),s.addEventListener(Ts.BOUNDS_CHANGED,f)})),o.hooks.endFrame.tap(t.tag,(function(){i.$camera&&a.renderReasons.has(ks.CAMERA_CHANGED)&&(i.$camera.style.transform=i.joinTransformMatrix(r.getOrthoMatrix()))})),o.hooks.destroy.tap(t.tag,(function(){i.$camera&&i.$camera.remove(),s.removeEventListener(Ul.RESIZE,p),s.removeEventListener(Ts.MOUNTED,c),s.removeEventListener(Ts.UNMOUNTED,h),s.removeEventListener(Ts.ATTR_MODIFIED,d),s.removeEventListener(Ts.BOUNDS_CHANGED,f)}))}},{key:"createCamera",value:function(t){var e=this.context.config,n=e.document,i=e.width,r=e.height,a=this.context.contextService.getDomElement(),o=a.parentNode;if(o){var s="g-canvas-camera",l=o.querySelector("#".concat(s));if(!l){var u=(n||document).createElement("div");u.style.overflow="hidden",u.style.pointerEvents="none",u.style.position="absolute",u.style.left="0px",u.style.top="0px",u.style.width="".concat(i||0,"px"),u.style.height="".concat(r||0,"px");var c=(n||document).createElement("div");l=c,c.id=s,c.style.position="absolute",c.style.left="".concat(a.offsetLeft||0,"px"),c.style.top="".concat(a.offsetTop||0,"px"),c.style.transformOrigin="left top",c.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),c.style.pointerEvents="none",c.style.width="100%",c.style.height="100%",u.appendChild(c),o.appendChild(u)}return l}return null}},{key:"getOrCreateEl",value:function(t){var e=this.context.config.document,n=this.displayObjectHTMLElementMap.get(t);return n||(n=(e||document).createElement("div"),t.parsedStyle.$el=n,this.displayObjectHTMLElementMap.set(t,n),t.id&&(n.id=t.id),t.name&&n.setAttribute("name",t.name),t.className&&(n.className=t.className),n.style.position="absolute",n.style["will-change"]="transform",n.style.transform=this.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())),n}},{key:"updateAttribute",value:function(t,e){var n=this.getOrCreateEl(e);switch(t){case"innerHTML":var i=e.parsedStyle.innerHTML;he(i)?n.innerHTML=i:(n.innerHTML="",n.appendChild(i));break;case"x":n.style.left="".concat(e.parsedStyle.x,"px");break;case"y":n.style.top="".concat(e.parsedStyle.y,"px");break;case"transformOrigin":var r=e.parsedStyle.transformOrigin;n.style["transform-origin"]="".concat(r[0].buildCSSText(null,null,"")," ").concat(r[1].buildCSSText(null,null,""));break;case"width":var a=e.parsedStyle.width;n.style.width=le(a)?"".concat(a,"px"):a.toString();break;case"height":var o=e.parsedStyle.height;n.style.height=le(o)?"".concat(o,"px"):o.toString();break;case"zIndex":var s=e.parsedStyle.zIndex;n.style["z-index"]="".concat(s);break;case"visibility":var l=e.parsedStyle.visibility;n.style.visibility=l;break;case"pointerEvents":var u=e.parsedStyle.pointerEvents,c=void 0===u?"auto":u;n.style.pointerEvents=c;break;case"opacity":var h=e.parsedStyle.opacity;n.style.opacity="".concat(h);break;case"fill":var d=e.parsedStyle.fill,f="";qr(d)?f=d.isNone?"transparent":e.getAttribute("fill"):Array.isArray(d)?f=e.getAttribute("fill"):Xr(d),n.style.background=f;break;case"stroke":var p=e.parsedStyle.stroke,g="";qr(p)?g=p.isNone?"transparent":e.getAttribute("stroke"):Array.isArray(p)?g=e.getAttribute("stroke"):Xr(p),n.style["border-color"]=g,n.style["border-style"]="solid";break;case"lineWidth":var v=e.parsedStyle.lineWidth;n.style["border-width"]="".concat(v||0,"px");break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":var y=e.style.filter;n.style.filter=y;break;default:ce(e.style[t])||""===e.style[t]||(n.style[t]=e.style[t])}}}])}();Dp.tag="HTMLRendering";var Ip=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).name="html-renderer",t}return m(e,t),c(e,[{key:"init",value:function(){this.addRenderingPlugin(new Dp)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Yn),_p=function(){return c((function t(e){l(this,t),this.renderingContext=e.renderingContext,this.canvasConfig=e.config}),[{key:"init",value:function(){var t=this.canvasConfig,e=t.container,n=t.canvas;if(n)this.$canvas=n,e&&n.parentElement!==e&&e.appendChild(n),this.$container=n.parentElement,this.canvasConfig.container=this.$container;else if(e&&(this.$container=he(e)?document.getElementById(e):e,this.$container)){var i=document.createElement("canvas");this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(t,e){var n=this.canvasConfig.devicePixelRatio;this.dpr=n,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*e,function(t,e,n){Eo&&t.style&&(t.style.width=e+"px",t.style.height=n+"px")}(this.$canvas,t,e)),this.renderingContext.renderReasons.add(ks.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)}},{key:"toDataURL",value:(t=jn(Bn().mark((function t(){var e,n,i,r=arguments;return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(e=r.length>0&&void 0!==r[0]?r[0]:{}).type,i=e.encoderOptions,t.abrupt("return",this.context.canvas.toDataURL(n,i));case 3:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})}]);var t}(),Bp=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).name="canvas-context-register",t}return m(e,t),c(e,[{key:"init",value:function(){this.context.ContextService=_p}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(Yn),Fp=function(t){function e(t){var n;return l(this,e),(n=v(this,e,[t])).registerPlugin(new Bp),n.registerPlugin(new gp),n.registerPlugin(new Lf),n.registerPlugin(new Cp),n.registerPlugin(new Lp),n.registerPlugin(new ip),n.registerPlugin(new Ip),n}return m(e,t),c(e)}($n);const jp=function(t,e){if(t)if($e(t))for(var n=0,i=t.length;n<i&&!1!==e(t[n],n);n++);else if(vn(t))for(var r in t)if(t.hasOwnProperty(r)&&!1===e(t[r],r))break};var Gp=Object.prototype.hasOwnProperty;const zp=function(t,e){if(null===t||!jh(t))return{};var n={};return jp(e,(function(e){Gp.call(t,e)&&(n[e]=t[e])})),n};class Vp extends yf{constructor(t){super(Object.assign(Object.assign({},t),{style:Object.assign({},Vp.defaultStyleProps,t.style)})),this.rootPointerEvent=new gs(null),this.forwardEvents=t=>{const e=this.context.canvas,n=e.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(t,n).forEach((i=>{const r=this.bootstrapEvent(this.rootPointerEvent,i,n,t);Bd(e.context.eventService,"mappingTable.pointerupoutside",[]),e.context.eventService.mapEvent(r)}))}}get eventService(){return this.context.canvas.context.eventService}get events(){return[ic.CLICK,ic.POINTER_DOWN,ic.POINTER_MOVE,ic.POINTER_UP,ic.POINTER_OVER,ic.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.drawPortShapes(t,e)}getKeyStyle(t){const e=zp(t,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:n=0,dy:i=0}=e,r=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["dx","dy"]),[a,o]=this.getSize(t);return Object.assign(Object.assign({x:n,y:i},r),{width:a,height:o})}drawKeyShape(t,e){const n=this.getKeyStyle(t),{x:i,y:r,width:a=0,height:o=0}=n,s=this.upsert("key-container",Dl,{x:i,y:r,width:a,height:o,opacity:0},e);return this.upsert("key",Ml,n,s)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof Fp))return;const t=this.getDomElement();this.events.forEach((e=>{t.addEventListener(e,this.forwardEvents)}))}attributeChangedCallback(t,e,n){"zIndex"===t&&e!==n&&(this.getDomElement().style.zIndex=n)}destroy(){const t=this.getDomElement();this.events.forEach((e=>{t.removeEventListener(e,this.forwardEvents)})),super.destroy()}normalizeToPointerEvent(t,e){const n=[];if(e.isTouchEvent(t))for(let e=0;e<t.changedTouches.length;e++){const i=t.changedTouches[e];hn(i.button)&&(i.button=0),hn(i.buttons)&&(i.buttons=1),hn(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),hn(i.width)&&(i.width=i.radiusX||1),hn(i.height)&&(i.height=i.radiusY||1),hn(i.tiltX)&&(i.tiltX=0),hn(i.tiltY)&&(i.tiltY=0),hn(i.pointerType)&&(i.pointerType="touch"),hn(i.pointerId)&&(i.pointerId=i.identifier||0),hn(i.pressure)&&(i.pressure=i.force||.5),hn(i.twist)&&(i.twist=0),hn(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i)}else if(e.isMouseEvent(t)){const e=t;hn(e.isPrimary)&&(e.isPrimary=!0),hn(e.width)&&(e.width=1),hn(e.height)&&(e.height=1),hn(e.tiltX)&&(e.tiltX=0),hn(e.tiltY)&&(e.tiltY=0),hn(e.pointerType)&&(e.pointerType="mouse"),hn(e.pointerId)&&(e.pointerId=1),hn(e.pressure)&&(e.pressure=.5),hn(e.twist)&&(e.twist=0),hn(e.tangentialPressure)&&(e.tangentialPressure=0),e.isNormalized=!0,n.push(e)}else n.push(t);return n}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}bootstrapEvent(t,e,n,i){t.view=n,t.originalEvent=null,t.nativeEvent=i,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);const{x:r,y:a}=this.getViewportXY(e);t.viewport.x=r,t.viewport.y=a;const[o,s]=this.context.canvas.getCanvasByViewport([r,a]);return t.canvas.x=o,t.canvas.y=s,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=i.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t}getViewportXY(t){let e,n;const{offsetX:i,offsetY:r,clientX:a,clientY:o}=t;if(ce(i)||ce(r)){const t=this.eventService.client2Viewport({x:a,y:o});e=t.x,n=t.y}else e=i,n=r;return{x:e,y:n}}onframe(){super.onframe();const{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}}Vp.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var Wp=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n};class Up extends yf{constructor(t){super(Hd({style:Up.defaultStyleProps},t))}getKeyStyle(t){const[e,n]=this.getSize(t),i=super.getKeyStyle(t),{fillOpacity:r,opacity:a=r}=i,o=Wp(i,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:a},o),{width:e,height:n,x:-e/2,y:-n/2})}getBounds(){return this.getShape("key").getBounds()}getHaloStyle(t){if(!1===t.halo)return!1;const e=this.getShape("key").attributes,{fill:n,stroke:i}=e,r=(Wp(e,["fill","stroke"]),Gd(this.getGraphicStyle(t),"halo")),a=Number(r.lineWidth),[o,s]=Uh(this.getSize(t),[a,a]),{lineWidth:l}=r,u={fill:"transparent",lineWidth:l/2,width:o-l/2,height:s-l/2,x:-(o-l/2)/2,y:-(s-l/2)/2};return Object.assign(Object.assign({},r),u)}getIconStyle(t){const e=super.getIconStyle(t),[n,i]=this.getSize(t);return!!e&&Object.assign({width:n*Td,height:i*Td},e)}drawKeyShape(t,e){const n=this.upsert("key",uf,this.getKeyStyle(t),e);return df(this),n}drawHaloShape(t,e){this.upsert("halo",Dl,this.getHaloStyle(t),e)}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&ff(this)}}Up.defaultStyleProps={size:32};class Hp extends yf{constructor(t){super(t)}getKeyStyle(t){const[e,n]=this.getSize(t);return Object.assign(Object.assign({},super.getKeyStyle(t)),{width:e,height:n,x:-e/2,y:-n/2})}getIconStyle(t){const e=super.getIconStyle(t),{width:n,height:i}=this.getShape("key").attributes;return!!e&&Object.assign({width:n*Td,height:i*Td},e)}drawKeyShape(t,e){return this.upsert("key",Dl,this.getKeyStyle(t),e)}}class Yp extends bf{constructor(t){super(t)}getInnerR(t){return t.innerR||3*this.getOuterR(t)/8}getOuterR(t){return Math.min(...this.getSize(t))/2}getPoints(t){return[[0,-(e=this.getOuterR(t))],[(n=this.getInnerR(t))*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)],[e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[0,n],[-e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[-n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[-e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[-n*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)]];var e,n}getIconStyle(t){const e=super.getIconStyle(t),n=2*this.getInnerR(t)*Td;return!!e&&Object.assign({width:n,height:n},e)}getPortXY(t,e){const{placement:n="top"}=e;return qg(this.getShape("key").getLocalBounds(),n,function(t,e){const n={};return n.top=[0,-t],n.left=[-t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],n["left-bottom"]=[-t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],n.bottom=[0,e],n["right-bottom"]=[t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],n.right=n.default=[t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],n}(this.getOuterR(t),this.getInnerR(t)),!1)}}class $p extends bf{constructor(t){super(Hd({style:$p.defaultStyleProps},t))}getPoints(t){const{direction:e}=t,[n,i]=this.getSize(t);return function(t,e,n){const i=e/2,r=t/2,a={up:[[-r,i],[r,i],[0,-i]],left:[[-r,0],[r,i],[r,-i]],right:[[-r,i],[-r,-i],[r,0]],down:[[-r,-i],[r,-i],[0,i]]};return a[n]||a.up}(n,i,e)}getPortXY(t,e){const{direction:n}=t,{placement:i="top"}=e,r=this.getShape("key").getLocalBounds(),[a,o]=this.getSize(t),s=function(t,e,n){const i=e/2,r=t/2,a={};return"down"===n?(a.bottom=a.default=[0,i],a.right=[r,-i],a.left=[-r,-i]):"left"===n?(a.top=[r,-i],a.bottom=[r,i],a.left=a.default=[-r,0]):"right"===n?(a.top=[-r,-i],a.bottom=[-r,i],a.right=a.default=[r,0]):(a.left=[-r,i],a.top=a.default=[0,-i],a.right=[r,i]),a}(a,o,n);return qg(r,i,s,!1)}getIconStyle(t){const{icon:e,iconText:n,iconSrc:i,direction:r}=t;if(!1===e||Jd(n||i))return!1;const a=Gd(this.getGraphicStyle(t),"icon"),o=this.getShape("key").getLocalBounds(),[s,l]=function(t,e){const{center:n}=t,[i,r]=Gc(t);return["up"===e||"down"===e?n[0]:"right"===e?n[0]-i/6:n[0]+i/6,"left"===e||"right"===e?n[1]:"down"===e?n[1]-r/6:n[1]+r/6]}(o,r),u=2*function(t,e){let[n,i]=Gc(t);return[n,i]="up"===e||"down"===e?[n,i]:[i,n],(Math.pow(i,2)-Math.pow(Math.sqrt(Math.pow(n/2,2)+Math.pow(i,2))-n/2,2))/(2*i)}(o,r)*Td;return Object.assign({x:s,y:l,width:u,height:u},a)}}$p.defaultStyleProps={size:40,direction:"up"};var Xp=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n};class qp extends yf{constructor(t){super(Hd({style:qp.defaultStyleProps},t)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(t){const{collapsed:e,childrenNode:n=[]}=t;return 0===n.length?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){const{padding:e,collapsedSize:n}=t,[i,r,a,o]=_c(e);return Uh(Wd(n),[o+r,i+a,0])}getCollapsedKeySize(t){return Wd(t.collapsedSize)}getExpandedKeySize(t){const e=this.getContentBBox(t);return[Fc(e),jc(e),0]}getContentBBox(t){const{childrenNode:e=[],padding:n}=t,i=e.map((t=>this.context.element.getElement(t))).filter(Boolean);if(0===i.length){const e=new ti,{x:n=0,y:i=0,size:r}=t,[a,o]=Wd(r);return e.setMinMax([n-a/2,i-o/2,0],[n+a/2,i+o/2,0]),e}const r=Uc(i.map((t=>t.getBounds())));return n?Wc(r,n):r}drawCollapsedMarkerShape(t,e){const n=this.getCollapsedMarkerStyle(t);this.upsert("collapsed-marker",pf,n,e),df(this)}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;const e=Gd(this.getGraphicStyle(t),"collapsedMarker"),{type:n}=e,i=Xp(e,["type"]),r=this.getShape("key"),[a,o]=ud(r.getLocalBounds(),"center"),s=Object.assign(Object.assign({},i),{x:a,y:o});if(n){const e=this.getCollapsedMarkerText(n,t);Object.assign(s,{text:e})}return s}getCollapsedMarkerText(t,e){const{childrenData:n=[]}=e,{model:i}=this.context;return"descendant-count"===t?i.getDescendantsData(this.id).length.toString():"child-count"===t?n.length.toString():"node-count"===t?i.getDescendantsData(this.id).filter((t=>"node"===i.getElementType(wh(t)))).length.toString():gn(t)?t(n):""}getComboPosition(t){const{x:e=0,y:n=0,collapsed:i,childrenData:r=[]}=t;if(0===r.length)return[+e,+n,0];if(i){const{model:t}=this.context,i=t.getDescendantsData(this.id).filter((e=>!t.isCombo(wh(e))));return i.length>0&&i.some(ld)?$h(i.reduce(((t,e)=>Uh(t,sd(e))),[0,0,0]),i.length):[+e,+n,0]}return this.getContentBBox(t).center}getComboStyle(t){const[e,n]=this.getComboPosition(t);return{x:e,y:n,transform:[["translate",e,n]]}}updateComboPosition(t){const e=this.getComboStyle(t);Object.assign(this.style,e);const{x:n,y:i}=e;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:n,y:i}}),ff(this)}render(t,e=this){super.render(t,e),this.drawCollapsedMarkerShape(t,e)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,e){const n=super.animate(this.attributes.collapsed?t:t.map((t=>{var{x:e,y:n,z:i,transform:r}=t;return Xp(t,["x","y","z","transform"])})),e);return n?new Proxy(n,{set:(t,e,n)=>("currentTime"===e&&Promise.resolve().then((()=>this.onframe())),Reflect.set(t,e,n))}):n}}qp.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};class Kp extends qp{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",ml,this.getKeyStyle(t),e)}getKeyStyle(t){const{collapsed:e}=t,n=super.getKeyStyle(t),[i]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},n),e&&Gd(n,"collapsed")),{r:i/2})}getCollapsedKeySize(t){const[e,n]=Wd(t.collapsedSize),i=Math.max(e,n)/2;return[2*i,2*i,0]}getExpandedKeySize(t){const e=this.getContentBBox(t),[n,i]=Gc(e),r=Math.sqrt(Math.pow(n,2)+Math.pow(i,2))/2;return[2*r,2*r,0]}getIntersectPoint(t,e=!1){return md(t,this.getShape("key").getBounds(),e)}}class Zp extends qp{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",Dl,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[n,i]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},e),t.collapsed&&Gd(e,"collapsed")),{width:n,height:i,x:-n/2,y:-i/2})}}const Qp=function(t,e){return void 0===e&&(e=[]),function(t,e){if(!Xu(t))return t;for(var n=[],i=0;i<t.length;i++){var r=t[i];e(r,i)&&n.push(r)}return n}(t,(function(t){return!function(t,e){return!!Xu(t)&&t.indexOf(e)>-1}(e,t)}))},Jp={padding:10};function tg(t,e,n,i,r,a){const{padding:o}=Object.assign(Jp,a),s=zc(n,o),l=zc(i,o),u=[t,...r,e];let c=null;const h=[];for(let t=0,e=u.length;t<e-1;t++){const n=t+1,i=u[t],r=u[n],a=pd(d=i,f=r)||function(t,e){return t[0]===e[0]}(d,f);let p=null;if(0===t)if(n===e-1)if(s.intersects(l))p=ug(i,r,s,l);else if($c(i,s)||$c(r,l))a||(p=lg(i,r,s,l));else{const t=qc(i,s),e=qc(r,l);p=ag(t,e,ig(t,e)),p.points.unshift(t),p.points.push(e)}else Hc(r,s)?p=ug(i,r,s,zc(r,o),c):a||(p=og(i,r,s));else n===e-1?Hc(i,l)?p=ug(i,r,zc(i,o),l,c):a||(p=sg(i,r,l,c)):a||(p=ag(i,r,c));p?(h.push(...p.points),c=p.direction):c=ig(i,r),n<e-1&&h.push(r)}var d,f;return h.map(ed)}const eg={N:"S",S:"N",W:"E",E:"W"},ng={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function ig(t,e){const[n,i]=t,[r,a]=e;return n===r?i>a?"N":"S":i===a?n>r?"W":"E":null}function rg(t,e){return"N"===e||"S"===e?jc(t):Fc(t)}function ag(t,e,n){const i=[t[0],e[1]],r=[e[0],t[1]],a=ig(t,i),o=ig(t,r),s=n?eg[n]:null,l=a===n||a!==s&&o!==n?i:r;return{points:[l],direction:ig(l,e)}}function og(t,e,n){if($c(t,n)){const i=cg(t,e,n);return{points:[i],direction:ig(i,e)}}{const i=qc(t,n),r=["left","right"].includes(Xc(t,n))?[e[0],i[1]]:[i[0],e[1]];return{points:[r],direction:ig(r,e)}}}function sg(t,e,n,i){const r=$c(e,n)?e:qc(e,n),a=[[r[0],t[1]],[t[0],r[1]]],o=a.filter((t=>function(t,e){return!Hc(t,e)}(t,n)&&!Yc(t,n,!0))),s=o.filter((e=>ig(e,t)!==i));if(s.length>0){const n=s.find((e=>ig(t,e)===i))||s[0];return{points:[n],direction:ig(n,e)}}{const r=fd(e,Qp(a,o)[0],rg(n,i)/2);return{points:[cg(r,t,n),r],direction:ig(r,e)}}}function lg(t,e,n,i){let r=og(t,e,n);const a=nd(r.points[0]);if(Hc(a,i)){r=og(e,t,i);const o=nd(r.points[0]);if(Hc(o,n)){const s=fd(t,a,rg(n,ig(t,a))/2),l=fd(e,o,rg(i,ig(e,o))/2),u=[(s[0]+l[0])/2,(s[1]+l[1])/2],c=og(t,u,n),h=sg(u,e,i,c.direction);r.points=[c.points[0],h.points[0]],r.direction=h.direction}}return r}function ug(t,e,n,i,r){const a=Uc([n,i]),o=qh(e,a.center)>qh(t,a.center),[s,l]=o?[e,t]:[t,e],u=jc(a)+Fc(a);let c;if(r){const t=[s[0]+u*Math.cos(ng[r]),s[1]+u*Math.sin(ng[r])];c=fd(qc(t,a),t,.01)}else c=fd(qc(s,a),s,-.01);let h=cg(c,l,a),d=[dd(c,2),dd(h,2)];if(Ku(dd(c),dd(h))){const t=Qh(Hh(c,s),[1,0,0])+Math.PI/2;h=[l[0]+u*Math.cos(t),l[1]+u*Math.sin(t),0],h=dd(fd(qc(h,a),l,-.01),2),d=[c,cg(c,h,a),h]}return{points:o?d.reverse():d,direction:ig(o?c:h,e)}}function cg(t,e,n){let i=[t[0],e[1]];return Hc(i,n)&&(i=[e[0],t[1]]),i}function hg(t,e,n,i,r){let a="number"==typeof e?e:.5;"start"===e&&(a=0),"end"===e&&(a=.99);const o=cd(t.getPoint(a)),s=cd(t.getPoint(a+.01));let l="start"===e?"left":"end"===e?"right":"center";if(pd(o,s)||!n){const[e,n]=dg(t,a,i,r);return{transform:[["translate",e,n]],textAlign:l}}let u=Math.atan2(s[1]-o[1],s[0]-o[0]);s[0]<o[0]&&(l="center"===l?l:"left"===l?"right":"left",i*=-1,u+=Math.PI);const[c,h]=dg(t,a,i,r,u);return{textAlign:l,transform:[["translate",c,h],["rotate",u/Math.PI*180]]}}function dg(t,e,n,i,r){const[a,o]=cd(t.getPoint(e));let s=n,l=i;return r&&(s=n*Math.cos(r)-i*Math.sin(r),l=n*Math.sin(r)+i*Math.cos(r)),[a+s,o+l]}function fg(t,e,n,i){if(Ku(t,e))return t;const r=Hh(e,t),a=[t[0]+n*r[0],t[1]+n*r[1]],o=Zh(Jh(r,!1));return a[0]+=i*o[0],a[1]+=i*o[1],a}function pg(t,e,n){return[["M",t[0],t[1]],["C",n[0][0],n[0][1],n[1][0],n[1][1],e[0],e[1]]]}function gg(t,e=0,n=!1){const i=t.length-1,r=t[0],a=t[i],o=t.slice(1,i),s=[["M",r[0],r[1]]];return o.forEach(((t,n)=>{const i=o[n-1]||r,l=o[n+1]||a;if(!gd(i,t,l)&&e){const[n,r]=function(t,e,n,i){const r=Kh(t,e),a=Kh(n,e),o=Math.min(i,Math.min(r,a)/2);return[[e[0]-o/r*(e[0]-t[0]),e[1]-o/r*(e[1]-t[1])],[e[0]-o/a*(e[0]-n[0]),e[1]-o/a*(e[1]-n[1])]]}(i,t,l,e);s.push(["L",n[0],n[1]],["Q",t[0],t[1],r[0],r[1]],["L",r[0],r[1]])}else s.push(["L",t[0],t[1]])})),s.push(["L",a[0],a[1]]),n&&s.push(["Z"]),s}function vg(t,e,n,i,r){const a=zc(t),o=t.getCenter();let s=i&&Qg(i),l=r&&Qg(r);if(!s||!l){const i=(t=>{const e=Math.PI/2,n=jc(t)/2,i=Fc(t)/2,r=Math.atan2(n,i)/2,a=Math.atan2(i,n)/2;return{top:[-e-a,-e+a],"top-right":[-e+a,-r],"right-top":[-e+a,-r],right:[-r,r],"bottom-right":[r,e-a],"right-bottom":[r,e-a],bottom:[e-a,e+a],"bottom-left":[e+a,Math.PI-r],"left-bottom":[e+a,Math.PI-r],left:[Math.PI-r,Math.PI+r],"top-left":[Math.PI+r,-e-a],"left-top":[Math.PI+r,-e-a]}})(a),r=i[e][0],u=i[e][1],[c,h]=Gc(a),d=Math.max(c,h),f=Uh(o,[d*Math.cos(r),d*Math.sin(r),0]),p=Uh(o,[d*Math.cos(u),d*Math.sin(u),0]);s=nv(t,f),l=nv(t,p),n||([s,l]=[l,s])}return[s,l]}function yg(t,e){const n=new Set,i=new Set,r=new Set;return t.forEach((a=>{e(a).forEach((e=>{n.add(e),t.includes(e.source)&&t.includes(e.target)?i.add(e):r.add(e)}))})),{edges:Array.from(n),internal:Array.from(i),external:Array.from(r)}}function mg(t,e){const n=[];let i=t;for(;i;){n.push(i);const t=e(wh(i));if(!t)break;i=t}if(n.some((t=>{var e;return null===(e=t.style)||void 0===e?void 0:e.collapsed}))){const t=n.reverse().findIndex(Id);return n[t]||n.at(-1)}return t}const bg=(t,e)=>{const n=Math.max(t,e)/2;return[["M",-t/2,0],["A",n,n,0,1,0,2*n-t/2,0],["A",n,n,0,1,0,-t/2,0],["Z"]]},xg=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",t/2,e/2],["Z"]],Eg=(t,e)=>[["M",-t/2,0],["L",0,-e/2],["L",t/2,0],["L",0,e/2],["Z"]],wg=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",4*t/5-t/2,0],["L",t/2,e/2],["Z"]],kg=(t,e)=>[["M",-t/2,-e/2],["L",t/2,-e/2],["L",t/2,e/2],["L",-t/2,e/2],["Z"]],Mg=(t,e)=>{const n=t/2,i=t/7,r=t-i;return[["M",-n,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",r-n,-e/2],["L",r+i-n,-e/2],["L",r+i-n,e/2],["L",r-n,e/2],["Z"]]},Sg=(t,e)=>[["M",t/2,-e/2],["L",-t/2,0],["L",t/2,0],["L",-t/2,0],["L",t/2,e/2]];var Ng=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n};class Tg extends gf{constructor(t){super(Hd({style:Tg.defaultStyleProps},t)),this.type="edge"}get sourceNode(){const{sourceNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}get targetNode(){const{targetNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}getKeyStyle(t){const e=this.getGraphicStyle(t),{loop:n}=e,i=Ng(e,["loop"]),{sourceNode:r,targetNode:a}=this;var o,s;const l={d:n&&(s=a,(o=r)&&s&&o===s)?this.getLoopPath(t):this.getKeyPath(t)};return Ol.PARSED_STYLE_LIST.forEach((t=>{t in i&&(l[t]=i[t])})),l}getLoopPath(t){const{sourcePort:e,targetPort:n}=t,i=this.sourceNode,r=zc(i),a=Math.max(Fc(r),jc(r)),{placement:o,clockwise:s,dist:l=a}=Gd(this.getGraphicStyle(t),"loop");return function(t,e,n,i,r,a){const o=t.getPorts()[r||a],s=t.getPorts()[a||r];let[l,u]=vg(t,e,n,o,s);const c=function(t,e,n,i){const r=t.getCenter();if(Ku(e,n)){const t=Hh(e,r),a=[i*Math.sign(t[0])||i/2,i*Math.sign(t[1])||-i/2,0];return[Uh(e,a),Uh(n,Yh(a,[1,-1,1]))]}return[fd(r,e,qh(r,e)+i),fd(r,n,qh(r,n)+i)]}(t,l,u,i);return o&&(l=ev(o,c[0])),s&&(u=ev(s,c.at(-1))),pg(l,u,c)}(i,o,s,l,e,n)}getEndpoints(t,e=!0,n=[]){const{sourcePort:i,targetPort:r}=t,{sourceNode:a,targetNode:o}=this,[s,l]=function(t,e,n,i){return[Jg(t,e,n,i),Jg(e,t,i,n)]}(a,o,i,r);if(!e)return[s?Qg(s):a.getCenter(),l?Qg(l):o.getCenter()];const u="function"==typeof n?n():n;return[tv(s||a,u[0]||l||o),tv(l||o,u[u.length-1]||s||a)]}getHaloStyle(t){if(!1===t.halo)return!1;const e=this.getKeyStyle(t),n=Gd(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign({},e),n)}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;const e=Gd(this.getGraphicStyle(t),"label"),{placement:n,offsetX:i,offsetY:r,autoRotate:a,maxWidth:o}=e,s=Ng(e,["placement","offsetX","offsetY","autoRotate","maxWidth"]),l=hg(this.shapeMap.key,n,a,i,r),u=this.shapeMap.key.getLocalBounds(),c=function(t,e,n=1){return Xd(qh(t[0],t[1])*n,e)}([u.min,u.max],o);return Object.assign({wordWrapWidth:c},l,s)}getBadgeStyle(t){if(!1===t.badge||!t.badgeText)return!1;const e=Gd(t,"badge"),{offsetX:n,offsetY:i,placement:r}=e,a=Ng(e,["offsetX","offsetY","placement"]);return Object.assign(a,function(t,e,n,i,r){var a,o;const s=2*(null===(a=t.badge)||void 0===a?void 0:a.getGeometryBounds().halfExtents[0])||0,l=2*(null===(o=t.label)||void 0===o?void 0:o.getGeometryBounds().halfExtents[0])||0;return hg(t.key,n,!0,(l?(l/2+s/2)*("suffix"===e?1:-1):0)+i,r)}(this.shapeMap,r,t.labelPlacement,n,i))}drawArrow(t,e){var n;const i="start"===e,r=t["start"===e?"startArrow":"endArrow"],a=this.shapeMap.key;if(r){const e=this.getArrowStyle(t,i),[n,r,o]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],s=a.parsedStyle[n];if(s)s.attr(e);else{const t=new(e.src?Sl:Ol)({style:e});a.style[n]=t}a.style[r]=t[o]||e.width/2+ +e.lineWidth}else{const t=i?"markerStart":"markerEnd";null===(n=a.style[t])||void 0===n||n.destroy(),a.style[t]=null}}getArrowStyle(t,n){const i=this.getShape("key").attributes,r=n?"startArrow":"endArrow",a=Gd(this.getGraphicStyle(t),r),{size:o,type:s}=a,l=Ng(a,["size","type"]),[u,c]=Wd(function(t,e){return e||(t<4?10:4===t?12:2.5*t)}(i.lineWidth,o)),h=(gn(s)?s:e[s]||xg)(u,c);return Object.assign(zp(i,["stroke","strokeOpacity","fillOpacity"]),{width:u,height:c},Object.assign({},h&&{d:h,fill:"simple"===s?"":i.stroke}),l)}drawLabelShape(t,e){const n=this.getLabelStyle(t);this.upsert("label",rf,n,e)}drawHaloShape(t,e){const n=this.getHaloStyle(t);this.upsert("halo",Ol,n,e)}drawBadgeShape(t,e){const n=this.getBadgeStyle(t);this.upsert("badge",af,n,e)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,e){const n=this.getKeyStyle(t);return this.upsert("key",Ol,n,e)}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,e){const n=super.animate(t,e);return n?new Proxy(n,{set:(t,e,n)=>("currentTime"===e&&Promise.resolve().then((()=>this.onframe())),Reflect.set(t,e,n))}):n}}Tg.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class Ag extends Tg{constructor(t){super(Hd({style:Ag.defaultStyleProps},t))}getKeyPath(t){const[e,n]=this.getEndpoints(t),{controlPoints:i,curvePosition:r,curveOffset:a}=t,o=this.getControlPoints(e,n,function(t){return le(t)?[t,1-t]:t}(r),function(t){return le(t)?[t,-t]:t}(a),i);return pg(e,n,o)}getControlPoints(t,e,n,i,r){return 2===(null==r?void 0:r.length)?r:[fg(t,e,n[0],i[0]),fg(t,e,n[1],i[1])]}}Ag.defaultStyleProps={curvePosition:.5,curveOffset:20};class Og extends Ag{constructor(t){super(Hd({style:Og.defaultStyleProps},t))}getControlPoints(t,e,n,i){const r=e[0]-t[0];return[[t[0]+r*n[0]+i[0],t[1]],[e[0]-r*n[1]+i[1],e[1]]]}}Og.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class Pg extends Ag{constructor(t){super(Hd({style:Pg.defaultStyleProps},t))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(t){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(t);const e=sd(this.ref);return[this.sourceNode.getIntersectPoint(e,!0),this.targetNode.getIntersectPoint(e)]}toRadialCoordinate(t){const e=sd(this.ref);return[qh(t,e),id(Hh(t,e))]}getControlPoints(t,e,n,i){const[r,a]=this.toRadialCoordinate(t),[o]=this.toRadialCoordinate(e),s=o-r;return[[t[0]+(s*n[0]+i[0])*Math.cos(a),t[1]+(s*n[0]+i[0])*Math.sin(a)],[e[0]-(s*n[1]-i[0])*Math.cos(a),e[1]-(s*n[1]-i[0])*Math.sin(a)]]}}Pg.defaultStyleProps={curvePosition:.5,curveOffset:20};class Cg extends Ag{constructor(t){super(Hd({style:Cg.defaultStyleProps},t))}getControlPoints(t,e,n,i){const r=e[1]-t[1];return[[t[0],t[1]+r*n[0]+i[0]],[e[0],e[1]-r*n[1]+i[1]]]}}Cg.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class Rg extends Tg{constructor(t){super(Hd({style:Rg.defaultStyleProps},t))}getKeyPath(t){const[e,n]=this.getEndpoints(t);return[["M",e[0],e[1]],["L",n[0],n[1]]]}}Rg.defaultStyleProps={};const Lg={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:Kh},Dg=t=>`${Math.round(t[0])}|||${Math.round(t[1])}`;function Ig(t,e){const n=t=>Math.round(t/e);return le(t)?n(t):t.map(n)}function _g(t,e){const n=e[0]-t[0],i=e[1]-t[1];return n||i?Math.atan2(i,n):0}function Bg(t,e,n,i){const r=_g(t,e);return function(t,e){const n=Math.abs(t-e);return n>Math.PI?2*Math.PI-n:n}(_g(n[Dg(t)]||i,t),r)}function Fg(t,e,n){return Math.min(...e.map((e=>n(t,e))))}const jg=(t,e,n,i)=>{if(!e)return[t];const{directionMap:r,offset:a}=i,o=Wc(e.getRenderBounds(),a),s=Object.keys(r).reduce(((e,i)=>{if(n.includes(i)){const n=r[i],[a,s]=Gc(o),l=[t[0]+n.stepX*a,t[1]+n.stepY*s],u=function(t){const{min:[e,n],max:[i,r]}=t,a=[e,r],o=[i,r],s=[i,n],l=[e,n];return[[a,o],[o,s],[s,l],[l,a]]}(o);for(let n=0;n<u.length;n++){const i=ad([t,l],u[n]);i&&Yc(i,o)&&e.push(i)}}return e}),[]);return Hc(t,o)||s.push(t),s.map((t=>Ig(t,i.gridSize)))},Gg=(t,e,n,i,r,a,o)=>{const s=[];let l=[a[0]===i[0]?i[0]:t[0]*o,a[1]===i[1]?i[1]:t[1]*o];s.unshift(l);let u=t,c=e[Dg(u)];for(;c;){const t=c,i=u;Bg(t,i,e,n)&&(l=[t[0]===i[0]?l[0]:t[0]*o,t[1]===i[1]?l[1]:t[1]*o],s.unshift(l)),c=e[Dg(t)],u=t}const h=r.map((t=>[t[0]*o,t[1]*o])),d=function(t,e,n){let i=t[0],r=n(t[0],e);for(let a=0;a<t.length;a++){const o=t[a],s=n(o,e);s<r&&(i=o,r=s)}return i}(h,l,Kh);return s.unshift(d),s};class zg{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(t,e){let n=0,i=e-1;for(;i-n>1;){const e=Math.floor((n+i)/2);if(this.arr[e].value>t.value)i=e;else{if(!(this.arr[e].value<t.value))return this.arr.splice(e,0,t),void(this.map[t.id]=!0);n=e}}this.arr.splice(i,0,t),this.map[t.id]=!0}add(t){delete this.map[t.id];const e=this.arr.length;if(!e||this.arr[e-1].value<t.value)return this.arr.push(t),void(this.map[t.id]=!0);this._innerAdd(t,e)}remove(t){this.map[t]&&delete this.map[t]}_clearAndGetMinId(){let t;for(let e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}_findFirstId(){for(;this.arr.length;){const t=this.arr.shift();if(this.map[t.id])return t.id}}minId(t){return t?this._clearAndGetMinId():this._findFirstId()}}class Vg extends Tg{constructor(t){super(Hd({style:Vg.defaultStyleProps},t))}getControlPoints(t){const{router:e}=t,{sourceNode:n,targetNode:i}=this,[r,a]=this.getEndpoints(t,!1);let o=[];return e?"shortest-path"===e.type?(o=function(t,e,n,i){const r=ed(t.getCenter()),a=ed(e.getCenter()),o=Object.assign(Lg,i),{gridSize:s}=o,l=((t,e)=>{const{offset:n,gridSize:i}=e,r={};return t.forEach((t=>{if(!t||t.destroyed||!t.isVisible())return;const e=Wc(t.getRenderBounds(),n);for(let t=Ig(e.min[0],i);t<=Ig(e.max[0],i);t+=1)for(let n=Ig(e.min[1],i);n<=Ig(e.max[1],i);n+=1)r[`${t}|||${n}`]=!0})),r})(o.enableObstacleAvoidance?n:[t,e],o),u=Ig(r,s),c=Ig(a,s),h=jg(r,t,o.startDirections,o),d=jg(a,e,o.endDirections,o);h.forEach((t=>delete l[Dg(t)])),d.forEach((t=>delete l[Dg(t)]));const f={},p={},g={},v={},y={},m=new zg;for(let t=0;t<h.length;t++){const e=h[t],n=Dg(e);f[n]=e,v[n]=0,y[n]=Fg(e,d,o.distFunc),m.add({id:n,value:y[n]})}const b=d.map((t=>Dg(t)));let x,E=o.maximumLoops,w=1/0;for(const[t,e]of Object.entries(f))y[t]<=w&&(w=y[t],x=e);for(;Object.keys(f).length>0&&E>0;){const t=m.minId(!1);if(!t)break;x=f[t];const e=Dg(x);if(b.includes(e))return Gg(x,g,u,a,h,c,s);delete f[e],m.remove(e),p[e]=!0;for(const t of Object.values(o.directionMap)){const n=Uh(x,[t.stepX,t.stepY]),i=Dg(n);if(p[i])continue;const r=Bg(x,n,g,u);if(r>o.maxAllowedDirectionChange)continue;if(l[i])continue;f[i]||(f[i]=n);const a=o.penalties[r],c=o.distFunc(x,n)+(isNaN(a)?s:a),h=v[e]+c,b=v[i];b&&h>=b||(g[i]=x,v[i]=h,y[i]=h+Fg(n,d,o.distFunc),m.add({id:i,value:y[i]}))}E-=1}return[]}(n,i,this.context.element.getNodes(),e),o.length||(o=tg(r,a,n,i,t.controlPoints,{padding:e.offset}))):"orth"===e.type&&(o=tg(r,a,n,i,t.controlPoints,e)):o=t.controlPoints,o}getPoints(t){const e=this.getControlPoints(t),[n,i]=this.getEndpoints(t,!0,e);return[n,...e,i]}getKeyPath(t){return gg(this.getPoints(t),t.radius)}getLoopPath(t){const{sourcePort:e,targetPort:n,radius:i}=t,r=this.sourceNode,a=zc(r),o=Math.max(Fc(a),jc(a))/4,{placement:s,clockwise:l,dist:u=o}=Gd(this.getGraphicStyle(t),"loop");return function(t,e,n,i,r,a,o){const s=Kg(t),l=s[a||o],u=s[o||a];let[c,h]=vg(t,n,i,l,u);const d=function(t,e,n,i){const r=[],a=zc(t);if(Ku(e,n))switch(Xc(e,a)){case"left":r.push([e[0]-i,e[1]]),r.push([e[0]-i,e[1]+i]),r.push([e[0],e[1]+i]);break;case"right":r.push([e[0]+i,e[1]]),r.push([e[0]+i,e[1]+i]),r.push([e[0],e[1]+i]);break;case"top":r.push([e[0],e[1]-i]),r.push([e[0]+i,e[1]-i]),r.push([e[0]+i,e[1]]);break;case"bottom":r.push([e[0],e[1]+i]),r.push([e[0]+i,e[1]+i]),r.push([e[0]+i,e[1]])}else{const t=Xc(e,a),o=Xc(n,a);if(t===o){let a,o;switch(t){case"left":a=Math.min(e[0],n[0])-i,r.push([a,e[1]]),r.push([a,n[1]]);break;case"right":a=Math.max(e[0],n[0])+i,r.push([a,e[1]]),r.push([a,n[1]]);break;case"top":o=Math.min(e[1],n[1])-i,r.push([e[0],o]),r.push([n[0],o]);break;case"bottom":o=Math.max(e[1],n[1])+i,r.push([e[0],o]),r.push([n[0],o])}}else{const s=(t,e)=>({left:[e[0]-i,e[1]],right:[e[0]+i,e[1]],top:[e[0],e[1]-i],bottom:[e[0],e[1]+i]}[t]),l=s(t,e),u=s(o,n),c=cg(l,u,a);r.push(l,c,u)}}return r}(t,c,h,r);return l&&(c=ev(l,d[0])),u&&(h=ev(u,d.at(-1))),gg([c,...d,h],e)}(r,i,s,l,u,e,n)}}Vg.defaultStyleProps={radius:0,controlPoints:[],router:!1};class Wg extends Tg{constructor(t){super(Hd({style:Wg.defaultStyleProps},t))}getKeyPath(t){const{curvePosition:e,curveOffset:n}=t,[i,r]=this.getEndpoints(t);return function(t,e,n){return[["M",t[0],t[1]],["Q",n[0],n[1],e[0],e[1]]]}(i,r,t.controlPoint||fg(i,r,e,n))}}Wg.defaultStyleProps={curvePosition:.5,curveOffset:30};var Ug=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n};function Hg(t){return t instanceof yf&&"node"===t.type}function Yg(t){return t instanceof Tg}function $g(t){return t instanceof qp}const Xg={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],"left-top":[0,0],"top-left":[0,0],"left-bottom":[0,1],"bottom-left":[0,1],"right-top":[1,0],"top-right":[1,0],"right-bottom":[1,1],"bottom-right":[1,1],default:[.5,.5]};function qg(t,e,n=Xg,i=!0){const r=[.5,.5],a=he(e)?_d(n,e.toLocaleLowerCase(),r):e;if(!i&&he(e))return a;const[o,s]=a||r;return[t.min[0]+Fc(t)*o,t.min[1]+jc(t)*s]}function Kg(t){if(!t)return{};const e=t.getPorts();return(t.attributes.ports||[]).forEach(((n,i)=>{var r;const{key:a,placement:o}=n;Zg(n)&&(e[r=a||i]||(e[r]=ud(t.getShape("key").getBounds(),o)))})),e}function Zg(t){const{r:e}=t;return!e||0===Number(e)}function Qg(t){return Dc(t)?t:t.getPosition()}function Jg(t,e,n,i){const r=Kg(t);if(n)return r[n];const a=Object.values(r);if(0===a.length)return;const o=a.map((t=>Qg(t))),s=function(t,e){const n=Kg(t);if(e)return[Qg(n[e])];const i=Object.values(n);return i.length>0?i.map((t=>Qg(t))):[t.getCenter()]}(e,i),[l]=function(t,e){let n=1/0,i=[t[0],e[0]];return t.forEach((t=>{e.forEach((e=>{const r=qh(t,e);r<n&&(n=r,i=[t,e])}))})),i}(o,s);return a.find((t=>Qg(t)===l))}function tv(t,e){return $g(t)||Hg(t)?nv(t,e):ev(t,e)}function ev(t,e){return t&&e?Dc(t)?t:t.attributes.linkToCenter?t.getPosition():md(Dc(e)?e:Hg(e)?e.getCenter():e.getPosition(),t.getBounds()):[0,0,0]}function nv(t,e){if(!t||!e)return[0,0,0];const n=Dc(e)?e:Hg(e)?e.getCenter():e.getPosition();return t.getIntersectPoint(n)||t.getCenter()}function iv(t,e="bottom",n=0,i=0,r=!1){const a=e.split("-"),[o,s]=ud(t,e),[l,u]=r?["bottom","top"]:["top","bottom"];return{transform:[["translate",o+n,s+i]],textBaseline:a.includes("top")?u:a.includes("bottom")?l:"middle",textAlign:a.includes("left")?"right":a.includes("right")?"left":"center"}}function rv(t){return"hidden"!==_d(t,["style","visibility"])}function av(t,e){"update"in t?t.update(e):t.attr(e)}function ov(t){return _d(t,"__to_be_destroyed__",!1)}class sv extends Bh{constructor(t,e){super(t,Object.assign({},sv.defaultOptions,e)),this.onCollapseExpand=t=>{return e=this,n=void 0,r=function*(){if(!this.validate(t))return;const{target:e}=t;if(!(Hg(n=e)||Yg(n)||$g(n)))return;var n;const i=e.id,{model:r,graph:a}=this.context,o=r.getElementDataById(i);if(!o)return!1;const{onCollapse:s,onExpand:l,animation:u,align:c}=this.options;Id(o)?(yield a.expandElement(i,{animation:u,align:c}),null==l||l(i)):(yield a.collapseElement(i,{animation:u,align:c}),null==s||s(i))},new((i=void 0)||(i=Promise))((function(t,a){function o(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,s)}l((r=r.apply(e,n||[])).next())}));var e,n,i,r},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`node:${e}`,this.onCollapseExpand),t.on(`combo:${e}`,this.onCollapseExpand)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`node:${e}`,this.onCollapseExpand),t.off(`combo:${e}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}sv.defaultOptions={enable:!0,animation:!0,trigger:ic.DBLCLICK,align:!0};var lv={};const uv=function(t){return lv[t=t||"g"]?lv[t]+=1:lv[t]=1,t+lv[t]};var cv=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};const hv="g6-create-edge-assist-node-id";class dv extends Bh{constructor(t,e){super(t,Object.assign({},dv.defaultOptions,e)),this.drop=t=>cv(this,void 0,void 0,(function*(){const{targetType:e}=t;["combo","node"].includes(e)&&this.source?yield this.handleCreateEdge(t):yield this.cancelEdge()})),this.handleCreateEdge=t=>cv(this,void 0,void 0,(function*(){var e,n,i;if(!this.validate(t))return;const{graph:r,canvas:a,batch:o,element:s}=this.context,{style:l}=this.options;if(this.source)return this.createEdge(t),void(yield this.cancelEdge());o.startBatch(),a.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0];const u=r.getElementData(this.source);r.addNodeData([{id:hv,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:null===(e=u.style)||void 0===e?void 0:e.x,y:null===(n=u.style)||void 0===n?void 0:n.y}}]),r.addEdgeData([{id:"g6-create-edge-assist-edge-id",source:this.source,target:hv,style:Object.assign({pointerEvents:"none"},l)}]),yield null===(i=s.draw({animation:!1}))||void 0===i?void 0:i.finished})),this.updateAssistEdge=t=>cv(this,void 0,void 0,(function*(){var e;if(!this.source)return;const{model:n,element:i}=this.context;n.translateNodeTo(hv,[t.canvas.x,t.canvas.y]),yield null===(e=i.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished})),this.createEdge=t=>{var e,n;const{graph:i}=this.context,{style:r,onFinish:a,onCreate:o}=this.options;if(void 0===(null===(e=t.target)||void 0===e?void 0:e.id)||void 0===this.source)return;const s=null===(n=this.getSelectedNodeIDs([t.target.id]))||void 0===n?void 0:n[0],l=o({id:`${this.source}-${s}-${uv()}`,source:this.source,target:s,style:r});l&&(i.addEdgeData([l]),a(l))},this.cancelEdge=()=>cv(this,void 0,void 0,(function*(){var t;if(!this.source)return;const{graph:e,element:n,batch:i}=this.context;e.removeNodeData([hv]),this.source=void 0,yield null===(t=n.draw({animation:!1}))||void 0===t?void 0:t.finished,i.endBatch()})),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;this.unbindEvents(),"click"===e?(t.on(lc.CLICK,this.handleCreateEdge),t.on(nc.CLICK,this.handleCreateEdge),t.on(ec.CLICK,this.cancelEdge),t.on(ac.CLICK,this.cancelEdge)):(t.on(lc.DRAG_START,this.handleCreateEdge),t.on(nc.DRAG_START,this.handleCreateEdge),t.on(ic.POINTER_UP,this.drop)),t.on(ic.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map((t=>t.id)).concat(t)))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;t.off(lc.CLICK,this.handleCreateEdge),t.off(nc.CLICK,this.handleCreateEdge),t.off(ec.CLICK,this.cancelEdge),t.off(ac.CLICK,this.cancelEdge),t.off(lc.DRAG_START,this.handleCreateEdge),t.off(nc.DRAG_START,this.handleCreateEdge),t.off(ic.POINTER_UP,this.drop),t.off(ic.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}dv.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:t=>t,onFinish:()=>{}};const fv=function(t,e,n){var i;return function(){var r=this,a=arguments,o=n&&!i;clearTimeout(i),i=setTimeout((function(){i=null,n||t.apply(r,a)}),e),o&&t.apply(r,a)}};var pv=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class gv extends Bh{constructor(t,e){super(t,Object.assign({},gv.defaultOptions,e)),this.isDragging=!1,this.onDragStart=t=>{this.validate(t)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=t=>{var e,n,i,r;if(!this.isDragging||wd.isPinching)return;const a=null!==(n=null===(e=t.movement)||void 0===e?void 0:e.x)&&void 0!==n?n:t.dx,o=null!==(r=null===(i=t.movement)||void 0===i?void 0:i.y)&&void 0!==r?r:t.dy;a|o&&this.translate([a,o],!1)},this.onDragEnd=()=>{var t,e;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},this.invokeOnFinish=fv((()=>{var t,e;null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)}),300),this.shortcut=new Md(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(vn(t)){const{up:e=[],down:n=[],left:i=[],right:r=[]}=t;this.shortcut.bind(e,(t=>this.onTranslate([0,1],t))),this.shortcut.bind(n,(t=>this.onTranslate([0,-1],t))),this.shortcut.bind(i,(t=>this.onTranslate([1,0],t))),this.shortcut.bind(r,(t=>this.onTranslate([-1,0],t)))}else{const{graph:t}=this.context;t.on(ic.DRAG_START,this.onDragStart),t.on(ic.DRAG,this.onDrag),t.on(ic.DRAG_END,this.onDragEnd)}}onTranslate(t,e){return pv(this,void 0,void 0,(function*(){if(!this.validate(e))return;const{sensitivity:n}=this.options,i=-1*n;yield this.translate(Yh(t,i),this.options.animation),this.invokeOnFinish()}))}translate(t,e){return pv(this,void 0,void 0,(function*(){t=this.clampByDirection(t),t=this.clampByRange(t),t=this.clampByRotation(t),yield this.context.graph.translateBy(t,e)}))}clampByRotation([t,e]){const n=this.context.graph.getRotation();if(n%360==0)return[t,e];const i=n*Math.PI/180,r=Math.cos(i),a=Math.sin(i);return[t*r-e*a,t*a+e*r]}clampByDirection([t,e]){const{direction:n}=this.options;return"x"===n?e=0:"y"===n&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:n,canvas:i}=this.context,[r,a]=i.getSize(),[o,s,l,u]=_c(this.options.range),c=[a*o,r*s,a*l,r*u],h=Wc(Vc(n.getCanvasCenter()),c),d=Hh(n.getViewportCenter(),[t,e,0]);if(!Hc(d,h)){const{min:[n,i],max:[r,a]}=h;(d[0]<n&&t>0||d[0]>r&&t<0)&&(t=0),(d[1]<i&&e>0||d[1]>a&&e<0)&&(e=0)}return[t,e]}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return"function"==typeof e?e(t):!!e}unbindEvents(){this.shortcut.unbindAll();const{graph:t}=this.context;t.off(ic.DRAG_START,this.onDragStart),t.off(ic.DRAG,this.onDrag),t.off(ic.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}gv.defaultOptions={enable:t=>!("targetType"in t)||"canvas"===t.targetType,sensitivity:10,direction:"both",range:1/0};var vv=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class yv extends Bh{constructor(t,e){super(t,Object.assign({},yv.defaultOptions,e)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=t=>vv(this,void 0,void 0,(function*(){var e;if("link"!==this.options.dropEffect)return;const{model:n,element:i}=this.context,r=t.target.id;this.target.forEach((t=>{const e=n.getParentData(t,uc);e&&wh(e)===r&&n.refreshComboData(r),n.setParent(t,r,uc)})),yield null===(e=null==i?void 0:i.draw({animation:!0}))||void 0===e?void 0:e.finished})),this.setCursor=t=>{if(this.isDragging)return;const{type:e}=t,{canvas:n}=this.context,{cursor:i}=this.options;e===ic.POINTER_ENTER?n.setCursor((null==i?void 0:i.grab)||"grab"):n.setCursor((null==i?void 0:i.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t,canvas:e}=this.context,n=e.getLayer().getContextService().$canvas;n&&(n.addEventListener("blur",this.onDragEnd),n.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach((e=>{t.on(`${e}:${ic.DRAG_START}`,this.onDragStart),t.on(`${e}:${ic.DRAG}`,this.onDrag),t.on(`${e}:${ic.DRAG_END}`,this.onDragEnd),t.on(`${e}:${ic.POINTER_ENTER}`,this.setCursor),t.on(`${e}:${ic.POINTER_LEAVE}`,this.setCursor)})),["link"].includes(this.options.dropEffect)&&(t.on(nc.DROP,this.onDrop),t.on(ec.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map((t=>t.id)).concat(t)))}getDelta(t){const e=this.context.graph.getZoom();return $h([t.dx,t.dy],e)}onDragStart(t){var e;if(this.enable=this.validate(t),!this.enable)return;const{batch:n,canvas:i,graph:r}=this.context;i.setCursor((null===(e=this.options.cursor)||void 0===e?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,n.startBatch();const a=t.target.id;r.getElementState(a).includes(this.options.state)?this.target=this.getSelectedNodeIDs([a]):this.target=[a],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}onDragEnd(){var t,e,n;if(!this.enable)return;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:t=0,y:e=0}=this.shadow.attributes,[n,i]=Hh([+t,+e],this.shadowOrigin);this.moveElement(this.target,[n,i])}this.showEdges(),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t,this.target);const{batch:i,canvas:r}=this.context;i.endBatch(),r.setCursor((null===(n=this.options.cursor)||void 0===n?void 0:n.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed||ov(t.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}moveElement(t,e){return vv(this,void 0,void 0,(function*(){const{graph:n,model:i}=this.context,{dropEffect:r}=this.options;"move"===r&&t.forEach((t=>i.refreshComboData(t))),n.translateElementBy(Object.fromEntries(t.map((t=>[t,e]))),!1)}))}moveShadow(t){if(!this.shadow)return;const{x:e=0,y:n=0}=this.shadow.attributes,[i,r]=t;this.shadow.attr({x:+e+i,y:+n+r})}createShadow(t){const e=Gd(this.options,"shadow"),n=Uc(t.map((t=>this.context.element.getElement(t).getBounds()))),[i,r]=n.min;this.shadowOrigin=[i,r];const[a,o]=Gc(n),s={width:a,height:o,x:i,y:r};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},e),s),{visibility:"visible"})):(this.shadow=new Dl({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},e),s),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||0===this.hiddenEdges.length||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:t,shadow:e}=this.options;if("none"===t||e)return;const{graph:n}=this.context;this.hiddenEdges="all"===t?n.getEdgeData().map(wh):Array.from(new Set(this.target.map((e=>n.getRelatedEdgesData(e,t).map(wh))).flat())),n.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:t,canvas:e}=this.context,n=e.getLayer().getContextService().$canvas;n&&(n.removeEventListener("blur",this.onDragEnd),n.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach((e=>{t.off(`${e}:${ic.DRAG_START}`,this.onDragStart),t.off(`${e}:${ic.DRAG}`,this.onDrag),t.off(`${e}:${ic.DRAG_END}`,this.onDragEnd),t.off(`${e}:${ic.POINTER_ENTER}`,this.setCursor),t.off(`${e}:${ic.POINTER_LEAVE}`,this.setCursor)})),t.off(`combo:${ic.DROP}`,this.onDrop),t.off(`canvas:${ic.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),null===(t=this.shadow)||void 0===t||t.destroy(),super.destroy()}}yv.defaultOptions={animation:!0,enable:t=>["node","combo"].includes(t.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var mv=function(){function t(){this._events={}}return t.prototype.on=function(t,e,n){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!n}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=this._events[t]||[],a=this._events["*"]||[],o=function(i){for(var r=i.length,a=0;a<r;a++)if(i[a]){var o=i[a],s=o.callback;o.once&&(i.splice(a,1),0===i.length&&delete e._events[t],r--,a--),s.apply(e,n)}};o(r),o(a)},t.prototype.off=function(t,e){if(t)if(e){for(var n=this._events[t]||[],i=n.length,r=0;r<i;r++)n[r].callback===e&&(n.splice(r,1),i--,r--);0===n.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();const bv=mv;function xv(t,e,n,i){for(;t.length;){const r=t.shift();if(n(r))return!0;e.add(r.id),i(r.id).forEach((n=>{e.has(n.id)||(e.add(n.id),t.push(n))}))}return!1}function Ev(t,e,n,i){if(n(t))return!0;e.add(t.id);for(const r of i(t.id))if(!e.has(r.id)&&Ev(r,e,n,i))return!0;return!1}const wv=()=>!0;class kv{graph;nodeFilter;edgeFilter;cacheEnabled;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;allNodesMap=new Map;allEdgesMap=new Map;constructor(t){this.graph=t.graph;const e=t.nodeFilter||wv,n=t.edgeFilter||wv;this.nodeFilter=e,this.edgeFilter=t=>{const{source:i,target:r}=this.graph.getEdgeDetail(t.id);return!(!e(i)||!e(r))&&n(t,i,r)},"auto"===t.cache?(this.cacheEnabled=!0,this.startAutoCache()):"manual"===t.cache?this.cacheEnabled=!0:this.cacheEnabled=!1}clearCache=()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()};refreshCache=()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map((t=>t.id)))};updateCache=t=>{const e=new Set;t.forEach((t=>{const n=this.bothEdgesMap.get(t);if(n&&n.forEach((t=>e.add(t.id))),this.hasNode(t)){const n=this.graph.getRelatedEdges(t,"in").filter(this.edgeFilter),i=this.graph.getRelatedEdges(t,"out").filter(this.edgeFilter),r=Array.from(new Set([...n,...i]));r.forEach((t=>e.add(t.id))),this.inEdgesMap.set(t,n),this.outEdgesMap.set(t,i),this.bothEdgesMap.set(t,r),this.allNodesMap.set(t,this.graph.getNode(t))}else this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.bothEdgesMap.delete(t),this.allNodesMap.delete(t)})),e.forEach((t=>{this.hasEdge(t)?this.allEdgesMap.set(t,this.graph.getEdge(t)):this.allEdgesMap.delete(t)}))};startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}handleGraphChanged=t=>{const e=new Set;t.changes.forEach((n=>{switch(n.type){case"NodeAdded":case"NodeRemoved":e.add(n.value.id);break;case"NodeDataUpdated":e.add(n.id);break;case"EdgeAdded":case"EdgeRemoved":e.add(n.value.source),e.add(n.value.target);break;case"EdgeUpdated":"source"!==n.propertyName&&"target"!==n.propertyName||(e.add(n.oldValue),e.add(n.newValue));break;case"EdgeDataUpdated":if(t.graph.hasEdge(n.id)){const i=t.graph.getEdge(n.id);e.add(i.source),e.add(i.target)}}})),this.updateCache(e)};checkNodeExistence(t){this.getNode(t)}hasNode(t){if(!this.graph.hasNode(t))return!1;const e=this.graph.getNode(t);return this.nodeFilter(e)}areNeighbors(t,e){return this.checkNodeExistence(t),this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.graph.getNode(t);if(!this.nodeFilter(e))throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){return this.checkNodeExistence(t),this.cacheEnabled?"in"===e?this.inEdgesMap.get(t):"out"===e?this.outEdgesMap.get(t):this.bothEdgesMap.get(t):this.graph.getRelatedEdges(t,e).filter(this.edgeFilter)}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([...e,...n]))}hasEdge(t){if(!this.graph.hasEdge(t))return!1;const e=this.graph.getEdge(t);return this.edgeFilter(e)}getEdge(t){const e=this.graph.getEdge(t);if(!this.edgeFilter(e))throw new Error("Edge not found for id: "+t);return e}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}hasTreeStructure(t){return this.graph.hasTreeStructure(t)}getRoots(t){return this.graph.getRoots(t).filter(this.nodeFilter)}getChildren(t,e){return this.checkNodeExistence(t),this.graph.getChildren(t,e).filter(this.nodeFilter)}getParent(t,e){this.checkNodeExistence(t);const n=this.graph.getParent(t,e);return n&&this.nodeFilter(n)?n:null}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(t,e,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];xv([this.getNode(t)],new Set,e,i)}dfs(t,e,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];Ev(this.getNode(t),new Set,e,i)}}class Mv extends bv{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let n=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const i=e.value.id===t.value.id;return i&&(n=!0),!i}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),n||e.push(t);break}case"EdgeRemoved":{let n=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const i=e.value.id===t.value.id;return i&&(n=!0),!i}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),n||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const n=e.findIndex((e=>e.type===t.type&&e.id===t.id&&(void 0===t.propertyName||e.propertyName===t.propertyName))),i=e[n];i?void 0!==t.propertyName?i.newValue=t.newValue:(e.splice(n,1),e.push(t)):e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const n=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));n?n.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([...e,...n]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),n=this.bothEdgesMap.get(t);n?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((n=>{n.childrenMap.get(t)?.forEach((t=>{n.parentMap.delete(t.id)}));const i=n.parentMap.get(t);i&&n.childrenMap.get(i.id)?.delete(e),n.parentMap.delete(t),n.childrenMap.delete(t)})),this.bothEdgesMap.delete(t),this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,n){const i=this.getNode(t);this.batch((()=>{const r=i.data[e],a=n;i.data[e]=a,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:r,newValue:a})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,n])=>{this.updateNodeDataProperty(t,e,n)}))}))}updateNodeData(...t){const e=t[0],n=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let i;if("function"==typeof t[1]){const e=t[1];i=e(n.data)}else"object"==typeof t[1]&&(i=t[1]);this.batch((()=>{const t=n.data,r=i;n.data=i,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:r})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),n=this.outEdgesMap.get(t.source),i=this.bothEdgesMap.get(t.source),r=this.bothEdgesMap.get(t.target);e.add(t),n.add(t),i.add(t),r.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),n=this.outEdgesMap.get(e.source),i=this.inEdgesMap.get(e.target),r=this.bothEdgesMap.get(e.source),a=this.bothEdgesMap.get(e.target);n.delete(e),i.delete(e),r.delete(e),a.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const n=this.getEdge(t);this.checkNodeExistence(e);const i=n.source,r=e;this.outEdgesMap.get(i).delete(n),this.bothEdgesMap.get(i).delete(n),this.outEdgesMap.get(r).add(n),this.bothEdgesMap.get(r).add(n),n.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:i,newValue:r})}))}updateEdgeTarget(t,e){const n=this.getEdge(t);this.checkNodeExistence(e);const i=n.target,r=e;this.inEdgesMap.get(i).delete(n),this.bothEdgesMap.get(i).delete(n),this.inEdgesMap.get(r).add(n),this.bothEdgesMap.get(r).add(n),n.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:i,newValue:r})}))}updateEdgeDataProperty(t,e,n){const i=this.getEdge(t);this.batch((()=>{const r=i.data[e],a=n;i.data[e]=a,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:r,newValue:a})}))}updateEdgeData(...t){const e=t[0],n=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let i;if("function"==typeof t[1]){const e=t[1];i=e(n.data)}else"object"==typeof t[1]&&(i=t[1]);this.batch((()=>{const t=n.data,r=i;n.data=i,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:r})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,n])=>{this.updateEdgeDataProperty(t,e,n)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const n=[],i=Array.isArray(t)?t:[t];for(;i.length;){const t=i.shift();n.push(t),t.children&&i.push(...t.children)}this.addNodes(n),n.forEach((t=>{t.children?.forEach((n=>{this.setParent(n.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const n=this.treeIndices.get(e).childrenMap.get(t);return Array.from(n||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const n=[];let i,r=this.getNode(t);for(;i=this.getParent(r.id,e);)n.push(i),r=i;return n}setParent(t,e,n){this.checkTreeExistence(n);const i=this.treeIndices.get(n);if(!i)return;const r=this.getNode(t),a=i.parentMap.get(t);if(a?.id===e)return;if(null==e)return a&&i.childrenMap.get(a.id)?.delete(r),void i.parentMap.delete(t);const o=this.getNode(e);i.parentMap.set(t,o),a&&i.childrenMap.get(a.id)?.delete(r);let s=i.childrenMap.get(o.id);s||(s=new Set,i.childrenMap.set(o.id,s)),s.add(r),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:n,nodeId:t,oldParentId:a?.id,newParentId:o.id})}))}dfsTree(t,e,n){return Ev(this.getNode(t),new Set,e,(t=>this.getChildren(t,n)))}bfsTree(t,e,n){return xv([this.getNode(t)],new Set,e,(t=>this.getChildren(t,n)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return xv([this.getNode(t)],new Set,e,i)}dfs(t,e,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return Ev(this.getNode(t),new Set,e,i)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),n=new Mv({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},i)=>{const r=new Map;t.forEach(((t,e)=>{r.set(e,n.getNode(t.id))}));const a=new Map;e.forEach(((t,e)=>{a.set(e,new Set(Array.from(t).map((t=>n.getNode(t.id)))))})),n.treeIndices.set(i,{parentMap:r,childrenMap:a})})),n}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(t){return new kv({graph:this,...t})}}class Sv{constructor(t,e){this.context=t,this.options=e||{}}}function Nv(t){const{nodes:e,edges:n}=t,i={nodes:[],edges:[],combos:[]};return e.forEach((t=>{const e=t.data._isCombo?i.combos:i.nodes,{x:n,y:r,z:a=0}=t.data;null==e||e.push({id:t.id,style:{x:n,y:r,z:a}})})),n.forEach((t=>{const{id:e,source:n,target:r,data:{points:a=[],controlPoints:o=a.slice(1,a.length-1)}}=t;i.edges.push({id:e,source:n,target:r,style:Object.assign({},(null==o?void 0:o.length)?{controlPoints:o.map(cd)}:{})})})),i}function Tv(t,e,...n){if(e in t)return t[e](...n);if("instance"in t){const i=t.instance;if(e in i)return i[e](...n)}return null}function Av(t,e){if(e in t)return t[e];if("instance"in t){const n=t.instance;if(e in n)return n[e]}return null}var Ov=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class Pv extends Bh{constructor(t,e){super(t,Object.assign({},Pv.defaultOptions,e)),this.isZoomEvent=t=>Boolean(t.data&&"scale"in t.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=t=>Ov(this,void 0,void 0,(function*(){if(!this.validate(t))return;const{graph:e}=this.context,{state:n,nodeFilter:i,edgeFilter:r,comboFilter:a}=this.options,o=(n?e.getElementDataByState("node",n):e.getNodeData()).filter(i),s=(n?e.getElementDataByState("edge",n):e.getEdgeData()).filter(r),l=(n?e.getElementDataByState("combo",n):e.getComboData()).filter(a),u=this.isZoomEvent(t)?this.zoom=Math.max(.01,Math.min(t.data.scale,10)):this.zoom,c=[...o,...l];c.length>0&&c.forEach((t=>this.fixNodeLike(t,u))),this.updateRelatedEdges(),s.length>0&&s.forEach((t=>this.fixEdge(t,u)))})),this.cachedStyles=new Map,this.getOriginalFieldValue=(t,e,n)=>{var i;const r=this.cachedStyles.get(t)||[],a=(null===(i=r.find((t=>t.shape===e)))||void 0===i?void 0:i.style)||{};return n in a||(a[n]=e.attributes[n],this.cachedStyles.set(t,[...r.filter((t=>t.shape!==e)),{shape:e,style:a}])),a[n]},this.scaleEntireElement=(t,e,n)=>{e.setLocalScale(1/n);const i=this.cachedStyles.get(t)||[];i.push({shape:e}),this.cachedStyles.set(t,i)},this.scaleSpecificShapes=(t,e,n)=>{const i=function(t){const e=[],n=t=>{(null==t?void 0:t.children.length)&&t.children.forEach((t=>{e.push(t),n(t)}))};return n(t),e}(t);(Array.isArray(n)?n:[n]).forEach((n=>{const{shape:r,fields:a}=n,o="function"==typeof r?r(i):t.getShape(r);o&&(a?a.forEach((n=>{const i=this.getOriginalFieldValue(t.id,o,n);le(i)&&(o.style[n]=i/e)})):this.scaleEntireElement(t.id,o,e))}))},this.skipIfExceedViewport=t=>{const{viewport:e}=this.context;return!(null==e?void 0:e.isInViewport(t.getRenderBounds(),!1,30))},this.fixNodeLike=(t,e)=>{const n=wh(t),{element:i,model:r}=this.context,a=i.getElement(n);if(!a||this.skipIfExceedViewport(a))return;r.getRelatedEdgesData(n).forEach((t=>this.relatedEdgeToUpdate.add(wh(t))));const o=this.options[a.type];o?this.scaleSpecificShapes(a,e,o):this.scaleEntireElement(n,a,e)},this.fixEdge=(t,e)=>{const n=wh(t),i=this.context.element.getElement(n);if(!i||this.skipIfExceedViewport(i))return;const r=this.options.edge;if(!r)return i.style.transformOrigin="center",void this.scaleEntireElement(n,i,e);this.scaleSpecificShapes(i,e,r)},this.updateRelatedEdges=()=>{const{element:t}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach((e=>{const n=t.getElement(e);null==n||n.update({})})),this.relatedEdgeToUpdate.clear()},this.resetTransform=t=>Ov(this,void 0,void 0,(function*(){var e;(null===(e=t.data)||void 0===e?void 0:e.firstRender)||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))})),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach((t=>{t.forEach((({shape:t,style:e})=>{if(Jd(e))t.setLocalScale(1);else{if(this.options.state)return;Object.entries(e).forEach((([e,n])=>t.style[e]=n))}}))}));const{graph:t,element:e}=this.context,n=Object.keys(Object.fromEntries(this.cachedStyles)).filter((e=>e&&"node"===t.getElementType(e)));if(n.length>0){const i=new Set;n.forEach((e=>{t.getRelatedEdgesData(e).forEach((t=>i.add(wh(t))))})),i.forEach((t=>{const n=null==e?void 0:e.getElement(t);null==n||n.update({})}))}}}bindEvents(){const{graph:t}=this.context;t.on(oc.AFTER_DRAW,this.resetTransform),t.on(oc.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){const{graph:t}=this.context;t.off(oc.AFTER_DRAW,this.resetTransform),t.off(oc.AFTER_TRANSFORM,this.fixElementSize)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}Pv.defaultOptions={enable:t=>t.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};class Cv extends Bh{constructor(t,e){super(t,Object.assign({},Cv.defaultOptions,e)),this.focus=t=>{return e=this,n=void 0,r=function*(){if(!this.validate(t))return;const{graph:e}=this.context;yield e.focusElement(t.target.id,this.options.animation)},new((i=void 0)||(i=Promise))((function(t,a){function o(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,s)}l((r=r.apply(e,n||[])).next())}));var e,n,i,r},this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Ad.forEach((e=>{t.on(`${e}:${ic.CLICK}`,this.focus)}))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Ad.forEach((e=>{t.off(`${e}:${ic.CLICK}`,this.focus)}))}destroy(){this.unbindEvents(),super.destroy()}}Cv.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class Rv extends Bh{constructor(t,e){super(t,Object.assign({},Rv.defaultOptions,e)),this.isFrozen=!1,this.toggleFrozen=t=>{this.isFrozen="dragstart"===t.type},this.hoverElement=t=>{if(!this.validate(t))return;const e=t.type===ic.POINTER_ENTER;this.updateElementsState(t,e);const{onHover:n,onHoverEnd:i}=this.options;e?null==n||n(t):null==i||i(t)},this.updateElementsState=(t,e)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:n}=this.context,{state:i,animation:r,inactiveState:a}=this.options,o=this.getActiveIds(t),s={};if(i&&Object.assign(s,this.getElementsState(o,i,e)),a){const t=Mh(n.getData(),!0).filter((t=>!o.includes(t)));Object.assign(s,this.getElementsState(t,a,e))}n.setElementState(s,r)},this.getElementsState=(t,e,n)=>{const{graph:i}=this.context,r={};return t.forEach((t=>{const a=i.getElementState(t);r[t]=n?a.includes(e)?a:[...a,e]:a.filter((t=>t!==e))})),r},this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Ad.forEach((e=>{t.on(`${e}:${ic.POINTER_ENTER}`,this.hoverElement),t.on(`${e}:${ic.POINTER_LEAVE}`,this.hoverElement)}));const e=this.context.canvas.document;e.addEventListener(`${ic.DRAG_START}`,this.toggleFrozen),e.addEventListener(`${ic.DRAG_END}`,this.toggleFrozen)}getActiveIds(t){const{graph:e}=this.context,{degree:n,direction:i}=this.options,r=t.target.id;return n?Pd(e,t.targetType,r,"function"==typeof n?n(t):n,i):[r]}validate(t){if(this.destroyed||this.isFrozen||ov(t.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Ad.forEach((e=>{t.off(`${e}:${ic.POINTER_ENTER}`,this.hoverElement),t.off(`${e}:${ic.POINTER_LEAVE}`,this.hoverElement)}));const e=this.context.canvas.document;e.removeEventListener(`${ic.DRAG_START}`,this.toggleFrozen),e.removeEventListener(`${ic.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}Rv.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class Lv extends Bh{constructor(t,e){super(t,Object.assign({},Lv.defaultOptions,e)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(t,e,n)=>{t.filter(Boolean).forEach((t=>{"hidden"!==e||t.isVisible()?"visible"===e&&this.hiddenShapes.includes(t)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(t),1):Dh(t,e,n):this.hiddenShapes.push(t)}))},this.filterShapes=(t,e)=>{if(gn(e))return n=>!e(t,n);const n=null==e?void 0:e[t];return t=>!t.className||!(null==n?void 0:n.includes(t.className))},this.hideShapes=t=>{if(!this.validate(t)||!this.isVisible)return;const{element:e}=this.context,{shapes:n={}}=this.options;this.setElementsVisibility(e.getNodes(),"hidden",this.filterShapes("node",n)),this.setElementsVisibility(e.getEdges(),"hidden",this.filterShapes("edge",n)),this.setElementsVisibility(e.getCombos(),"hidden",this.filterShapes("combo",n)),this.isVisible=!1},this.showShapes=fv((t=>{if(!this.validate(t)||this.isVisible)return;const{element:e}=this.context;this.setElementsVisibility(e.getNodes(),"visible"),this.setElementsVisibility(e.getEdges(),"visible"),this.setElementsVisibility(e.getCombos(),"visible"),this.isVisible=!0}),this.options.debounce),this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(oc.BEFORE_TRANSFORM,this.hideShapes),t.on(oc.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:t}=this.context;t.off(oc.BEFORE_TRANSFORM,this.hideShapes),t.off(oc.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}Lv.defaultOptions={enable:!0,debounce:200,shapes:t=>"node"===t};var Dv=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class Iv extends Bh{constructor(t,e){super(t,Object.assign({},Iv.defaultOptions,e)),this.onWheel=t=>Dv(this,void 0,void 0,(function*(){this.options.preventDefault&&t.preventDefault();const e=t.deltaX,n=t.deltaY;yield this.scroll([-e,-n],t)})),this.shortcut=new Md(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var t,e;const{trigger:n}=this.options;if(this.shortcut.unbindAll(),vn(n)){null===(t=this.graphDom)||void 0===t||t.removeEventListener(ic.WHEEL,this.onWheel);const{up:e=[],down:i=[],left:r=[],right:a=[]}=n;this.shortcut.bind(e,(t=>this.scroll([0,-10],t))),this.shortcut.bind(i,(t=>this.scroll([0,10],t))),this.shortcut.bind(r,(t=>this.scroll([-10,0],t))),this.shortcut.bind(a,(t=>this.scroll([10,0],t)))}else null===(e=this.graphDom)||void 0===e||e.addEventListener(ic.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(t){const{sensitivity:e}=this.options;return t=Yh(t,e),t=this.clampByDirection(t),this.clampByRange(t)}clampByDirection([t,e]){const{direction:n}=this.options;return"x"===n?e=0:"y"===n&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:n,canvas:i}=this.context,[r,a]=i.getSize(),[o,s,l,u]=_c(this.options.range),c=[a*o,r*s,a*l,r*u],h=Wc(Vc(n.getCanvasCenter()),c),d=Hh(n.getViewportCenter(),[t,e,0]);if(!Hc(d,h)){const{min:[n,i],max:[r,a]}=h;(d[0]<n&&t>0||d[0]>r&&t<0)&&(t=0),(d[1]<i&&e>0||d[1]>a&&e<0)&&(e=0)}return[t,e]}scroll(t,e){return Dv(this,void 0,void 0,(function*(){if(!this.validate(e))return;const{onFinish:n}=this.options,i=this.context.graph,r=this.formatDisplacement(t);yield i.translateBy(r,!1),null==n||n()}))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.graphDom)||void 0===t||t.removeEventListener(ic.WHEEL,this.onWheel),super.destroy()}}Iv.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var _v=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class Bv extends Bh{constructor(t,e){super(t,Object.assign({},Bv.defaultOptions,e)),this.zoom=(t,e,n)=>_v(this,void 0,void 0,(function*(){if(!this.validate(e))return;const{graph:i}=this.context;let r=this.options.origin;!r&&"viewport"in e&&(r=cd(e.viewport));const{sensitivity:a,onFinish:o}=this.options,s=1+de(t,-50,50)*a/100,l=i.getZoom();yield i.zoomTo(l*s,n,r),null==o||o()})),this.onReset=()=>_v(this,void 0,void 0,(function*(){yield this.context.graph.zoomTo(1,this.options.animation)})),this.preventDefault=t=>{this.options.preventDefault&&t.preventDefault()},this.shortcut=new Md(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(this.shortcut.unbindAll(),Array.isArray(t))if(t.includes(ic.PINCH))this.shortcut.bind([ic.PINCH],(t=>{this.zoom(t.scale,t,!1)}));else{const e=this.context.canvas.getContainer();null==e||e.addEventListener(ic.WHEEL,this.preventDefault),this.shortcut.bind([...t,ic.WHEEL],(t=>{const{deltaX:e,deltaY:n}=t;this.zoom(-(null!=n?n:e),t,!1)}))}if("object"==typeof t){const{zoomIn:e=[],zoomOut:n=[],reset:i=[]}=t;this.shortcut.bind(e,(t=>this.zoom(10,t,this.options.animation))),this.shortcut.bind(n,(t=>this.zoom(-10,t,this.options.animation))),this.shortcut.bind(i,this.onReset)}}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return gn(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.context.canvas.getContainer())||void 0===t||t.removeEventListener(ic.WHEEL,this.preventDefault),super.destroy()}}Bv.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var Fv=n(5802);const jv=(t,e)=>{if("next"!==t&&"prev"!==t)return e},Gv=t=>{t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev};class zv{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,e=t.prev;if(e&&e!==t)return Gv(e),e}enqueue(t){const e=this.shortcut;t.prev&&t.next&&Gv(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e}toString(){const t=[],e=this.shortcut;let n=e.prev;for(;n!==e;)t.push(JSON.stringify(n,jv)),n=null==n?void 0:n.prev;return`[${t.join(", ")}]`}}class Vv extends zv{}const Wv=()=>1,Uv=(t,e,n,i,r)=>{var a,o;const s=[];return t.hasNode(i.v)&&(null===(a=t.getRelatedEdges(i.v,"in"))||void 0===a||a.forEach((i=>{const a=i.data.weight,o=t.getNode(i.source);r&&s.push({v:i.source,w:i.target,in:0,out:0}),void 0===o.data.out&&(o.data.out=0),o.data.out-=a,Hv(e,n,Object.assign({v:o.id},o.data))})),null===(o=t.getRelatedEdges(i.v,"out"))||void 0===o||o.forEach((i=>{const r=i.data.weight,a=i.target,o=t.getNode(a);void 0===o.data.in&&(o.data.in=0),o.data.in-=r,Hv(e,n,Object.assign({v:o.id},o.data))})),t.removeNode(i.v)),r?s:void 0},Hv=(t,e,n)=>{n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)},Yv=(t,e)=>{const n="greedy"===e?(t=>{var e;if(t.getAllNodes().length<=1)return[];const n=((t,e)=>{const n=new Mv;let i=0,r=0;t.getAllNodes().forEach((t=>{n.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((t=>{const a=n.getRelatedEdges(t.source,"out").find((e=>e.target===t.target)),o=(null==e?void 0:e(t))||1;a?n.updateEdgeData(null==a?void 0:a.id,Object.assign(Object.assign({},a.data),{weight:a.data.weight+o})):n.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:o}}),r=Math.max(r,n.getNode(t.source).data.out+=o),i=Math.max(i,n.getNode(t.target).data.in+=o)}));const a=[],o=r+i+3;for(let t=0;t<o;t++)a.push(new Vv);const s=i+1;return n.getAllNodes().forEach((t=>{Hv(a,s,Object.assign({v:t.id},n.getNode(t.id).data))})),{buckets:a,zeroIdx:s,graph:n}})(t,(t=>t.data.weight||1)||Wv);return null===(e=((t,e,n)=>{let i=[];const r=e[e.length-1],a=e[0];let o;for(;t.getAllNodes().length;){for(;o=a.dequeue();)Uv(t,e,n,o);for(;o=r.dequeue();)Uv(t,e,n,o);if(t.getAllNodes().length)for(let r=e.length-2;r>0;--r)if(o=e[r].dequeue(),o){i=i.concat(Uv(t,e,n,o,!0));break}}return i})(n.graph,n.buckets,n.zeroIdx).map((e=>t.getRelatedEdges(e.v,"out").filter((({target:t})=>t===e.w)))))||void 0===e?void 0:e.flat()})(t):$v(t);null==n||n.forEach((e=>{const n=e.data;t.removeEdge(e.id),n.forwardName=e.data.name,n.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign({},n)})}))},$v=t=>{const e=[],n={},i={},r=a=>{i[a]||(i[a]=!0,n[a]=!0,t.getRelatedEdges(a,"out").forEach((t=>{n[t.target]?e.push(t):r(t.target)})),delete n[a])};return t.getAllNodes().forEach((t=>r(t.id))),e},Xv=(t,e,n,i)=>{let r;do{r=`${i}${Math.random()}`}while(t.hasNode(r));return n.dummy=e,t.addNode({id:r,data:n}),r},qv=t=>{const e=new Mv;return t.getAllNodes().forEach((n=>{t.getChildren(n.id).length||e.addNode(Object.assign({},n))})),t.getAllEdges().forEach((t=>{e.addEdge(t)})),e},Kv=(t,e)=>{const n=Number(t.x),i=Number(t.y),r=Number(e.x)-n,a=Number(e.y)-i;let o,s,l=Number(t.width)/2,u=Number(t.height)/2;return r||a?(Math.abs(a)*l>Math.abs(r)*u?(a<0&&(u=-u),o=u*r/a,s=u):(r<0&&(l=-l),o=l,s=l*a/r),{x:n+o,y:i+s}):{x:0,y:0}},Zv=t=>{const e=[],n=Jv(t)+1;for(let t=0;t<n;t++)e.push([]);t.getAllNodes().forEach((t=>{const n=t.data.rank;void 0!==n&&e[n]&&e[n].push(t.id)}));for(let i=0;i<n;i++)e[i]=e[i].sort(((e,n)=>{return i=t.getNode(e).data.order,r=t.getNode(n).data.order,Number(i)-Number(r);var i,r}));return e},Qv=(t,e,n,i)=>{const r={width:0,height:0};return le(n)&&le(i)&&(r.rank=n,r.order=i),Xv(t,"border",r,e)},Jv=t=>{let e;return t.getAllNodes().forEach((t=>{const n=t.data.rank;void 0!==n&&(void 0===e||n>e)&&(e=n)})),e||(e=0),e},ty=(t,e)=>t.reduce(((t,n)=>e(t)>e(n)?n:t)),ey=(t,e,n,i,r,a)=>{i.includes(e.id)||(i.push(e.id),n||a.push(e.id),r(e.id).forEach((e=>ey(t,e,n,i,r,a))),n&&a.push(e.id))},ny=(t,e,n,i)=>{const r=Array.isArray(e)?e:[e],a=e=>i?t.getSuccessors(e):t.getNeighbors(e),o=[],s=[];return r.forEach((e=>{if(!t.hasNode(e.id))throw new Error(`Graph does not have node: ${e}`);ey(t,e,"post"===n,s,a,o)})),o},iy=(t,e,n,i,r,a)=>{const o={rank:a,borderType:e,width:0,height:0},s=r.data[e][a-1],l=Xv(t,"border",o,n);r.data[e][a]=l,t.setParent(l,i),s&&t.addEdge({id:`e${Math.random()}`,source:s,target:l,data:{weight:1}})},ry=t=>{t.getAllNodes().forEach((t=>{ay(t)})),t.getAllEdges().forEach((t=>{ay(t)}))},ay=t=>{const e=t.data.width;t.data.width=t.data.height,t.data.height=e},oy=t=>{(null==t?void 0:t.y)&&(t.y=-t.y)},sy=t=>{const e=t.x;t.x=t.y,t.y=e},ly=(t,e,n,i,r,a,o)=>{const s=t.getChildren(o);if(!(null==s?void 0:s.length))return void(o!==e&&t.addEdge({id:`e${Math.random()}`,source:e,target:o,data:{weight:0,minlen:n}}));const l=Qv(t,"_bt"),u=Qv(t,"_bb"),c=t.getNode(o);t.setParent(l,o),c.data.borderTop=l,t.setParent(u,o),c.data.borderBottom=u,null==s||s.forEach((s=>{ly(t,e,n,i,r,a,s.id);const c=s.data.borderTop?s.data.borderTop:s.id,h=s.data.borderBottom?s.data.borderBottom:s.id,d=s.data.borderTop?i:2*i,f=c!==h?1:r-a[o]+1;t.addEdge({id:`e${Math.random()}`,source:l,target:c,data:{minlen:f,weight:d,nestingEdge:!0}}),t.addEdge({id:`e${Math.random()}`,source:h,target:u,data:{minlen:f,weight:d,nestingEdge:!0}})})),t.getParent(o)||t.addEdge({id:`e${Math.random()}`,source:e,target:l,data:{weight:0,minlen:r+a[o]}})},uy="edge-label",cy=(t,e,n)=>{const i=(a=n,o=n.map(((t,e)=>e)),null==a?void 0:a.reduce(((t,e,n)=>(t[e]=o[n],t)),{})),r=e.map((e=>{const n=t.getRelatedEdges(e,"out").map((t=>({pos:i[t.target]||0,weight:t.data.weight})));return null==n?void 0:n.sort(((t,e)=>t.pos-e.pos))})).flat().filter((t=>void 0!==t));var a,o;let s=1;for(;s<n.length;)s<<=1;const l=2*s-1;s-=1;const u=Array(l).fill(0,0,l);let c=0;return null==r||r.forEach((t=>{if(t){let e=t.pos+s;u[e]+=t.weight;let n=0;for(;e>0;)e%2&&(n+=u[e+1]),e=e-1>>1,u[e]+=t.weight;c+=t.weight*n}})),c},hy=(t,e)=>{let n=0;for(let i=1;i<(null==e?void 0:e.length);i+=1)n+=cy(t,e[i-1],e[i]);return n},dy=t=>{const e={},n=t.getAllNodes(),i=n.map((t=>{var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),r=Math.max(...i),a=[];for(let t=0;t<r+1;t++)a.push([]);const o=n.sort(((e,n)=>t.getNode(e.id).data.rank-t.getNode(n.id).data.rank)),s=o.filter((e=>void 0!==t.getNode(e.id).data.fixorder)).sort(((e,n)=>t.getNode(e.id).data.fixorder-t.getNode(n.id).data.fixorder));return null==s||s.forEach((n=>{isNaN(t.getNode(n.id).data.rank)||a[t.getNode(n.id).data.rank].push(n.id),e[n.id]=!0})),null==o||o.forEach((n=>t.dfsTree(n.id,(t=>{if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||a[t.data.rank].push(t.id)})))),a},fy=(t,e)=>{var n;let i=0,r=0;t.weight&&(i+=t.barycenter*t.weight,r+=t.weight),e.weight&&(i+=e.barycenter*e.weight,r+=e.weight),t.vs=null===(n=e.vs)||void 0===n?void 0:n.concat(t.vs),t.barycenter=i/r,t.weight=r,t.i=Math.min(e.i,t.i),e.merged=!0},py=(t,e)=>{var n,i,r;const a={};null==t||t.forEach(((t,e)=>{a[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};const n=a[t.v];void 0!==t.barycenter&&(n.barycenter=t.barycenter,n.weight=t.weight)})),null===(n=e.getAllEdges())||void 0===n||n.forEach((t=>{const e=a[t.source],n=a[t.target];void 0!==e&&void 0!==n&&(n.indegree++,e.out.push(a[t.target]))}));return(t=>{var e,n;const i=[];for(;null==t?void 0:t.length;){const r=t.pop();i.push(r),null===(e=r.in.reverse())||void 0===e||e.forEach((t=>{return(e=r,t=>{t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&fy(e,t)})(t);var e})),null===(n=r.out)||void 0===n||n.forEach((e=>{return(n=r,e=>{e.in.push(n),0==--e.indegree&&t.push(e)})(e);var n}))}const r=i.filter((t=>!t.merged)),a=["vs","i","barycenter","weight"];return r.map((t=>{const e={};return null==a||a.forEach((n=>{void 0!==t[n]&&(e[n]=t[n])})),e}))})(null===(r=(i=Object.values(a)).filter)||void 0===r?void 0:r.call(i,(t=>!t.indegree)))},gy=(t,e,n)=>{let i,r=n;for(;e.length&&(i=e[e.length-1]).i<=r;)e.pop(),null==t||t.push(i.vs),r++;return r},vy=(t,e,n,i,r,a)=>{var o,s,l,u;let c=t.getChildren(e).map((t=>t.id));const h=t.getNode(e),d=h?h.data.borderLeft:void 0,f=h?h.data.borderRight:void 0,p={};d&&(c=null==c?void 0:c.filter((t=>t!==d&&t!==f)));const g=((t,e)=>e.map((e=>{const n=t.getRelatedEdges(e,"in");if(!(null==n?void 0:n.length))return{v:e};const i={sum:0,weight:0};return null==n||n.forEach((e=>{const n=t.getNode(e.source);i.sum+=e.data.weight*n.data.order,i.weight+=e.data.weight})),{v:e,barycenter:i.sum/i.weight,weight:i.weight}})))(t,c||[]);null==g||g.forEach((e=>{var r;if(null===(r=t.getChildren(e.v))||void 0===r?void 0:r.length){const r=vy(t,e.v,n,i,a);p[e.v]=r,r.hasOwnProperty("barycenter")&&my(e,r)}}));const v=py(g,n);yy(v,p),null===(o=v.filter((t=>t.vs.length>0)))||void 0===o||o.forEach((e=>{const n=t.getNode(e.vs[0]);n&&(e.fixorder=n.data.fixorder,e.order=n.data.order)}));const y=((t,e,n,i)=>{const r=(t=>{const e={lhs:[],rhs:[]};return null==t||t.forEach((t=>{(t=>{const e=t.hasOwnProperty("fixorder")&&!isNaN(t.fixorder);return i?!e&&t.hasOwnProperty("barycenter"):e||t.hasOwnProperty("barycenter")})(t)?e.lhs.push(t):e.rhs.push(t)})),e})(t),a=r.lhs,o=r.rhs.sort(((t,e)=>-t.i- -e.i)),s=[];let l=0,u=0,c=0;null==a||a.sort(((t,e)=>(n,i)=>{if(void 0!==n.fixorder&&void 0!==i.fixorder)return n.fixorder-i.fixorder;if(n.barycenter<i.barycenter)return-1;if(n.barycenter>i.barycenter)return 1;if(e&&void 0!==n.order&&void 0!==i.order){if(n.order<i.order)return-1;if(n.order>i.order)return 1}return t?i.i-n.i:n.i-i.i})(!!e,!!n)),c=gy(s,o,c),null==a||a.forEach((t=>{var e;c+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),l+=t.barycenter*t.weight,u+=t.weight,c=gy(s,o,c)}));const h={vs:s.flat()};return u&&(h.barycenter=l/u,h.weight=u),h})(v,i,r,a);if(d&&(y.vs=[d,y.vs,f].flat(),null===(s=t.getPredecessors(d))||void 0===s?void 0:s.length)){const e=t.getNode((null===(l=t.getPredecessors(d))||void 0===l?void 0:l[0].id)||""),n=t.getNode((null===(u=t.getPredecessors(f))||void 0===u?void 0:u[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+e.data.order+n.data.order)/(y.weight+2),y.weight+=2}return y},yy=(t,e)=>{null==t||t.forEach((t=>{var n;const i=null===(n=t.vs)||void 0===n?void 0:n.map((t=>e[t]?e[t].vs:t));t.vs=i.flat()}))},my=(t,e)=>{void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},by=(t,e,n)=>e.map((e=>((t,e,n)=>{const i=(t=>{let e;for(;t.hasNode(e=`_root${Math.random()}`););return e})(t),r=new Mv({tree:[{id:i,children:[],data:{}}]});return t.getAllNodes().forEach((a=>{const o=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(r.hasNode(a.id)||r.addNode(Object.assign({},a)),(null==o?void 0:o.id)&&!r.hasNode(null==o?void 0:o.id)&&r.addNode(Object.assign({},o)),r.setParent(a.id,(null==o?void 0:o.id)||i),t.getRelatedEdges(a.id,n).forEach((e=>{const n=e.source===a.id?e.target:e.source;r.hasNode(n)||r.addNode(Object.assign({},t.getNode(n)));const i=r.getRelatedEdges(n,"out").find((({target:t})=>t===a.id)),o=void 0!==i?i.data.weight:0;i?r.updateEdgeData(i.id,Object.assign(Object.assign({},i.data),{weight:e.data.weight+o})):r.addEdge({id:e.id,source:n,target:a.id,data:{weight:e.data.weight+o}})})),a.data.hasOwnProperty("minRank")&&r.updateNodeData(a.id,Object.assign(Object.assign({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),r})(t,e,n))),xy=(t,e,n,i)=>{const r=new Mv;null==t||t.forEach((t=>{var a;const o=t.getRoots()[0].id,s=vy(t,o,r,e,n,i);for(let e=0;e<(null===(a=s.vs)||void 0===a?void 0:a.length);e++){const n=t.getNode(s.vs[e]);n&&(n.data.order=e)}((t,e,n)=>{const i={};let r;null==n||n.forEach((n=>{let a,o,s=t.getParent(n);for(;s;){if(a=t.getParent(s.id),a?(o=i[a.id],i[a.id]=s.id):(o=r,r=s.id),o&&o!==s.id)return e.hasNode(o)||e.addNode({id:o,data:{}}),e.hasNode(s.id)||e.addNode({id:s.id,data:{}}),void(e.hasEdge(`e${o}-${s.id}`)||e.addEdge({id:`e${o}-${s.id}`,source:o,target:s.id,data:{}}));s=a}}))})(t,r,s.vs)}))},Ey=(t,e)=>{null==e||e.forEach((e=>{null==e||e.forEach(((e,n)=>{t.getNode(e).data.order=n}))}))},wy=(t,e)=>{var n,i;if(null===(n=t.getNode(e))||void 0===n?void 0:n.data.dummy)return null===(i=t.getPredecessors(e))||void 0===i?void 0:i.find((e=>t.getNode(e.id).data.dummy))},ky=(t,e,n)=>{let i=e,r=n;if(i>r){const t=i;i=r,r=t}let a=t[i];a||(t[i]=a={}),a[r]=!0},My=(t,e,n)=>{let i=e,r=n;return i>n&&(i=n,r=e),!!t[i]},Sy=(t,e,n,i,r,a)=>{const o=new Mv,s=Ny(i,r,a);return null==e||e.forEach((e=>{let i;null==e||e.forEach((e=>{const r=n[e];if(o.hasNode(r)||o.addNode({id:r,data:{}}),i){const a=n[i],l=o.getRelatedEdges(a,"out").find((t=>t.target===r));l?o.updateEdgeData(l.id,Object.assign(Object.assign({},l.data),{weight:Math.max(s(t,e,i),l.data.weight||0)})):o.addEdge({id:`e${Math.random()}`,source:a,target:r,data:{weight:Math.max(s(t,e,i),0)}})}i=e}))})),o};const Ny=(t,e,n)=>(i,r,a)=>{const o=i.getNode(r),s=i.getNode(a);let l=0,u=0;if(l+=o.data.width/2,o.data.hasOwnProperty("labelpos"))switch((o.data.labelpos||"").toLowerCase()){case"l":u=-o.data.width/2;break;case"r":u=o.data.width/2}if(u&&(l+=n?u:-u),u=0,l+=(o.data.dummy?e:t)/2,l+=(s.data.dummy?e:t)/2,l+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":u=s.data.width/2;break;case"r":u=-s.data.width/2}return u&&(l+=n?u:-u),u=0,l},Ty=(t,e)=>t.getNode(e).data.width||0,Ay=(t,e)=>{var n;const i=qv(t);((t,e)=>{const{ranksep:n=0}=e||{},i=Zv(t);let r=0;null==i||i.forEach((e=>{const i=e.map((e=>t.getNode(e).data.height)),a=Math.max(...i,0);null==e||e.forEach((e=>{t.getNode(e).data.y=r+a/2})),r+=a+n}))})(i,e);const r=((t,e)=>{const{align:n,nodesep:i=0,edgesep:r=0}=e||{},a=Zv(t),o=Object.assign(((t,e)=>{const n={};return(null==e?void 0:e.length)&&e.reduce(((e,i)=>{let r=0,a=0;const o=e.length,s=null==i?void 0:i[(null==i?void 0:i.length)-1];return null==i||i.forEach(((e,l)=>{var u;const c=wy(t,e),h=c?t.getNode(c.id).data.order:o;(c||e===s)&&(null===(u=i.slice(a,l+1))||void 0===u||u.forEach((e=>{var i;null===(i=t.getPredecessors(e))||void 0===i||i.forEach((i=>{var a;const o=t.getNode(i.id),s=o.data.order;!(s<r||h<s)||o.data.dummy&&(null===(a=t.getNode(e))||void 0===a?void 0:a.data.dummy)||ky(n,i.id,e)}))})),a=l+1,r=h)})),i})),n})(t,a),((t,e)=>{const n={};function i(e,i){const r=function(t){return JSON.stringify(t.slice(1))}(e);i.get(r)||(function(e,i,r,a,o){var s,l;let u;for(let c=i;c<r;c++)u=e[c],(null===(s=t.getNode(u))||void 0===s?void 0:s.data.dummy)&&(null===(l=t.getPredecessors(u))||void 0===l||l.forEach((e=>{const i=t.getNode(e.id);i.data.dummy&&(i.data.order<a||i.data.order>o)&&ky(n,e.id,u)})))}(...e),i.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce(((e,n)=>{let r,a=-1,o=0;const s=new Map;return null==n||n.forEach(((l,u)=>{var c;if("border"===(null===(c=t.getNode(l))||void 0===c?void 0:c.data.dummy)){const e=t.getPredecessors(l)||[];e.length&&(r=t.getNode(e[0].id).data.order,i([n,o,u,a,r],s),o=u,a=r)}i([n,o,n.length,r,e.length],s)})),n})),n})(t,a)),s={};let l=[];["u","d"].forEach((e=>{l="u"===e?a:Object.values(a).reverse(),["l","r"].forEach((n=>{"r"===n&&(l=l.map((t=>Object.values(t).reverse())));const a=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),u=((t,e,n,i)=>{const r={},a={},o={};return null==e||e.forEach((t=>{null==t||t.forEach(((t,e)=>{r[t]=t,a[t]=t,o[t]=e}))})),null==e||e.forEach((t=>{let e=-1;null==t||t.forEach((t=>{let s=i(t).map((t=>t.id));if(s.length){s=s.sort(((t,e)=>o[t]-o[e]));const i=(s.length-1)/2;for(let l=Math.floor(i),u=Math.ceil(i);l<=u;++l){const i=s[l];a[t]===t&&e<o[i]&&!My(n,t,i)&&(a[i]=t,a[t]=r[t]=r[i],e=o[i])}}}))})),{root:r,align:a}})(0,l,o,a),c=((t,e,n,i,r,a,o)=>{var s;const l={},u=Sy(t,e,n,r,a,o),c=o?"borderLeft":"borderRight",h=(t,e)=>{let n=u.getAllNodes(),i=n.pop();const r={};for(;i;)r[i.id]?t(i.id):(r[i.id]=!0,n.push(i),n=n.concat(e(i.id))),i=n.pop()};return h((t=>{l[t]=(u.getRelatedEdges(t,"in")||[]).reduce(((t,e)=>Math.max(t,(l[e.source]||0)+e.data.weight)),0)}),u.getPredecessors.bind(u)),h((e=>{const n=(u.getRelatedEdges(e,"out")||[]).reduce(((t,e)=>Math.min(t,(l[e.target]||0)-e.data.weight)),Number.POSITIVE_INFINITY),i=t.getNode(e);n!==Number.POSITIVE_INFINITY&&i.data.borderType!==c&&(l[e]=Math.max(l[e],n))}),u.getSuccessors.bind(u)),null===(s=Object.values(i))||void 0===s||s.forEach((t=>{l[t]=l[n[t]]})),l})(t,l,u.root,u.align,i,r,"r"===n);"r"===n&&Object.keys(c).forEach((t=>c[t]=-c[t])),s[e+n]=c}))}));const u=((t,e)=>ty(Object.values(e),(e=>{var n;let i=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return null===(n=Object.keys(e))||void 0===n||n.forEach((n=>{const a=e[n],o=Ty(t,n)/2;i=Math.max(a+o,i),r=Math.min(a-o,r)})),i-r})))(t,s);return u&&function(t,e){const n=Object.values(e),i=Math.min(...n),r=Math.max(...n);["u","d"].forEach((n=>{["l","r"].forEach((a=>{const o=n+a,s=t[o];let l;if(s===e)return;const u=Object.values(s);l="l"===a?i-Math.min(...u):r-Math.max(...u),l&&(t[o]={},Object.keys(s).forEach((e=>{t[o][e]=s[e]+l})))}))}))}(s,u),((t,e)=>{const n={};return Object.keys(t.ul).forEach((i=>{if(e)n[i]=t[e.toLowerCase()][i];else{const e=Object.values(t).map((t=>t[i]));n[i]=(e[0]+e[1])/2}})),n})(s,n)})(i,e);null===(n=Object.keys(r))||void 0===n||n.forEach((t=>{i.getNode(t).data.x=r[t]}))},Oy=t=>{const e={},n=i=>{var r;const a=t.getNode(i);if(!a)return 0;if(e[i])return a.data.rank;let o;return e[i]=!0,null===(r=t.getRelatedEdges(i,"out"))||void 0===r||r.forEach((t=>{const e=n(t.target)-t.data.minlen;e&&(void 0===o||e<o)&&(o=e)})),o||(o=0),a.data.rank=o,o};t.getAllNodes().filter((e=>0===t.getRelatedEdges(e.id,"in").length)).forEach((t=>n(t.id)))},Py=(t,e)=>t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen,Cy=(t,e)=>{const n=i=>{e.getRelatedEdges(i,"both").forEach((r=>{const a=r.source,o=i===a?r.target:a;t.hasNode(o)||Py(e,r)||(t.addNode({id:o,data:{}}),t.addEdge({id:r.id,source:i,target:o,data:{}}),n(o))}))};return t.getAllNodes().forEach((t=>n(t.id))),t.getAllNodes().length},Ry=(t,e)=>{const n=i=>{var r;null===(r=e.getRelatedEdges(i,"both"))||void 0===r||r.forEach((r=>{const a=r.source,o=i===a?r.target:a;t.hasNode(o)||void 0===e.getNode(o).data.layer&&Py(e,r)||(t.addNode({id:o,data:{}}),t.addEdge({id:r.id,source:i,target:o,data:{}}),n(o))}))};return t.getAllNodes().forEach((t=>n(t.id))),t.getAllNodes().length},Ly=(t,e)=>ty(e.getAllEdges(),(n=>t.hasNode(n.source)!==t.hasNode(n.target)?Py(e,n):1/0)),Dy=(t,e,n)=>{t.getAllNodes().forEach((t=>{const i=e.getNode(t.id);i.data.rank||(i.data.rank=0),i.data.rank+=n}))},Iy=(t,e)=>{let n=ny(t,t.getAllNodes(),"post",!1);n=n.slice(0,(null==n?void 0:n.length)-1),n.forEach((n=>{_y(t,e,n)}))},_y=(t,e,n)=>{const i=t.getNode(n).data.parent;t.getRelatedEdges(n,"both").find((t=>t.target===i||t.source===i)).data.cutvalue=By(t,e,n)},By=(t,e,n)=>{const i=t.getNode(n).data.parent;let r=!0,a=e.getRelatedEdges(n,"out").find((t=>t.target===i)),o=0;return a||(r=!1,a=e.getRelatedEdges(i,"out").find((t=>t.target===n))),o=a.data.weight,e.getRelatedEdges(n,"both").forEach((e=>{const a=e.source===n,s=a?e.target:e.source;if(s!==i){const i=a===r,l=e.data.weight;if(o+=i?l:-l,Uy(t,n,s)){const e=t.getRelatedEdges(n,"both").find((t=>t.source===s||t.target===s)).data.cutvalue;o+=i?-e:e}}})),o},Fy=(t,e=t.getAllNodes()[0].id)=>{jy(t,{},1,e)},jy=(t,e,n,i,r)=>{var a;const o=n;let s=n;const l=t.getNode(i);return e[i]=!0,null===(a=t.getNeighbors(i))||void 0===a||a.forEach((n=>{e[n.id]||(s=jy(t,e,s,n.id,i))})),l.data.low=o,l.data.lim=s++,r?l.data.parent=r:delete l.data.parent,s},Gy=t=>t.getAllEdges().find((t=>t.data.cutvalue<0)),zy=(t,e,n)=>{let i=n.source,r=n.target;e.getRelatedEdges(i,"out").find((t=>t.target===r))||(i=n.target,r=n.source);const a=t.getNode(i),o=t.getNode(r);let s=a,l=!1;a.data.lim>o.data.lim&&(s=o,l=!0);const u=e.getAllEdges().filter((e=>l===Hy(t.getNode(e.source),s)&&l!==Hy(t.getNode(e.target),s)));return ty(u,(t=>Py(e,t)))},Vy=(t,e,n,i)=>{const r=t.getRelatedEdges(n.source,"both").find((t=>t.source===n.target||t.target===n.target));r&&t.removeEdge(r.id),t.addEdge({id:`e${Math.random()}`,source:i.source,target:i.target,data:{}}),Fy(t),Iy(t,e),Wy(t,e)},Wy=(t,e)=>{const n=t.getAllNodes().find((t=>!t.data.parent));let i=ny(t,n,"pre",!1);i=i.slice(1),i.forEach((n=>{const i=t.getNode(n).data.parent;let r=e.getRelatedEdges(n,"out").find((t=>t.target===i)),a=!1;!r&&e.hasNode(i)&&(r=e.getRelatedEdges(i,"out").find((t=>t.target===n)),a=!0),e.getNode(n).data.rank=(e.hasNode(i)&&e.getNode(i).data.rank||0)+(a?null==r?void 0:r.data.minlen:-(null==r?void 0:r.data.minlen))}))},Uy=(t,e,n)=>t.getRelatedEdges(e,"both").find((t=>t.source===n||t.target===n)),Hy=(t,e)=>e.data.low<=t.data.lim&&t.data.lim<=e.data.lim,Yy=Oy,$y=t=>{(t=>{const e=(t=>{const e=new Mv;return t.getAllNodes().forEach((t=>{e.addNode(Object.assign({},t))})),t.getAllEdges().forEach((t=>{const n=e.getRelatedEdges(t.source,"out").find((e=>e.target===t.target));n?e.updateEdgeData(null==n?void 0:n.id,Object.assign(Object.assign({},n.data),{weight:n.data.weight+t.data.weight||0,minlen:Math.max(n.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e})(t);Oy(e);const n=(t=>{const e=new Mv({tree:[]}),n=t.getAllNodes()[0],i=t.getAllNodes().length;let r,a;for(e.addNode(n);Cy(e,t)<i;)r=Ly(e,t),a=e.hasNode(r.source)?Py(t,r):-Py(t,r),Dy(e,t,a);return e})(e);let i,r;for(Fy(n),Iy(n,e);i=Gy(n);)r=zy(n,e,i),Vy(n,e,i,r)})(t)},Xy=(t,e)=>{const{acyclicer:n,ranker:i,rankdir:r="tb",nodeOrder:a,keepNodeOrder:o,align:s,nodesep:l=50,edgesep:u=20,ranksep:c=50}=e;lm(t),Yv(t,n);const{nestingRoot:h,nodeRankFactor:d}=(t=>{const e=Xv(t,"root",{},"_root"),n=(t=>{const e={},n=(i,r)=>{const a=t.getChildren(i);null==a||a.forEach((t=>n(t.id,r+1))),e[i]=r};return t.getRoots().forEach((t=>n(t.id,1))),e})(t);let i=Math.max(...Object.values(n));Math.abs(i)===1/0&&(i=1);const r=i-1,a=2*r+1;t.getAllEdges().forEach((t=>{t.data.minlen*=a}));const o=(t=>{let e=0;return t.getAllEdges().forEach((t=>{e+=t.data.weight})),e})(t)+1;return t.getRoots().forEach((i=>{ly(t,e,a,o,r,n,i.id)})),{nestingRoot:e,nodeRankFactor:a}})(t);((t,e)=>{switch(e){case"network-simplex":$y(t);break;case"tight-tree":default:(t=>{(t=>{const e={};let n;const i=r=>{var a;const o=t.getNode(r);if(!o)return 0;if(e[r])return o.data.rank;let s;return e[r]=!0,null===(a=t.getRelatedEdges(r,"out"))||void 0===a||a.forEach((t=>{const e=i(t.target)-t.data.minlen;e&&(void 0===s||e<s)&&(s=e)})),s||(s=0),(void 0===n||s<n)&&(n=s),o.data.rank=s,s};t.getAllNodes().filter((e=>0===t.getRelatedEdges(e.id,"in").length)).forEach((t=>{t&&i(t.id)})),void 0===n&&(n=0);const r={},a=(e,n)=>{var i;const o=t.getNode(e),s=isNaN(o.data.layer)?n:o.data.layer;(void 0===o.data.rank||o.data.rank<s)&&(o.data.rank=s),r[e]||(r[e]=!0,null===(i=t.getRelatedEdges(e,"out"))||void 0===i||i.forEach((t=>{a(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((t=>{const e=t.data;e&&(isNaN(e.layer)?e.rank-=n:a(t.id,e.layer))}))})(t),(t=>{const e=new Mv({tree:[]}),n=t.getAllNodes()[0],i=t.getAllNodes().length;let r,a;for(e.addNode(n);Ry(e,t)<i;)r=Ly(e,t),a=e.hasNode(r.source)?Py(t,r):-Py(t,r),Dy(e,t,a)})(t)})(t);break;case"longest-path":Yy(t)}})(qv(t),i),tm(t),((t,e=0)=>{const n=t.getAllNodes(),i=n.filter((t=>void 0!==t.data.rank)).map((t=>t.data.rank)),r=Math.min(...i),a=[];n.forEach((t=>{const e=(t.data.rank||0)-r;a[e]||(a[e]=[]),a[e].push(t.id)}));let o=0;for(let n=0;n<a.length;n++){const i=a[n];void 0===i?n%e!=0&&(o-=1):o&&(null==i||i.forEach((e=>{const n=t.getNode(e);n&&(n.data.rank=n.data.rank||0,n.data.rank+=o)})))}})(t,d),((t,e)=>{e&&t.removeNode(e),t.getAllEdges().forEach((e=>{e.data.nestingEdge&&t.removeEdge(e.id)}))})(t,h),(t=>{const e=t.getAllNodes().filter((t=>void 0!==t.data.rank)).map((t=>t.data.rank)),n=Math.min(...e);t.getAllNodes().forEach((t=>{t.data.hasOwnProperty("rank")&&n!==1/0&&(t.data.rank-=n)}))})(t),em(t),nm(t);const f=[];((t,e)=>{t.getAllEdges().forEach((n=>((t,e,n)=>{let i=e.source,r=t.getNode(i).data.rank;const a=e.target,o=t.getNode(a).data.rank,s=e.data.labelRank;if(o===r+1)return;let l,u,c;for(t.removeEdge(e.id),c=0,++r;r<o;++c,++r)e.data.points=[],u={originalEdge:e,width:0,height:0,rank:r},l=Xv(t,"edge",u,"_d"),r===s&&(u.width=e.data.width,u.height=e.data.height,u.dummy=uy,u.labelpos=e.data.labelpos),t.addEdge({id:`e${Math.random()}`,source:i,target:l,data:{weight:e.data.weight}}),0===c&&n.push(l),i=l;t.addEdge({id:`e${Math.random()}`,source:i,target:a,data:{weight:e.data.weight}})})(t,n,e)))})(t,f),((t,e)=>{const n=(t=>{const e={};let n=0;const i=r=>{const a=n;t.getChildren(r).forEach((t=>i(t.id))),e[r]={low:a,lim:n++}};return t.getRoots().forEach((t=>i(t.id))),e})(t);e.forEach((e=>{var i,r;let a=e,o=t.getNode(a);const s=o.data.originalEdge;if(!s)return;const l=((t,e,n,i)=>{var r,a;const o=[],s=[],l=Math.min(e[n].low,e[i].low),u=Math.max(e[n].lim,e[i].lim);let c,h;c=n;do{c=null===(r=t.getParent(c))||void 0===r?void 0:r.id,o.push(c)}while(c&&(e[c].low>l||u>e[c].lim));for(h=c,c=i;c&&c!==h;)s.push(c),c=null===(a=t.getParent(c))||void 0===a?void 0:a.id;return{lca:h,path:o.concat(s.reverse())}})(t,n,s.source,s.target),u=l.path,c=l.lca;let h=0,d=u[h],f=!0;for(;a!==s.target;){if(o=t.getNode(a),f){for(;d!==c&&(null===(i=t.getNode(d))||void 0===i?void 0:i.data.maxRank)<o.data.rank;)h++,d=u[h];d===c&&(f=!1)}if(!f){for(;h<u.length-1&&(null===(r=t.getNode(u[h+1]))||void 0===r?void 0:r.data.minRank)<=o.data.rank;)h++;d=u[h]}t.hasNode(d)&&t.setParent(a,d),a=t.getSuccessors(a)[0].id}}))})(t,f),(t=>{const e=n=>{const i=t.getChildren(n),r=t.getNode(n);if((null==i?void 0:i.length)&&i.forEach((t=>e(t.id))),r.data.hasOwnProperty("minRank")){r.data.borderLeft=[],r.data.borderRight=[];for(let e=r.data.minRank,i=r.data.maxRank+1;e<i;e+=1)iy(t,"borderLeft","_bl",n,r,e),iy(t,"borderRight","_br",n,r,e)}};t.getRoots().forEach((t=>e(t.id)))})(t),o&&((t,e)=>{const n=t.getAllNodes().filter((e=>{var n;return!(null===(n=t.getChildren(e.id))||void 0===n?void 0:n.length)})),i=n.map((t=>t.data.rank)),r=Math.max(...i),a=[];for(let t=0;t<r+1;t++)a[t]=[];null==e||e.forEach((e=>{const n=t.getNode(e);n&&!n.data.dummy&&(isNaN(n.data.rank)||(n.data.fixorder=a[n.data.rank].length,a[n.data.rank].push(e)))}))})(t,a),((t,e)=>{const n=Jv(t),i=[],r=[];for(let t=1;t<n+1;t++)i.push(t);for(let t=n-1;t>-1;t--)r.push(t);const a=by(t,i,"in"),o=by(t,r,"out");let s=dy(t);Ey(t,s);let l,u=Number.POSITIVE_INFINITY;for(let n=0,i=0;i<4;++n,++i){xy(n%2?a:o,n%4>=2,!1,e),s=Zv(t);const r=hy(t,s);r<u&&(i=0,l=Lc(s),u=r)}s=dy(t),Ey(t,s);for(let n=0,i=0;i<4;++n,++i){xy(n%2?a:o,n%4>=2,!0,e),s=Zv(t);const r=hy(t,s);r<u&&(i=0,l=Lc(s),u=r)}Ey(t,l)})(t,o),um(t),((t,e)=>{const n=e.toLowerCase();"lr"!==n&&"rl"!==n||ry(t)})(t,r),Ay(t,{align:s,nodesep:l,edgesep:u,ranksep:c}),cm(t),sm(t),((t,e)=>{e.forEach((e=>{let n=t.getNode(e);const{data:i}=n,r=i.originalEdge;let a;r&&t.addEdge(r);let o=e;for(;n.data.dummy;)a=t.getSuccessors(o)[0],t.removeNode(o),r.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===uy&&(r.data.x=n.data.x,r.data.y=n.data.y,r.data.width=n.data.width,r.data.height=n.data.height),o=a.id,n=t.getNode(o)}))})(t,f),am(t),((t,e)=>{const n=e.toLowerCase();"bt"!==n&&"rl"!==n||(t=>{t.getAllNodes().forEach((t=>{oy(t.data)})),t.getAllEdges().forEach((t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach((t=>oy(t))),t.data.hasOwnProperty("y")&&oy(t.data)}))})(t),"lr"!==n&&"rl"!==n||((t=>{t.getAllNodes().forEach((t=>{sy(t.data)})),t.getAllEdges().forEach((t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach((t=>sy(t))),t.data.hasOwnProperty("x")&&sy(t.data)}))})(t),ry(t))})(t,r);const{width:p,height:g}=im(t);return rm(t),om(t),(t=>{t.getAllEdges().forEach((e=>{const n=e.data;if(n.reversed){t.removeEdge(e.id);const i=n.forwardName;delete n.reversed,delete n.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign(Object.assign({},n),{forwardName:i})})}}))})(t),{width:p,height:g}},qy=["width","height","layer","fixorder"],Ky={width:0,height:0},Zy=["minlen","weight","width","height","labeloffset"],Qy={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Jy=["labelpos"],tm=t=>{t.getAllEdges().forEach((e=>{if(e.data.width&&e.data.height){const n=t.getNode(e.source),i={e,rank:(t.getNode(e.target).data.rank-n.data.rank)/2+n.data.rank};Xv(t,"edge-proxy",i,"_ep")}}))},em=t=>{let e=0;return t.getAllNodes().forEach((n=>{var i,r;n.data.borderTop&&(n.data.minRank=null===(i=t.getNode(n.data.borderTop))||void 0===i?void 0:i.data.rank,n.data.maxRank=null===(r=t.getNode(n.data.borderBottom))||void 0===r?void 0:r.data.rank,e=Math.max(e,n.data.maxRank||-1/0))})),e},nm=t=>{t.getAllNodes().forEach((e=>{"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},im=(t,e)=>{let n,i,r=0,a=0;const{marginx:o=0,marginy:s=0}=e||{},l=t=>{if(!t.data)return;const e=t.data.x,o=t.data.y,s=t.data.width,l=t.data.height;isNaN(e)||isNaN(s)||(void 0===n&&(n=e-s/2),n=Math.min(n,e-s/2),r=Math.max(r,e+s/2)),isNaN(o)||isNaN(l)||(void 0===i&&(i=o-l/2),i=Math.min(i,o-l/2),a=Math.max(a,o+l/2))};return t.getAllNodes().forEach((t=>{l(t)})),t.getAllEdges().forEach((t=>{(null==t?void 0:t.data.hasOwnProperty("x"))&&l(t)})),n-=o,i-=s,t.getAllNodes().forEach((t=>{t.data.x-=n,t.data.y-=i})),t.getAllEdges().forEach((t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach((t=>{t.x-=n,t.y-=i})),t.data.hasOwnProperty("x")&&(t.data.x-=n),t.data.hasOwnProperty("y")&&(t.data.y-=i)})),{width:r-n+o,height:a-i+s}},rm=t=>{t.getAllEdges().forEach((e=>{const n=t.getNode(e.source),i=t.getNode(e.target);let r,a;e.data.points?(r=e.data.points[0],a=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},a={x:n.data.x,y:n.data.y}),e.data.points.unshift(Kv(n.data,r)),e.data.points.push(Kv(i.data,a))}))},am=t=>{t.getAllEdges().forEach((t=>{if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},om=t=>{t.getAllEdges().forEach((t=>{var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},sm=t=>{t.getAllNodes().forEach((e=>{var n,i,r;if(null===(n=t.getChildren(e.id))||void 0===n?void 0:n.length){const n=t.getNode(e.id),a=t.getNode(n.data.borderTop),o=t.getNode(n.data.borderBottom),s=t.getNode(n.data.borderLeft[(null===(i=n.data.borderLeft)||void 0===i?void 0:i.length)-1]),l=t.getNode(n.data.borderRight[(null===(r=n.data.borderRight)||void 0===r?void 0:r.length)-1]);n.data.width=Math.abs((null==l?void 0:l.data.x)-(null==s?void 0:s.data.x))||10,n.data.height=Math.abs((null==o?void 0:o.data.y)-(null==a?void 0:a.data.y))||10,n.data.x=((null==s?void 0:s.data.x)||0)+n.data.width/2,n.data.y=((null==a?void 0:a.data.y)||0)+n.data.height/2}})),t.getAllNodes().forEach((e=>{"border"===e.data.dummy&&t.removeNode(e.id)}))},lm=t=>{t.getAllEdges().forEach((e=>{if(e.source===e.target){const n=t.getNode(e.source);n.data.selfEdges||(n.data.selfEdges=[]),n.data.selfEdges.push(e),t.removeEdge(e.id)}}))},um=t=>{const e=Zv(t);null==e||e.forEach((e=>{let n=0;null==e||e.forEach(((e,i)=>{var r;const a=t.getNode(e);a.data.order=i+n,null===(r=a.data.selfEdges)||void 0===r||r.forEach((e=>{Xv(t,"selfedge",{width:e.data.width,height:e.data.height,rank:a.data.rank,order:i+ ++n,e},"_se")})),delete a.data.selfEdges}))}))},cm=t=>{t.getAllNodes().forEach((e=>{const n=t.getNode(e.id);if("selfedge"===n.data.dummy){const i=t.getNode(n.data.e.source),r=i.data.x+i.data.width/2,a=i.data.y,o=n.data.x-r,s=i.data.height/2;t.hasEdge(n.data.e.id)?t.updateEdgeData(n.data.e.id,n.data.e.data):t.addEdge({id:n.data.e.id,source:n.data.e.source,target:n.data.e.target,data:n.data.e.data}),t.removeNode(e.id),n.data.e.data.points=[{x:r+2*o/3,y:a-s},{x:r+5*o/6,y:a-s},{y:a,x:r+o},{x:r+5*o/6,y:a+s},{x:r+2*o/3,y:a+s}],n.data.e.data.x=n.data.x,n.data.e.data.y=n.data.y}}))},hm=(t,e)=>{const n={};return null==e||e.forEach((e=>{void 0!==t[e]&&(n[e]=+t[e])})),n},dm=(t={})=>{const e={};return Object.keys(t).forEach((n=>{e[n.toLowerCase()]=t[n]})),e};function fm(t){if(!t)return[0,0,0];if(le(t))return[t,t,t];if(0===t.length)return[0,0,0];const[e,n=e,i=e]=t;return[e,n,i]}function pm(t,e){let n;return n=gn(e)?e:le(e)?()=>e:()=>t,n}function gm(t,e,n=!0){return e||0===e?gn(e)?e:le(e)?()=>e:Array.isArray(e)?()=>n?Math.max(...e)||t:e:vn(e)&&e.width&&e.height?()=>n?Math.max(e.width,e.height)||t:[e.width,e.height]:()=>t:e=>{const{size:i}=e.data||{};return i?Array.isArray(i)?n?Math.max(...i)||t:i:vn(i)&&i.width&&i.height?n?Math.max(i.width,i.height)||t:[i.width,i.height]:i:t}}const vm=(t,e,n=10)=>{let i;const r="function"==typeof e?e:()=>e||0;return i=t?Array.isArray(t)?e=>t:gn(t)?t:e=>t:t=>{var e,i,r;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return null===(i=t.data)||void 0===i?void 0:i.bboxSize;if(null===(r=t.data)||void 0===r?void 0:r.size){const e=t.data.size;return Array.isArray(e)?e:vn(e)?[e.width,e.height]:e}return n},t=>{const e=i(t),n=r(t);return Math.max(...fm(e))+n}},ym=t=>{if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){const e=[];return t.forEach((t=>{e.push(t)})),e.map((t=>ym(t)))}if("object"==typeof t){const e={};return Object.keys(t).forEach((n=>{e[n]=ym(t[n])})),e}return t},mm=(t,e)=>{const n=ym(t);return n.data=n.data||{},e&&(le(n.data.x)||(n.data.x=Math.random()*e[0]),le(n.data.y)||(n.data.y=Math.random()*e[1])),n},bm={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null},xm=(t,e,n)=>{const i=t.getAllNodes(),r=t.getAllEdges();return(null==i?void 0:i.length)?1===i.length?(e&&t.mergeNodeData(i[0].id,{x:n[0],y:n[1]}),{nodes:[Object.assign(Object.assign({},i[0]),{data:Object.assign(Object.assign({},i[0].data),{x:n[0],y:n[1]})})],edges:r}):void 0:{nodes:[],edges:r}},Em={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},wm=(t,e,n=!1)=>{const i=[mm(e[0])],r={},a=e.length;r[e[0].id]=!0;let o=0;return e.forEach(((s,l)=>{if(0!==l)if(l!==a-1&&t.getDegree(s.id,"both")===t.getDegree(e[l+1].id,"both")&&!t.areNeighbors(i[o].id,s.id)||r[s.id]){const l=n?t.getSuccessors(i[o].id):t.getNeighbors(i[o].id);let u=!1;for(let e=0;e<l.length;e++){const n=l[e];if(t.getDegree(n.id)===t.getDegree(s.id)&&!r[n.id]){i.push(mm(n)),r[n.id]=!0,u=!0;break}}let c=0;for(;!u&&(r[e[c].id]||(i.push(mm(e[c])),r[e[c].id]=!0,u=!0),c++,c!==a););}else i.push(mm(s)),r[s.id]=!0,o++})),i},km=Array.isArray,Mm={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class Sm{constructor(t={}){this.options=t,this.id="concentric",this.options=Object.assign(Object.assign({},Mm),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericConcentricLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericConcentricLayout(!0,t,e)}))}genericConcentricLayout(t,e,n){return ye(this,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},this.options),n),{center:r,width:a,height:o,sortBy:s,maxLevelDiff:l,sweep:u,clockwise:c,equidistant:h,preventOverlap:d,startAngle:f=1.5*Math.PI,nodeSize:p,nodeSpacing:g}=i,v=e.getAllNodes(),y=e.getAllEdges(),m=a||"undefined"==typeof window?a:window.innerWidth,b=o||"undefined"==typeof window?o:window.innerHeight,x=r||[m/2,b/2];if(!(null==v?void 0:v.length)||1===v.length)return xm(e,t,x);const E=[];let w,k=0;km(p)?w=Math.max(p[0],p[1]):gn(p)?(w=-1/0,v.forEach((t=>{const e=Math.max(...fm(p(t)));e>w&&(w=e)}))):w=p,km(g)?k=Math.max(g[0],g[1]):le(g)&&(k=g),v.forEach((t=>{const e=mm(t);E.push(e);let n=w;const{data:i}=e;km(i.size)?n=Math.max(i.size[0],i.size[1]):le(i.size)?n=i.size:vn(i.size)&&(n=Math.max(i.size.width,i.size.height)),w=Math.max(w,n),gn(g)&&(k=Math.max(g(t),k))}));const M={};E.forEach(((t,e)=>{M[t.id]=e}));let S=s;he(S)&&void 0!==E[0].data[S]||(S="degree"),"degree"===S?E.sort(((t,n)=>e.getDegree(n.id,"both")-e.getDegree(t.id,"both"))):E.sort(((t,e)=>e.data[S]-t.data[S]));const N=E[0],T=(l||("degree"===S?e.getDegree(N.id,"both"):N.data[S]))/4,A=[{nodes:[]}];let O=A[0];E.forEach((t=>{if(O.nodes.length>0){const n="degree"===S?Math.abs(e.getDegree(O.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(O.nodes[0].data[S]-t.data[S]);T&&n>=T&&(O={nodes:[]},A.push(O))}O.nodes.push(t)}));let P=w+k;if(!d){const t=A.length>0&&A[0].nodes.length>1,e=(Math.min(m,b)/2-P)/(A.length+(t?1:0));P=Math.min(P,e)}let C=0;if(A.forEach((t=>{const e=void 0===u?2*Math.PI-2*Math.PI/t.nodes.length:u;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&d){const e=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),i=Math.sqrt(P*P/(e*e+n*n));C=Math.max(i,C)}t.r=C,C+=P})),h){let t=0,e=0;for(let n=0;n<A.length;n++){const i=(A[n].r||0)-e;t=Math.max(t,i)}e=0,A.forEach(((n,i)=>{0===i&&(e=n.r||0),n.r=e,e+=t}))}return A.forEach((t=>{const e=t.dTheta||0,n=t.r||0;t.nodes.forEach(((t,i)=>{const r=f+(c?1:-1)*e*i;t.data.x=x[0]+n*Math.cos(r),t.data.y=x[1]+n*Math.sin(r)}))})),t&&E.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y}))),{nodes:E,edges:y}}))}}function Nm(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,a,o,s,l,u,c,h,d,f=t._root,p={data:i},g=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((u=e>=(a=(g+y)/2))?g=a:y=a,(c=n>=(o=(v+m)/2))?v=o:m=o,r=f,!(f=f[h=c<<1|u]))return r[h]=p,t;if(s=+t._x.call(null,f.data),l=+t._y.call(null,f.data),e===s&&n===l)return p.next=f,r?r[h]=p:t._root=p,t;do{r=r?r[h]=new Array(4):t._root=new Array(4),(u=e>=(a=(g+y)/2))?g=a:y=a,(c=n>=(o=(v+m)/2))?v=o:m=o}while((h=c<<1|u)==(d=(l>=o)<<1|s>=a));return r[d]=f,r[h]=p,t}function Tm(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function Am(t){return t[0]}function Om(t){return t[1]}function Pm(t,e,n){var i=new Cm(null==e?Am:e,null==n?Om:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function Cm(t,e,n,i,r,a){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=a,this._root=void 0}function Rm(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Lm=Pm.prototype=Cm.prototype;function Dm(t,e,n,i,r){if(isNaN(e)||isNaN(n)||isNaN(i))return t;var a,o,s,l,u,c,h,d,f,p,g,v,y=t._root,m={data:r},b=t._x0,x=t._y0,E=t._z0,w=t._x1,k=t._y1,M=t._z1;if(!y)return t._root=m,t;for(;y.length;)if((d=e>=(o=(b+w)/2))?b=o:w=o,(f=n>=(s=(x+k)/2))?x=s:k=s,(p=i>=(l=(E+M)/2))?E=l:M=l,a=y,!(y=y[g=p<<2|f<<1|d]))return a[g]=m,t;if(u=+t._x.call(null,y.data),c=+t._y.call(null,y.data),h=+t._z.call(null,y.data),e===u&&n===c&&i===h)return m.next=y,a?a[g]=m:t._root=m,t;do{a=a?a[g]=new Array(8):t._root=new Array(8),(d=e>=(o=(b+w)/2))?b=o:w=o,(f=n>=(s=(x+k)/2))?x=s:k=s,(p=i>=(l=(E+M)/2))?E=l:M=l}while((g=p<<2|f<<1|d)==(v=(h>=l)<<2|(c>=s)<<1|u>=o));return a[v]=y,a[g]=m,t}function Im(t,e,n,i,r,a,o){this.node=t,this.x0=e,this.y0=n,this.z0=i,this.x1=r,this.y1=a,this.z1=o}Lm.copy=function(){var t,e,n=new Cm(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=Rm(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=Rm(e));return n},Lm.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Nm(this.cover(e,n),e,n,t)},Lm.addAll=function(t){var e,n,i,r,a=t.length,o=new Array(a),s=new Array(a),l=1/0,u=1/0,c=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(o[n]=i,s[n]=r,i<l&&(l=i),i>c&&(c=i),r<u&&(u=r),r>h&&(h=r));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),n=0;n<a;++n)Nm(this,o[n],s[n],t[n]);return this},Lm.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,a=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,a=(i=Math.floor(e))+1;else{for(var o,s,l=r-n||1,u=this._root;n>t||t>=r||i>e||e>=a;)switch(s=(e<i)<<1|t<n,(o=new Array(4))[s]=u,u=o,l*=2,s){case 0:r=n+l,a=i+l;break;case 1:n=r-l,a=i+l;break;case 2:r=n+l,i=a-l;break;case 3:n=r-l,i=a-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=i,this._x1=r,this._y1=a,this},Lm.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Lm.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Lm.find=function(t,e,n){var i,r,a,o,s,l,u,c=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],g=this._root;for(g&&p.push(new Tm(g,c,h,d,f)),null==n?n=1/0:(c=t-n,h=e-n,d=t+n,f=e+n,n*=n);l=p.pop();)if(!(!(g=l.node)||(r=l.x0)>d||(a=l.y0)>f||(o=l.x1)<c||(s=l.y1)<h))if(g.length){var v=(r+o)/2,y=(a+s)/2;p.push(new Tm(g[3],v,y,o,s),new Tm(g[2],r,y,v,s),new Tm(g[1],v,a,o,y),new Tm(g[0],r,a,v,y)),(u=(e>=y)<<1|t>=v)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var m=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),x=m*m+b*b;if(x<n){var E=Math.sqrt(n=x);c=t-E,h=e-E,d=t+E,f=e+E,i=g.data}}return i},Lm.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,i,r,a,o,s,l,u,c,h,d,f=this._root,p=this._x0,g=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((u=a>=(s=(p+v)/2))?p=s:v=s,(c=o>=(l=(g+y)/2))?g=l:y=l,e=f,!(f=f[h=c<<1|u]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(i=f,!(f=f.next))return this;return(r=f.next)&&delete f.next,i?(r?i.next=r:delete i.next,this):e?(r?e[h]=r:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=r,this)},Lm.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Lm.root=function(){return this._root},Lm.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Lm.visit=function(t){var e,n,i,r,a,o,s=[],l=this._root;for(l&&s.push(new Tm(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,i=e.x0,r=e.y0,a=e.x1,o=e.y1)&&l.length){var u=(i+a)/2,c=(r+o)/2;(n=l[3])&&s.push(new Tm(n,u,c,a,o)),(n=l[2])&&s.push(new Tm(n,i,c,u,o)),(n=l[1])&&s.push(new Tm(n,u,r,a,c)),(n=l[0])&&s.push(new Tm(n,i,r,u,c))}return this},Lm.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new Tm(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var a,o=e.x0,s=e.y0,l=e.x1,u=e.y1,c=(o+l)/2,h=(s+u)/2;(a=r[0])&&n.push(new Tm(a,o,s,c,h)),(a=r[1])&&n.push(new Tm(a,c,s,l,h)),(a=r[2])&&n.push(new Tm(a,o,h,c,u)),(a=r[3])&&n.push(new Tm(a,c,h,l,u))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Lm.x=function(t){return arguments.length?(this._x=t,this):this._x},Lm.y=function(t){return arguments.length?(this._y=t,this):this._y};const _m=(t,e,n,i,r,a)=>Math.sqrt((t-i)**2+(e-r)**2+(n-a)**2);function Bm(t){return t[0]}function Fm(t){return t[1]}function jm(t){return t[2]}function Gm(t,e,n,i){var r=new zm(null==e?Bm:e,null==n?Fm:n,null==i?jm:i,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function zm(t,e,n,i,r,a,o,s,l){this._x=t,this._y=e,this._z=n,this._x0=i,this._y0=r,this._z0=a,this._x1=o,this._y1=s,this._z1=l,this._root=void 0}function Vm(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Wm=Gm.prototype=zm.prototype;function Um(t){let e=0,n=0,i=0,r=0,a=0;const o=t.length;if(o){for(let s=0;s<o;s++){const o=t[s];o&&o.weight&&(e+=o.weight,n+=o.x*o.weight,i+=o.y*o.weight,r+=o.z*o.weight,a+=o.size*o.weight)}t.x=n/e,t.y=i/e,t.z=r/e,t.size=a/e,t.weight=e}else{const e=t;t.x=e.data.x,t.y=e.data.y,t.z=e.data.z,t.size=e.data.size,t.weight=e.data.weight}}Wm.copy=function(){var t,e,n=new zm(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),i=this._root;if(!i)return n;if(!i.length)return n._root=Vm(i),n;for(t=[{source:i,target:n._root=new Array(8)}];i=t.pop();)for(var r=0;r<8;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(8)}):i.target[r]=Vm(e));return n},Wm.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t),i=+this._z.call(null,t);return Dm(this.cover(e,n,i),e,n,i,t)},Wm.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,n=new Float64Array(e),i=new Float64Array(e),r=new Float64Array(e);let a=1/0,o=1/0,s=1/0,l=-1/0,u=-1/0,c=-1/0;for(let h,d,f,p,g=0;g<e;++g)isNaN(d=+this._x.call(null,h=t[g]))||isNaN(f=+this._y.call(null,h))||isNaN(p=+this._z.call(null,h))||(n[g]=d,i[g]=f,r[g]=p,d<a&&(a=d),d>l&&(l=d),f<o&&(o=f),f>u&&(u=f),p<s&&(s=p),p>c&&(c=p));if(a>l||o>u||s>c)return this;this.cover(a,o,s).cover(l,u,c);for(let a=0;a<e;++a)Dm(this,n[a],i[a],r[a],t[a]);return this},Wm.cover=function(t,e,n){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(n=+n))return this;var i=this._x0,r=this._y0,a=this._z0,o=this._x1,s=this._y1,l=this._z1;if(isNaN(i))o=(i=Math.floor(t))+1,s=(r=Math.floor(e))+1,l=(a=Math.floor(n))+1;else{for(var u,c,h=o-i||1,d=this._root;i>t||t>=o||r>e||e>=s||a>n||n>=l;)switch(c=(n<a)<<2|(e<r)<<1|t<i,(u=new Array(8))[c]=d,d=u,h*=2,c){case 0:o=i+h,s=r+h,l=a+h;break;case 1:i=o-h,s=r+h,l=a+h;break;case 2:o=i+h,r=s-h,l=a+h;break;case 3:i=o-h,r=s-h,l=a+h;break;case 4:o=i+h,s=r+h,a=l-h;break;case 5:i=o-h,s=r+h,a=l-h;break;case 6:o=i+h,r=s-h,a=l-h;break;case 7:i=o-h,r=s-h,a=l-h}this._root&&this._root.length&&(this._root=d)}return this._x0=i,this._y0=r,this._z0=a,this._x1=o,this._y1=s,this._z1=l,this},Wm.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Wm.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Wm.find=function(t,e,n,i){var r,a,o,s,l,u,c,h,d,f=this._x0,p=this._y0,g=this._z0,v=this._x1,y=this._y1,m=this._z1,b=[],x=this._root;for(x&&b.push(new Im(x,f,p,g,v,y,m)),null==i?i=1/0:(f=t-i,p=e-i,g=n-i,v=t+i,y=e+i,m=n+i,i*=i);h=b.pop();)if(!(!(x=h.node)||(a=h.x0)>v||(o=h.y0)>y||(s=h.z0)>m||(l=h.x1)<f||(u=h.y1)<p||(c=h.z1)<g))if(x.length){var E=(a+l)/2,w=(o+u)/2,k=(s+c)/2;b.push(new Im(x[7],E,w,k,l,u,c),new Im(x[6],a,w,k,E,u,c),new Im(x[5],E,o,k,l,w,c),new Im(x[4],a,o,k,E,w,c),new Im(x[3],E,w,s,l,u,k),new Im(x[2],a,w,s,E,u,k),new Im(x[1],E,o,s,l,w,k),new Im(x[0],a,o,s,E,w,k)),(d=(n>=k)<<2|(e>=w)<<1|t>=E)&&(h=b[b.length-1],b[b.length-1]=b[b.length-1-d],b[b.length-1-d]=h)}else{var M=t-+this._x.call(null,x.data),S=e-+this._y.call(null,x.data),N=n-+this._z.call(null,x.data),T=M*M+S*S+N*N;if(T<i){var A=Math.sqrt(i=T);f=t-A,p=e-A,g=n-A,v=t+A,y=e+A,m=n+A,r=x.data}}return r},Wm.findAllWithinRadius=function(t,e,n,i){const r=[],a=t-i,o=e-i,s=n-i,l=t+i,u=e+i,c=n+i;return this.visit(((h,d,f,p,g,v,y)=>{if(!h.length)do{const a=h.data;_m(t,e,n,this._x(a),this._y(a),this._z(a))<=i&&r.push(a)}while(h=h.next);return d>l||f>u||p>c||g<a||v<o||y<s})),r},Wm.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,n,i,r,a,o,s,l,u,c,h,d,f,p,g,v=this._root,y=this._x0,m=this._y0,b=this._z0,x=this._x1,E=this._y1,w=this._z1;if(!v)return this;if(v.length)for(;;){if((h=a>=(l=(y+x)/2))?y=l:x=l,(d=o>=(u=(m+E)/2))?m=u:E=u,(f=s>=(c=(b+w)/2))?b=c:w=c,e=v,!(v=v[p=f<<2|d<<1|h]))return this;if(!v.length)break;(e[p+1&7]||e[p+2&7]||e[p+3&7]||e[p+4&7]||e[p+5&7]||e[p+6&7]||e[p+7&7])&&(n=e,g=p)}for(;v.data!==t;)if(i=v,!(v=v.next))return this;return(r=v.next)&&delete v.next,i?(r?i.next=r:delete i.next,this):e?(r?e[p]=r:delete e[p],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(n?n[g]=v:this._root=v),this):(this._root=r,this)},Wm.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Wm.root=function(){return this._root},Wm.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Wm.visit=function(t){var e,n,i,r,a,o,s,l,u=[],c=this._root;for(c&&u.push(new Im(c,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=u.pop();)if(!t(c=e.node,i=e.x0,r=e.y0,a=e.z0,o=e.x1,s=e.y1,l=e.z1)&&c.length){var h=(i+o)/2,d=(r+s)/2,f=(a+l)/2;(n=c[7])&&u.push(new Im(n,h,d,f,o,s,l)),(n=c[6])&&u.push(new Im(n,i,d,f,h,s,l)),(n=c[5])&&u.push(new Im(n,h,r,f,o,d,l)),(n=c[4])&&u.push(new Im(n,i,r,f,h,d,l)),(n=c[3])&&u.push(new Im(n,h,d,a,o,s,f)),(n=c[2])&&u.push(new Im(n,i,d,a,h,s,f)),(n=c[1])&&u.push(new Im(n,h,r,a,o,d,f)),(n=c[0])&&u.push(new Im(n,i,r,a,h,d,f))}return this},Wm.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new Im(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=n.pop();){var r=e.node;if(r.length){var a,o=e.x0,s=e.y0,l=e.z0,u=e.x1,c=e.y1,h=e.z1,d=(o+u)/2,f=(s+c)/2,p=(l+h)/2;(a=r[0])&&n.push(new Im(a,o,s,l,d,f,p)),(a=r[1])&&n.push(new Im(a,d,s,l,u,f,p)),(a=r[2])&&n.push(new Im(a,o,f,l,d,c,p)),(a=r[3])&&n.push(new Im(a,d,f,l,u,c,p)),(a=r[4])&&n.push(new Im(a,o,s,p,d,f,h)),(a=r[5])&&n.push(new Im(a,d,s,p,u,f,h)),(a=r[6])&&n.push(new Im(a,o,f,p,d,c,h)),(a=r[7])&&n.push(new Im(a,d,f,p,u,c,h))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},Wm.x=function(t){return arguments.length?(this._x=t,this):this._x},Wm.y=function(t){return arguments.length?(this._y=t,this):this._y},Wm.z=function(t){return arguments.length?(this._z=t,this):this._z};const Hm=(t,e,n,i,r,a,o)=>{var s;if((null===(s=t.data)||void 0===s?void 0:s.id)===a.id)return;const l=[n,i,r][o-1],u=a.x-t.x||.1,c=a.y-t.y||.1,h=a.z-t.z||.1,d=[u,c,h],f=l-e;let p=0;for(let t=0;t<o;t++)p+=d[t]*d[t];const g=Math.sqrt(p)*p;if(f*f*.81<p){const e=t.weight/g;return a.vx+=u*e,a.vy+=c*e,a.vz+=h*e,!0}if(t.length)return!1;if(t.data!==a){const e=t.data.weight/g;a.vx+=u*e,a.vy+=c*e,a.vz+=h*e}},Ym={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class $m{constructor(t={}){this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},Ym),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericForceLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericForceLayout(!0,t,e)}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let e=0;(this.judgingDistance>this.lastOptions.minMovement||e<1)&&e<t;e++)this.runOneStep(this.lastCalcGraph,this.lastGraph,e,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach((t=>this.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===this.options.dimensions?t.data.z:void 0}))),e}genericForceLayout(t,e,n){return ye(this,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},this.options),n),r=e.getAllNodes(),a=e.getAllEdges(),o=this.formatOptions(i,e),{dimensions:s,width:l,height:u,nodeSize:c,getMass:h,nodeStrength:d,edgeStrength:f,linkDistance:p}=o,g=r.map(((t,e)=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{x:le(t.data.x)?t.data.x:Math.random()*l,y:le(t.data.y)?t.data.y:Math.random()*u,z:le(t.data.z)?t.data.z:Math.random()*Math.sqrt(l*u),size:c(t)||30,mass:h(t),nodeStrength:d(t)})}))),v=a.map((t=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{edgeStrength:f(t),linkDistance:p(t,e.getNode(t.source),e.getNode(t.target))})})));if(!(null==r?void 0:r.length))return this.lastResult={nodes:[],edges:a},{nodes:[],edges:a};const y={};r.forEach(((t,e)=>{y[t.id]={x:0,y:0,z:0}}));const m=new Mv({nodes:g,edges:v});this.formatCentripetal(o,m);const{maxIteration:b,minMovement:x,onTick:E}=o;if(this.lastLayoutNodes=g,this.lastLayoutEdges=v,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=m,this.lastOptions=o,this.lastVelMap=y,"undefined"==typeof window)return;let w=0;return new Promise((n=>{this.timeInterval=window.setInterval((()=>{r&&this.running||n({nodes:Qm(e,g),edges:a}),this.runOneStep(m,e,w,y,o),this.updatePosition(e,m,y,o),t&&g.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===s?t.data.z:void 0}))),null==E||E({nodes:Qm(e,g),edges:a}),w++,(w>=b||this.judgingDistance<x)&&(window.clearInterval(this.timeInterval),n({nodes:Qm(e,g),edges:a}))}),0),this.running=!0}))}))}formatOptions(t,e){const n=Object.assign({},t),{width:i,height:r,getMass:a}=t;n.width=i||"undefined"==typeof window?i:window.innerWidth,n.height=r||"undefined"==typeof window?r:window.innerHeight,t.center||(n.center=[n.width/2,n.height/2]),a||(n.getMass=t=>{let n=1;le(null==t?void 0:t.data.mass)&&(n=null==t?void 0:t.data.mass);const i=e.getDegree(t.id,"both");return!i||i<5?n:5*i*n}),n.nodeSize=vm(t.nodeSize,t.nodeSpacing);const o=t.linkDistance?pm(1,t.linkDistance):t=>1+n.nodeSize(e.getNode(t.source))+n.nodeSize(e.getNode(t.target));return n.linkDistance=o,n.nodeStrength=pm(1,t.nodeStrength),n.edgeStrength=pm(1,t.edgeStrength),n}formatCentripetal(t,e){const{dimensions:n,centripetalOptions:i,center:r,clusterNodeStrength:a,leafCluster:o,clustering:s,nodeClusterBy:l}=t,u=e.getAllNodes(),c=i||{leaf:2,single:2,others:1,center:t=>({x:r[0],y:r[1],z:3===n?r[2]:void 0})};let h,d;if("function"!=typeof a&&(t.clusterNodeStrength=t=>a),o&&l&&(h=Xm(e,l),d=Array.from(new Set(null==u?void 0:u.map((t=>t.data[l]))))||[],t.centripetalOptions=Object.assign(c,{single:100,leaf:e=>{const{siblingLeaves:n,sameTypeLeaves:i}=h[e.id]||{};return(null==i?void 0:i.length)===(null==n?void 0:n.length)||1===(null==d?void 0:d.length)?1:t.clusterNodeStrength(e)},others:1,center:t=>{const n=e.getDegree(t.id,"both");if(!n)return{x:100,y:100,z:0};let i;if(1===n){const{sameTypeLeaves:e=[]}=h[t.id]||{};1===e.length?i=void 0:e.length>1&&(i=Zm(e))}else i=void 0;return{x:null==i?void 0:i.x,y:null==i?void 0:i.y,z:null==i?void 0:i.z}}})),s&&l){h||(h=Xm(e,l)),d||(d=Array.from(new Set(u.map((t=>t.data[l]))))),d=d.filter((t=>void 0!==t));const n={};d.forEach((t=>{const i=u.filter((e=>e.data[l]===t)).map((t=>e.getNode(t.id)));n[t]=Zm(i)})),t.centripetalOptions=Object.assign(c,{single:e=>t.clusterNodeStrength(e),leaf:e=>t.clusterNodeStrength(e),others:e=>t.clusterNodeStrength(e),center:t=>{const e=n[t.data[l]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y,z:null==e?void 0:e.z}}})}const{leaf:f,single:p,others:g}=t.centripetalOptions||{};f&&"function"!=typeof f&&(t.centripetalOptions.leaf=()=>f),p&&"function"!=typeof p&&(t.centripetalOptions.single=()=>p),g&&"function"!=typeof g&&(t.centripetalOptions.others=()=>g)}runOneStep(t,e,n,i,r){const a={},o=t.getAllNodes(),s=t.getAllEdges();if(!(null==o?void 0:o.length))return;const{monitor:l}=r;this.calRepulsive(t,a,r),s&&this.calAttractive(t,a,r),this.calGravity(t,e,a,r),this.updateVelocity(t,a,i,r),l&&l({energy:this.calTotalEnergy(a,o),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:n})}calTotalEnergy(t,e){if(!(null==e?void 0:e.length))return 0;let n=0;return e.forEach(((e,i)=>{const r=t[e.id].x,a=t[e.id].y,o=3===this.options.dimensions?t[e.id].z:0,s=r*r+a*a+o*o,{mass:l=1}=e.data;n+=l*s*.5})),n}calRepulsive(t,e,n){const{dimensions:i,factor:r,coulombDisScale:a}=n;!function(t,e,n,i,r=2){const a=e/n,o=t.getAllNodes(),s=o.map(((t,e)=>{const{nodeStrength:n,x:i,y:r,z:o,size:s}=t.data;return{x:i,y:r,z:o,size:s,index:e,id:t.id,vx:0,vy:0,vz:0,weight:a*n}})),l=(2===r?Pm(s,(t=>t.x),(t=>t.y)):Gm(s,(t=>t.x),(t=>t.y),(t=>t.z))).visitAfter(Um),u=new Map;s.forEach((t=>{u.set(t.id,t),function(t,e,n){e.visit(((e,i,r,a,o)=>Hm(e,i,r,a,o,t,n)))}(t,l,r)})),s.map(((t,e)=>{const{id:n,data:r}=o[e],{mass:a=1}=r;i[n]={x:t.vx/a,y:t.vy/a,z:t.vz/a}}))}(t,r,a*a,e,i)}calAttractive(t,e,n){const{dimensions:i,nodeSize:r}=n;t.getAllEdges().forEach(((n,a)=>{const{source:o,target:s}=n,l=t.getNode(o),u=t.getNode(s);if(!l||!u)return;let c=u.data.x-l.data.x,h=u.data.y-l.data.y,d=3===i?u.data.z-l.data.z:0;c||h||(c=.01*Math.random(),h=.01*Math.random(),3!==i||d||(d=.01*Math.random()));const f=Math.sqrt(c*c+h*h+d*d);if(f<r(l)+r(u))return;const p=c/f,g=h/f,v=d/f,{linkDistance:y=200,edgeStrength:m=200}=n.data||{},b=(y-f)*m,x=1/(l.data.mass||1),E=1/(u.data.mass||1),w=p*b,k=g*b,M=v*b;e[o].x-=w*x,e[o].y-=k*x,e[o].z-=M*x,e[s].x+=w*E,e[s].y+=k*E,e[s].z+=M*E}))}calGravity(t,e,n,i){const{getCenter:r}=i,a=t.getAllNodes(),o=e.getAllNodes(),s=e.getAllEdges(),{width:l,height:u,center:c,gravity:h,centripetalOptions:d}=i;a&&a.forEach((i=>{const{id:a,data:f}=i,{mass:p,x:g,y:v,z:y}=f,m=e.getNode(a);let b=0,x=0,E=0,w=h;const k=t.getDegree(a,"in"),M=t.getDegree(a,"out"),S=t.getDegree(a,"both"),N=null==r?void 0:r(m,S);if(N){const[t,e,n]=N;b=g-t,x=v-e,w=n}else b=g-c[0],x=v-c[1],E=y-c[2];if(w&&(n[a].x-=w*b/p,n[a].y-=w*x/p,n[a].z-=w*E/p),d){const{leaf:t,single:e,others:i,center:r}=d,{x:c,y:h,z:f,centerStrength:b}=(null==r?void 0:r(m,o,s,l,u))||{x:0,y:0,z:0,centerStrength:0};if(!le(c)||!le(h))return;const x=(g-c)/p,E=(v-h)/p,w=(y-f)/p;if(b&&(n[a].x-=b*x,n[a].y-=b*E,n[a].z-=b*w),0===S){const t=e(m);if(!t)return;return n[a].x-=t*x,n[a].y-=t*E,void(n[a].z-=t*w)}if(0===k||0===M){const e=t(m,o,s);if(!e)return;return n[a].x-=e*x,n[a].y-=e*E,void(n[a].z-=e*w)}const N=i(m);if(!N)return;n[a].x-=N*x,n[a].y-=N*E,n[a].z-=N*w}}))}updateVelocity(t,e,n,i){const{damping:r,maxSpeed:a,interval:o,dimensions:s}=i,l=t.getAllNodes();(null==l?void 0:l.length)&&l.forEach((t=>{const{id:i}=t;let l=(n[i].x+e[i].x*o)*r||.01,u=(n[i].y+e[i].y*o)*r||.01,c=3===s?(n[i].z+e[i].z*o)*r||.01:0;const h=Math.sqrt(l*l+u*u+c*c);if(h>a){const t=a/h;l*=t,u*=t,c*=t}n[i]={x:l,y:u,z:c}}))}updatePosition(t,e,n,i){const{distanceThresholdMode:r,interval:a,dimensions:o}=i,s=e.getAllNodes();if(!(null==s?void 0:s.length))return void(this.judgingDistance=0);let l=0;"max"===r?this.judgingDistance=-1/0:"min"===r&&(this.judgingDistance=1/0),s.forEach((i=>{const{id:s}=i,u=t.getNode(s);if(le(u.data.fx)&&le(u.data.fy))return void e.mergeNodeData(s,{x:u.data.fx,y:u.data.fy,z:3===o?u.data.fz:void 0});const c=n[s].x*a,h=n[s].y*a,d=3===o?n[s].z*a:0;e.mergeNodeData(s,{x:i.data.x+c,y:i.data.y+h,z:i.data.z+d});const f=Math.sqrt(c*c+h*h+d*d);switch(r){case"max":this.judgingDistance<f&&(this.judgingDistance=f);break;case"min":this.judgingDistance>f&&(this.judgingDistance=f);break;default:l+=f}})),r&&"mean"!==r||(this.judgingDistance=l/s.length)}}const Xm=(t,e)=>{const n=t.getAllNodes();if(!(null==n?void 0:n.length))return{};const i={};return n.forEach(((n,r)=>{1===t.getDegree(n.id,"both")&&(i[n.id]=qm(t,"leaf",n,e))})),i},qm=(t,e,n,i)=>{const r=t.getDegree(n.id,"in"),a=t.getDegree(n.id,"out");let o=n,s=[];return 0===r?(o=t.getSuccessors(n.id)[0],s=t.getNeighbors(o.id)):0===a&&(o=t.getPredecessors(n.id)[0],s=t.getNeighbors(o.id)),s=s.filter((e=>0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out"))),{coreNode:o,siblingLeaves:s,sameTypeLeaves:Km(t,e,i,n,s)}},Km=(t,e,n,i,r)=>{const a=i.data[n]||"";let o=(null==r?void 0:r.filter((t=>t.data[n]===a)))||[];return"leaf"===e&&(o=o.filter((e=>0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")))),o},Zm=t=>{const e={x:0,y:0};t.forEach((t=>{const{x:n,y:i}=t.data;e.x+=n||0,e.y+=i||0}));const n=t.length||1;return{x:e.x/n,y:e.y/n}},Qm=(t,e)=>e.map((e=>{const{id:n,data:i}=e,r=t.getNode(n);return Object.assign(Object.assign({},r),{data:Object.assign(Object.assign({},r.data),{x:i.x,y:i.y,z:i.z})})}));var Jm=n(673);Jm.y3,Jm.jy,Jm.oN,Jm.Hc,Jm.cg,Jm.hj,Jm.LU,Jm.Tb;const tb=Jm.uq,eb=(Jm.Zm,Jm.Dq,Jm.__,Jm.q0,Jm.lh,Jm.pI,Jm.zC,Jm.zg,Jm.g6,Jm.OL,Jm.ks,Jm.QR,Jm.jp,Jm.mk,Jm.W2),nb=(Jm.l,Jm.KY,Jm.dv,Jm.BR,Jm.Wu,Jm.uq,Jm.uq,Jm.a4,Jm.DI,Jm.Jo,Jm.Zi,Jm.kH,Jm.LV,t=>{const e=[],n=t.length;for(let i=0;i<n;i+=1){e[i]=[];for(let r=0;r<n;r+=1)i===r?e[i][r]=0:0!==t[i][r]&&t[i][r]?e[i][r]=t[i][r]:e[i][r]=1/0}for(let t=0;t<n;t+=1)for(let i=0;i<n;i+=1)for(let r=0;r<n;r+=1)e[i][r]>e[i][t]+e[t][r]&&(e[i][r]=e[i][t]+e[t][r]);return e}),ib=(t,e)=>{const{nodes:n,edges:i}=t,r=[],a={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach(((t,e)=>{a[t.id]=e,r.push([])})),null==i||i.forEach((t=>{const{source:n,target:i}=t,o=a[n],s=a[i];void 0!==o&&void 0!==s&&(r[o][s]=1,e||(r[s][o]=1))})),r},rb=(t,e)=>Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),ab=(t,e,n,i="TB",r,a={})=>{if(!(null==e?void 0:e.length))return;const{stopBranchFn:o,stopAllFn:s}=a;for(let l=0;l<e.length;l++){const u=e[l];if(t.hasNode(u.id)&&!(null==o?void 0:o(u))){if(null==s?void 0:s(u))return;"TB"===i&&n(u),ab(t,t.getChildren(u.id,r),n,i,r,a),"TB"!==i&&n(u)}}},ob={center:[0,0],linkDistance:50};class sb{constructor(t={}){this.options=t,this.id="mds",this.options=Object.assign(Object.assign({},ob),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericMDSLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericMDSLayout(!0,t,e)}))}genericMDSLayout(t,e,n){return ye(this,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},this.options),n),{center:r=[0,0],linkDistance:a=50}=i,o=e.getAllNodes(),s=e.getAllEdges();if(!(null==o?void 0:o.length)||1===o.length)return xm(e,t,r);const l=ib({nodes:o,edges:s},!1),u=nb(l);lb(u);const c=((t,e)=>{const n=[];return t.forEach((t=>{const i=[];t.forEach((t=>{i.push(t*e)})),n.push(i)})),n})(u,a),h=ub(c),d=[];return h.forEach(((t,e)=>{const n=mm(o[e]);n.data.x=t[0]+r[0],n.data.y=t[1]+r[1],d.push(n)})),t&&d.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y}))),{nodes:d,edges:s}}))}}const lb=t=>{let e=-999999;t.forEach((t=>{t.forEach((t=>{t!==1/0&&e<t&&(e=t)}))})),t.forEach(((n,i)=>{n.forEach(((n,r)=>{n===1/0&&(t[i][r]=e)}))}))},ub=t=>{const e=tb.mul(tb.pow(t,2),-.5),n=e.mean("row"),i=e.mean("column"),r=e.mean();e.add(r).subRowVector(n).subColumnVector(i);const a=new eb(e),o=tb.sqrt(a.diagonalMatrix).diagonal();return a.leftSingularVectors.toJSON().map((t=>tb.mul([t],[o]).toJSON()[0].splice(0,2)))};function cb(t){return!!t.tick&&!!t.stop}const hb={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},db={center:[0,0],comboPadding:10,treeKey:"combo"};function fb(t,e,n,i){var r;return ye(this,void 0,void 0,(function*(){return cb(t)?(t.execute(e,n),t.stop(),t.tick(null!==(r=n.iterations)&&void 0!==r?r:300)):i?yield t.assign(e,n):yield t.execute(e,n)}))}function pb(t){return function(){return t}}function gb(t){return 1e-6*(t()-.5)}function vb(t){return t.index}function yb(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function mb(t){var e,n,i,r,a,o,s=vb,l=function(t){return 1/Math.min(r[t.source.index],r[t.target.index])},u=pb(30),c=1;function h(i){for(var r=0,s=t.length;r<c;++r)for(var l,u,h,d,f,p,g,v=0;v<s;++v)u=(l=t[v]).source,d=(h=l.target).x+h.vx-u.x-u.vx||gb(o),f=h.y+h.vy-u.y-u.vy||gb(o),d*=p=((p=Math.sqrt(d*d+f*f))-n[v])/p*i*e[v],f*=p,h.vx-=d*(g=a[v]),h.vy-=f*g,u.vx+=d*(g=1-g),u.vy+=f*g}function d(){if(i){var o,l,u=i.length,c=t.length,h=new Map(i.map(((t,e)=>[s(t,e,i),t])));for(o=0,r=new Array(u);o<c;++o)(l=t[o]).index=o,"object"!=typeof l.source&&(l.source=yb(h,l.source)),"object"!=typeof l.target&&(l.target=yb(h,l.target)),r[l.source.index]=(r[l.source.index]||0)+1,r[l.target.index]=(r[l.target.index]||0)+1;for(o=0,a=new Array(c);o<c;++o)l=t[o],a[o]=r[l.source.index]/(r[l.source.index]+r[l.target.index]);e=new Array(c),f(),n=new Array(c),p()}}function f(){if(i)for(var n=0,r=t.length;n<r;++n)e[n]=+l(t[n],n,t)}function p(){if(i)for(var e=0,r=t.length;e<r;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){i=t,o=e,d()},h.links=function(e){return arguments.length?(t=e,d(),h):t},h.id=function(t){return arguments.length?(s=t,h):s},h.iterations=function(t){return arguments.length?(c=+t,h):c},h.strength=function(t){return arguments.length?(l="function"==typeof t?t:pb(+t),f(),h):l},h.distance=function(t){return arguments.length?(u="function"==typeof t?t:pb(+t),p(),h):u},h}var bb={value:()=>{}};function xb(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Eb(i)}function Eb(t){this._=t}function wb(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function kb(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=bb,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Eb.prototype=xb.prototype={constructor:Eb,on:function(t,e){var n,i,r=this._,a=(i=r,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=a[o]).type)r[n]=kb(r[n],t.name,e);else if(null==e)for(n in r)r[n]=kb(r[n],t.name,null);return this}for(;++o<s;)if((n=(t=a[o]).type)&&(n=wb(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Eb(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),a=0;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(i=this._[t]).length;a<n;++a)i[a].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}};const Mb=xb;var Sb,Nb,Tb=0,Ab=0,Ob=0,Pb=0,Cb=0,Rb=0,Lb="object"==typeof performance&&performance.now?performance:Date,Db="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ib(){return Cb||(Db(_b),Cb=Lb.now()+Rb)}function _b(){Cb=0}function Bb(){this._call=this._time=this._next=null}function Fb(t,e,n){var i=new Bb;return i.restart(t,e,n),i}function jb(){Cb=(Pb=Lb.now())+Rb,Tb=Ab=0;try{!function(){Ib(),++Tb;for(var t,e=Sb;e;)(t=Cb-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Tb}()}finally{Tb=0,function(){for(var t,e,n=Sb,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Sb=e);Nb=t,zb(i)}(),Cb=0}}function Gb(){var t=Lb.now(),e=t-Pb;e>1e3&&(Rb-=e,Pb=t)}function zb(t){Tb||(Ab&&(Ab=clearTimeout(Ab)),t-Cb>24?(t<1/0&&(Ab=setTimeout(jb,t-Lb.now()-Rb)),Ob&&(Ob=clearInterval(Ob))):(Ob||(Pb=Lb.now(),Ob=setInterval(Gb,1e3)),Tb=1,Db(jb)))}Bb.prototype=Fb.prototype={constructor:Bb,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Ib():+n)+(null==e?0:+e),this._next||Nb===this||(Nb?Nb._next=this:Sb=this,Nb=this),this._call=t,this._time=n,zb()},stop:function(){this._call&&(this._call=null,this._time=1/0,zb())}};const Vb=4294967296;function Wb(t){return t.x}function Ub(t){return t.y}var Hb=Math.PI*(3-Math.sqrt(5));function Yb(){var t,e,n,i,r,a=pb(-30),o=1,s=1/0,l=.81;function u(n){var r,a=t.length,o=Pm(t,Wb,Ub).visitAfter(h);for(i=n,r=0;r<a;++r)e=t[r],o.visit(d)}function c(){if(t){var e,n,i=t.length;for(r=new Array(i),e=0;e<i;++e)n=t[e],r[n.index]=+a(n,e,t)}}function h(t){var e,n,i,a,o,s=0,l=0;if(t.length){for(i=a=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,l+=n,i+=n*e.x,a+=n*e.y);t.x=i/l,t.y=a/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=r[e.data.index]}while(e=e.next)}t.value=s}function d(t,a,u,c){if(!t.value)return!0;var h=t.x-e.x,d=t.y-e.y,f=c-a,p=h*h+d*d;if(f*f/l<p)return p<s&&(0===h&&(p+=(h=gb(n))*h),0===d&&(p+=(d=gb(n))*d),p<o&&(p=Math.sqrt(o*p)),e.vx+=h*t.value*i/p,e.vy+=d*t.value*i/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===h&&(p+=(h=gb(n))*h),0===d&&(p+=(d=gb(n))*d),p<o&&(p=Math.sqrt(o*p)));do{t.data!==e&&(f=r[t.data.index]*i/p,e.vx+=h*f,e.vy+=d*f)}while(t=t.next)}}return u.initialize=function(e,i){t=e,n=i,c()},u.strength=function(t){return arguments.length?(a="function"==typeof t?t:pb(+t),c(),u):a},u.distanceMin=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.distanceMax=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u.theta=function(t){return arguments.length?(l=t*t,u):Math.sqrt(l)},u}function $b(t,e){var n,i=1;function r(){var r,a,o=n.length,s=0,l=0;for(r=0;r<o;++r)s+=(a=n[r]).x,l+=a.y;for(s=(s/o-t)*i,l=(l/o-e)*i,r=0;r<o;++r)(a=n[r]).x-=s,a.y-=l}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r.strength=function(t){return arguments.length?(i=+t,r):i},r}function Xb(t){return t.x+t.vx}function qb(t){return t.y+t.vy}function Kb(t){var e,n,i,r=1,a=1;function o(){for(var t,o,l,u,c,h,d,f=e.length,p=0;p<a;++p)for(o=Pm(e,Xb,qb).visitAfter(s),t=0;t<f;++t)l=e[t],h=n[l.index],d=h*h,u=l.x+l.vx,c=l.y+l.vy,o.visit(g);function g(t,e,n,a,o){var s=t.data,f=t.r,p=h+f;if(!s)return e>u+p||a<u-p||n>c+p||o<c-p;if(s.index>l.index){var g=u-s.x-s.vx,v=c-s.y-s.vy,y=g*g+v*v;y<p*p&&(0===g&&(y+=(g=gb(i))*g),0===v&&(y+=(v=gb(i))*v),y=(p-(y=Math.sqrt(y)))/y*r,l.vx+=(g*=y)*(p=(f*=f)/(d+f)),l.vy+=(v*=y)*p,s.vx-=g*(p=1-p),s.vy-=v*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var i,r,a=e.length;for(n=new Array(a),i=0;i<a;++i)r=e[i],n[r.index]=+t(r,i,e)}}return"function"!=typeof t&&(t=pb(null==t?1:+t)),o.initialize=function(t,n){e=t,i=n,l()},o.iterations=function(t){return arguments.length?(a=+t,o):a},o.strength=function(t){return arguments.length?(r=+t,o):r},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:pb(+e),l(),o):t},o}function Zb(t,e,n){var i,r,a,o=pb(.1);function s(t){for(var o=0,s=i.length;o<s;++o){var l=i[o],u=l.x-e||1e-6,c=l.y-n||1e-6,h=Math.sqrt(u*u+c*c),d=(a[o]-h)*r[o]*t/h;l.vx+=u*d,l.vy+=c*d}}function l(){if(i){var e,n=i.length;for(r=new Array(n),a=new Array(n),e=0;e<n;++e)a[e]=+t(i[e],e,i),r[e]=isNaN(a[e])?0:+o(i[e],e,i)}}return"function"!=typeof t&&(t=pb(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){i=t,l()},s.strength=function(t){return arguments.length?(o="function"==typeof t?t:pb(+t),l(),s):o},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:pb(+e),l(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s}function Qb(t){var e,n,i,r=pb(.1);function a(t){for(var r,a=0,o=e.length;a<o;++a)(r=e[a]).vx+=(i[a]-r.x)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),i=new Array(o),a=0;a<o;++a)n[a]=isNaN(i[a]=+t(e[a],a,e))?0:+r(e[a],a,e)}}return"function"!=typeof t&&(t=pb(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(r="function"==typeof t?t:pb(+t),o(),a):r},a.x=function(e){return arguments.length?(t="function"==typeof e?e:pb(+e),o(),a):t},a}function Jb(t){var e,n,i,r=pb(.1);function a(t){for(var r,a=0,o=e.length;a<o;++a)(r=e[a]).vy+=(i[a]-r.y)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),i=new Array(o),a=0;a<o;++a)n[a]=isNaN(i[a]=+t(e[a],a,e))?0:+r(e[a],a,e)}}return"function"!=typeof t&&(t=pb(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(r="function"==typeof t?t:pb(+t),o(),a):r},a.y=function(e){return arguments.length?(t="function"==typeof e?e:pb(+e),o(),a):t},a}const tx=(t,e)=>e.reduce(((e,[n,i])=>e[n]&&void 0!==i?e[n].call(t,i):e),t);var ex=n(6246),nx=n.n(ex);class ix{constructor(t){this.id="dagre",this.options={},Object.assign(this.options,ix.defaultOptions,t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericDagreLayout(!1,t,Object.assign(Object.assign({},this.options),e))}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericDagreLayout(!0,t,Object.assign(Object.assign({},this.options),e))}))}genericDagreLayout(t,e,n){return ye(this,void 0,void 0,(function*(){const{nodeSize:i}=n,r=new ex.graphlib.Graph;r.setGraph(n),r.setDefaultEdgeLabel((()=>({}))),[...e.getAllNodes(),...e.getAllEdges()].some((({id:t})=>le(t)))&&console.error("Dagre layout only support string id, it will convert number to string."),e.getAllNodes().forEach((t=>{const{id:e}=t,n=Object.assign({},t.data);if(void 0!==i){const[e,r]=fm(gn(i)?i(t):i);Object.assign(n,{width:e,height:r})}r.setNode(e.toString(),n)})),e.getAllEdges().forEach((({id:t,source:e,target:n})=>{r.setEdge(e.toString(),n.toString(),{id:t})})),nx().layout(r);const a={nodes:[],edges:[]};return r.nodes().forEach((n=>{const i=r.node(n);a.nodes.push({id:n,data:i}),t&&e.mergeNodeData(n,i)})),r.edges().forEach((n=>{const i=r.edge(n),{id:o}=i,s=ve(i,["id"]),{v:l,w:u}=n;a.edges.push({id:o,source:l,target:u,data:s}),t&&e.mergeEdgeData(o,s)})),a}))}}ix.defaultOptions={};class rx{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){const e=this.rx-t.rx,n=this.ry-t.ry;return Math.hypot(e,n)}setPos(t,e){this.rx=t,this.ry=e}resetForce(){this.fx=0,this.fy=0}addForce(t){const e=t.rx-this.rx,n=t.ry-this.ry;let i=Math.hypot(e,n);i=i<1e-4?1e-4:i;const r=this.g*(this.degree+1)*(t.degree+1)/i;this.fx+=r*e/i,this.fy+=r*n/i}in(t){return t.contains(this.rx,this.ry)}add(t){const e=this.mass+t.mass,n=(this.rx*this.mass+t.rx*t.mass)/e,i=(this.ry*this.mass+t.ry*t.mass)/e,r=this.degree+t.degree;return new rx({rx:n,ry:i,mass:e,degree:r})}}class ax{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,e){const n=this.length/2;return t<=this.xmid+n&&t>=this.xmid-n&&e<=this.ymid+n&&e>=this.ymid-n}NW(){const t=this.xmid-this.length/4,e=this.ymid+this.length/4,n=this.length/2;return new ax({xmid:t,ymid:e,length:n})}NE(){const t=this.xmid+this.length/4,e=this.ymid+this.length/4,n=this.length/2;return new ax({xmid:t,ymid:e,length:n})}SW(){const t=this.xmid-this.length/4,e=this.ymid-this.length/4,n=this.length/2;return new ax({xmid:t,ymid:e,length:n})}SE(){const t=this.xmid+this.length/4,e=this.ymid-this.length/4,n=this.length/2;return new ax({xmid:t,ymid:e,length:n})}}class ox{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}insert(t){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new ox(this.quad.NW()),this.NE=new ox(this.quad.NE()),this.SW=new ox(this.quad.SW()),this.SE=new ox(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t)):this.body=t}_putBody(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE}updateForce(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))}}const sx={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},lx={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},ux={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},cx=(t,e)=>{let n;const i=t.rows||5,r=t.cols||5;return null==e?n=Math.min(i,r):Math.min(i,r)===t.rows?t.rows=e:t.cols=e,n},hx=(t,e)=>{let n;const i=t.rows||5,r=t.cols||5;return null==e?n=Math.max(i,r):Math.max(i,r)===t.rows?t.rows=e:t.cols=e,n},dx=(t,e)=>t[`c-${e.row}-${e.col}`]||!1,fx=(t,e)=>t[`c-${e.row}-${e.col}`]=!0,px=(t,e)=>{const n=t.cols||5;e.col++,e.col>=n&&(e.col=0,e.row++)},gx=(t,e,n,i,r,a,o,s)=>{let l,u;const c=r[t.id];if(c)l=c.col*n+n/2+e[0],u=c.row*i+i/2+e[1];else{for(;dx(s,o);)px(a,o);l=o.col*n+n/2+e[0],u=o.row*i+i/2+e[1],fx(s,o),px(a,o)}t.data.x=l,t.data.y=u},vx={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},yx=(t,e,n,i,r,a)=>{e.forEach(((o,s)=>{n[s]={x:0,y:0},e.forEach(((e,l)=>{if(s===l)return;if(r[s]!==r[l])return;let u=o.x-e.x,c=o.y-e.y,h=Math.sqrt(u*u+c*c);if(0===h){h=1;const t=s>l?1:-1;u=.01*t,c=.01*t}if(h<a(t[s])/2+a(t[l])/2){const t=i*i/h;n[s].x+=u/h*t,n[s].y+=c/h*t}}))}))},mx=(t,e,n,i,r,a,o,s)=>{const l=a||o/10;return i&&e.forEach(((e,n)=>{const i=t[n].x-t[r].x,a=t[n].y-t[r].y,o=Math.sqrt(i*i+a*a);let s=a/o,l=-i/o;const u=Math.sqrt(e.x*e.x+e.y*e.y);let c=Math.acos((s*e.x+l*e.y)/u);c>Math.PI/2&&(c-=Math.PI/2,s*=-1,l*=-1);const h=Math.cos(c)*u;e.x=s*h,e.y=l*h})),t.forEach(((a,o)=>{if(o===r)return;const u=Math.sqrt(e[o].x*e[o].x+e[o].y*e[o].y);if(u>0&&o!==r){const c=Math.min(l*(n/800),u);if(a.x+=e[o].x/u*c,a.y+=e[o].y/u*c,i){let e=a.x-t[r].x,n=a.y-t[r].y;const i=Math.sqrt(e*e+n*n);e=e/i*s[o],n=n/i*s[o],a.x=t[r].x+e,a.y=t[r].y+n}}})),t},bx={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},xx={center:[0,0],width:300,height:300};var Ex=new Map;function wx(t,e,n){return void 0===n&&(n=128),function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var a=e?e.apply(this,i):i[0];Ex.has(t)||Ex.set(t,function(t){var e,n,i,r=t||1;function a(t,a){++e>r&&(i=n,o(1),++e),n[t]=a}function o(t){e=0,n=Object.create(null),t||(i=Object.create(null))}return o(),{clear:o,has:function(t){return void 0!==n[t]||void 0!==i[t]},get:function(t){var e=n[t];return void 0!==e?e:void 0!==(e=i[t])?(a(t,e),e):void 0},set:function(t,e){void 0!==n[t]?n[t]=e:a(t,e)}}}(n));var o=Ex.get(t);if(o.has(a))return o.get(a);var s=t.apply(this,i);return o.set(a,s),s}}class kx extends Sv{constructor(){super(...arguments),this.id="fishbone"}getRoot(){const t=this.context.model.getRootsData();if(!(Jd(t)||t.length>2))return t[0]}formatSize(t){const e="function"==typeof t?t:()=>t;return t=>Wd(e(t))}doLayout(t,e){const{hGap:n,getRibSep:i,vGap:r,nodeSize:a,height:o}=e,{model:s}=this.context,l=this.formatSize(a);let u=l(t)[0]+i(t);const c=(t,e=0)=>{var i;return e+=n*((t.children||[]).length+1),null===(i=t.children)||void 0===i||i.forEach((t=>{var n;null===(n=s.getNodeLikeDatum(t).children)||void 0===n||n.forEach((t=>{const n=s.getNodeLikeDatum(t);e=c(n,e)}))})),e},h=t=>{if(1===t.depth)return u;const e=s.getParentData(t.id,"tree");if(Nx(t)){const i=s.getParentData(e.id,"tree"),a=p(t)-p(i);return h(e)+a*n/r}{const n=(e.children||[]).indexOf(t.id),i=s.getNodeData((e.children||[]).slice(n));return d(e)-i.reduce(((t,e)=>t+c(e)),0)-l(e)[0]/2}},d=wx((t=>{if(Sx(t))return l(t)[0]/2;const e=s.getParentData(t.id,"tree");if(Nx(t))return h(t)+c(t)+l(t)[0]/2;{const i=p(t)-p(e),a=n/r;return h(t)+i*a}}),(t=>t.id)),f=t=>p(s.getParentData(t,"tree")),p=wx((t=>{if(Sx(t))return o/2;if(Nx(t)){const e=s.getParentData(t.id,"tree"),n=e.children.indexOf(t.id);if(0===n)return f(e.id)+r;const i=s.getNodeLikeDatum(e.children[n-1]);if(Jd(i.children))return p(i)+r;const a=s.getDescendantsData(i.id);return Math.max(...a.map((t=>Nx(t)?f(t.id):p(t))))+r}{if(Jd(t.children))return f(t.id)+r;const e=s.getNodeLikeDatum(t.children.slice(-1)[0]);if(Jd(e.children))return p(e)+r;const n=s.getDescendantsData(t.id).slice(-1)[0];return(Nx(n)?f(n.id):p(n))+r}}),(t=>t.id));let g=0;const v={nodes:[],edges:[]},y=t=>{var e;null===(e=t.children)||void 0===e||e.forEach((t=>y(s.getNodeLikeDatum(t))));const n=p(t),r=d(t);if(v.nodes.push({id:t.id,x:r,y:n}),Sx(t))return;const a=s.getRelatedEdgesData(t.id,"in")[0],o=[h(t),Nx(t)?n:f(t.id)];v.edges.push({id:wh(a),controlPoints:[o],relatedNodeId:t.id}),g=Math.max(g,r+i(t)),1===t.depth&&(u=g)};return y(t),v}placeAlterative(t,e){const n=(e.children||[]).filter(((t,e)=>e%2!=0));if(0===n.length)return t;const{model:i}=this.context,r=t.nodes.find((t=>t.id===e.id)).y,a=t=>{const e=i.getAncestorsData(t,"tree");if(Jd(e))return!1;const r=1===e.length?t:e[e.length-2].id;return n.includes(r)};t.nodes.forEach((t=>{a(t.id)&&(t.y=2*r-t.y)})),t.edges.forEach((t=>{a(t.relatedNodeId)&&(t.controlPoints=t.controlPoints.map((t=>[t[0],2*r-t[1]])))}))}rightToLeft(t,e){return t.nodes.forEach((t=>t.x=e.width-t.x)),t.edges.forEach((t=>{t.controlPoints=t.controlPoints.map((t=>[e.width-t[0],t[1]]))})),t}execute(t,e){return n=this,i=void 0,a=function*(){const n=Object.assign(Object.assign(Object.assign({},kx.defaultOptions),this.options),e),{direction:i,nodeSize:r}=n,a=this.getRoot();if(!a)return t;const o=this.formatSize(r);n.vGap||(n.vGap=Math.max(...(t.nodes||[]).map((t=>o(t)[1])))),n.hGap||(n.hGap=Math.max(...(t.nodes||[]).map((t=>o(t)[0]))));let s=this.doLayout(a,n);this.placeAlterative(s,a),"RL"===i&&(s=this.rightToLeft(s,n));const{model:l}=this.context,u=[],c=[];return s.nodes.forEach((t=>{const{id:e,x:n,y:i}=t,r=l.getNodeLikeDatum(e);u.push(Mx(r,{x:n,y:i}))})),s.edges.forEach((t=>{const{id:e,controlPoints:n}=t,i=l.getEdgeDatum(e);c.push(Mx(i,{controlPoints:n}))})),{nodes:u,edges:c}},new((r=void 0)||(r=Promise))((function(t,e){function o(t){try{l(a.next(t))}catch(t){e(t)}}function s(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,s)}l((a=a.apply(n,i||[])).next())}));var n,i,r,a}}kx.defaultOptions={direction:"RL",getRibSep:()=>60};const Mx=(t,e)=>Object.assign(Object.assign({},t),{style:Object.assign(Object.assign({},t.style||{}),e)}),Sx=t=>0===t.depth,Nx=t=>(t.depth||(t.depth=0))%2==0;class Tx extends Sv{constructor(){super(...arguments),this.id="snake"}formatSize(t,e){const n="function"==typeof e?e:()=>e;return t.reduce(((t,e)=>{const[i,r]=Wd(n(e))||[0,0];return[Math.max(t[0],i),Math.max(t[1],r)]}),[0,0])}validate(t){const{nodes:e=[],edges:n=[]}=t,i={},r={},a={};e.forEach((t=>{i[t.id]=0,r[t.id]=0,a[t.id]=[]})),n.forEach((t=>{i[t.target]++,r[t.source]++,a[t.source].push(t.target)}));const o=new Set,s=t=>{o.has(t)||(o.add(t),a[t].forEach(s))};if(s(e[0].id),o.size!==e.length)return!1;const l=e.filter((t=>0===i[t.id])),u=e.filter((t=>0===r[t.id]));return 1===l.length&&1===u.length&&e.filter((t=>1===i[t.id]&&1===r[t.id])).length===e.length-2}execute(t,e){return n=this,i=void 0,a=function*(){var n;if(!this.validate(t))return t;const{nodeSize:i,padding:r,sortBy:a,cols:o,colGap:s,rowGap:l,clockwise:u,width:c,height:h}=Object.assign({},Tx.defaultOptions,this.options,e),[d,f,p,g]=_c(r),v=this.formatSize(t.nodes||[],i),y=Math.ceil((t.nodes||[]).length/o);let m=s||(c-g-f-o*v[0])/(o-1),b=l||(h-d-p-y*v[1])/(y-1);(b===1/0||b<0)&&(b=0),(m===1/0||m<0)&&(m=0);const x=a?null===(n=t.nodes)||void 0===n?void 0:n.sort(a):function(t){const{nodes:e=[],edges:n=[]}=t,i={},r={};e.forEach((t=>{i[t.id]=0,r[t.id]=[]})),n.forEach((t=>{i[t.target]++,r[t.source].push(t.target)}));const a=[],o=[];for(e.forEach((t=>{0===i[t.id]&&a.push(t.id)}));a.length>0;){const t=a.shift(),n=e.find((e=>e.id===t));o.push(n),r[t].forEach((t=>{i[t]--,0===i[t]&&a.push(t)}))}return o}(t),E=(x||[]).map(((t,e)=>{const n=Math.floor(e/o),i=e%o,r=g+(u?n%2==0?i:o-1-i:n%2==0?o-1-i:i)*(v[0]+m)+v[0]/2,a=d+n*(v[1]+b)+v[1]/2;return{id:t.id,style:{x:r,y:a}}}));return{nodes:E}},new((r=void 0)||(r=Promise))((function(t,e){function o(t){try{l(a.next(t))}catch(t){e(t)}}function s(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,s)}l((a=a.apply(n,i||[])).next())}));var n,i,r,a}}Tx.defaultOptions={padding:0,cols:5,clockwise:!0};const Ax=function(t,e){return function(t,e,n){if(!$e(t)&&!jh(t))return t;var i=n;return jp(t,(function(t,n){i=e(i,t,n)})),i}(t,(function(t,n,i){return e.includes(i)||(t[i]=n),t}),{})};class Ox extends _h{}function Px(t,e=!0,n){const i=document.createElement("div");return i.setAttribute("class",`g6-${t}`),Object.assign(i.style,{position:"absolute",display:"block"}),e&&Object.assign(i.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),n&&Object.assign(i.style,n),i}function Cx(t,e="div",n={},i="",r=document.body){const a=document.getElementById(t);a&&a.remove();const o=document.createElement(e);return o.innerHTML=i,o.id=t,Object.assign(o.style,n),r.appendChild(o),o}var Rx,Lx;class Dx extends Ox{constructor(t,e){super(t,Object.assign({},Dx.defaultOptions,e)),this.$element=Px("background"),this.context.canvas.getContainer().prepend(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return n=this,i=void 0,a=function*(){e.update.call(this,t),Object.assign(this.$element.style,Ax(this.options,["key","type"]))},new((r=void 0)||(r=Promise))((function(t,e){function o(t){try{l(a.next(t))}catch(t){e(t)}}function s(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,s)}l((a=a.apply(n,i||[])).next())}));var n,i,r,a}destroy(){super.destroy(),this.$element.remove()}}function Ix(t,e,n,i,r,a){const o=n-t,s=i-e;let l=r-t,u=a-e,c=l*o+u*s,h=0;c<=0?h=0:(l=o-l,u=s-u,c=l*o+u*s,h=c<=0?0:c*c/(o*o+s*s));const d=l*l+u*u-h;return d<0?0:d}function _x(t,e,n,i){return(t-n)*(t-n)+(e-i)*(e-i)}function Bx(t,e,n,i,r){return _x(t,e,n,i)<r*r}function Fx(t){const e=Math.min(t.x1,t.x2),n=Math.max(t.x1,t.x2),i=Math.min(t.y1,t.y2),r=Math.max(t.y1,t.y2);return{x:e,y:i,x2:n,y2:r,width:n-e,height:r-i}}Dx.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};class jx{constructor(t,e,n,i){this.x1=t,this.y1=e,this.x2=n,this.y2=i}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}draw(t){t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(t){return new jx(t.x1,t.y1,t.x2,t.y2)}cuts(t,e){return this.y1!==this.y2&&(!(e<this.y1&&e<=this.y2||e>this.y1&&e>=this.y2)&&(!(t>this.x1&&t>=this.x2)&&(t<this.x1&&t<=this.x2||t<=this.x1+(e-this.y1)*(this.x2-this.x1)/(this.y2-this.y1))))}distSquare(t,e){return Ix(this.x1,this.y1,this.x2,this.y2,t,e)}ptClose(t,e,n){if(this.x1<this.x2){if(t<this.x1-n||t>this.x2+n)return!1}else if(t<this.x2-n||t>this.x1+n)return!1;if(this.y1<this.y2){if(e<this.y1-n||e>this.y2+n)return!1}else if(e<this.y2-n||e>this.y1+n)return!1;return!0}}!function(t){t[t.POINT=1]="POINT",t[t.PARALLEL=2]="PARALLEL",t[t.COINCIDENT=3]="COINCIDENT",t[t.NONE=4]="NONE"}(Rx||(Rx={}));class Gx{constructor(t,e=0,n=0){this.state=t,this.x=e,this.y=n}}function zx(t,e){const n=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),i=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),r=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(r){const e=n/r,a=i/r;return 0<=e&&e<=1&&0<=a&&a<=1?new Gx(Rx.POINT,t.x1+e*(t.x2-t.x1),t.y1+e*(t.y2-t.y1)):new Gx(Rx.NONE)}return new Gx(0===n||0===i?Rx.COINCIDENT:Rx.PARALLEL)}function Vx(t,e){const n=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),i=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),r=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(r){const t=n/r,e=i/r;if(0<=t&&t<=1&&0<=e&&e<=1)return t}return Number.POSITIVE_INFINITY}function Wx(t,e,n){const i=new Set;return t.width<=0?(i.add(Lx.LEFT),i.add(Lx.RIGHT)):e<t.x?i.add(Lx.LEFT):e>t.x+t.width&&i.add(Lx.RIGHT),t.height<=0?(i.add(Lx.TOP),i.add(Lx.BOTTOM)):n<t.y?i.add(Lx.TOP):n>t.y+t.height&&i.add(Lx.BOTTOM),i}function Ux(t,e){let n=e.x1,i=e.y1;const r=e.x2,a=e.y2,o=Array.from(Wx(t,r,a));if(0===o.length)return!0;let s=Wx(t,n,i);for(;0!==s.size;){for(const t of o)if(s.has(t))return!1;if(s.has(Lx.RIGHT)||s.has(Lx.LEFT)){let e=t.x;s.has(Lx.RIGHT)&&(e+=t.width),i+=(e-n)*(a-i)/(r-n),n=e}else{let e=t.y;s.has(Lx.BOTTOM)&&(e+=t.height),n+=(e-i)*(r-n)/(a-i),i=e}s=Wx(t,n,i)}return!0}function Hx(t,e){let n=Number.POSITIVE_INFINITY,i=0;function r(t,r,a,o){let s=Vx(e,new jx(t,r,a,o));s=Math.abs(s-.5),s>=0&&s<=1&&(i++,s<n&&(n=s))}return r(t.x,t.y,t.x2,t.y),r(t.x,t.y,t.x,t.y2),i>1?n:(r(t.x,t.y2,t.x2,t.y2),i>1?n:(r(t.x2,t.y,t.x2,t.y2),0===i?-1:n))}function Yx(t,e){let n=0;const i=zx(t,new jx(e.x,e.y,e.x2,e.y));n+=i.state===Rx.POINT?1:0;const r=zx(t,new jx(e.x,e.y,e.x,e.y2));n+=r.state===Rx.POINT?1:0;const a=zx(t,new jx(e.x,e.y2,e.x2,e.y2));n+=a.state===Rx.POINT?1:0;const o=zx(t,new jx(e.x2,e.y,e.x2,e.y2));return n+=o.state===Rx.POINT?1:0,{top:i,left:r,bottom:a,right:o,count:n}}!function(t){t[t.LEFT=0]="LEFT",t[t.TOP=1]="TOP",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=3]="BOTTOM"}(Lx||(Lx={}));class $x{constructor(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(t){return new $x(t.x,t.y,t.width,t.height)}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}clone(){return new $x(this.x,this.y,this.width,this.height)}add(t){const e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x2,t.x+t.width),r=Math.max(this.y2,t.y+t.height);this.x=e,this.y=n,this.width=i-e,this.height=r-n}addPoint(t){const e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x2,t.x),r=Math.max(this.y2,t.y);this.x=e,this.y=n,this.width=i-e,this.height=r-n}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(t){t.rect(this.x,this.y,this.width,this.height)}containsPt(t,e){return t>=this.x&&t<=this.x2&&e>=this.y&&e<=this.y2}get area(){return this.width*this.height}intersects(t){return!(this.area<=0||t.width<=0||t.height<=0)&&t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x2&&t.y<this.y2}distSquare(t,e){if(this.containsPt(t,e))return 0;const n=Wx(this,t,e);return n.has(Lx.TOP)?n.has(Lx.LEFT)?_x(t,e,this.x,this.y):n.has(Lx.RIGHT)?_x(t,e,this.x2,this.y):(this.y-e)*(this.y-e):n.has(Lx.BOTTOM)?n.has(Lx.LEFT)?_x(t,e,this.x,this.y2):n.has(Lx.RIGHT)?_x(t,e,this.x2,this.y2):(e-this.y2)*(e-this.y2):n.has(Lx.LEFT)?(this.x-t)*(this.x-t):n.has(Lx.RIGHT)?(t-this.x2)*(t-this.x2):0}}class Xx{constructor(t,e,n){this.cx=t,this.cy=e,this.radius=n}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return 2*this.radius}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return 2*this.radius}static from(t){return new Xx(t.cx,t.cy,t.radius)}containsPt(t,e){return _x(this.cx,this.cy,t,e)<this.radius*this.radius}distSquare(t,e){const n=_x(this.cx,this.cy,t,e);if(n<this.radius*this.radius)return 0;const i=Math.sqrt(n)-this.radius;return i*i}draw(t){t.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,2*Math.PI)}}class qx{constructor(t,e=0,n=0,i=0,r=0,a=10,o=10,s=new Float32Array(Math.max(0,a*o)).fill(0)){this.pixelGroup=t,this.i=e,this.j=n,this.pixelX=i,this.pixelY=r,this.width=a,this.height=o,this.area=s}createSub(t,e){return new qx(this.pixelGroup,t.x,t.y,e.x,e.y,t.width,t.height)}static fromPixelRegion(t,e){return new qx(e,0,0,t.x,t.y,Math.ceil(t.width/e),Math.ceil(t.height/e))}copy(t,e){return new qx(this.pixelGroup,this.scaleX(e.x),this.scaleY(e.y),e.x,e.y,t.width,t.height,t.area)}boundX(t){return t<this.i?this.i:t>=this.width?this.width-1:t}boundY(t){return t<this.j?this.j:t>=this.height?this.height-1:t}scaleX(t){return this.boundX(Math.floor((t-this.pixelX)/this.pixelGroup))}scaleY(t){return this.boundY(Math.floor((t-this.pixelY)/this.pixelGroup))}scale(t){const e=this.scaleX(t.x),n=this.scaleY(t.y),i=this.boundX(Math.ceil((t.x+t.width-this.pixelX)/this.pixelGroup)),r=this.boundY(Math.ceil((t.y+t.height-this.pixelY)/this.pixelGroup));return new $x(e,n,i-e,r-n)}invertScaleX(t){return Math.round(t*this.pixelGroup+this.pixelX)}invertScaleY(t){return Math.round(t*this.pixelGroup+this.pixelY)}addPadding(t,e){const n=Math.ceil(e/this.pixelGroup),i=this.boundX(t.x-n),r=this.boundY(t.y-n),a=this.boundX(t.x2+n),o=this.boundY(t.y2+n);return new $x(i,r,a-i,o-r)}get(t,e){return t<0||e<0||t>=this.width||e>=this.height?Number.NaN:this.area[t+e*this.width]}inc(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]+=n)}set(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]=n)}incArea(t,e){if(t.width<=0||t.height<=0||0===e)return;const n=this.width,i=t.width,r=Math.max(0,t.i),a=Math.max(0,t.j),o=Math.min(t.i+t.width,n),s=Math.min(t.j+t.height,this.height);if(!(s<=0||o<=0||r>=n||s>=this.height))for(let l=a;l<s;l++){const a=(l-t.j)*i,s=l*n;for(let n=r;n<o;n++){const i=t.area[n-t.i+a];0!==i&&(this.area[n+s]+=e*i)}}}fill(t){this.area.fill(t)}fillArea(t,e){const n=t.x+t.y*this.width;for(let i=0;i<t.height;i++){const r=n+i*this.width;this.area.fill(e,r,r+t.width)}}fillHorizontalLine(t,e,n,i){const r=t+e*this.width;this.area.fill(i,r,r+n)}fillVerticalLine(t,e,n,i){const r=t+e*this.width;for(let t=0;t<n;t++)this.area[r+t*this.width]=i}clear(){this.area.fill(0)}toString(){let t="";for(let e=0;e<this.height;e++){const n=e*this.width;for(let e=0;e<this.width;e++)t+=this.area[n+e].toFixed(1).padStart(6),t+=" ";t+="\n"}return t}draw(t,e=!0){if(this.width<=0||this.height<=0)return;t.save(),e&&t.translate(this.pixelX,this.pixelY);const n=this.area.reduce(((t,e)=>Math.min(t,e)),Number.POSITIVE_INFINITY),i=this.area.reduce(((t,e)=>Math.max(t,e)),Number.NEGATIVE_INFINITY),r=t=>(t-n)/(i-n);t.scale(this.pixelGroup,this.pixelGroup);for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++){const i=this.area[e+n*this.width];t.fillStyle=`rgba(0, 0, 0, ${r(i)})`,t.fillRect(e,n,1,1)}t.restore()}drawThreshold(t,e,n=!0){if(!(this.width<=0||this.height<=0)){t.save(),n&&t.translate(this.pixelX,this.pixelY),t.scale(this.pixelGroup,this.pixelGroup);for(let n=0;n<this.width;n++)for(let i=0;i<this.height;i++){const r=this.area[n+i*this.width];t.fillStyle=r>e?"black":"white",t.fillRect(n,i,1,1)}t.restore()}}}function Kx(t,e){const n=t=>({x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e});return Array.isArray(t)?t.map(n):n(t)}function Zx(t,e,n){return Qx(Object.assign(Fx(t),{distSquare:(e,n)=>Ix(t.x1,t.y1,t.x2,t.y2,e,n)}),e,n)}function Qx(t,e,n){const i=Kx(t,n),r=e.scale(i),a=e.createSub(r,i);return function(t,e,n,i){const r=n*n;for(let a=0;a<t.height;a++)for(let o=0;o<t.width;o++){const s=i(e.invertScaleX(t.i+o),e.invertScaleY(t.j+a));if(0!==s){if(s<r){const e=n-Math.sqrt(s);t.set(o,a,e*e)}}else t.set(o,a,r)}}(a,e,n,((e,n)=>t.distSquare(e,n))),a}function Jx(t,e){return{x:t,y:e}}function tE(t,e){return e.some((e=>e.containsPt(t.x,t.y)))}function eE(t,e){return e.some((e=>!!Bx(e.x1,e.y1,t.x,t.y,.001)||!!Bx(e.x2,e.y2,t.x,t.y,.001)))}function nE(t,e){let n=Number.POSITIVE_INFINITY,i=null;for(const r of t){if(!Ux(r,e))continue;const t=Hx(r,e);t>=0&&t<n&&(i=r,n=t)}return i}function iE(t,e,n,i){const r=n.top,a=n.left,o=n.bottom,s=n.right;if(i){if(a.state===Rx.POINT){if(r.state===Rx.POINT)return Jx(t.x-e,t.y-e);if(o.state===Rx.POINT)return Jx(t.x-e,t.y2+e);const n=t.width*t.height;return t.width*(.5*(a.y-t.y+(s.y-t.y)))<.5*n?a.y>s.y?Jx(t.x-e,t.y-e):Jx(t.x2+e,t.y-e):a.y<s.y?Jx(t.x-e,t.y2+e):Jx(t.x2+e,t.y2+e)}if(s.state===Rx.POINT){if(r.state===Rx.POINT)return Jx(t.x2+e,t.y-e);if(o.state===Rx.POINT)return Jx(t.x2+e,t.y2+e)}const n=t.height*t.width;return t.height*(.5*(r.x-t.x+(s.x-t.x)))<.5*n?r.x>o.x?Jx(t.x-e,t.y-e):Jx(t.x-e,t.y2+e):r.x<o.x?Jx(t.x2+e,t.y-e):Jx(t.x2+e,t.y2+e)}if(a.state===Rx.POINT){if(r.state===Rx.POINT)return Jx(t.x2+e,t.y2+e);if(o.state===Rx.POINT)return Jx(t.x2+e,t.y-e);const n=t.height*t.width;return t.width*(.5*(a.y-t.y+(s.y-t.y)))<.5*n?a.y>s.y?Jx(t.x2+e,t.y2+e):Jx(t.x-e,t.y2+e):a.y<s.y?Jx(t.x2+e,t.y-e):Jx(t.x-e,t.y-e)}if(s.state===Rx.POINT){if(r.state===Rx.POINT)return Jx(t.x-e,t.y2+e);if(o.state===Rx.POINT)return Jx(t.x-e,t.y-e)}const l=t.height*t.width;return t.height*(.5*(r.x-t.x+(s.x-t.x)))<.5*l?r.x>o.x?Jx(t.x2+e,t.y2+e):Jx(t.x2+e,t.y-e):r.x<o.x?Jx(t.x-e,t.y2+e):Jx(t.x-e,t.y-e)}function rE(t,e,n,i){if(!(t.closed?n<t.length:n<t.length-1))return!1;const r=t.get(e),a=t.get(n+1);for(let o=e+1;o<=n;o++){const e=t.get(o);if(Ix(r.x,r.y,a.x,a.y,e.x,e.y)>i)return!1}return!0}function aE(t,e){switch(t){case-2:return(((3-e)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw new Error("unknown error")}}class oE{constructor(t=[],e=!0){this.points=t,this.closed=e}get(t){const e=t,n=this.points.length;return t<0?this.closed?this.get(t+n):this.points[0]:t>=n?this.closed?this.get(t-n):this.points[n-1]:this.points[e]}get length(){return this.points.length}toString(t=1/0){const e=this.points;if(0===e.length)return"";const n="function"==typeof t?t:function(t){if(!Number.isFinite(t))return t=>t;if(0===t)return Math.round;const e=Math.pow(10,t);return t=>Math.round(t*e)/e}(t);let i="M";for(const t of e)i+=`${n(t.x)},${n(t.y)} L`;return i=i.slice(0,-1),this.closed&&(i+=" Z"),i}draw(t){const e=this.points;if(0!==e.length){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(const n of e)t.lineTo(n.x,n.y);this.closed&&t.closePath()}}sample(t){return function(t=8){return e=>{let n=t,i=e.length;if(n>1)for(i=Math.floor(e.length/n);i<3&&n>1;)n-=1,i=Math.floor(e.length/n);const r=[];for(let t=0,a=0;a<i;a++,t+=n)r.push(e.get(t));return new oE(r)}}(t)(this)}simplify(t){return function(t=0){return e=>{if(t<0||e.length<3)return e;const n=[];let i=0;const r=t*t;for(;i<e.length;){let t=i+1;for(;rE(e,i,t,r);)t++;n.push(e.get(i)),i=t}return new oE(n)}}(t)(this)}bSplines(t){return function(t=6){function e(t,e,n){let i=0,r=0;for(let a=-2;a<=1;a++){const o=t.get(e+a),s=aE(a,n);i+=s*o.x,r+=s*o.y}return{x:i,y:r}}return n=>{if(n.length<3)return n;const i=[],r=n.closed,a=n.length+3-1+(r?0:2);i.push(e(n,2-(r?0:2),0));for(let o=2-(r?0:2);o<a;o++)for(let r=1;r<=t;r++)i.push(e(n,o,r/t));return new oE(i)}}(t)(this)}apply(t){return t(this)}containsElements(t){const e=function(t){if(0===t.length)return null;const e=t[0],n=new $x(e.x,e.y,0,0);for(const e of t)n.addPoint(e);return n}(this.points);return!!e&&t.every((t=>e.containsPt(t.cx,t.cy)&&this.withinArea(t.cx,t.cy)))}withinArea(t,e){if(0===this.length)return!1;let n=0;const i=this.points[0],r=new jx(i.x,i.y,i.x,i.y);for(let i=1;i<this.points.length;i++){const a=this.points[i];r.x1=r.x2,r.y1=r.y2,r.x2=a.x,r.y2=a.y,r.cuts(t,e)&&n++}return r.x1=r.x2,r.y1=r.y2,r.x2=i.x,r.y2=i.y,r.cuts(t,e)&&n++,n%2==1}}class sE{constructor(t=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=t}add(t){this.set.add(`${t.x}x${t.y}`),this.arr[this.count++]=t}contains(t){return this.set.has(`${t.x}x${t.y}`)}isFirst(t){if(0===this.count)return!1;const e=this.arr[0];return null!=e&&e.x===t.x&&e.y===t.y}path(){return new oE(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(t){return this.arr[t]}get length(){return this.count}}function lE(t,e){const n=2*(Math.floor(t.width)+Math.floor(t.height)),i=new sE(n);function r(n,i,r,a){const o=t.get(n,i);return Number.isNaN(o)?Number.NaN:o>e?r+a:r}function a(t,e){let n=0;return n=r(t,e,n,1),n=r(t+1,e,n,2),n=r(t,e+1,n,4),n=r(t+1,e+1,n,8),Number.isNaN(n)?-1:n}let o=1;function s(e,n){let r=e,s=n,l=t.invertScaleX(r),u=t.invertScaleY(s);for(let e=0;e<t.width*t.height;e++){const e={x:l,y:u};if(i.contains(e)){if(i.isFirst(e))return!0}else i.add(e);const n=a(r,s);switch(n){case-1:return!0;case 0:case 3:case 2:case 7:o=2;break;case 12:case 14:case 4:o=3;break;case 6:o=0===o?3:2;break;case 1:case 13:case 5:o=0;break;case 9:o=2===o?0:1;break;case 10:case 8:case 11:o=1;break;default:return console.warn("Marching squares invalid state: "+n),!0}switch(o){case 0:s--,u-=t.pixelGroup;break;case 1:s++,u+=t.pixelGroup;break;case 3:r--,l-=t.pixelGroup;break;case 2:r++,l+=t.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+n),!0}}return!0}for(let n=0;n<t.width;n++)for(let r=0;r<t.height;r++){if(t.get(n,r)<=e)continue;const o=a(n,r);if(!(o<0||15===o)&&s(n,r))return i.path()}return null}const uE={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function cE(t){return null!=t&&"number"==typeof t.radius}function hE(t,e){if(cE(t)!==cE(e))return!1;if(cE(t)){const n=e;return t.cx===n.cx&&t.cy===n.cy&&t.radius===n.radius}const n=e;return t.x===n.x&&t.y===n.y&&t.width===n.width&&t.height===n.height}var dE;!function(t){t[t.MEMBERS=0]="MEMBERS",t[t.NON_MEMBERS=1]="NON_MEMBERS",t[t.EDGES=2]="EDGES"}(dE||(dE={}));class fE{constructor(t={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new $x(0,0,0,0),this.potentialArea=new qx(1,0,0,0,0,0,0),this.o=Object.assign({},uE,t)}pushMember(...t){if(0!==t.length){this.dirty.add(dE.MEMBERS);for(const e of t)this.members.push({raw:e,obj:cE(e)?Xx.from(e):$x.from(e),area:null})}}removeMember(t){const e=this.members.findIndex((e=>hE(e.raw,t)));return!(e<0||(this.members.splice(e,1),this.dirty.add(dE.MEMBERS),0))}removeNonMember(t){const e=this.nonMembers.findIndex((e=>hE(e.raw,t)));return!(e<0||(this.nonMembers.splice(e,1),this.dirty.add(dE.NON_MEMBERS),0))}removeEdge(t){const e=this.edges.findIndex((e=>e.obj.equals(t)));return!(e<0||(this.edges.splice(e,1),this.dirty.add(dE.NON_MEMBERS),0))}pushNonMember(...t){if(0!==t.length){this.dirty.add(dE.NON_MEMBERS);for(const e of t)this.nonMembers.push({raw:e,obj:cE(e)?Xx.from(e):$x.from(e),area:null})}}pushEdge(...t){if(0!==t.length){this.dirty.add(dE.EDGES);for(const e of t)this.edges.push({raw:e,obj:jx.from(e),area:null})}}update(){const t=this.dirty.has(dE.MEMBERS),e=this.dirty.has(dE.NON_MEMBERS);let n=this.dirty.has(dE.EDGES);this.dirty.clear();const i=this.members.map((t=>t.obj));if(this.o.virtualEdges&&(t||e)){const t=function(t,e,n,i){if(0===t.length)return[];const r=function(t){if(t.length<2)return t;let e=0,n=0;return t.forEach((t=>{e+=t.cx,n+=t.cy})),e/=t.length,n/=t.length,t.map((t=>{const i=e-t.cx,r=n-t.cy;return[t,i*i+r*r]})).sort(((t,e)=>t[1]-e[1])).map((t=>t[0]))}(t);return r.map(((t,a)=>{const o=r.slice(0,a);return function(t,e,n,i,r){const a=Jx(e.cx,e.cy),o=function(t,e,n){let i=Number.POSITIVE_INFINITY;return e.reduce(((e,r)=>{const a=_x(t.x,t.y,r.cx,r.cy);if(a>i)return e;const o=new jx(t.x,t.y,r.cx,r.cy),s=function(t,e){return t.reduce(((t,n)=>Ux(n,e)&&function(t,e){function n(t,n,i,r){let a=Vx(e,new jx(t,n,i,r));return a=Math.abs(a-.5),a>=0&&a<=1?1:0}let i=n(t.x,t.y,t.x2,t.y);return i+=n(t.x,t.y,t.x,t.y2),i>1||(i+=n(t.x,t.y2,t.x2,t.y2),i>1||(i+=n(t.x2,t.y,t.x2,t.y2),i>0))}(n,e)?t+1:t),0)}(n,o);return a*(s+1)*(s+1)<i&&(e=r,i=a*(s+1)*(s+1)),e}),null)}(a,n,t);if(null==o)return[];const s=function(t,e,n,i){const r=[],a=[];a.push(t);let o=!0;for(let t=0;t<n&&o;t++)for(o=!1;!o&&a.length>0;){const t=a.pop(),n=nE(e,t),s=n?Yx(t,n):null;if(!n||!s||2!==s.count){o||r.push(t);continue}let l=i,u=iE(n,l,s,!0),c=eE(u,a)||eE(u,r),h=tE(u,e);for(;!c&&h&&l>=1;)l/=1.5,u=iE(n,l,s,!0),c=eE(u,a)||eE(u,r),h=tE(u,e);if(!u||c||h||(a.push(new jx(t.x1,t.y1,u.x,u.y)),a.push(new jx(u.x,u.y,t.x2,t.y2)),o=!0),o)continue;l=i,u=iE(n,l,s,!1);let d=eE(u,a)||eE(u,r);for(h=tE(u,e);!d&&h&&l>=1;)l/=1.5,u=iE(n,l,s,!1),d=eE(u,a)||eE(u,r),h=tE(u,e);u&&!d&&(a.push(new jx(t.x1,t.y1,u.x,u.y)),a.push(new jx(u.x,u.y,t.x2,t.y2)),o=!0),o||r.push(t)}for(;a.length>0;)r.push(a.pop());return r}(new jx(a.x,a.y,o.cx,o.cy),t,i,r);return function(t,e){const n=[];for(;t.length>0;){const i=t.pop();if(0===t.length){n.push(i);break}const r=t.pop(),a=new jx(i.x1,i.y1,r.x2,r.y2);nE(e,a)?(n.push(i),t.push(r)):t.push(a)}return n}(s,t)}(e,t,o,n,i)})).flat()}(i,this.nonMembers.map((t=>t.obj)),this.o.maxRoutingIterations,this.o.morphBuffer),e=new Map(this.virtualEdges.map((t=>[t.obj.toString(),t.area])));this.virtualEdges=t.map((t=>{var n;return{raw:t,obj:t,area:null!==(n=e.get(t.toString()))&&void 0!==n?n:null}})),n=!0}let r=!1;if(t||n){const t=function(t,e){if(0===t.length)return new $x(0,0,0,0);const n=$x.from(t[0]);for(const e of t)n.add(e);for(const t of e)n.add(Fx(t));return n}(i,this.virtualEdges.concat(this.edges).map((t=>t.obj))),e=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,n=$x.from(Kx(t,e));n.equals(this.activeRegion)||(r=!0,this.activeRegion=n)}if(r){const t=Math.ceil(this.activeRegion.width/this.o.pixelGroup),e=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=qx.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach((t=>t.area=null)),this.nonMembers.forEach((t=>t.area=null)),this.edges.forEach((t=>t.area=null)),this.virtualEdges.forEach((t=>t.area=null))):t===this.potentialArea.width&&e===this.potentialArea.height||(this.potentialArea=qx.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const a=new Map,o=t=>{if(t.area){const e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof $x?"R":"C"}`;a.set(e,t.area)}},s=t=>{if(t.area)return;const e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof $x?"R":"C"}`;if(a.has(e)){const n=a.get(e);return void(t.area=this.potentialArea.copy(n,{x:t.obj.x-this.o.nodeR1,y:t.obj.y-this.o.nodeR1}))}const n=t.obj instanceof $x?function(t,e,n){const i=e.scale(t),r=e.addPadding(i,n),a=e.createSub(r,{x:t.x-n,y:t.y-n}),o=i.x-r.x,s=i.y-r.y,l=r.x2-i.x2,u=r.y2-i.y2,c=r.width-o-l,h=r.height-s-u,d=n*n;a.fillArea({x:o,y:s,width:c+1,height:h+1},d);const f=[0],p=Math.max(s,o,l,u);{const r=e.invertScaleX(i.x+i.width/2);for(let a=1;a<p;a++){const o=e.invertScaleY(i.y-a),s=t.distSquare(r,o);if(!(s<d))break;{const t=n-Math.sqrt(s);f.push(t*t)}}}const g=[],v=Math.max(o,l),y=Math.max(s,l);for(let r=1;r<v;r++){const a=e.invertScaleX(i.x-r),o=[];for(let r=1;r<y;r++){const s=e.invertScaleY(i.y-r),l=t.distSquare(a,s);if(l<d){const t=n-Math.sqrt(l);o.push(t*t)}else o.push(0)}g.push(o)}for(let t=1;t<Math.min(s,f.length);t++){const e=f[t];a.fillHorizontalLine(o,s-t,c+1,e)}for(let t=1;t<Math.min(u,f.length);t++){const e=f[t];a.fillHorizontalLine(o,s+h+t,c+1,e)}for(let t=1;t<Math.min(o,f.length);t++){const e=f[t];a.fillVerticalLine(o-t,s,h+1,e)}for(let t=1;t<Math.min(u,f.length);t++){const e=f[t];a.fillVerticalLine(o+c+t,s,h+1,e)}for(let t=1;t<o;t++){const e=g[t-1],n=o-t;for(let t=1;t<s;t++)a.set(n,s-t,e[t-1]);for(let t=1;t<u;t++)a.set(n,s+h+t,e[t-1])}for(let t=1;t<l;t++){const e=g[t-1],n=o+c+t;for(let t=1;t<s;t++)a.set(n,s-t,e[t-1]);for(let t=1;t<u;t++)a.set(n,s+h+t,e[t-1])}return a}(t.obj,this.potentialArea,this.o.nodeR1):Qx(t.obj,this.potentialArea,this.o.nodeR1);t.area=n,a.set(e,n)};this.members.forEach(o),this.nonMembers.forEach(o),this.members.forEach(s),this.nonMembers.forEach((t=>{this.activeRegion.intersects(t.obj)?s(t):t.area=null})),this.edges.forEach((t=>{t.area||(t.area=Zx(t.obj,this.potentialArea,this.o.edgeR1))})),this.virtualEdges.forEach((t=>{t.area||(t.area=Zx(t.obj,this.potentialArea,this.o.edgeR1))}))}drawMembers(t){for(const e of this.members)e.obj.draw(t)}drawNonMembers(t){for(const e of this.nonMembers)e.obj.draw(t)}drawEdges(t){for(const e of this.edges)e.obj.draw(t)}drawPotentialArea(t,e=!0){this.potentialArea.draw(t,e)}compute(){if(0===this.members.length)return new oE([]);this.dirty.size>0&&this.update();const{o:t,potentialArea:e}=this,n=this.members.map((t=>t.area)),i=this.virtualEdges.concat(this.edges).map((t=>t.area)),r=this.nonMembers.filter((t=>null!=t.area)).map((t=>t.area)),a=this.members.map((t=>t.obj));return function(t,e,n,i,r,a={}){const o=Object.assign({},uE,a);let s=o.threshold,l=o.memberInfluenceFactor,u=o.edgeInfluenceFactor,c=o.nonMemberInfluenceFactor;const h=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),d=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1);for(let a=0;a<o.maxMarchingIterations;a++){if(t.clear(),0!==l){const n=l/h;for(const i of e)t.incArea(i,n)}if(0!==u){const e=u/d;for(const i of n)t.incArea(i,e)}if(0!==c){const e=c/h;for(const n of i)t.incArea(n,e)}const f=lE(t,s);if(f&&r(f))return f;if(s*=.95,a<=.5*o.maxMarchingIterations)l*=1.2,u*=1.2;else{if(!(0!==c&&i.length>0))break;c*=.8}}return new oE([])}(e,n,i,r,(t=>t.containsElements(a)),t)}}class pE extends Ox{constructor(t,e){super(t,Vh({},pE.defaultOptions,e)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{const{style:t,bubbleSetOptions:e}=this.parseOptions();Ku(this.bubbleSetOptions,e)||this.init(),this.bubbleSetOptions=Object.assign({},e);const n=Object.assign(Object.assign({},t),{d:this.getPath()});this.shape?this.shape.update(n):(this.shape=new lf({style:n}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=t=>{if(!this.shape)return;const e=wh(t.data);[...this.options.members,...this.options.avoidMembers].includes(e)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(e)}))},this.getPath=t=>{const{graph:e}=this.context,n=this.options.members,i=[...this.members.keys()],r=this.options.avoidMembers,a=[...this.avoidMembers.keys()];if(!t&&Ku(n,i)&&Ku(r,a))return this.path;const{enter:o=[],exit:s=[]}=Lh(i,n,(t=>t)),{enter:l=[],exit:u=[]}=Lh(a,r,(t=>t));t&&(s.push(t),o.push(t));const c=(t,n,i)=>{t.forEach((t=>{const r=i?this.members:this.avoidMembers,a=i?"pushMember":"pushNonMember",o=i?"removeMember":"removeNonMember";if(n){let n;"edge"===e.getElementType(t)?([n]=vE(e,t),this.bubbleSets.pushEdge(n)):([n]=gE(e,t),this.bubbleSets[a](n)),r.set(t,n)}else{const n=r.get(t);n&&("edge"===e.getElementType(t)?this.bubbleSets.removeEdge(n):this.bubbleSets[o](n),r.delete(t))}}))};c(s,!1,!0),c(o,!0,!0),c(u,!1,!1),c(l,!0,!1);const h=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=sf(h.points.map(cd)),this.path},this.bindEvents(),this.bubbleSets=new fE(this.options)}bindEvents(){this.context.graph.on(oc.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(oc.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new fE(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const t=this.options,{type:e,key:n,members:i,avoidMembers:r}=t,a=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(t,["type","key","members","avoidMembers"]),o=Object.keys(a).reduce(((t,e)=>(e in uE?t.bubbleSetOptions[e]=a[e]:t.style[e]=a[e],t)),{style:{},bubbleSetOptions:{}});return Object.assign({type:e,key:n,members:i,avoidMembers:r},o)}addMember(t){const e=Array.isArray(t)?t:[t];e.some((t=>this.options.avoidMembers.includes(t)))&&(this.options.avoidMembers=this.options.avoidMembers.filter((t=>!e.includes(t)))),this.options.members=[...new Set([...this.options.members,...e])],this.drawBubbleSets()}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter((t=>!e.includes(t))),this.drawBubbleSets()}updateMember(t){this.options.members=gn(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){const e=Array.isArray(t)?t:[t];e.some((t=>this.options.members.includes(t)))&&(this.options.members=this.options.members.filter((t=>!e.includes(t)))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...e])],this.drawBubbleSets()}removeAvoidMember(t){const e=Array.isArray(t)?t:[t];this.options.avoidMembers.some((t=>e.includes(t)))&&(this.options.avoidMembers=this.options.avoidMembers.filter((t=>!e.includes(t))),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(oc.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(oc.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}pE.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},uE);const gE=(t,e)=>(Array.isArray(e)?e:[e]).map((e=>{const n=t.getElementRenderBounds(e);return new $x(n.min[0],n.min[1],Fc(n),jc(n))})),vE=(t,e)=>(Array.isArray(e)?e:[e]).map((e=>{const n=t.getEdgeData(e),i=t.getElementPosition(n.source),r=t.getElementPosition(n.target);return jx.from({x1:i[0],y1:i[1],x2:r[0],y2:r[1]})}));var yE=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class mE extends Ox{constructor(t,e){super(t,Object.assign({},mE.defaultOptions,e)),this.targetElement=null,this.onTriggerEvent=t=>{var e;null===(e=t.preventDefault)||void 0===e||e.call(t),this.show(t)},this.onMenuItemClick=t=>{const{onClick:e,trigger:n}=this.options;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){const n=t.target.getAttribute("value");null==e||e(n,t.target,this.targetElement),this.hide()}"click"!==n&&this.hide()},this.initElement(),this.update(e)}initElement(){this.$element=Px("contextmenu",!1,{zIndex:"99"});const{className:t}=this.options;t&&this.$element.classList.add(t),this.context.canvas.getContainer().appendChild(this.$element),Cx("g6-contextmenu-css","style",{},"\n  .g6-contextmenu {\n    font-size: 12px;\n    background-color: rgba(255, 255, 255, 0.96);\n    border-radius: 4px;\n    overflow: hidden;\n    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;\n    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;\n  }\n\n  .g6-contextmenu-ul {\n    max-width: 256px;\n    min-width: 96px;\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n\n  .g6-contextmenu-li {\n    padding: 8px 12px;\n    cursor: pointer;\n    user-select: none;\n  }\n\n  .g6-contextmenu-li:hover {\n    background-color: #f5f5f5;\n    cursor: pointer;\n  }\n",document.head)}show(t){return yE(this,void 0,void 0,(function*(){const{enable:e,offset:n}=this.options;if("function"==typeof e&&!e(t)||!e)return void this.hide();const i=yield this.getDOMContent(t);i instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(i)):this.$element.innerHTML=i;const r=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-r.left+n[0]}px`,this.$element.style.top=`${t.client.y-r.top+n[1]}px`,this.$element.style.display="block",this.targetElement=t.target}))}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return yE(this,void 0,void 0,(function*(){const{getContent:e,getItems:n}=this.options;return n?`\n    <ul class="g6-contextmenu-ul">\n      ${(yield n(t)).map((t=>`<li  class="g6-contextmenu-li" value="${t.value}">${t.name}</li>`)).join("")}\n    </ul>\n  `:yield e(t)}))}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`canvas:${e}`,this.onTriggerEvent),t.on(`node:${e}`,this.onTriggerEvent),t.on(`edge:${e}`,this.onTriggerEvent),t.on(`combo:${e}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`canvas:${e}`,this.onTriggerEvent),t.off(`node:${e}`,this.onTriggerEvent),t.off(`edge:${e}`,this.onTriggerEvent),t.off(`combo:${e}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}mE.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class bE extends Ox{constructor(t,e){super(t,Object.assign({},bE.defaultOptions,e)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{const{model:t,element:e}=this.context,n=t.getEdgeData();this.divideEdges(this.options.divisions);const{cycles:i,iterRate:r,divRate:a}=this.options;let{lambda:o,divisions:s,iterations:l}=this.options;for(let t=0;t<i;t++){for(let t=0;t<l;t++){const t={};n.forEach((e=>{var n;if(e.source===e.target)return;const i=wh(e);t[i]=this.getEdgeForces(e,s,o);for(let e=0;e<s+1;e++)(n=this.edgePoints)[i]||(n[i]=[]),this.edgePoints[i][e]=Uh(this.edgePoints[i][e],t[i][e])}))}o/=2,s*=a,l*=r,this.divideEdges(s)}n.forEach((t=>{const n=wh(t),i=e.getElement(n);null==i||i.update({d:gg(this.edgePoints[n])})}))},this.bindEvents()}get nodeMap(){const t=this.context.model.getNodeData();return Object.fromEntries(t.map((t=>[wh(t),ed(sd(t))])))}divideEdges(t){this.context.model.getEdgeData().forEach((e=>{var n;const i=wh(e);(n=this.edgePoints)[i]||(n[i]=[]);const r=this.nodeMap[e.source],a=this.nodeMap[e.target];if(1===t)this.edgePoints[i].push(r),this.edgePoints[i].push($h(Uh(r,a),2)),this.edgePoints[i].push(a);else{const e=(0===this.edgePoints[i].length?qh(r,a):NE(this.edgePoints[i]))/(t+1);let n=e;const o=[r];for(let t=1;t<this.edgePoints[i].length;t++){const r=this.edgePoints[i][t-1],a=this.edgePoints[i][t];let s=qh(a,r);for(;s>n;){const t=n/s,i=Uh(r,Yh(Hh(a,r),t));o.push(i),s-=n,n=e}n-=s}o.push(a),this.edgePoints[i]=o}}))}getVectorPosition(t){const e=this.nodeMap[t.source],n=this.nodeMap[t.target],[i,r]=Hh(n,e);return{source:e,target:n,vx:i,vy:r,length:qh(e,n)}}measureEdgeCompatibility(t,e){const n=this.getVectorPosition(t),i=this.getVectorPosition(e);return xE(n,i)*EE(n,i)*wE(n,i)*SE(n,i)}getEdgeBundles(){const t={},e=this.options.bundleThreshold,n=this.context.model.getEdgeData();return n.forEach(((i,r)=>{n.forEach(((n,a)=>{var o,s;a<=r||this.measureEdgeCompatibility(i,n)>=e&&(t[o=wh(i)]||(t[o]=[]),t[wh(i)].push(n),t[s=wh(n)]||(t[s]=[]),t[wh(n)].push(i))}))})),t}getSpringForce(t,e){const{pre:n,cur:i,next:r}=t;return Yh(Hh(Uh(n,r),Yh(i,2)),e)}getElectrostaticForce(t,e){Jd(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());const n=this.edgeBundles[wh(e)];let i=[0,0];return null==n||n.forEach((n=>{const r=this.edgePoints[wh(n)][t],a=this.edgePoints[wh(e)][t],o=Hh(r,a),s=qh(r,a);i=Uh(i,Yh(o,1/s))})),i}getEdgeForces(t,e,n){const i=this.nodeMap[t.source],r=this.nodeMap[t.target],a=this.options.K/(qh(i,r)*(e+1)),o=[[0,0]],s=wh(t);for(let i=1;i<e;i++){const e=this.getSpringForce({pre:this.edgePoints[s][i-1],cur:this.edgePoints[s][i],next:this.edgePoints[s][i+1]||[0,0]},a),r=this.getElectrostaticForce(i,t);o.push(Yh(Uh(e,r),n))}return o.push([0,0]),o}bindEvents(){const{graph:t}=this.context;t.on(oc.AFTER_RENDER,this.onBundle)}unbindEvents(){const{graph:t}=this.context;t.off(oc.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}bE.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const xE=(t,e)=>{return Math.abs((n=[t.vx,t.vy],i=[e.vx,e.vy],n.reduce(((t,e,n)=>t+e*i[n]),0)/(t.length*e.length)));var n,i},EE=(t,e)=>{const n=(t.length+e.length)/2;return 2/(n/Math.min(t.length,e.length)+Math.max(t.length,e.length)/n)},wE=(t,e)=>{const n=(t.length+e.length)/2;return n/(n+qh($h(Uh(t.source,t.target),2),$h(Uh(e.source,e.target),2)))},kE=(t,e)=>{if(e.source[0]===e.target[0])return[e.source[0],t[1]];if(e.source[1]===e.target[1])return[t[0],e.source[1]];const n=(e.source[1]-e.target[1])/(e.source[0]-e.target[0]),i=(n*n*e.source[0]+n*(t[1]-e.source[1])+t[0])/(n*n+1);return[i,n*(i-e.source[0])+e.source[1]]},ME=(t,e)=>{const n=kE(e.source,t),i=kE(e.target,t),r=$h(Uh(n,i),2),a=$h(Uh(t.source,t.target),2);return 0===qh(n,i)?0:Math.max(0,1-2*qh(a,r)/qh(n,i))},SE=(t,e)=>Math.min(ME(t,e),ME(e,t)),NE=t=>{let e=0;for(let n=1;n<t.length;n++)e+=qh(t[n],t[n-1]);return e},TE={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0};class AE extends Ox{constructor(t,e){super(t,Object.assign({},AE.defaultOptions,e)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;const e=cd(t.canvas);this.renderLens(e),this.renderFocusElements()},this.renderLens=t=>{const e=Object.assign({},TE,this.options.style);this.isLensOn||(this.lens=new mf({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,hd(t),{size:2*this.r}),this.lens.update(e)},this.getFilterData=()=>{const{filter:t}=this.options,{model:e}=this.context,n=e.getData();if(!t)return n;const{nodes:i,edges:r,combos:a}=n;return{nodes:i.filter((e=>t(wh(e),"node"))),edges:r.filter((e=>t(wh(e),"edge"))),combos:a.filter((e=>t(wh(e),"combo")))}},this.getFocusElements=t=>{const{nodes:e,edges:n}=this.getFilterData(),i=e.filter((e=>qh(sd(e),t)<this.r)),r=i.map((t=>wh(t)));return{nodes:i,edges:n.filter((t=>{const{source:e,target:n}=t,i=r.includes(e),a=r.includes(n);switch(this.options.nodeType){case"both":return i&&a;case"either":return i!==a;case"source":return i&&!a;case"target":return!i&&a;default:return!1}}))}},this.renderFocusElements=()=>{const{element:t,graph:e}=this.context;if(!this.isLensOn)return;const n=this.lens.getCenter(),{nodes:i,edges:r}=this.getFocusElements(n),a=new Set,o=n=>{const i=wh(n);a.add(i);const r=t.getElement(i);if(!r)return;const o=this.shapes.get(i)||r.cloneNode();o.setPosition(r.getPosition()),o.id=r.id,this.shapes.has(i)?Object.entries(r.attributes).forEach((([t,e])=>{o.style[t]!==e&&(o.style[t]=e)})):(this.canvas.appendChild(o),this.shapes.set(i,o));const s=e.getElementType(i),l=this.getElementStyle(s,n);o.update(l)};i.forEach(o),r.forEach(o),this.shapes.forEach(((t,e)=>{a.has(e)||(t.destroy(),this.shapes.delete(e))}))},this.scaleRByWheel=t=>{var e;this.options.preventDefault&&t.preventDefault();const{clientX:n,clientY:i,deltaX:r,deltaY:a}=t,{graph:o,canvas:s}=this.context,l=o.getCanvasByClient([n,i]),u=null===(e=this.lens)||void 0===e?void 0:e.getCenter();if(!this.isLensOn||qh(l,u)>this.r)return;const{maxR:c,minR:h}=this.options,d=r+a>0?1/.95:.95,f=Math.min(...s.getSize())/2;this.r=Math.max(h||0,Math.min(c||f,this.r*d)),this.renderLens(u),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=t=>{var e;const n=cd(t.canvas),i=null===(e=this.lens)||void 0===e?void 0:e.getCenter();!this.isLensOn||qh(n,i)>this.r||(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;const e=cd(t.canvas);this.renderLens(e),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,e){const n="node"===t?this.options.nodeStyle:this.options.edgeStyle;return"function"==typeof n?n(e):n}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:i}=this.options,r=e.getCanvas().getLayer();["click","drag"].includes(n)&&r.addEventListener(ic.CLICK,this.onEdgeFilter),"pointermove"===n?r.addEventListener(ic.POINTER_MOVE,this.onEdgeFilter):"drag"===n&&(r.addEventListener(ic.DRAG_START,this.onDragStart),r.addEventListener(ic.DRAG,this.onDrag),r.addEventListener(ic.DRAG_END,this.onDragEnd)),"wheel"===i&&(null===(t=this.graphDom)||void 0===t||t.addEventListener(ic.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:i}=this.options,r=e.getCanvas().getLayer();["click","drag"].includes(n)&&r.removeEventListener(ic.CLICK,this.onEdgeFilter),"pointermove"===n?r.removeEventListener(ic.POINTER_MOVE,this.onEdgeFilter):"drag"===n&&(r.removeEventListener(ic.DRAG_START,this.onDragStart),r.removeEventListener(ic.DRAG,this.onDrag),r.removeEventListener(ic.DRAG_END,this.onDragEnd)),"wheel"===i&&(null===(t=this.graphDom)||void 0===t||t.removeEventListener(ic.WHEEL,this.scaleRByWheel))}update(t){var e;this.unbindEvents(),super.update(t),this.r=null!==(e=t.r)&&void 0!==e?e:this.r,this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach(((t,e)=>{t.destroy(),this.shapes.delete(e)})),super.destroy()}}AE.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const OE={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12};class PE extends Ox{constructor(t,e){super(t,Object.assign({},PE.defaultOptions,e)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;const e=cd(t.canvas);this.onMagnify(e)},this.onMagnify=t=>{t.some(isNaN)||(this.renderLens(t),this.renderFocusElements())},this.renderLens=t=>{const e=Object.assign({},OE,this.options.style);this.isLensOn||(this.lens=new mf({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,hd(t),{size:2*this.r,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(e)},this.getDPercent=()=>{const{minD:t,maxD:e}=this.options;return`${Math.round((this.d-t)/(e-t)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;const{graph:t}=this.context,e=this.lens.getCenter(),n=(this.d+1)*this.r,i=new Map,r=new Map;t.getNodeData().forEach((a=>{const o=sd(a),s=qh(o,e);if(s>this.r)return;const l=n*s/(this.d*s+this.r),[u,c]=o,[h,d]=e,f=[h+l*((u-h)/s),d+l*((c-d)/s)],p=wh(a),g=this.getNodeStyle(a),v=zp(t.getElementRenderStyle(p),Object.keys(g));i.set(p,Object.assign(Object.assign({},hd(f)),g)),r.set(p,Object.assign(Object.assign({},hd(o)),v))})),this.updateStyle(i,r)},this.getNodeStyle=t=>{const{nodeStyle:e}=this.options;return"function"==typeof e?e(t):e},this.updateStyle=(t,e)=>{const{graph:n,element:i}=this.context,{enter:r,exit:a,keep:o}=Lh(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(t.keys()),(t=>t)),s=new Set,l=(t,e)=>{const r=i.getElement(t);null==r||r.update(e),n.getRelatedEdgesData(t).forEach((t=>{s.add(wh(t))}))};[...r,...o].forEach((e=>{l(e,t.get(e))})),a.forEach((t=>{l(t,this.prevOriginStyleMap.get(t)),this.prevOriginStyleMap.delete(t)})),s.forEach((t=>{const e=i.getElement(t);null==e||e.update({})})),this.prevMagnifiedStyleMap=t,e.forEach(((t,e)=>{this.prevOriginStyleMap.has(e)||this.prevOriginStyleMap.set(e,t)}))},this.isWheelValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;const{clientX:e,clientY:n}=t;return!(qh(this.context.graph.getCanvasByClient([e,n]),this.lens.getCenter())>this.r)},this.scaleR=t=>{const{maxR:e,minR:n}=this.options,i=t?1/.95:.95,r=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(n||0,Math.min(e||r,this.r*i))},this.scaleD=t=>{const{maxD:e,minD:n}=this.options,i=t?this.d+.1:this.d-.1;this.d=Math.max(n,Math.min(e,i))},this.scaleRByWheel=t=>{if(!this.isWheelValid(t))return;const{deltaX:e,deltaY:n}=t;this.scaleR(e+n>0);const i=this.lens.getCenter();this.onMagnify(i)},this.scaleDByWheel=t=>{if(!this.isWheelValid(t))return;const{deltaX:e,deltaY:n}=t;this.scaleD(e+n>0);const i=this.lens.getCenter();this.onMagnify(i)},this.isDragValid=t=>(this.options.preventDefault&&t.preventDefault(),!!this.isLensOn&&!(qh(cd(t.canvas),this.lens.getCenter())>this.r)),this.isLensDragging=!1,this.onDragStart=t=>{this.isDragValid(t)&&(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;const e=cd(t.canvas);this.onMagnify(e)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=t=>{if(!this.isLensDragging)return;const{dx:e,dy:n}=t;this.scaleR(e-n>0);const i=this.lens.getCenter();this.onMagnify(i)},this.scaleDByDrag=t=>{if(!this.isLensDragging)return;const{dx:e,dy:n}=t;this.scaleD(e-n>0);const i=this.lens.getCenter();this.onMagnify(i)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:i,scaleDBy:r}=this.options,a=e.getCanvas().getLayer();if(["click","drag"].includes(n)&&a.addEventListener(ic.CLICK,this.onCreateFisheye),"pointermove"===n&&a.addEventListener(ic.POINTER_MOVE,this.onCreateFisheye),"drag"===n||"drag"===i||"drag"===r){a.addEventListener(ic.DRAG_START,this.onDragStart),a.addEventListener(ic.DRAG_END,this.onDragEnd);const t="drag"===n?this.onDrag:"drag"===i?this.scaleRByDrag:this.scaleDByDrag;a.addEventListener(ic.DRAG,t)}if("wheel"===i||"wheel"===r){const e="wheel"===i?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.addEventListener(ic.WHEEL,e,{passive:!1})}}unbindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:i,scaleDBy:r}=this.options,a=e.getCanvas().getLayer();if(["click","drag"].includes(n)&&a.removeEventListener(ic.CLICK,this.onCreateFisheye),"pointermove"===n&&a.removeEventListener(ic.POINTER_MOVE,this.onCreateFisheye),"drag"===n||"drag"===i||"drag"===r){a.removeEventListener(ic.DRAG_START,this.onDragStart),a.removeEventListener(ic.DRAG_END,this.onDragEnd);const t="drag"===n?this.onDrag:"drag"===i?this.scaleRByDrag:this.scaleDByDrag;a.removeEventListener(ic.DRAG,t)}if("wheel"===i||"wheel"===r){const e="wheel"===i?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.removeEventListener(ic.WHEEL,e)}}update(t){var e,n;this.unbindEvents(),super.update(t),this.r=null!==(e=t.r)&&void 0!==e?e:this.r,this.d=null!==(n=t.d)&&void 0!==n?n:this.d,this.bindEvents()}destroy(){var t;this.unbindEvents(),this.isLensOn&&(null===(t=this.lens)||void 0===t||t.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}PE.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class CE extends Ox{constructor(t,e){super(t,Object.assign({},CE.defaultOptions,e)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var t,e,n,i;const r=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(r),r?null===(e=(t=this.options).onEnter)||void 0===e||e.call(t):null===(i=(n=this.options).onExit)||void 0===i||i.call(n)},this.shortcut=new Md(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML="\n      :not(:root):fullscreen::backdrop {\n        background: transparent;\n      }\n    "}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:t=[],exit:e=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(e,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach((t=>{document.addEventListener(t,this.onFullscreenChange,!1)}))}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach((t=>{document.removeEventListener(t,this.onFullscreenChange,!1)}))}setGraphSize(t=!0){var e,n;let i,r;t?(i=(null===(e=globalThis.screen)||void 0===e?void 0:e.width)||0,r=(null===(n=globalThis.screen)||void 0===n?void 0:n.height)||0,this.graphSize=this.context.graph.getSize()):[i,r]=this.graphSize,this.context.graph.setSize(i,r),this.context.graph.render()}request(){!document.fullscreenElement&&(document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled"))&&this.$el.requestFullscreen().catch((t=>{gc.warn(`Error attempting to enable full-screen: ${t.message} (${t.name})`)}))}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}CE.defaultOptions={trigger:{},autoFit:!0};class RE extends Ox{constructor(t,e){super(t,Object.assign({},RE.defaultOptions,e)),this.$element=Px("grid-line",!0),this.offset=[0,0],this.currentScale=1,this.followZoom=t=>{const{data:{scale:e,origin:n}}=t;if(!e)return;const i=this.currentScale;this.currentScale=e;const r=e/i,a=Yh(n||this.context.graph.getCanvasCenter(),1-r),o=this.baseSize*e,s=Uh(td(Yh(this.offset,r),o),a);this.$element.style.backgroundSize=`${o}px ${o}px`,this.$element.style.backgroundPosition=`${s[0]}px ${s[1]}px`,this.offset=td(s,o)},this.followTranslate=t=>{if(!this.options.follow)return;const{data:{translate:e}}=t;e&&this.updateOffset(e)},this.onTransform=t=>{const e=this.parseFollow(this.options.follow);e.zoom&&this.followZoom(t),e.translate&&this.followTranslate(t)},this.context.canvas.getContainer().prepend(this.$element),this.baseSize=this.options.size,this.updateStyle(),this.bindEvents()}update(t){super.update(t),void 0!==t.size&&(this.baseSize=t.size),this.updateStyle()}bindEvents(){const{graph:t}=this.context;t.on(oc.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{stroke:t,lineWidth:e,border:n,borderLineWidth:i,borderStroke:r,borderStyle:a}=this.options,o=this.baseSize*this.currentScale;Object.assign(this.$element.style,{border:n?`${i}px ${a} ${r}`:"none",backgroundImage:`linear-gradient(${t} ${e}px, transparent ${e}px), linear-gradient(90deg, ${t} ${e}px, transparent ${e}px)`,backgroundSize:`${o}px ${o}px`,backgroundRepeat:"repeat"})}updateOffset(t){const e=this.baseSize*this.currentScale;this.offset=td(Uh(this.offset,t),e),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}parseFollow(t){var e,n;return pn(t)?{translate:t,zoom:t}:{translate:null!==(e=null==t?void 0:t.translate)&&void 0!==e&&e,zoom:null!==(n=null==t?void 0:t.zoom)&&void 0!==n&&n}}destroy(){this.context.graph.off(oc.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}function LE(t){const e={Added:new Map,Updated:new Map,Removed:new Map};return t.forEach((t=>{const{type:n,value:i}=t,r=wh(i);if("NodeAdded"===n||"EdgeAdded"===n||"ComboAdded"===n)e.Added.set(r,t);else if("NodeUpdated"===n||"EdgeUpdated"===n||"ComboUpdated"===n)if(e.Added.has(r))e.Added.set(r,{type:n.replace("Updated","Added"),value:i});else if(e.Updated.has(r)){const{original:t}=e.Updated.get(r);e.Updated.set(r,{type:n,value:i,original:t})}else e.Removed.has(r)||e.Updated.set(r,t);else"NodeRemoved"!==n&&"EdgeRemoved"!==n&&"ComboRemoved"!==n||(e.Added.has(r)?e.Added.delete(r):e.Updated.has(r)?(e.Updated.delete(r),e.Removed.set(r,t)):e.Removed.set(r,t))})),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function DE(t){const{NodeAdded:e=[],NodeUpdated:n=[],NodeRemoved:i=[],EdgeAdded:r=[],EdgeUpdated:a=[],EdgeRemoved:o=[],ComboAdded:s=[],ComboUpdated:l=[],ComboRemoved:u=[]}=Pc(t,(t=>t.type));return{add:{nodes:e,edges:r,combos:s},update:{nodes:n,edges:a,combos:l},remove:{nodes:i,edges:o,combos:u}}}function IE(t,e){for(const n in t)vn(t[n])&&!Array.isArray(t[n])&&null!==t[n]?(e[n]||(e[n]={}),IE(t[n],e[n])):void 0===e[n]&&(e[n]=bc(n))}function _E(t,e=!1,n){const i={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:r,update:a,remove:o}=DE(LE(t));return["nodes","edges","combos"].forEach((t=>{a[t]&&a[t].forEach((e=>{var r,a;const o=Object.assign({},e.value);let s=Object.assign({},e.original);if(n){const t=n.graph.getElementType(wh(e.original)),i="edge"===t?"stroke":"fill",r=n.element.getElementComputedStyle(t,e.original);s=Object.assign(Object.assign({},e.original),{style:Object.assign({[i]:r[i]},e.original.style)})}IE(o,s),(r=i.current.update)[t]||(r[t]=[]),i.current.update[t].push(o),(a=i.original.update)[t]||(a[t]=[]),i.original.update[t].push(s)})),r[t]&&r[t].forEach((e=>{var n,r;const a=Object.assign({},e.value);(n=i.current.add)[t]||(n[t]=[]),i.current.add[t].push(a),(r=i.original.remove)[t]||(r[t]=[]),i.original.remove[t].push(a)})),o[t]&&o[t].forEach((e=>{var n,r;const a=Object.assign({},e.value);(n=i.current.remove)[t]||(n[t]=[]),i.current.remove[t].push(a),(r=i.original.add)[t]||(r[t]=[]),i.original.add[t].push(a)}))})),i}RE.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};class BE extends Ox{constructor(t,e){super(t,Object.assign({},BE.defaultOptions,e)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(t,e=!0)=>{var n,i,r;this.freezed=!0,null===(i=(n=this.options).executeCommand)||void 0===i||i.call(n,t);const a=e?t.original:t.current;this.context.graph.addData(a.add),this.context.graph.updateData(a.update),this.context.graph.removeData(Mh(a.remove,!1)),null===(r=this.context.element)||void 0===r||r.draw({silence:!0,animation:t.animation}),this.freezed=!1},this.addCommand=t=>{var e;if(!this.freezed){if(t.type===oc.AFTER_DRAW){const{dataChanges:n=[],animation:i=!0}=t.data;if(null===(e=this.context.batch)||void 0===e?void 0:e.isBatching){if(!this.batchChanges)return;return this.batchChanges.push(n),void(this.batchAnimation&&(this.batchAnimation=i))}this.batchChanges=[n],this.batchAnimation=i}this.undoStackPush(_E(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(sc.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=t=>{const{initiate:e}=t.data;this.batchAnimation=!1,e?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)},this.emitter=new bv;const{graph:n}=this.context;n.on(oc.AFTER_DRAW,this.addCommand),n.on(oc.BATCH_START,this.initBatchCommand),n.on(oc.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var t,e,n,i;const r=this.undoStack.pop();if(r){if(this.executeCommand(r),!1===(null===(e=(t=this.options).beforeAddCommand)||void 0===e?void 0:e.call(t,r,!1)))return;this.redoStack.push(r),null===(i=(n=this.options).afterAddCommand)||void 0===i||i.call(n,r,!1),this.notify(sc.UNDO,r)}return this}redo(){const t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(sc.REDO,t)),this}undoAndCancel(){const t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(sc.CANCEL,t)),this}undoStackPush(t){var e,n,i,r;const{stackSize:a}=this.options;0!==a&&this.undoStack.length>=a&&this.undoStack.shift(),!1!==(null===(n=(e=this.options).beforeAddCommand)||void 0===n?void 0:n.call(e,t,!0))&&(this.undoStack.push(t),null===(r=(i=this.options).afterAddCommand)||void 0===r||r.call(i,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(sc.CLEAR,null)}notify(t,e){this.emitter.emit(t,{cmd:e}),this.emitter.emit(sc.CHANGE,{cmd:e})}on(t,e){this.emitter.on(t,e)}destroy(){const{graph:t}=this.context;t.off(oc.AFTER_DRAW,this.addCommand),t.off(oc.BATCH_START,this.initBatchCommand),t.off(oc.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}BE.defaultOptions={stackSize:0};const FE={toXy(t,e){if(!e)return[...t];const n=e[0].slice(1),i=e[1].slice(1);return t.map((t=>[t[n],t[i]]))},fromXy(t,e){if(!e)return[...t];const n=e[0].slice(1),i=e[1].slice(1);return t.map((([t,e])=>({[n]:t,[i]:e})))}};class jE{constructor(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(const e of t){const t=this.coordToCellNum(e[0]),n=this.coordToCellNum(e[1]);this._cells[t]||(this._cells[t]=[]),this._cells[t][n]||(this._cells[t][n]=[]),this._cells[t][n].push(e)}}cellPoints(t,e){var n;return(null===(n=this._cells[t])||void 0===n?void 0:n[e])||[]}rangePoints(t){const e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),i=this.coordToCellNum(t[2]),r=this.coordToCellNum(t[3]),a=[];for(let t=e;t<=i;t++)for(let e=n;e<=r;e++){const n=this.cellPoints(t,e);for(const t of n)a.push(t)}return a}removePoint(t){const e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),i=this._cells[e][n],r=i.findIndex((([e,n])=>e===t[0]&&n===t[1]));return r>-1&&i.splice(r,1),i}trunc(t){return Math.trunc(t)}coordToCellNum(t){return this.trunc(t*this._reverseCellSize)}extendBbox(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}}const GE=+(Math.pow(2,27)+1);function zE(t,e,n){const i=t*e,r=GE*t,a=r-(r-t),o=t-a,s=GE*e,l=s-(s-e),u=e-l,c=o*u-(i-a*l-o*l-a*u);return n?(n[0]=c,n[1]=i,n):[c,i]}function VE(t,e,n){const i=t+e,r=i-t,a=e-r,o=t-(i-r);return n?(n[0]=o+a,n[1]=i,n):[o+a,i]}function WE(t,e){const n=t.length;if(1===n){const n=zE(t[0],e);return n[0]?n:[n[1]]}const i=new Array(2*n),r=[.1,.1],a=[.1,.1];let o=0;zE(t[0],e,r),r[0]&&(i[o++]=r[0]);for(let s=1;s<n;++s){zE(t[s],e,a),VE(r[1],a[0],r),r[0]&&(i[o++]=r[0]);const n=a[1],l=r[1],u=n+l,c=l-(u-n);r[1]=u,c&&(i[o++]=c)}return r[1]&&(i[o++]=r[1]),0===o&&(i[o++]=0),i.length=o,i}function UE(t,e){const n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){const n=t+e,i=n-t,r=t-(n-i)+(e-i);return r?[r,n]:[n]}(t[0],-e[0]);const r=new Array(n+i);let a=0,o=0,s=0;const l=Math.abs;let u,c,h=t[o],d=l(h),f=-e[s],p=l(f);d<p?(c=h,o+=1,o<n&&(h=t[o],d=l(h))):(c=f,s+=1,s<i&&(f=-e[s],p=l(f))),o<n&&d<p||s>=i?(u=h,o+=1,o<n&&(h=t[o],d=l(h))):(u=f,s+=1,s<i&&(f=-e[s],p=l(f)));let g,v,y,m,b,x=u+c,E=x-u,w=c-E,k=w,M=x;for(;o<n&&s<i;)d<p?(u=h,o+=1,o<n&&(h=t[o],d=l(h))):(u=f,s+=1,s<i&&(f=-e[s],p=l(f))),c=k,x=u+c,E=x-u,w=c-E,w&&(r[a++]=w),g=M+x,v=g-M,y=g-v,m=x-v,b=M-y,k=b+m,M=g;for(;o<n;)u=h,c=k,x=u+c,E=x-u,w=c-E,w&&(r[a++]=w),g=M+x,v=g-M,y=g-v,m=x-v,b=M-y,k=b+m,M=g,o+=1,o<n&&(h=t[o]);for(;s<i;)u=f,c=k,x=u+c,E=x-u,w=c-E,w&&(r[a++]=w),g=M+x,v=g-M,y=g-v,m=x-v,b=M-y,k=b+m,M=g,s+=1,s<i&&(f=-e[s]);return k&&(r[a++]=k),M&&(r[a++]=M),a||(r[a++]=0),r.length=a,r}function HE(t,e){const n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){const n=t+e,i=n-t,r=t-(n-i)+(e-i);return r?[r,n]:[n]}(t[0],e[0]);const r=new Array(n+i);let a=0,o=0,s=0;const l=Math.abs;let u,c,h=t[o],d=l(h),f=e[s],p=l(f);d<p?(c=h,o+=1,o<n&&(h=t[o],d=l(h))):(c=f,s+=1,s<i&&(f=e[s],p=l(f))),o<n&&d<p||s>=i?(u=h,o+=1,o<n&&(h=t[o],d=l(h))):(u=f,s+=1,s<i&&(f=e[s],p=l(f)));let g,v,y,m,b,x=u+c,E=x-u,w=c-E,k=w,M=x;for(;o<n&&s<i;)d<p?(u=h,o+=1,o<n&&(h=t[o],d=l(h))):(u=f,s+=1,s<i&&(f=e[s],p=l(f))),c=k,x=u+c,E=x-u,w=c-E,w&&(r[a++]=w),g=M+x,v=g-M,y=g-v,m=x-v,b=M-y,k=b+m,M=g;for(;o<n;)u=h,c=k,x=u+c,E=x-u,w=c-E,w&&(r[a++]=w),g=M+x,v=g-M,y=g-v,m=x-v,b=M-y,k=b+m,M=g,o+=1,o<n&&(h=t[o]);for(;s<i;)u=f,c=k,x=u+c,E=x-u,w=c-E,w&&(r[a++]=w),g=M+x,v=g-M,y=g-v,m=x-v,b=M-y,k=b+m,M=g,s+=1,s<i&&(f=e[s]);return k&&(r[a++]=k),M&&(r[a++]=M),a||(r[a++]=0),r.length=a,r}function YE(t,e,n,i){return function(n,r,a){const o=t(t(e(r[1],a[0]),e(-a[1],r[0])),t(e(n[1],r[0]),e(-r[1],n[0]))),s=t(e(n[1],a[0]),e(-a[1],n[0])),l=i(o,s);return l[l.length-1]}}function $E(t,e,n,i){return function(r,a,o,s){const l=t(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),a[2]),t(n(t(e(a[1],s[0]),e(-s[1],a[0])),-o[2]),n(t(e(a[1],o[0]),e(-o[1],a[0])),s[2]))),t(n(t(e(a[1],s[0]),e(-s[1],a[0])),r[2]),t(n(t(e(r[1],s[0]),e(-s[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),s[2])))),u=t(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),r[2]),t(n(t(e(r[1],s[0]),e(-s[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),s[2]))),t(n(t(e(a[1],o[0]),e(-o[1],a[0])),r[2]),t(n(t(e(r[1],o[0]),e(-o[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),o[2])))),c=i(l,u);return c[c.length-1]}}function XE(t,e,n,i){return function(r,a,o,s,l){const u=t(t(t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),o[2]),t(n(t(e(o[1],l[0]),e(-l[1],o[0])),-s[2]),n(t(e(o[1],s[0]),e(-s[1],o[0])),l[2]))),a[3]),t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),a[2]),t(n(t(e(a[1],l[0]),e(-l[1],a[0])),-s[2]),n(t(e(a[1],s[0]),e(-s[1],a[0])),l[2]))),-o[3]),n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),a[2]),t(n(t(e(a[1],l[0]),e(-l[1],a[0])),-o[2]),n(t(e(a[1],o[0]),e(-o[1],a[0])),l[2]))),s[3]))),t(n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),a[2]),t(n(t(e(a[1],s[0]),e(-s[1],a[0])),-o[2]),n(t(e(a[1],o[0]),e(-o[1],a[0])),s[2]))),-l[3]),t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),a[2]),t(n(t(e(a[1],l[0]),e(-l[1],a[0])),-s[2]),n(t(e(a[1],s[0]),e(-s[1],a[0])),l[2]))),r[3]),n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),l[2]))),-a[3])))),t(t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),l[2]))),s[3]),t(n(t(n(t(e(a[1],s[0]),e(-s[1],a[0])),r[2]),t(n(t(e(r[1],s[0]),e(-s[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),s[2]))),-l[3]),n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),a[2]),t(n(t(e(a[1],s[0]),e(-s[1],a[0])),-o[2]),n(t(e(a[1],o[0]),e(-o[1],a[0])),s[2]))),r[3]))),t(n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),r[2]),t(n(t(e(r[1],s[0]),e(-s[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),s[2]))),-a[3]),t(n(t(n(t(e(a[1],s[0]),e(-s[1],a[0])),r[2]),t(n(t(e(r[1],s[0]),e(-s[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),s[2]))),o[3]),n(t(n(t(e(a[1],o[0]),e(-o[1],a[0])),r[2]),t(n(t(e(r[1],o[0]),e(-o[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),o[2]))),-s[3]))))),c=t(t(t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),o[2]),t(n(t(e(o[1],l[0]),e(-l[1],o[0])),-s[2]),n(t(e(o[1],s[0]),e(-s[1],o[0])),l[2]))),r[3]),n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),l[2]))),-o[3])),t(n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),l[2]))),s[3]),n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),r[2]),t(n(t(e(r[1],s[0]),e(-s[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),s[2]))),-l[3]))),t(t(n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),a[2]),t(n(t(e(a[1],l[0]),e(-l[1],a[0])),-o[2]),n(t(e(a[1],o[0]),e(-o[1],a[0])),l[2]))),r[3]),n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),l[2]))),-a[3])),t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),l[2]))),o[3]),n(t(n(t(e(a[1],o[0]),e(-o[1],a[0])),r[2]),t(n(t(e(r[1],o[0]),e(-o[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),o[2]))),-l[3])))),h=i(u,c);return h[h.length-1]}}function qE(t){return(3===t?YE:4===t?$E:XE)(HE,zE,WE,UE)}const KE=qE(3),ZE=qE(4),QE=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){const i=(t[1]-n[1])*(e[0]-n[0]),r=(t[0]-n[0])*(e[1]-n[1]),a=i-r;let o;if(i>0){if(r<=0)return a;o=i+r}else{if(!(i<0))return a;if(r>=0)return a;o=-(i+r)}const s=33306690738754716e-32*o;return a>=s||a<=-s?a:KE(t,e,n)},function(t,e,n,i){const r=t[0]-i[0],a=e[0]-i[0],o=n[0]-i[0],s=t[1]-i[1],l=e[1]-i[1],u=n[1]-i[1],c=t[2]-i[2],h=e[2]-i[2],d=n[2]-i[2],f=a*u,p=o*l,g=o*s,v=r*u,y=r*l,m=a*s,b=c*(f-p)+h*(g-v)+d*(y-m),x=7771561172376103e-31*((Math.abs(f)+Math.abs(p))*Math.abs(c)+(Math.abs(g)+Math.abs(v))*Math.abs(h)+(Math.abs(y)+Math.abs(m))*Math.abs(d));return b>x||-b>x?b:ZE(t,e,n,i)}];function JE(t){let e=QE[t.length];return e||(e=QE[t.length]=qE(t.length)),e.apply(void 0,...t)}const tw=function(){for(;QE.length<=5;)QE.push(qE(QE.length));const t=function(t,e,n,i,r,a,o){return function(...e){switch(e.length){case 0:case 1:return 0;case 2:return i(e[0],e[1]);case 3:return r(e[0],e[1],e[2]);case 4:return a(e[0],e[1],e[2],e[3]);case 5:return o(e[0],e[1],e[2],e[3],e[4])}return t(e)}}(void 0,JE,...QE);for(let e=0;e<=5;++e)t[e]=QE[e];return t}(),ew=tw[3];function nw(t,e,n,i){const r=tw(t,n,i),a=tw(e,n,i);if(r>0&&a>0||r<0&&a<0)return!1;const o=tw(n,t,e),s=tw(i,t,e);return!(o>0&&s>0||o<0&&s<0)&&(0!==r||0!==a||0!==o||0!==s||function(t,e,n,i){for(let r=0;r<2;++r){const a=t[r],o=e[r],[s,l]=[Math.min(a,o),Math.max(a,o)],u=n[r],c=i[r],[h,d]=[Math.min(u,c),Math.max(u,c)];if(d<s||l<h)return!1}return!0}(t,e,n,i))}function iw(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function rw(t,e,n){const i=[e[0]-t[0],e[1]-t[1]],r=[n[0]-t[0],n[1]-t[1]],a=iw(t,e),o=iw(t,n);return(i[0]*r[0]+i[1]*r[1])/Math.sqrt(a*o)}function aw(t,e){for(let n=0;n<e.length-1;n++){const i=[e[n],e[n+1]];if(!(t[0][0]===i[0][0]&&t[0][1]===i[0][1]||t[0][0]===i[1][0]&&t[0][1]===i[1][1])&&nw(t[0],t[1],i[0],i[1]))return!0}return!1}function ow(t){return[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]}function sw(t,e,n){let i,r,a=null,o=cw,s=cw;for(let l=0;l<e.length;l++)i=rw(t[0],t[1],e[l]),r=rw(t[1],t[0],e[l]),i>o&&r>s&&!aw([t[0],e[l]],n)&&!aw([t[1],e[l]],n)&&(o=i,s=r,a=e[l]);return a}function lw(t,e,n,i,r){let a=!1;for(let o=0;o<t.length-1;o++){const s=[t[o],t[o+1]],l=s[0][0]+","+s[0][1]+","+s[1][0]+","+s[1][1];if(iw(s[0],s[1])<e||r.has(l))continue;let u,c,h,d=0,f=ow(s);do{f=i.extendBbox(f,d),u=f[2]-f[0],c=f[3]-f[1],h=sw(s,i.rangePoints(f),t),d++}while(null===h&&(n[0]>u||n[1]>c));u>=n[0]&&c>=n[1]&&r.add(l),null!==h&&(t.splice(o+1,0,h),i.removePoint(h),a=!0)}return a?lw(t,e,n,i,r):t}function uw(t,e,n){const i=e||20,r=function(t){const e=[t[0]];let n=t[0];for(let i=1;i<t.length;i++){const r=t[i];n[0]===r[0]&&n[1]===r[1]||e.push(r),n=r}return e}(function(t){return t.sort((function(t,e){return t[0]-e[0]||t[1]-e[1]}))}(FE.toXy(t,n)));if(r.length<4){const t=r.concat([r[0]]);return n?FE.fromXy(t,n):t}const a=function(t){let e=1/0,n=1/0,i=-1/0,r=-1/0;for(let a=t.length-1;a>=0;a--)t[a][0]<e&&(e=t[a][0]),t[a][1]<n&&(n=t[a][1]),t[a][0]>i&&(i=t[a][0]),t[a][1]>r&&(r=t[a][1]);return[i-e,r-n]}(r),o=[a[0]*hw,a[1]*hw],s=function(t){const e=t.length;if(e<3){const n=new Array(e);for(let t=0;t<e;++t)n[t]=t;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}const n=new Array(e);for(let t=0;t<e;++t)n[t]=t;n.sort(((e,n)=>t[e][0]-t[n][0]||t[e][1]-t[n][1]));const i=[n[0],n[1]],r=[n[0],n[1]];for(let a=2;a<e;++a){const e=n[a],o=t[e];let s=i.length;for(;s>1&&ew(t[i[s-2]],t[i[s-1]],o)<=0;)s-=1,i.pop();for(i.push(e),s=r.length;s>1&&ew(t[r[s-2]],t[r[s-1]],o)>=0;)s-=1,r.pop();r.push(e)}const a=new Array(r.length+i.length-2);let o=0;for(let t=0,e=i.length;t<e;++t)a[o++]=i[t];for(let t=r.length-2;t>0;--t)a[o++]=r[t];return a}(r).reverse().map((t=>r[t]));s.push(s[0]);const l=r.filter((function(t){return s.indexOf(t)<0})),u=Math.ceil(1/(r.length/(a[0]*a[1]))),c=lw(s,Math.pow(i,2),o,function(t,e){return new jE(t,e)}(l,u),new Set);return n?FE.fromXy(c,n):c}const cw=Math.cos(90/(180/Math.PI)),hw=.6,dw=(t,e,n)=>{const i=[e,e,0,0,0],r="sharp"===n?Uh(t[0],Xh(Zh(Hh(t[0],t[1])),e)):t[0],a="sharp"===n?Uh(t[1],Xh(Zh(Hh(t[1],t[0])),e)):t[1],o=Xh(Zh(Jh(Hh(r,a),!1)),e),s=Xh(o,-1),l=Uh(r,o),u=Uh(a,o),c=Uh(a,s),h=Uh(r,s);return"sharp"===n?[["M",l[0],l[1]],["L",u[0],u[1]],["L",c[0],c[1]],["L",h[0],h[1]],["Z"]]:[["M",l[0],l[1]],["L",u[0],u[1]],["A",...i,c[0],c[1]],["L",h[0],h[1]],["A",...i,l[0],l[1]]]};class fw extends Ox{constructor(t,e){super(t,Object.assign({},fw.defaultOptions,e)),this.hullMemberIds=[],this.drawHull=()=>{if(this.shape){const t=!Ku(this.optionsCache,this.options);this.shape.update(this.getHullStyle(t))}else this.shape=new lf({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);this.optionsCache=Object.assign({},this.options)},this.updateHullPath=t=>{this.shape&&this.options.members.includes(wh(t.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(t=!1)=>{const{graph:e}=this.context,n=this.getMember();if(0===n.length)return"";const i=n.map((t=>e.getNodeData(t))),r=uw(i.map(sd),this.options.concavity).slice(1).reverse(),a=r.flatMap((t=>i.filter((e=>Ku(sd(e),t))).map(wh)));return Ku(a,this.hullMemberIds)&&!t||(this.hullMemberIds=a,this.path=function(t,e,n){if(1===t.length)return((t,e,n)=>{if("sharp"===n)return[["M",t[0]-e,t[1]-e],["L",t[0]+e,t[1]-e],["L",t[0]+e,t[1]+e],["L",t[0]-e,t[1]+e],["Z"]];const i=[e,e,0,0,0];return[["M",t[0],t[1]-e],["A",...i,t[0],t[1]+e],["A",...i,t[0],t[1]-e]]})(t[0],e,n);if(2===t.length)return dw(t,e,n);if(3===t.length){const[i,r,a]=xd(t);if(gd(i,r,a))return dw([i,a],e,n)}switch(n){case"smooth":return((t,e)=>{const n=xd(t).map(((e,n)=>({p:e,v:Zh(Hh(t[(n+1)%t.length],e))})));return n.forEach(((i,r)=>{const a=r>0?r-1:t.length-1,o=n[a].v,s=Zh(Uh(o,Xh(i.v,Qh(o,i.v,!0)<Math.PI?1:-1)));i.p=Uh(i.p,Xh(s,e))})),sf(n.map((t=>t.p)))})(t,e);case"sharp":return((t,e)=>{const n=t.map(((n,i)=>{const r=t[0===i?t.length-1:i-1],a=nd(Xh(Zh(Jh(Hh(r,n),!1)),e));return[Uh(r,a),Uh(n,a)]})),i=n.flat();return i.map(((t,e)=>e%2==0?null:ad([i[(e-1)%i.length],i[e%i.length]],[i[(e+1)%i.length],i[(e+2)%i.length]],!0))).filter(Boolean).map(((t,e)=>[0===e?"M":"L",t[0],t[1]])).concat([["Z"]])})(t,e);default:return((t,e)=>{const n=xd(t).map(((n,i)=>{const r=(i-2+t.length)%t.length,a=(i-1+t.length)%t.length,o=(i+1)%t.length,s=t[r],l=t[a],u=t[o],c=Hh(s,l),h=Hh(l,n),d=Hh(n,u),f=(t,e)=>Qh(t,e,!0)<Math.PI,p=f(c,h),g=f(h,d),v=t=>Xh(Zh(Jh(t,!1)),e),y=v(h);return[{p:ed(Uh(l,p?v(c):y)),concave:p&&l},{p:ed(Uh(n,g?v(d):y)),concave:g&&n}]})),i=[e,e,0,0,0],r=n.findIndex(((t,e)=>!(n[(e-1+n.length)%n.length][0].concave||n[(e-1+n.length)%n.length][1].concave||t[0].concave||t[0].concave||t[1].concave))),a=n.slice(r).concat(n.slice(0,r));let o=[];return a.flatMap(((t,e)=>{const r=[],s=a[n.length-1];return 0===e&&r.push(["M",...s[1].p]),t[0].concave?o.push(t[0].p,t[1].p):r.push(["A",...i,...t[0].p]),t[1].concave?o.unshift(t[1].p):r.push(["L",...t[1].p]),3===o.length&&(r.pop(),r.push(["C",...o.flat()]),o=[]),r}))})(t,e)}}(r,this.getPadding(),this.options.corner)),this.path},this.bindEvents()}bindEvents(){this.context.graph.on(oc.AFTER_RENDER,this.drawHull),this.context.graph.on(oc.AFTER_ELEMENT_UPDATE,this.updateHullPath)}unbindEvents(){this.context.graph.off(oc.AFTER_RENDER,this.drawHull),this.context.graph.off(oc.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){const e=this.options,{members:n,padding:i,corner:r}=e,a=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["members","padding","corner"]);return Object.assign(Object.assign({},a),{d:this.getHullPath(t)})}getPadding(){const{graph:t}=this.context,e=this.hullMemberIds.reduce(((e,n)=>{const{halfExtents:i}=t.getElementRenderBounds(n),r=Math.max(i[0],i[1]);return Math.max(e,r)}),0);return e+this.options.padding}addMember(t){const e=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...e])],this.shape.update({d:this.getHullPath()})}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter((t=>!e.includes(t))),e.some((t=>this.hullMemberIds.includes(t)))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=gn(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.unbindEvents(),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}function pw(t,e){e(t),t.children&&t.children.forEach((function(t){t&&pw(t,e)}))}function gw(t){yw(t,!0)}function vw(t){yw(t,!1)}function yw(t,e){var n=e?"visible":"hidden";pw(t,(function(t){t.attr("visibility",n)}))}fw.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};var mw=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=5),Object.entries(e).forEach((function(r){var a=be(r,2),o=a[0],s=a[1],l=t;Object.prototype.hasOwnProperty.call(e,o)&&(s?jh(s)?(jh(t[o])||(l[o]={}),n<i?mw(t[o],s,n+1,i):l[o]=e[o]):$e(s)?(l[o]=[],l[o]=l[o].concat(s)):l[o]=s:l[o]=s)}))},bw=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0;i<e.length;i+=1)mw(t,e[i]);return t},xw=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=t.apply(this,xe([],be(e),!1))||this;return i.isMutationObserved=!0,i.addEventListener(Ts.INSERTED,(function(){vw(i)})),i}return pe(e,t),e}(wl);function Ew(t){var e=t.appendChild(new xw({class:"offscreen"}));return vw(e),e}function ww(){yw(this,"hidden"!==this.attributes.visibility)}var kw=function(t){function e(e,n){void 0===n&&(n={});var i=t.call(this,bw({},{style:n},e))||this;return i.initialized=!1,i._defaultOptions=n,i}return pe(e,t),Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=Ew(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;null===(t=this._offscreen)||void 0===t||t.destroy()},e.prototype.attributeChangedCallback=function(t){"visibility"===t&&ww.call(this)},e.prototype.update=function(t,e){var n;return this.attr(bw({},this.attributes,t||{})),null===(n=this.render)||void 0===n?void 0:n.call(this,this.attributes,this,e)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,e){},e.prototype.getSubShapeStyle=function(t){return t.x,t.y,t.transform,t.transformOrigin,t.class,t.className,t.zIndex,ve(t,["x","y","transform","transformOrigin","class","className","zIndex"])},e}(xl);function Mw(t){return t.toString().charAt(0).toUpperCase()+t.toString().slice(1)}function Sw(t,e,n){var i;void 0===n&&(n=!0);var r=e||(null===(i=t.match(/^([a-z][a-z0-9]+)/))||void 0===i?void 0:i[0])||"",a=t.replace(new RegExp("^(".concat(r,")")),"");return n?function(t){return t.toString().charAt(0).toLowerCase()+t.toString().slice(1)}(a):a}var Nw=function(t,e){if(!(null==t?void 0:t.startsWith(e)))return!1;var n=t[e.length];return n>="A"&&n<="Z"};function Tw(t,e,n){void 0===n&&(n=!1);var i={};return Object.entries(t).forEach((function(t){var r,a=be(t,2),o=a[0],s=a[1];if("className"===o||"class"===o);else if(Nw(o,"show")&&Nw(Sw(o,"show"),e)!==n)o===(r=e,"".concat("show").concat(Mw(r)))?i[o]=s:i[o.replace(new RegExp(Mw(e)),"")]=s;else if(!Nw(o,"show")&&Nw(o,e)!==n){var l=Sw(o,e);"filter"===l&&"function"==typeof s||(i[l]=s)}})),i}function Aw(t,e){return Object.entries(t).reduce((function(t,n){var i=be(n,2),r=i[0],a=i[1];return r.startsWith("show")?t["show".concat(e).concat(r.slice(4))]=a:t["".concat(e).concat(Mw(r))]=a,t}),{})}function Ow(t,e){void 0===e&&(e=["x","y","class","className"]);var n=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],i={},r={};return Object.entries(t).forEach((function(t){var a=be(t,2),o=a[0],s=a[1];e.includes(o)||(-1!==n.indexOf(o)?r[o]=s:i[o]=s)})),[i,r]}var Pw=function(t){function e(e){void 0===e&&(e={});var n=e.style,i=ve(e,["style"]);return t.call(this,ge({style:ge({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},n)},i))||this}return pe(e,t),Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=Ew(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;null===(t=this._offscreen)||void 0===t||t.destroy()},e}(_l),Cw=function(){function t(t,n,i,r,a,o,s){void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a=[null,null,null,null,null]),void 0===o&&(o=[]),void 0===s&&(s=[]),e.add(this),this._elements=Array.from(t),this._data=n,this._parent=i,this._document=r,this._enter=a[0],this._update=a[1],this._exit=a[2],this._merge=a[3],this._split=a[4],this._transitions=o,this._facetElements=s}var e,n,i;return t.prototype.selectAll=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t):t;return new n(e,null,this._elements[0],this._document)},t.prototype.selectFacetAll=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t):t;return new n(this._elements,null,this._parent,this._document,void 0,void 0,e)},t.prototype.select=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t)[0]||null:t;return new n([e],null,e,this._document)},t.prototype.append=function(t){var e=this,i="function"==typeof t?t:function(){return e.createElement(t)},r=[];if(null!==this._data){for(var a=0;a<this._data.length;a++){var o=this._data[a],s=be(Array.isArray(o)?o:[o,null],2),l=s[0],u=s[1];(h=i(l,a)).__data__=l,null!==u&&(h.__fromElements__=u),this._parent.appendChild(h),r.push(h)}return new n(r,null,this._parent,this._document)}for(a=0;a<this._elements.length;a++){var c=this._elements[a],h=i(l=c.__data__,a);c.appendChild(h),r.push(h)}return new n(r,null,r[0],this._document)},t.prototype.maybeAppend=function(t,n){var r=Ee(this,e,"m",i).call(this,"#"===t[0]?t:"#".concat(t),n);return r.attr("id",t),r},t.prototype.maybeAppendByClassName=function(t,n){var r=t.toString(),a=Ee(this,e,"m",i).call(this,"."===r[0]?r:".".concat(r),n);return a.attr("className",r),a},t.prototype.maybeAppendByName=function(t,n){var r=Ee(this,e,"m",i).call(this,'[name="'.concat(t,'"]'),n);return r.attr("name",t),r},t.prototype.data=function(t,e,i){var r,a;void 0===e&&(e=function(t){return t}),void 0===i&&(i=function(){return null});for(var o,s,l,u=[],c=[],h=new Set(this._elements),d=[],f=new Set,p=new Map(this._elements.map((function(t,n){return[e(t.__data__,n),t]}))),g=new Map(this._facetElements.map((function(t,n){return[e(t.__data__,n),t]}))),v=(o=this._elements,s=function(t){return i(t.__data__)},l=new Map,o.forEach((function(t){var e=s(t);l.has(e)||l.set(e,[]),l.get(e).push(t)})),l),y=0;y<t.length;y++){var m=t[y],b=e(m,y),x=i(m,y);if(p.has(b))(M=p.get(b)).__data__=m,M.__facet__=!1,c.push(M),h.delete(M),p.delete(b);else if(g.has(b))(M=g.get(b)).__data__=m,M.__facet__=!0,c.push(M),g.delete(b);else if(v.has(b)){var E=v.get(b);d.push([m,E]);try{for(var w=(r=void 0,me(E)),k=w.next();!k.done;k=w.next()){var M=k.value;h.delete(M)}}catch(t){r={error:t}}finally{try{k&&!k.done&&(a=w.return)&&a.call(w)}finally{if(r)throw r.error}}v.delete(b)}else p.has(x)?((M=p.get(x)).__toData__?M.__toData__.push(m):M.__toData__=[m],f.add(M),h.delete(M)):u.push(m)}var S=[new n([],u,this._parent,this._document),new n(c,null,this._parent,this._document),new n(h,null,this._parent,this._document),new n([],d,this._parent,this._document),new n(f,null,this._parent,this._document)];return new n(this._elements,null,this._parent,this._document,S)},t.prototype.merge=function(t){var e=xe(xe([],be(this._elements),!1),be(t._elements),!1),i=xe(xe([],be(this._transitions),!1),be(t._transitions),!1);return new n(e,null,this._parent,this._document,void 0,i)},t.prototype.createElement=function(t){if(this._document)return this._document.createElement(t,{});var e=n.registry[t];return e?new e:function(t){throw new Error(t)}("Unknown node type: ".concat(t))},t.prototype.join=function(t,e,n,i,r){void 0===t&&(t=function(t){return t}),void 0===e&&(e=function(t){return t}),void 0===n&&(n=function(t){return t.remove()}),void 0===i&&(i=function(t){return t}),void 0===r&&(r=function(t){return t.remove()});var a=t(this._enter),o=e(this._update),s=n(this._exit),l=i(this._merge),u=r(this._split);return o.merge(a).merge(s).merge(l).merge(u)},t.prototype.remove=function(){for(var t=function(t){var n=e._elements[t],i=e._transitions[t];i?i.then((function(){return n.remove()})):n.remove()},e=this,i=0;i<this._elements.length;i++)t(i);return new n([],null,this._parent,this._document,void 0,this._transitions)},t.prototype.each=function(t){for(var e=0;e<this._elements.length;e++){var n=this._elements[e],i=n.__data__;t.call(n,i,e)}return this},t.prototype.attr=function(t,e){var n="function"!=typeof e?function(){return e}:e;return this.each((function(i,r){void 0!==e&&(this[t]=n.call(this,i,r))}))},t.prototype.style=function(t,e,n){void 0===n&&(n=!0);var i="function"==typeof e&&n?e:function(){return e};return this.each((function(n,r){void 0!==e&&(this.style[t]=i.call(this,n,r))}))},t.prototype.styles=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=!0),this.each((function(n,i){var r=this;Object.entries(t).forEach((function(t){var a=be(t,2),o=a[0],s=a[1],l="function"==typeof s&&e?s:function(){return s};void 0!==s&&r.attr(o,l.call(r,n,i))}))}))},t.prototype.update=function(t,e){void 0===e&&(e=!0);var n="function"==typeof t&&e?t:function(){return t};return this.each((function(e,i){t&&this.update&&this.update(n.call(this,e,i))}))},t.prototype.maybeUpdate=function(t,e){void 0===e&&(e=!0);var n="function"==typeof t&&e?t:function(){return t};return this.each((function(e,i){t&&this.update&&this.update(n.call(this,e,i))}))},t.prototype.transition=function(t){this._transitions;var e=new Array(this._elements.length);return this.each((function(n,i){e[i]=t.call(this,n,i)})),this._transitions=function(t){if(!$e(t))return[];for(var e=[],n=0;n<t.length;n++)e=e.concat(t[n]);return e}(e),this},t.prototype.on=function(t,e){return this.each((function(){this.addEventListener(t,e)})),this},t.prototype.call=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.call.apply(t,xe([this._parent,this],be(e),!1)),this},t.prototype.node=function(){return this._elements[0]},t.prototype.nodes=function(){return this._elements},t.prototype.transitions=function(){return this._transitions.filter((function(t){return!!t}))},t.prototype.parent=function(){return this._parent},n=t,e=new WeakSet,i=function(t,e){var i=this._elements[0],r=i.querySelector(t);if(r)return new n([r],null,this._parent,this._document);var a="string"==typeof e?this.createElement(e):e();return i.appendChild(a),new n([a],null,this._parent,this._document)},t.registry={g:wl,rect:Dl,circle:ml,path:Ol,text:Pw,ellipse:El,image:Sl,line:Tl,polygon:Cl,polyline:Ll,html:Ml},t}();function Rw(t){return new Cw([t],null,t,t.ownerDocument)}var Lw=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=e,this.width=n,this.height=i}return Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},t.prototype.isPointIn=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},t}(),Dw=function(t,e){var n=function(t){return"".concat(e,"-").concat(t)},i=Object.fromEntries(Object.entries(t).map((function(t){var e=be(t,2),i=e[0],r=e[1],a=n(r);return[i,{name:a,class:".".concat(a),id:"#".concat(a),toString:function(){return a}}]})));return Object.assign(i,{prefix:n}),i};function Iw(t){if(le(t))return[t,t,t,t];if($e(t)){var e=t.length;if(1===e)return[t[0],t[0],t[0],t[0]];if(2===e)return[t[0],t[1],t[0],t[1]];if(3===e)return[t[0],t[1],t[2],t[1]];if(4===e)return t}return[0,0,0,0]}function _w(t,e,n,i,r){return void 0===i&&(i=!0),void 0===r&&(r=function(t){t.node().removeChildren()}),t?n(e):(i&&r(e),null)}var Bw=Dw({text:"text"},"title");function Fw(t){return/\S+-\S+/g.test(t)?t.split("-").map((function(t){return t[0]})):t.length>2?[t[0]]:t.split("")}function jw(t,e){var n=Object.entries(e).reduce((function(e,n){var i=be(n,2),r=i[0],a=i[1];return t.node().attr(r)||(e[r]=a),e}),{});t.styles(n)}var Gw=function(t){function e(e){return t.call(this,e,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return pe(e,t),e.prototype.getAvailableSpace=function(){var t=this.attributes,e=t.width,n=t.height,i=t.position,r=t.spacing,a=t.inset,o=this.querySelector(Bw.text.class);if(!o)return new Lw(0,0,+e,+n);var s=o.getBBox(),l=s.width,u=s.height,c=be(Iw(r),4),h=c[0],d=c[1],f=c[2],p=c[3],g=be([0,0,+e,+n],4),v=g[0],y=g[1],m=g[2],b=g[3],x=Fw(i);if(x.includes("i"))return new Lw(v,y,m,b);x.forEach((function(t,i){var r,a,o,s;"t"===t&&(r=be(0===i?[u+f,+n-u-f]:[0,+n],2),y=r[0],b=r[1]),"r"===t&&(a=be([+e-l-p],1),m=a[0]),"b"===t&&(o=be([+n-u-h],1),b=o[0]),"l"===t&&(s=be(0===i?[l+d,+e-l-d]:[0,+e],2),v=s[0],m=s[1])}));var E=be(Iw(a),4),w=E[0],k=E[1],M=E[2],S=E[3],N=be([S+k,w+M],2),T=N[0],A=N[1];return new Lw(v+S,y+w,m-T,b-A)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new Lw(0,0,0,0)},e.prototype.render=function(t,e){var n=this,i=(t.width,t.height,t.position,t.spacing,ve(t,["width","height","position","spacing"])),r=be(Ow(i),1)[0],a=function(t){var e,n,i,r,a=t,o=a.width,s=a.height,l=a.position,u=be([+o/2,+s/2],2),c=be([+u[0],+u[1],"center","middle"],4),h=c[0],d=c[1],f=c[2],p=c[3],g=Fw(l);return g.includes("l")&&(h=(e=be([0,"start"],2))[0],f=e[1]),g.includes("r")&&(h=(n=be([+o,"end"],2))[0],f=n[1]),g.includes("t")&&(d=(i=be([0,"top"],2))[0],p=i[1]),g.includes("b")&&(d=(r=be([+s,"bottom"],2))[0],p=r[1]),{x:h,y:d,textAlign:f,textBaseline:p}}(t),o=a.x,s=a.y,l=a.textAlign,u=a.textBaseline;_w(!!i.text,Rw(e),(function(t){n.title=t.maybeAppendByClassName(Bw.text,"text").styles(r).call(jw,{x:o,y:s,textAlign:l,textBaseline:u}).node()}))},e}(kw);const zw=function(){};function Vw(t,e){return gn(t)?t.apply(void 0,xe([],be(e),!1)):t}function Ww(t){if(!t)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],n=Object.fromEntries(Object.entries(t).filter((function(t){var n=be(t,1)[0];return!e.includes(n)})));return Object.fromEntries(e.map((function(e){return function(t){return"boolean"!=typeof t&&"enter"in t&&"update"in t&&"exit"in t}(t)?!1===t[e]?[e,!1]:[e,ge(ge({},t[e]),n)]:[e,n]})))}function Uw(t,e){t?t.finished.then(e):e()}function Hw(t,e){"update"in t?t.update(e):t.attr(e)}function Yw(t,e,n){return 0===e.length?null:n?t.animate(e,n):(Hw(t,{style:e.slice(-1)[0]}),null)}function $w(t,e,n){var i={},r={};return Object.entries(e).forEach((function(e){var n=be(e,2),a=n[0],o=n[1];if(!ce(o)){var s=t.style[a]||t.parsedStyle[a]||0;s!==o&&(i[a]=s,r[a]=o)}})),n?Yw(t,[i,r],ge({fill:"both"},n)):(Hw(t,r),null)}function Xw(t,e,n){void 0===n&&(n=!1);var i=t.getBBox(),r=i.width,a=i.height,o=e/Math.max(r,a);return n&&(t.style.transform="scale(".concat(o,")")),o}var qw=function(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]},Kw=qw,Zw=function(t,e,n){return[["M",t,e+n],["L",t,e-n]]},Qw=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},Jw=Qw,tk=Dw({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),ek=function(t){function e(e){var n,i,r,a=t.call(this,e,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:(n=0,i=0,r=6,[["M",n-r,i-r],["L",n+r,i],["L",n-r,i+r],["Z"]]),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(t,e){return"".concat(t,"/").concat(e)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return a.playState="idle",a.contentGroup=a.appendChild(new wl({class:tk.contentGroup.name})),a.playWindow=a.contentGroup.appendChild(new wl({class:tk.playWindow.name})),a.innerCurrPage=a.defaultPage,a}return pe(e,t),Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return de(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=be(function(t){var e;return(null===(e=t[0])||void 0===e?void 0:e.map((function(e,n){return t.map((function(t){return t[n]}))})))||[]}(this.pageViews.map((function(t){var e=t.getBBox();return[e.width,e.height]}))).map((function(t){return Math.max.apply(Math,xe([],be(t),!1))})),2),e=t[0],n=t[1],i=this.attributes,r=i.pageWidth,a=void 0===r?e:r,o=i.pageHeight;return{pageWidth:a,pageHeight:void 0===o?n:o}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var e=t.prototype.getBBox.call(this),n=e.x,i=e.y,r=this.controllerShape,a=this.pageShape,o=a.pageWidth,s=a.pageHeight;return new Lw(n,i,o+r.width,s)},e.prototype.goTo=function(t){var e=this,n=this.attributes.animate,i=this,r=i.currPage,a=i.playState,o=i.playWindow,s=i.pageViews;if("idle"!==a||t<0||s.length<=0||t>=s.length)return null;s[r].setLocalPosition(0,0),this.prepareFollowingPage(t);var l=be(this.getFollowingPageDiff(t),2),u=l[0],c=l[1];this.playState="running";var h=Yw(o,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-u,", ").concat(-c,")")}],n);return Uw(h,(function(){e.innerCurrPage=t,e.playState="idle",e.setVisiblePages([t]),e.updatePageInfo()})),h},e.prototype.prev=function(){var t=this.attributes.loop,e=this.pageViews.length,n=this.currPage;if(!t&&n<=0)return null;var i=t?(n-1+e)%e:de(n-1,0,e);return this.goTo(i)},e.prototype.next=function(){var t=this.attributes.loop,e=this.pageViews.length,n=this.currPage;if(!t&&n>=e-1)return null;var i=t?(n+1)%e:de(n+1,0,e);return this.goTo(i)},e.prototype.renderClipPath=function(t){var e=this.pageShape,n=e.pageWidth,i=e.pageHeight;n&&i?(this.clipPath=t.maybeAppendByClassName(tk.clipPath,"rect").styles({width:n,height:i}),this.contentGroup.attr("clipPath",this.clipPath.node())):this.contentGroup.style.clipPath=void 0},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach((function(e,n){t.includes(n)?gw(e):vw(e)}))},e.prototype.adjustControllerLayout=function(){var t=this,e=t.prevBtnGroup,n=t.nextBtnGroup,i=t.pageInfoGroup,r=this.attributes,a=r.orientation,o=r.controllerPadding,s=i.getBBox(),l=s.width,u=(s.height,be("horizontal"===a?[-180,0]:[-90,90],2)),c=u[0],h=u[1];e.setLocalEulerAngles(c),n.setLocalEulerAngles(h);var d=e.getBBox(),f=d.width,p=d.height,g=n.getBBox(),v=g.width,y=g.height,m=Math.max(f,l,v),b="horizontal"===a?{offset:[[0,0],[f/2+o,0],[f+l+2*o,0]],textAlign:"start"}:{offset:[[m/2,-p-o],[m/2,0],[m/2,y+o]],textAlign:"center"},x=be(b.offset,3),E=be(x[0],2),w=E[0],k=E[1],M=be(x[1],2),S=M[0],N=M[1],T=be(x[2],2),A=T[0],O=T[1],P=b.textAlign,C=i.querySelector("text");C&&(C.style.textAlign=P),e.setLocalPosition(w,k),i.setLocalPosition(S,N),n.setLocalPosition(A,O)},e.prototype.updatePageInfo=function(){var t,e=this,n=e.currPage,i=e.pageViews,r=e.attributes.formatter;i.length<2||(null===(t=this.pageInfoGroup.querySelector(tk.pageInfo.class))||void 0===t||t.attr("text",r(n+1,i.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var e=this.currPage;if(e===t)return[0,0];var n=this.attributes.orientation,i=this.pageShape,r=i.pageWidth,a=i.pageHeight,o=t<e?-1:1;return"horizontal"===n?[o*r,0]:[0,o*a]},e.prototype.prepareFollowingPage=function(t){var e=this.currPage,n=this.pageViews;if(this.setVisiblePages([t,e]),t!==e){var i=be(this.getFollowingPageDiff(t),2),r=i[0],a=i[1];n[t].setLocalPosition(r,a)}},e.prototype.renderController=function(t){var e=this,n=this.attributes.controllerSpacing,i=this.pageShape,r=i.pageWidth,a=i.pageHeight,o=this.pageViews.length>=2,s=t.maybeAppendByClassName(tk.controller,"g");if(yw(s.node(),o),o){var l=Tw(this.attributes,"button"),u=Tw(this.attributes,"pageNum"),c=be(Ow(l),2),h=c[0],d=c[1],f=h.size,p=ve(h,["size"]),g=!s.select(tk.prevBtnGroup.class).node(),v=s.maybeAppendByClassName(tk.prevBtnGroup,"g").styles(d);this.prevBtnGroup=v.node();var y=v.maybeAppendByClassName(tk.prevBtn,"path"),m=s.maybeAppendByClassName(tk.nextBtnGroup,"g").styles(d);this.nextBtnGroup=m.node(),[y,m.maybeAppendByClassName(tk.nextBtn,"path")].forEach((function(t){t.styles(ge(ge({},p),{transformOrigin:"center"})),Xw(t.node(),f,!0)}));var b=s.maybeAppendByClassName(tk.pageInfoGroup,"g");this.pageInfoGroup=b.node(),b.maybeAppendByClassName(tk.pageInfo,"text").styles(u),this.updatePageInfo(),s.node().setLocalPosition(r+n,a/2),g&&(this.prevBtnGroup.addEventListener("click",(function(){e.prev()})),this.nextBtnGroup.addEventListener("click",(function(){e.next()})))}},e.prototype.render=function(t,e){var n=t.x,i=void 0===n?0:n,r=t.y,a=void 0===r?0:r;this.attr("transform","translate(".concat(i,", ").concat(a,")"));var o=Rw(e);this.renderClipPath(o),this.renderController(o),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,e=fv((function(){return t.render(t.attributes,t)}),50);this.playWindow.addEventListener(Ts.INSERTED,e),this.playWindow.addEventListener(Ts.REMOVED,e)},e}(kw);var nk,ik=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),e.prototype.render=function(t,n){var i=t.x,r=void 0===i?0:i,a=t.y,o=void 0===a?0:a,s=this.getSubShapeStyle(t),l=s.symbol,u=s.size,c=void 0===u?16:u,h=ve(s,["symbol","size"]),d=function(t){var e=function(t){var e="default";if(vn(t)&&t instanceof Image)e="image";else if(gn(t))e="symbol";else if(he(t)){var n=new RegExp("data:(image|text)");e=t.match(n)?"base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(t)?"url":"symbol"}return e}(t);return["base64","url","image"].includes(e)?"image":t&&"symbol"===e?"path":null}(l);_w(!!d,Rw(n),(function(t){t.maybeAppendByClassName("marker",d).attr("className","marker ".concat(d,"-marker")).call((function(t){if("image"===d){var n=2*c;t.styles({img:l,width:n,height:n,x:r-c,y:o-c})}else{n=c/2;var i=gn(l)?l:e.getSymbol(l);t.styles(ge({d:null==i?void 0:i(r,o,n)},h))}}))}))},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,n){e.MARKER_SYMBOL_MAP.set(t,n)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(kw);function rk(t,e,n){return void 0===t&&(t="horizontal"),"horizontal"===t?e:n}function ak(t){var e=t.getLocalBounds(),n=be([e.min,e.max],2),i=be(n[0],2),r=i[0],a=i[1],o=be(n[1],2),s=o[0],l=o[1];return{x:r,y:a,width:s-r,height:l-a,left:r,bottom:l,top:a,right:s}}function ok(t,e){var n=be(t,2),i=n[0],r=n[1],a=be(e,2),o=a[0],s=a[1];return i!==o&&r===s}function sk(t){return"function"==typeof t?t():he(t)||le(t)?new Pw({style:{text:String(t)}}):t}ik.registerSymbol("cross",(function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]})),ik.registerSymbol("hyphen",(function(t,e,n){return[["M",t-n,e],["L",t+n,e]]})),ik.registerSymbol("line",Zw),ik.registerSymbol("plus",(function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]})),ik.registerSymbol("tick",(function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]})),ik.registerSymbol("circle",qw),ik.registerSymbol("point",Kw),ik.registerSymbol("bowtie",(function(t,e,n){var i=n-1.5;return[["M",t-n,e-i],["L",t+n,e+i],["L",t+n,e-i],["L",t-n,e+i],["Z"]]})),ik.registerSymbol("hexagon",(function(t,e,n){var i=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+i,e-n/2],["L",t+i,e+n/2],["L",t,e+n],["L",t-i,e+n/2],["L",t-i,e-n/2],["Z"]]})),ik.registerSymbol("square",(function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]})),ik.registerSymbol("diamond",(function(t,e,n){return[["M",t-n,e],["L",t,e-n],["L",t+n,e],["L",t,e+n],["Z"]]})),ik.registerSymbol("triangle",(function(t,e,n){var i=n*Math.sin(1/3*Math.PI);return[["M",t-n,e+i],["L",t,e-i],["L",t+n,e+i],["Z"]]})),ik.registerSymbol("triangle-down",(function(t,e,n){var i=n*Math.sin(1/3*Math.PI);return[["M",t-n,e-i],["L",t+n,e-i],["L",t,e+i],["Z"]]})),ik.registerSymbol("line",Zw),ik.registerSymbol("dot",Qw),ik.registerSymbol("dash",Jw),ik.registerSymbol("smooth",(function(t,e,n){return[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]]})),ik.registerSymbol("hv",(function(t,e,n){return[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]]})),ik.registerSymbol("vh",(function(t,e,n){return[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]]})),ik.registerSymbol("hvh",(function(t,e,n){return[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]]})),ik.registerSymbol("vhv",(function(t,e){return[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]]})),ik.registerSymbol("hiddenHandle",(function(t,e,n){var i=1.4*n;return[["M",t-n,e-i],["L",t+n,e-i],["L",t+n,e+i],["L",t-n,e+i],["Z"]]})),ik.registerSymbol("verticalHandle",(function(t,e,n){var i=1.4*n,r=n/2,a=n/6,o=t+.4*i;return[["M",t,e],["L",o,e+r],["L",t+i,e+r],["L",t+i,e-r],["L",o,e-r],["Z"],["M",o,e+a],["L",t+i-2,e+a],["M",o,e-a],["L",t+i-2,e-a]]})),ik.registerSymbol("horizontalHandle",(function(t,e,n){var i=1.4*n,r=n/2,a=n/6,o=e+.4*i;return[["M",t,e],["L",t-r,o],["L",t-r,e+i],["L",t+r,e+i],["L",t+r,o],["Z"],["M",t-a,o],["L",t-a,e+i-2],["M",t+a,o],["L",t+a,e+i-2]]}));var lk,uk=wx((function(t,e){var n=e.fontSize,i=e.fontFamily,r=e.fontWeight,a=e.fontStyle,o=e.fontVariant;return nk||(nk=rl.offscreenCanvasCreator.getOrCreateContext(void 0)),nk.font=[a,o,r,"".concat(n,"px"),i].join(" "),nk.measureText(t).width}),(function(t,e){return[t,Object.values(e||ck(t)).join()].join("")}),4096),ck=function(t){var e=t.style.fontFamily||"sans-serif",n=t.style.fontWeight||"normal",i=t.style.fontStyle||"normal",r=t.style.fontVariant,a=t.style.fontSize;return{fontSize:a="object"==typeof a?a.value:a,fontFamily:e,fontWeight:n,fontStyle:i,fontVariant:r}};function hk(t){return"text"===t.nodeName?t:"g"===t.nodeName&&1===t.children.length&&"text"===t.children[0].nodeName?t.children[0]:null}function dk(t,e){var n=hk(t);n&&n.attr(e)}function fk(t,e,n){void 0===n&&(n="..."),dk(t,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:n})}function pk(t,e){for(var n in e)e.hasOwnProperty(n)&&"constructor"!==n&&void 0!==e[n]&&(t[n]=e[n])}var gk="component-poptip",vk="component-poptip-arrow",yk="component-poptip-text",mk=((lk={})[".".concat(gk)]={visibility:"visible",position:"absolute","background-color":"rgba(0, 0, 0)","box-shadow":"0px 0px 10px #aeaeae","border-radius":"3px",color:"#fff",opacity:.8,"font-size":"12px",padding:"4px 6px",display:"flex","justify-content":"center","align-items":"center","z-index":8,transition:"visibility 50ms"},lk[".".concat(yk)]={"text-align":"center"},lk[".".concat(gk,"[data-position='top']")]={transform:"translate(-50%, -100%)"},lk[".".concat(gk,"[data-position='left']")]={transform:"translate(-100%, -50%)"},lk[".".concat(gk,"[data-position='right']")]={transform:"translate(0, -50%)"},lk[".".concat(gk,"[data-position='bottom']")]={transform:"translate(-50%, 0)"},lk[".".concat(gk,"[data-position='top-left']")]={transform:"translate(0,-100%)"},lk[".".concat(gk,"[data-position='top-right']")]={transform:"translate(-100%,-100%)"},lk[".".concat(gk,"[data-position='left-top']")]={transform:"translate(-100%, 0)"},lk[".".concat(gk,"[data-position='left-bottom']")]={transform:"translate(-100%, -100%)"},lk[".".concat(gk,"[data-position='right-top']")]={transform:"translate(0, 0)"},lk[".".concat(gk,"[data-position='right-bottom']")]={transform:"translate(0, -100%)"},lk[".".concat(gk,"[data-position='bottom-left']")]={transform:"translate(0, 0)"},lk[".".concat(gk,"[data-position='bottom-right']")]={transform:"translate(-100%, 0)"},lk[".".concat(vk)]={width:"4px",height:"4px",transform:"rotate(45deg)","background-color":"rgba(0, 0, 0)",position:"absolute","z-index":-1},lk[".".concat(gk,"[data-position='top']")]={transform:"translate(-50%, calc(-100% - 5px))"},lk["[data-position='top'] .".concat(vk)]={bottom:"-2px"},lk[".".concat(gk,"[data-position='left']")]={transform:"translate(calc(-100% - 5px), -50%)"},lk["[data-position='left'] .".concat(vk)]={right:"-2px"},lk[".".concat(gk,"[data-position='right']")]={transform:"translate(5px, -50%)"},lk["[data-position='right'] .".concat(vk)]={left:"-2px"},lk[".".concat(gk,"[data-position='bottom']")]={transform:"translate(-50%, 5px)"},lk["[data-position='bottom'] .".concat(vk)]={top:"-2px"},lk[".".concat(gk,"[data-position='top-left']")]={transform:"translate(0, calc(-100% - 5px))"},lk["[data-position='top-left'] .".concat(vk)]={left:"10px",bottom:"-2px"},lk[".".concat(gk,"[data-position='top-right']")]={transform:"translate(-100%, calc(-100% - 5px))"},lk["[data-position='top-right'] .".concat(vk)]={right:"10px",bottom:"-2px"},lk[".".concat(gk,"[data-position='left-top']")]={transform:"translate(calc(-100% - 5px), 0)"},lk["[data-position='left-top'] .".concat(vk)]={right:"-2px",top:"8px"},lk[".".concat(gk,"[data-position='left-bottom']")]={transform:"translate(calc(-100% - 5px), -100%)"},lk["[data-position='left-bottom'] .".concat(vk)]={right:"-2px",bottom:"8px"},lk[".".concat(gk,"[data-position='right-top']")]={transform:"translate(5px, 0)"},lk["[data-position='right-top'] .".concat(vk)]={left:"-2px",top:"8px"},lk[".".concat(gk,"[data-position='right-bottom']")]={transform:"translate(5px, -100%)"},lk["[data-position='right-bottom'] .".concat(vk)]={left:"-2px",bottom:"8px"},lk[".".concat(gk,"[data-position='bottom-left']")]={transform:"translate(0, 5px)"},lk["[data-position='bottom-left'] .".concat(vk)]={top:"-2px",left:"8px"},lk[".".concat(gk,"[data-position='bottom-right']")]={transform:"translate(-100%, 5px)"},lk["[data-position='bottom-right'] .".concat(vk)]={top:"-2px",right:"8px"},lk);function bk(t){var e=t&&document.getElementById(t);return e||((e=document.createElement("div")).setAttribute("id",t),document.body.appendChild(e)),e}var xk=function(t){function e(n){var i=t.call(this,Vh({style:{id:"component-poptip"}},e.defaultOptions,n))||this;return i.visibility="visible",i.map=new Map,i.domStyles="",i.initShape(),i.render(i.attributes,i),i}return pe(e,t),Object.defineProperty(e.prototype,"visible",{get:function(){return"visible"===this.visibility},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){this.visibility=this.style.visibility,this.updatePoptipElement()},e.prototype.update=function(t){this.attr(Vh({},this.style,t)),this.render(this.attributes,this)},e.prototype.bind=function(t,e){var n=this;if(t){var i=this.style.text,r=function(r){var a,o,s,l=t,u=n.style,c=i;if(e){var h="function"==typeof e?e.call(null,r):e,d=h.html,f=h.target,p=ve(h,["html","target"]);a={},o=n.style,s=p,o&&pk(a,o),s&&pk(a,s),u=a,(f||!1===f)&&(l=f),"string"==typeof d&&(c=d)}var g=u.position,v=u.arrowPointAtCenter,y=u.follow,m=u.offset;if(l){var b=r,x=be(function(t,e,n,i,r,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),a)return[t,e];var o=n.getBoundingClientRect(),s=o.x,l=o.y,u=o.width,c=o.height;switch(i){case"top":return r?[s+u/2,l]:[t,l];case"left":return r?[s,l+c/2]:[s,e];case"bottom":return r?[s+u/2,l+c]:[t,l+c];case"right":return r?[s+u,l+c/2]:[s+u,e];case"top-right":case"right-top":return[s+u,l];case"left-bottom":case"bottom-left":return[s,l+c];case"right-bottom":case"bottom-right":return[s+u,l+c];default:return[s,l]}}(b.clientX,b.clientY,l,g,v,y),2),E=x[0],w=x[1];n.showTip(E,w,{text:c,position:g,offset:m})}else n.hideTip()},a=function(){n.hideTip()};t.addEventListener("mousemove",r),t.addEventListener("mouseleave",a),this.map.set(t,[r,a])}},e.prototype.unbind=function(t){if(this.map.has(t)){var e=be(this.map.get(t)||[],2),n=e[0],i=e[1];n&&t.removeEventListener("mousemove",n),i&&t.removeEventListener("mouseleave",i),this.map.delete(t)}},e.prototype.clear=function(){this.container.innerHTML=""},e.prototype.destroy=function(){var e,n=this;xe([],be(this.map.keys()),!1).forEach((function(t){return n.unbind(t)})),null===(e=this.container)||void 0===e||e.remove(),t.prototype.destroy.call(this)},e.prototype.showTip=function(t,e,n){var i=_d(n,"text");if((!i||"string"==typeof i)&&(this.applyStyles(),t&&e&&n)){var r=n.offset,a=n.position;if(a&&this.container.setAttribute("data-position",a),this.setOffsetPosition(t,e,r),"string"==typeof i){var o=this.container.querySelector(".".concat(yk));o&&(o.innerHTML=i)}this.visibility="visible",this.container.style.visibility="visible"}},e.prototype.hideTip=function(){this.visibility="hidden",this.container.style.visibility="hidden"},e.prototype.getContainer=function(){return this.container},e.prototype.getClassName=function(){var t=this.style.containerClassName;return"".concat(gk).concat(t?" ".concat(t):"")},e.prototype.initShape=function(){var t=this,e=this.style.id;this.container=function(t){var e,n,i=(e=bk,function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return n||(n=e.apply(void 0,t)),n})(t);return i}(e),this.container.className=this.getClassName(),this.container.addEventListener("mousemove",(function(){return t.showTip()})),this.container.addEventListener("mouseleave",(function(){return t.hideTip()}))},e.prototype.updatePoptipElement=function(){var t=this.container;this.clear();var e=this.style,n=e.id,i=e.template,r=e.text;this.container.setAttribute("id",n),this.container.className=this.getClassName();var a,o='<span class="'.concat(vk,'"></span>');t.innerHTML=o,he(i)?t.innerHTML+=i:i&&((a=i)instanceof Element||a instanceof Document)&&t.appendChild(i),r&&(t.getElementsByClassName(yk)[0].textContent=r),this.applyStyles(),this.container.style.visibility=this.visibility},e.prototype.applyStyles=function(){var t=bw({},mk,this.style.domStyles),e=Object.entries(t).reduce((function(t,e){var n=be(e,2),i=n[0],r=n[1],a=Object.entries(r).reduce((function(t,e){var n=be(e,2),i=n[0],r=n[1];return"".concat(t).concat(i,": ").concat(r,";")}),"");return"".concat(t).concat(i,"{").concat(a,"}")}),"");if(this.domStyles!==e){this.domStyles=e;var n=this.container.querySelector("style");n&&this.container.removeChild(n),(n=document.createElement("style")).innerHTML=e,this.container.appendChild(n)}},e.prototype.setOffsetPosition=function(t,e,n){void 0===n&&(n=this.style.offset);var i=be(n,2),r=i[0],a=void 0===r?0:r,o=i[1],s=void 0===o?0:o;this.container.style.left="".concat(t+a,"px"),this.container.style.top="".concat(e+s,"px")},e.tag="poptip",e.defaultOptions={style:{x:0,y:0,width:0,height:0,target:null,visibility:"hidden",text:"",position:"top",follow:!1,offset:[0,0],domStyles:mk,template:'<div class="'.concat(yk,'"></div>')}},e}(kw),Ek=Dw({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item"),wk={offset:[0,20],domStyles:{".component-poptip":{opacity:"1",padding:"8px 12px",background:"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"},".component-poptip-arrow":{display:"none"},".component-poptip-text":{color:"#000",lineHeight:"20px"}}},kk=function(t){function e(e){return t.call(this,e,{span:[1,1],marker:function(){return new ml({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return pe(e,t),Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return!!t&&("string"==typeof t||"number"==typeof t?""!==t:"function"==typeof t||""!==t.attr("text"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,e=this.valueGroup,n=this.attributes.markerSize,i=t.node().getBBox(),r=i.width,a=i.height,o=e.node().getBBox(),s=o.width,l=o.height;return{markerWidth:n,labelWidth:r,valueWidth:s,height:Math.max(n,a,l)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var e=be(Iw(t),2),n=e[0],i=e[1],r=this.showValue?i:0,a=n+r;return[n/a,r/a]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,e=this.attributes,n=e.markerSize,i=e.width,r=this.actualSpace,a=r.markerWidth,o=r.height,s=this.actualSpace,l=s.labelWidth,u=s.valueWidth,c=be(this.spacing,2),h=c[0],d=c[1];if(i){var f=i-n-h-d,p=be(this.span,2);l=(t=be([p[0]*f,p[1]*f],2))[0],u=t[1]}return{width:a+l+u+h+d,height:o,markerWidth:a,labelWidth:l,valueWidth:u}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var e=be(Iw(t),2),n=e[0],i=e[1];return this.showValue?[n,i]:[n,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,e=t.markerWidth,n=t.labelWidth,i=t.valueWidth,r=t.width,a=t.height,o=be(this.spacing,2),s=o[0];return{height:a,width:r,markerWidth:e,labelWidth:n,valueWidth:i,position:[e/2,e+s,e+n+s+o[1]]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t,e,n=(t=this.markerGroup.node(),(e=t.querySelector(Ek.marker.class))?e.style:{}),i=this.attributes,r=i.markerSize,a=i.markerStrokeWidth,o=void 0===a?n.strokeWidth:a,s=i.markerLineWidth,l=void 0===s?n.lineWidth:s,u=i.markerStroke,c=void 0===u?n.stroke:u,h=+(o||l||(c?1:0))*Math.sqrt(2),d=this.markerGroup.node().getBBox(),f=d.width,p=d.height;return(1-h/Math.max(f,p))*r},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var e=this,n=this.attributes.marker,i=Tw(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(Ek.markerGroup,"g").style("zIndex",0),_w(!!n,this.markerGroup,(function(){var t,r=e.markerGroup.node(),a=null===(t=r.childNodes)||void 0===t?void 0:t[0],o="string"==typeof n?new ik({style:{symbol:n},className:Ek.marker.name}):n();a?o.nodeName===a.nodeName?a instanceof ik?a.update(ge(ge({},i),{symbol:n})):(function(t,e){var n,i,r=e.attributes;try{for(var a=me(Object.entries(r)),o=a.next();!o.done;o=a.next()){var s=be(o.value,2),l=s[0],u=s[1];"id"!==l&&"className"!==l&&t.attr(l,u)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(a,o),Rw(a).styles(i)):(a.remove(),Rw(o).attr("className",Ek.marker.name).styles(i),r.appendChild(o)):(o instanceof ik||Rw(o).attr("className",Ek.marker.name).styles(i),r.appendChild(o)),e.markerGroup.node().scale(1/e.markerGroup.node().getScale()[0]);var s=Xw(e.markerGroup.node(),e.scaleSize,!0);e.markerGroup.node().style._transform="scale(".concat(s,")")}))},e.prototype.renderLabel=function(t){var e=Tw(this.attributes,"label"),n=e.text,i=ve(e,["text"]);this.labelGroup=t.maybeAppendByClassName(Ek.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(Ek.label,(function(){return sk(n)})).styles(i)},e.prototype.renderValue=function(t){var e=this,n=Tw(this.attributes,"value"),i=n.text,r=ve(n,["text"]);this.valueGroup=t.maybeAppendByClassName(Ek.valueGroup,"g").style("zIndex",0),_w(this.showValue,this.valueGroup,(function(){e.valueGroup.maybeAppendByClassName(Ek.value,(function(){return sk(i)})).styles(r)}))},e.prototype.createPoptip=function(){var t=this.attributes.poptip||{},e=(t.render,ve(t,["render"])),n=new xk({style:bw(wk,e)});return this.poptipGroup=n,n},e.prototype.bindPoptip=function(t){var e=this,n=this.attributes.poptip;n&&(this.poptipGroup||this.createPoptip()).bind(t,(function(){var t=e.attributes,i=t.labelText,r=t.valueText,a=t.markerFill,o="string"==typeof i?i:null==i?void 0:i.attr("text"),s="string"==typeof r?r:null==r?void 0:r.attr("text");if("function"==typeof n.render)return{html:n.render({label:o,value:s,color:a})};var l="";return"string"!=typeof o&&"number"!=typeof o||(l+='<div class="component-poptip-label">'.concat(o,"</div>")),"string"!=typeof s&&"number"!=typeof s||(l+='<div class="component-poptip-value">'.concat(s,"</div>")),{html:l}}))},e.prototype.renderPoptip=function(t){var e=this;this.attributes.poptip&&[t.maybeAppendByClassName(Ek.value,"g").node(),t.maybeAppendByClassName(Ek.label,"g").node()].forEach((function(t){t&&e.bindPoptip(t)}))},e.prototype.renderBackground=function(t){var e=this.shape,n=e.width,i=e.height,r=Tw(this.attributes,"background");this.background=t.maybeAppendByClassName(Ek.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(Ek.background,"rect").styles(ge({width:n,height:i},r))},e.prototype.adjustLayout=function(){var t=this.layout,e=t.labelWidth,n=t.valueWidth,i=t.height,r=be(t.position,3),a=r[0],o=r[1],s=r[2],l=i/2;this.markerGroup.styles({transform:"translate(".concat(a,", ").concat(l,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(o,", ").concat(l,")")}),fk(this.labelGroup.select(Ek.label.class).node(),Math.ceil(e)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(s,", ").concat(l,")")}),fk(this.valueGroup.select(Ek.value.class).node(),Math.ceil(n)))},e.prototype.render=function(t,e){var n=Rw(e),i=t.x,r=void 0===i?0:i,a=t.y,o=void 0===a?0:a;n.styles({transform:"translate(".concat(r,", ").concat(o,")")}),this.renderMarker(n),this.renderLabel(n),this.renderValue(n),this.renderBackground(n),this.renderPoptip(n),this.adjustLayout()},e}(kw),Mk=Dw({page:"item-page",navigator:"navigator",item:"item"},"items"),Sk=function(t,e,n){return void 0===n&&(n=!0),t?e(t):n},Nk=function(t){function e(e){var n=t.call(this,e,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:zw,mouseenter:zw,mouseleave:zw})||this;return n.navigatorShape=[0,0],n}return pe(e,t),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,e=t.gridRow,n=t.gridCol,i=t.data;if(!e&&!n)throw new Error("gridRow and gridCol can not be set null at the same time");return e&&n?[e,n]:e?[e,i.length]:[i.length,n]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,e=t.data,n=t.layout,i=t.poptip,r=Tw(this.attributes,"item"),a=e.map((function(t,a){var o=t.id,s=void 0===o?a:o,l=t.label,u=t.value;return{id:"".concat(s),index:a,style:ge({layout:n,labelText:l,valueText:u,poptip:i},Object.fromEntries(Object.entries(r).map((function(n){var i=be(n,2);return[i[0],Vw(i[1],[t,a,e])]}))))}}));return a},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,e=this.attributes,n=e.orientation,i=e.width,r=e.rowPadding,a=e.colPadding,o=be(this.navigatorShape,1)[0],s=be(this.grid,2),l=s[0],u=s[1],c=u*l,h=0;return this.pageViews.children.map((function(e,s){var d,f,p=Math.floor(s/c),g=s%c,v=t.ifHorizontal(u,l),y=[Math.floor(g/v),g%v];"vertical"===n&&y.reverse();var m=be(y,2),b=m[0],x=m[1],E=(i-o-(u-1)*a)/u,w=e.getBBox().height,k=be([0,0],2),M=k[0],S=k[1];return"horizontal"===n?(M=(d=be([h,b*(w+r)],2))[0],S=d[1],h=x===u-1?0:h+E+a):(M=(f=be([x*(E+a),h],2))[0],S=f[1],h=b===l-1?0:h+w+r),{page:p,index:s,row:b,col:x,pageIndex:g,width:E,height:w,x:M,y:S}}))},e.prototype.getFlexLayout=function(){var t=this.attributes,e=t.width,n=t.height,i=t.rowPadding,r=t.colPadding,a=be(this.navigatorShape,1)[0],o=be(this.grid,2),s=o[0],l=o[1],u=be([e-a,n],2),c=u[0],h=u[1],d=be([0,0,0,0,0,0,0,0],8),f=d[0],p=d[1],g=d[2],v=d[3],y=d[4],m=d[5],b=d[6],x=d[7];return this.pageViews.children.map((function(t,e){var n,a,o,u,d=t.getBBox(),E=d.width,w=d.height,k=0===b?0:r,M=b+k+E;return M<=c&&Sk(y,(function(t){return t<l}))?(n=be([b+k,x,M],3),f=n[0],p=n[1],b=n[2],{width:E,height:w,x:f,y:p,page:g,index:e,pageIndex:v++,row:m,col:y++}):(a=be([m+1,0,0,x+w+i],4),m=a[0],y=a[1],b=a[2],(x=a[3])+w<=h&&Sk(m,(function(t){return t<s}))?(o=be([b,x,E],3),f=o[0],p=o[1],b=o[2],{width:E,height:w,x:f,y:p,page:g,index:e,pageIndex:v++,row:m,col:y++}):(u=be([0,0,E,0,g+1,0,0,0],8),f=u[0],p=u[1],b=u[2],x=u[3],g=u[4],v=u[5],m=u[6],y=u[7],{width:E,height:w,x:f,y:p,page:g,index:e,pageIndex:v++,row:m,col:y++}))}))},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t="grid"===this.attributes.layout?this.getGridLayout:this.getFlexLayout,e=t.call(this);return e.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):e},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,e){return rk(this.attributes.orientation,t,e)},e.prototype.flattenPage=function(t){t.querySelectorAll(Mk.item.class).forEach((function(e){t.appendChild(e)})),t.querySelectorAll(Mk.page.class).forEach((function(e){t.removeChild(e).destroy()}))},e.prototype.renderItems=function(t){var e=this.attributes,n=e.click,i=e.mouseenter,r=e.mouseleave;this.flattenPage(t);var a=this.dispatchCustomEvent.bind(this);Rw(t).selectAll(Mk.item.class).data(this.renderData,(function(t){return t.id})).join((function(t){return t.append((function(t){var e=t.style;return new kk({style:e})})).attr("className",Mk.item.name).on("click",(function(){null==n||n(this),a("itemClick",{item:this})})).on("pointerenter",(function(){null==i||i(this),a("itemMouseenter",{item:this})})).on("pointerleave",(function(){null==r||r(this),a("itemMouseleave",{item:this})}))}),(function(t){return t.each((function(t){var e=t.style;this.update(e)}))}),(function(t){return t.remove()}))},e.prototype.relayoutNavigator=function(){var t,e=this.attributes,n=e.layout,i=e.width,r=(null===(t=this.pageViews.children[0])||void 0===t?void 0:t.getBBox().height)||0,a=be(this.navigatorShape,2),o=a[0],s=a[1];this.navigator.update("grid"===n?{pageWidth:i-o,pageHeight:r-s}:{})},e.prototype.adjustLayout=function(){var t,e,n=this,i=Object.entries((t=this.itemsLayout,e="page",t.reduce((function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t}),{}))).map((function(t){var e=be(t,2);return{page:e[0],layouts:e[1]}})),r=xe([],be(this.navigator.getContainer().children),!1);i.forEach((function(t){var e=t.layouts,i=n.pageViews.appendChild(new wl({className:Mk.page.name}));e.forEach((function(t){var e=t.x,n=t.y,a=t.index,o=t.width,s=t.height,l=r[a];i.appendChild(l),Bd(l,"__layout__",t),l.update({x:e,y:n,width:o,height:s})}))})),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var e=this.attributes.orientation,n=Tw(this.attributes,"nav"),i=bw({orientation:e},n),r=this;return t.selectAll(Mk.navigator.class).data(["nav"]).join((function(t){return t.append((function(){return new ek({style:i})})).attr("className",Mk.navigator.name).each((function(){r.navigator=this}))}),(function(t){return t.each((function(){this.update(i)}))}),(function(t){return t.remove()})),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,e){var n=this.attributes.data;if(n&&0!==n.length){var i=this.renderNavigator(Rw(e));this.renderItems(i.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,e){var n=new ys(t,{detail:e});this.dispatchEvent(n)},e}(kw),Tk=Dw({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),Ak={showLabel:!0,formatter:function(t){return t.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},Ok=(function(t){function e(e){return t.call(this,e,Ak)||this}pe(e,t),e.prototype.render=function(t,e){var n=Rw(e).maybeAppendByClassName(Tk.markerGroup,"g");this.renderMarker(n);var i=Rw(e).maybeAppendByClassName(Tk.labelGroup,"g");this.renderLabel(i)},e.prototype.renderMarker=function(t){var e=this,n=this.attributes,i=n.orientation,r=n.markerSymbol,a=void 0===r?rk(i,"horizontalHandle","verticalHandle"):r;_w(!!a,t,(function(t){var n=Tw(e.attributes,"marker"),i=ge({symbol:a},n);e.marker=t.maybeAppendByClassName(Tk.marker,(function(){return new ik({style:i})})).update(i)}))},e.prototype.renderLabel=function(t){var e=this,n=this.attributes,i=n.showLabel,r=n.orientation,a=n.spacing,o=void 0===a?0:a,s=n.formatter;_w(i,t,(function(t){var n,i=Tw(e.attributes,"label"),a=i.text,l=ve(i,["text"]),u=(null===(n=t.select(Tk.marker.class))||void 0===n?void 0:n.node().getBBox())||{},c=u.width,h=void 0===c?0:c,d=u.height,f=be(rk(r,[0,(void 0===d?0:d)+o,"center","top"],[h+o,0,"start","middle"]),4),p=f[0],g=f[1],v=f[2],y=f[3];t.maybeAppendByClassName(Tk.label,"text").styles(ge(ge({},l),{x:p,y:g,text:s(a).toString(),textAlign:v,textBaseline:y}))}))}}(kw),{showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12}),Pk=bw({},Ok,{}),Ck=(bw({},Ok,Aw(Ak,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),Dw({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend")),Rk=function(t){function e(e){return t.call(this,e,Pk)||this}return pe(e,t),e.prototype.renderTitle=function(t,e,n){var i=this.attributes,r=i.showTitle,a=i.titleText,o=be(Ow(Tw(this.attributes,"title")),2),s=o[0],l=o[1];this.titleGroup=t.maybeAppendByClassName(Ck.titleGroup,"g").styles(l);var u=ge(ge({width:e,height:n},s),{text:r?a:""});this.title=this.titleGroup.maybeAppendByClassName(Ck.title,(function(){return new Gw({style:u})})).update(u)},e.prototype.renderItems=function(t,e){var n=e.x,i=e.y,r=e.width,a=e.height,o=be(Ow(Tw(this.attributes,"title",!0)),2),s=o[0],l=o[1],u=ge(ge({},s),{width:r,height:a,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(Ck.itemsGroup,"g").styles(ge(ge({},l),{transform:"translate(".concat(n,", ").concat(i,")")}));var c=this;this.itemsGroup.selectAll(Ck.items.class).data(["items"]).join((function(t){return t.append((function(){return new Nk({style:u})})).attr("className",Ck.items.name).each((function(){c.items=Rw(this)}))}),(function(t){return t.update(u)}),(function(t){return t.remove()}))},e.prototype.adjustLayout=function(){if(this.attributes.showTitle){var t=this.title.node().getAvailableSpace(),e=t.x,n=t.y;this.itemsGroup.node().style.transform="translate(".concat(e,", ").concat(n,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,e=t.showTitle,n=t.width,i=t.height;return e?this.title.node().getAvailableSpace():new Lw(0,0,n,i)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var e,n,i=null===(e=this.title)||void 0===e?void 0:e.node(),r=null===(n=this.items)||void 0===n?void 0:n.node();return i&&r?function(t,e){var n=t.attributes,i=n.position,r=n.spacing,a=n.inset,o=n.text,s=t.getBBox(),l=e.getBBox(),u=Fw(i),c=be(Iw(o?r:0),4),h=c[0],d=c[1],f=c[2],p=c[3],g=be(Iw(a),4),v=g[0],y=g[1],m=g[2],b=g[3],x=be([p+d,h+f],2),E=x[0],w=x[1],k=be([b+y,v+m],2),M=k[0],S=k[1];if("l"===u[0])return new Lw(s.x,s.y,l.width+s.width+E+M,Math.max(l.height+S,s.height));if("t"===u[0])return new Lw(s.x,s.y,Math.max(l.width+M,s.width),l.height+s.height+w+S);var N=be([e.attributes.width||l.width,e.attributes.height||l.height],2),T=N[0],A=N[1];return new Lw(l.x,l.y,T+s.width+E+M,A+s.height+w+S)}(i,r):t.prototype.getBBox.call(this)},e.prototype.render=function(t,e){var n=this.attributes,i=n.width,r=n.height,a=n.x,o=void 0===a?0:a,s=n.y,l=void 0===s?0:s,u=Rw(e);e.style.transform="translate(".concat(o,", ").concat(l,")"),this.renderTitle(u,i,r),this.renderItems(u,this.availableSpace),this.adjustLayout()},e}(kw);function Lk(t){const{width:e,height:n,renderer:i}=t,r=function(t){var e;const{container:n,className:i,graphCanvas:r}=t;if(n)return"string"==typeof n?document.getElementById(n):n;const a=Px(i,!1),{width:o,height:s,containerStyle:l}=t,[u,c]=function(t){const{width:e,height:n,placement:i,graphCanvas:r}=t,[a,o]=r.getSize(),[s,l]=od(i);return[s*(a-e),l*(o-n)]}(t);return Object.assign(a.style,Object.assign({position:"absolute",left:u+"px",top:c+"px",width:o+"px",height:s+"px"},l)),null===(e=r.getContainer())||void 0===e||e.appendChild(a),a}(t);return[r,new Kl({width:e,height:n,container:r,renderer:i||new Fp})]}class Dk extends Ox{constructor(t,e){super(t,Object.assign({},Dk.defaultOptions,e)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{const{graph:t}=this.context;t.on(oc.AFTER_DRAW,this.createElement)},this.changeState=(t,e)=>{const{graph:n}=this.context,{typePrefix:i}=this,r=_d(t,[i,"id"]),a=_d(t,[i,"style","labelText"]),[o]=r.split("__"),s=this.fieldMap[o].get(a)||[];n.setElementState(Object.fromEntries(null==s?void 0:s.map((t=>[t,e]))))},this.click=t=>{if("hover"===this.options.trigger)return;const e=_d(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?(this.selectedItems=this.selectedItems.filter((t=>t!==e)),this.changeState(t,[])):(this.selectedItems.push(e),this.changeState(t,"selected"))},this.mouseleave=t=>{"click"!==this.options.trigger&&(this.selectedItems=[],this.changeState(t,[]))},this.mouseenter=t=>{if("click"===this.options.trigger)return;const e=_d(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?this.selectedItems=this.selectedItems.filter((t=>t!==e)):(this.selectedItems.push(e),this.changeState(t,"active"))},this.setFieldMap=(t,e,n)=>{if(!t)return;const i=this.fieldMap[n];if(i)if(i.has(t)){const n=i.get(t);n&&(n.push(e),i.set(t,n))}else i.set(t,[e])},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(t,e)=>{if(!t)return[];const{model:n,element:i}=this.context,{nodes:r,edges:a,combos:o}=n.getData(),s={},l=e=>gn(t)?t(e):t,u={node:"circle",edge:"line",combo:"rect"},c={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},h=(t,e)=>{t.forEach((t=>{const{id:n}=t,r=_d(t,["data",l(t)]),a=(null==i?void 0:i.getElementType(e,t))||"circle",o=((t,e)=>null==i?void 0:i.getElementComputedStyle(t,e))(e,t),h=("edge"===e?null==o?void 0:o.stroke:null==o?void 0:o.fill)||"#1783ff";n&&r&&r.replace(/\s+/g,"")&&(this.setFieldMap(r,n,e),s[r]||(s[r]={id:`${e}__${n}`,label:r,marker:c[a]||u[e],elementType:e,lineWidth:1,stroke:h,fill:h}))}))};switch(e){case"node":h(r,"node");break;case"edge":h(a,"edge");break;case"combo":h(o,"combo");break;default:return[]}return Object.values(s)},this.createElement=()=>{if(this.draw)return void this.updateElement();const t=this.options,{width:e,height:n,nodeField:i,edgeField:r,comboField:a,trigger:o,position:s,container:l,containerStyle:u,className:c}=t,h=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(t,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),d=this.getMarkerData(i,"node"),f=this.getMarkerData(r,"edge"),p=this.getMarkerData(a,"combo"),g=[...d,...p,...f],v=Object.assign({width:e,height:n,data:g,itemMarkerLineWidth:({lineWidth:t})=>t,itemMarker:({marker:t})=>t,itemMarkerStroke:({stroke:t})=>t,itemMarkerFill:({fill:t})=>t,gridCol:d.length},h,this.getEvents()),y=new Rk({className:"legend",style:v});this.category=y,this.upsertCanvas().appendChild(y),this.draw=!0},this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t,e;null===(t=this.canvas)||void 0===t||t.destroy(),null===(e=this.container)||void 0===e||e.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5,itemLabelOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;const t=this.context.canvas,[e,n]=t.getSize(),{width:i=e,height:r=n,position:a,container:o,containerStyle:s,className:l}=this.options,[u,c]=Lk({width:i,height:r,graphCanvas:t,container:o,containerStyle:s,placement:a,className:"legend"});return this.container=u,l&&u.classList.add(l),this.canvas=c,this.canvas}destroy(){this.clear(),this.context.graph.off(oc.AFTER_DRAW,this.createElement),super.destroy()}}Dk.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class Ik extends Ox{constructor(t,e){super(t,Object.assign({},Ik.defaultOptions,e)),this.onDraw=t=>{var e;(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.render)||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=t=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(t.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=t=>{if(!this.mask||!this.isMaskDragging)return;const{size:[e,n]}=this.options,{movementX:i,movementY:r}=t,{left:a,top:o,width:s,height:l}=this.mask.style,[,,u,c]=this.maskBBox;let h=parseInt(a)+i,d=parseInt(o)+r,f=parseInt(s),p=parseInt(l);h<0&&(h=0),d<0&&(d=0),h+f>e&&(h=Bk(e-f,0)),d+p>n&&(d=Bk(n-p,0)),f<u&&(i>0?(h=Bk(h-i,0),f=_k(f+i,e)):i<0&&(f=_k(f-i,e))),p<c&&(r>0?(d=Bk(d-r,0),p=_k(p+r,n)):r<0&&(p=_k(p-r,n))),Object.assign(this.mask.style,{left:h+"px",top:d+"px",width:f+"px",height:p+"px"});const g=parseInt(a)-h,v=parseInt(o)-d;if(0===g&&0===v)return;const y=this.context.canvas.getCamera().getZoom()/this.canvas.getCamera().getZoom();this.context.graph.translateBy([g*y,v*y],!1)},this.onMaskDragEnd=t=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(t.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=Cc((()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())}),32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),"delay"in t&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=fv((()=>{this.renderMinimap(),this.renderMask()}),this.options.delay)}bindEvents(){const{graph:t}=this.context;t.on(oc.AFTER_DRAW,this.onDraw),t.on(oc.AFTER_RENDER,this.onRender),t.on(oc.AFTER_ANIMATE,this.onRender),t.on(oc.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(oc.AFTER_DRAW,this.onDraw),t.off(oc.AFTER_RENDER,this.onRender),t.off(oc.AFTER_ANIMATE,this.onRender),t.off(oc.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}getElements(){const{filter:t}=this.options,{model:e,element:n}=this.context,i=e.getData(),r={nodes:i.nodes.filter((t=>null==n?void 0:n.getElement(wh(t)))),edges:i.edges.filter((t=>{const e=null==n?void 0:n.getElement(wh(t));return e&&rv(e)})),combos:i.combos.filter((t=>null==n?void 0:n.getElement(wh(t))))};if(!t)return r;const{nodes:a,edges:o,combos:s}=r;return{nodes:a.filter((e=>t(wh(e),"node"))),edges:o.filter((e=>t(wh(e),"edge"))),combos:s.filter((e=>t(wh(e),"combo")))}}setShapes(t,e){const{nodes:n,edges:i,combos:r}=e,{shape:a}=this.options,{element:o}=this.context;if("key"===a){const e=new Set,a=n=>{const i=wh(n);e.add(i);const r=o.getElement(i);if(!r)return;const a=r.getShape("key"),s=this.shapes.get(i)||a.cloneNode();s.setPosition(a.getPosition()),r.style.zIndex&&(s.style.zIndex=r.style.zIndex),s.id=r.id,this.shapes.has(i)?Object.entries(a.attributes).forEach((([t,e])=>{s.style[t]!==e&&(s.style[t]=e)})):(t.appendChild(s),this.shapes.set(i,s))};return i.forEach(a),r.forEach(a),n.forEach(a),void this.shapes.forEach(((n,i)=>{e.has(i)||(t.removeChild(n),this.shapes.delete(i))}))}const s=(t,e)=>{const n=o.getElement(t).getPosition();return e.setPosition(n),e};t.removeChildren(),i.forEach((e=>t.appendChild(a(wh(e),"edge")))),r.forEach((e=>{t.appendChild(s(wh(e),a(wh(e),"combo")))})),n.forEach((e=>{t.appendChild(s(wh(e),a(wh(e),"node")))}))}initCanvas(){const{renderer:t,size:[e,n]}=this.options;if(this.canvas){const{width:i,height:r}=this.canvas.getConfig();e===i&&n===r||this.canvas.resize(e,n),t&&this.canvas.setRenderer(t)}else{const{className:i,position:r,container:a,containerStyle:o}=this.options,[s,l]=Lk({renderer:t,width:e,height:n,placement:r,className:"minimap",container:a,containerStyle:o,graphCanvas:this.context.canvas});i&&s.classList.add(i),this.container=s,this.canvas=l}return this.setCamera(),this.canvas}createLandmark(t,e,n){const i=`${t.join(",")}-${e.join(",")}-${n}`;if(this.landmarkMap.has(i))return this.landmarkMap.get(i);const r=this.canvas.getCamera().createLandmark(i,{position:t,focalPoint:e,zoom:n});return this.landmarkMap.set(i,r),r}setCamera(){var t;const{canvas:e}=this.context,n=null===(t=this.canvas)||void 0===t?void 0:t.getCamera();if(!n)return;const{size:[i,r],padding:a}=this.options,[o,s,l,u]=_c(a),{min:c,max:h,center:d}=e.getBounds("elements"),f=(i-u-s)/(h[0]-c[0]),p=(r-o-l)/(h[1]-c[1]),g=Math.min(f,p),v=this.createLandmark(d,d,g);n.gotoLandmark(v,0)}get maskBBox(){const{canvas:t}=this.context,e=t.getSize(),n=t.getCanvasByViewport([0,0]),i=t.getCanvasByViewport(e),r=this.canvas.canvas2Viewport(hd(n)),a=this.canvas.canvas2Viewport(hd(i)),o=a.x-r.x,s=a.y-r.y;return[r.x,r.y,o,s]}calculateMaskBBox(){const{size:[t,e]}=this.options;let[n,i,r,a]=this.maskBBox;return n<0&&(r=_k(r+n,t),n=0),i<0&&(a=_k(a+i,e),i=0),n+r>t&&(r=Bk(t-n,0)),i+a>e&&(a=Bk(e-i,0)),[_k(n,t),_k(i,e),Bk(r,0),Bk(a,0)]}renderMask(){const{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart),this.mask.draggable=!0,this.mask.addEventListener("dragstart",(t=>t.preventDefault&&t.preventDefault()))),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[t,e,n,i]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:e+"px",left:t+"px",width:n+"px",height:i+"px"})}destroy(){var t,e,n;this.unbindEvents(),null===(t=this.canvas)||void 0===t||t.destroy(),null===(e=this.mask)||void 0===e||e.remove(),null===(n=this.container)||void 0===n||n.remove(),super.destroy()}}Ik.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const _k=(t,e)=>Math.min(t,e),Bk=(t,e)=>Math.max(t,e);var Fk=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};const jk={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class Gk extends Ox{constructor(t,e){super(t,Object.assign({},Gk.defaultOptions,e)),this.initSnapline=()=>{const t=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=t.appendChild(new Tl({style:Object.assign(Object.assign({},jk),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=t.appendChild(new Tl({style:Object.assign(Object.assign({},jk),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(t,e,n)=>Fk(this,void 0,void 0,(function*(){const{verticalX:i,horizontalY:r}=n,{tolerance:a}=this.options,{min:[o,s],max:[l,u],center:[c,h]}=e;let d=0,f=0;null!==i&&(zk(l,i)<a&&(d=i-l),zk(o,i)<a&&(d=i-o),zk(c,i)<a&&(d=i-c),0!==d&&(this.isVerticalSticking=!0)),null!==r&&(zk(u,r)<a&&(f=r-u),zk(s,r)<a&&(f=r-s),zk(h,r)<a&&(f=r-h),0!==f&&(this.isHorizontalSticking=!0)),0===d&&0===f||(yield this.context.graph.translateElementBy({[t]:[d,f]},!1))})),this.enableSnap=t=>{const{target:e}=t,n=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[i,r]=this.getDelta(t);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(i)<=n&&Math.abs(r)<=n)return this.context.graph.translateElementBy({[e.id]:[-i,-r]},!1),!1;if(this.isHorizontalSticking&&Math.abs(r)<=n)return this.context.graph.translateElementBy({[e.id]:[0,-r]},!1),!1;if(this.isVerticalSticking&&Math.abs(i)<=n)return this.context.graph.translateElementBy({[e.id]:[-i,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout((()=>{this.enableStick=!0}),200)}return this.enableStick},this.calcSnaplineMetadata=(t,e)=>{const{tolerance:n,shape:i}=this.options,{min:[r,a],max:[o,s],center:[l,u]}=e;let c=null,h=null,d=null,f=null,p=null,g=null;return this.getNodes().some((e=>{if(Ku(t.id,e.id))return!1;const v=Vk(e,i).getRenderBounds(),{min:[y,m],max:[b,x],center:[E,w]}=v;return null===c&&(zk(E,l)<n?c=E:zk(y,r)<n||zk(y,o)<n?c=y:(zk(b,o)<n||zk(b,r)<n)&&(c=b),null!==c&&(h=Math.min(m,a),d=Math.max(x,s))),null===f&&(zk(w,u)<n?f=w:zk(m,a)<n||zk(m,s)<n?f=m:(zk(x,s)<n||zk(x,a)<n)&&(f=x),null!==f&&(p=Math.min(y,r),g=Math.max(b,o))),null!==c&&null!==f})),{verticalX:c,verticalMinY:h,verticalMaxY:d,horizontalY:f,horizontalMinX:p,horizontalMaxX:g}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=t=>Fk(this,void 0,void 0,(function*(){const{target:e}=t;if(this.options.autoSnap&&!this.enableSnap(t))return;const n=Vk(e,this.options.shape).getRenderBounds(),i=this.calcSnaplineMetadata(e,n);this.hideSnapline(),null===i.verticalX&&null===i.horizontalY||this.updateSnapline(i),this.options.autoSnap&&(yield this.autoSnapToLine(e.id,n,i))})),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var t;const{filter:e}=this.options,n=((null===(t=this.context.element)||void 0===t?void 0:t.getNodes())||[]).filter((t=>{var e;return rv(t)&&(null===(e=this.context.viewport)||void 0===e?void 0:e.isInViewport(t.getRenderBounds()))}));return e?n.filter((t=>e(t))):n}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){const{lineWidth:e}=this.options[`${t}LineStyle`];return+(e||jk.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){const{verticalX:e,verticalMinY:n,verticalMaxY:i,horizontalY:r,horizontalMinX:a,horizontalMaxX:o}=t,[s,l]=this.context.canvas.getSize(),{offset:u}=this.options;null!==r?Object.assign(this.horizontalLine.style,{x1:u===1/0?0:a-u,y1:r,x2:u===1/0?s:o+u,y2:r,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",null!==e?Object.assign(this.verticalLine.style,{x1:e,y1:u===1/0?0:n-u,x2:e,y2:u===1/0?l:i+u,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){const e=this.context.graph.getZoom();return $h([t.dx,t.dy],e)}bindEvents(){return Fk(this,void 0,void 0,(function*(){const{graph:t}=this.context;t.on(lc.DRAG_START,this.onDragStart),t.on(lc.DRAG,this.onDrag),t.on(lc.DRAG_END,this.onDragEnd)}))}unbindEvents(){const{graph:t}=this.context;t.off(lc.DRAG_START,this.onDragStart),t.off(lc.DRAG,this.onDrag),t.off(lc.DRAG_END,this.onDragEnd)}destroyElements(){var t,e;null===(t=this.horizontalLine)||void 0===t||t.destroy(),null===(e=this.verticalLine)||void 0===e||e.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}Gk.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const zk=(t,e)=>Math.abs(t-e),Vk=(t,e)=>"function"==typeof e?e(t):t.getShape(e);function Wk(t,e){var n={YYYY:t.getFullYear(),MM:t.getMonth()+1,DD:t.getDate(),HH:t.getHours(),mm:t.getMinutes(),ss:t.getSeconds()},i=e;return Object.keys(n).forEach((function(t){var e=n[t];i=i.replace(t,"YYYY"===t?"".concat(e):"".concat(e).padStart(2,"0"))})),i}var Uk={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new Ol({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},Hk=(Vh({},Uk,{style:{type:"arc"}}),Vh({},Uk,{style:{}}),Dw({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"));function Yk(t,e){return[t[0]*e,t[1]*e]}function $k(t,e){return[t[0]+e[0],t[1]+e[1]]}function Xk(t,e){return[t[0]-e[0],t[1]-e[1]]}function qk(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1])]}function Kk(t,e){return[Math.max(t[0],e[0]),Math.max(t[1],e[1])]}function Zk(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function Qk(t){if(0===t[0]&&0===t[1])return[0,0];var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return[t[0]/e,t[1]/e]}function Jk(t){return t*Math.PI/180}function tM(t){return Number((180*t/Math.PI).toPrecision(5))}function eM(t,e){return t.style.opacity||(t.style.opacity=1),$w(t,{opacity:0},e)}var nM=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function iM(t){return nM.includes(t)}function rM(t){var e={};for(var n in t)iM(n)&&(e[n]=t[n]);return e}var aM=Dw({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function oM(t){return t.reduce((function(t,e,n){return t.push(xe([0===n?"M":"L"],be(e),!1)),t}),[])}function sM(t,e,n){return"surround"===e.type?function(t,e,n){var i=e.connect,r=void 0===i?"line":i,a=e.center;if("line"===r)return oM(t);if(!a)return[];var o=Zk(t[0],a),s=n?0:1;return t.reduce((function(t,e,n){return 0===n?t.push(xe(["M"],be(e),!1)):t.push(xe(["A",o,o,0,0,s],be(e),!1)),t}),[])}(t,e,n):oM(t)}function lM(t,e,n){var i=n.type,r=n.connect,a=n.center,o=n.closed?[["Z"]]:[],s=be([sM(t,n),sM(e.slice().reverse(),n,!0)],2),l=s[0],u=s[1],c=be([t[0],e.slice(-1)[0]],2),h=c[0],d=c[1],f=function(t,e){return[l,t,u,e,o].flat()};if("line"===r||"surround"===i)return f([xe(["L"],be(d),!1)],[xe(["L"],be(h),!1)]);if(!a)throw new Error("Arc grid need to specified center");var p=be([Zk(d,a),Zk(h,a)],2),g=p[0],v=p[1];return f([xe(["A",g,g,0,0,1],be(d),!1),xe(["L"],be(d),!1)],[xe(["A",v,v,0,0,0],be(h),!1),xe(["L"],be(h),!1)])}var uM=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),e.prototype.render=function(t,e){t.type,t.center,t.areaFill,t.closed;var n=ve(t,["type","center","areaFill","closed"]),i=function(t){var e=t.data,n=void 0===e?[]:e;return t.closed?n.map((function(t){var e=t.points,n=be(e,1)[0];return ge(ge({},t),{points:xe(xe([],be(e),!1),[n],!1)})})):n}(t),r=Rw(e).maybeAppendByClassName(aM.lineGroup,"g"),a=Rw(e).maybeAppendByClassName(aM.regionGroup,"g"),o=function(t,e,n,i){var r=n.animate,a=n.isBillboard,o=e.map((function(t,e){return{id:t.id||"grid-line-".concat(e),d:sM(t.points,n)}}));return t.selectAll(aM.line.class).data(o,(function(t){return t.id})).join((function(t){return t.append("path").each((function(t,e){var n=Vw(rM(ge({d:t.d},i)),[t,e,o]);this.attr(ge({class:aM.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:a},n))}))}),(function(t){return t.transition((function(t,e){return $w(this,Vw(rM(ge({d:t.d},i)),[t,e,o]),r.update)}))}),(function(t){return t.transition((function(){var t=this,e=eM(this,r.exit);return Uw(e,(function(){return t.remove()})),e}))})).transitions()}(r,i,t,n),s=function(t,e,n){var i=n.animate,r=n.connect,a=n.areaFill;if(e.length<2||!a||!r)return[];for(var o=Array.isArray(a)?a:[a,"transparent"],s=function(t){return o[t%o.length]},l=[],u=0;u<e.length-1;u++){var c=be([e[u].points,e[u+1].points],2),h=lM(c[0],c[1],n);l.push({d:h,fill:s(u)})}return t.selectAll(aM.region.class).data(l,(function(t,e){return e})).join((function(t){return t.append("path").each((function(t,e){var n=Vw(t,[t,e,l]);this.attr(n)})).attr("className",aM.region.name)}),(function(t){return t.transition((function(t,e){return $w(this,Vw(t,[t,e,l]),i.update)}))}),(function(t){return t.transition((function(){var t=this,e=eM(this,i.exit);return Uw(e,(function(){return t.remove()})),e}))})).transitions()}(a,i,t);return xe(xe([],be(o),!1),be(s),!1)},e}(kw);function cM(t,e){return"number"==typeof t&&"number"==typeof e?function(t,e){return function(n){return t*(1-n)+e*n}}(t,e):Array.isArray(t)&&Array.isArray(e)?function(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0;return function(r){var a=new Array(i),o=new Array(n),s=0;for(s=0;s<i;++s)a[s]=cM(t[s],e[s]);for(;s<n;++s)o[s]=e[s];for(s=0;s<i;++s)o[s]=a[s](r);return o}}(t,e):"object"==typeof t&&"object"==typeof e?function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n={},i={};return Object.entries(e).forEach((function(e){var r=be(e,2),a=r[0],o=r[1];a in t?n[a]=cM(t[a],o):i[a]=o})),function(t){return Object.entries(n).forEach((function(e){var n=be(e,2),r=n[0],a=n[1];return i[r]=a(t)})),i}}(t,e):function(e){return t}}function hM(t,e){var n={},i=Array.isArray(e)?e:[e];for(var r in t)i.includes(r)||(n[r]=t[r]);return n}function dM(t,e){return Object.fromEntries(Object.entries(t).map((function(t){var n=be(t,2);return[n[0],Vw(n[1],e)]})))}function fM(t,e){return e&&gn(e)?t.filter(e):t}function pM(t,e){var n=e.startAngle;return(e.endAngle-n)*t+n}function gM(t,e){if("linear"===e.type){var n=be(e.startPos,2),i=n[0],r=n[1],a=be(e.endPos,2),o=be([a[0]-i,a[1]-r],2);return Qk([o[0],o[1]])}var s=Jk(pM(t,e));return[-Math.sin(s),Math.cos(s)]}function vM(t,e,n){return function(t,e){return e?[t[1],-t[0]]:[-t[1],t[0]]}(gM(t,n),"positive"!==e)}function yM(t,e){return vM(t,e.labelDirection,e)}function mM(t,e){return"linear"===e.type?function(t,e){var n=be(e.startPos,2),i=n[0],r=n[1],a=be(e.endPos,2),o=be([a[0]-i,a[1]-r],2);return[i+o[0]*t,r+o[1]*t]}(t,e):function(t,e){var n=e.radius,i=be(e.center,2),r=i[0],a=i[1],o=Jk(pM(t,e));return[r+n*Math.cos(o),a+n*Math.sin(o)]}(t,e)}function bM(t){return 0===gM(0,t)[1]}function xM(t){return 0===gM(0,t)[0]}function EM(t,e){return e-t==360}function wM(t,e,n,i,r){var a=e-t,o=be([r,r],2),s=o[0],l=o[1],u=be([Jk(t),Jk(e)],2),c=u[0],h=u[1],d=function(t){return[n+r*Math.cos(t),i+r*Math.sin(t)]},f=be(d(c),2),p=f[0],g=f[1],v=be(d(h),2),y=v[0],m=v[1];if(EM(t,e)){var b=be(d((h+c)/2),2);return[["M",p,g],["A",s,l,0,1,0,b[0],b[1]],["A",s,l,0,1,0,y,m]]}var x=a>180?1:0,E=t>e?0:1;return"M".concat(p,",").concat(g,",A").concat(s,",").concat(l,",0,").concat(x,",").concat(E,",").concat(y,",").concat(m)}function kM(t,e,n,i){var r=e.startAngle,a=e.endAngle,o=e.center,s=e.radius;return t.selectAll(Hk.line.class).data([{d:wM.apply(void 0,xe(xe([r,a],be(o),!1),[s],!1))}],(function(t,e){return e})).join((function(t){return t.append("path").attr("className",Hk.line.name).styles(e).styles({d:function(t){return t.d}})}),(function(t){return t.transition((function(){var t=this,e=function(t,e,n,i){if(!i)return t.attr("__keyframe_data__",n),null;var r=i.duration,a=void 0===r?0:r,o=cM(e,n),s=Math.ceil(+a/16),l=new Array(s).fill(0).map((function(t,e,n){return{__keyframe_data__:o(e/(n.length-1))}}));return t.animate(l,ge({fill:"both"},i))}(this,function(t){var e=t.attributes,n=e.startAngle,i=e.endAngle,r=e.center,a=e.radius;return xe(xe([n,i],be(r),!1),[a],!1)}(this),xe(xe([r,a],be(o),!1),[s],!1),i.update);if(e){var n=function(){var e=_d(t.attributes,"__keyframe_data__");t.style.d=wM.apply(void 0,xe([],be(e),!1))};e.onframe=n,e.onfinish=n}return e})).styles(e)}),(function(t){return t.remove()})).styles(n).transitions()}function MM(t){var e=be(t,2),n=be(e[0],2),i=n[0],r=n[1],a=be(e[1],2);return{x1:i,y1:r,x2:a[0],y2:a[1]}}function SM(t,e,n){var i,r=e.type,a=Tw(e,"line");return i="linear"===r?function(t,e,n,i){var r=e.showTrunc,a=e.startPos,o=e.endPos,s=e.truncRange,l=e.lineExtension,u=be([a,o],2),c=be(u[0],2),h=c[0],d=c[1],f=be(u[1],2),p=f[0],g=f[1],v=be(l?function(t,e,n){void 0===n&&(n=[0,0]);var i=be([t,e,n],3),r=be(i[0],2),a=r[0],o=r[1],s=be(i[1],2),l=s[0],u=s[1],c=be(i[2],2),h=c[0],d=c[1],f=be([l-a,u-o],2),p=f[0],g=f[1],v=Math.sqrt(Math.pow(p,2)+Math.pow(g,2)),y=be([-h/v,d/v],2),m=y[0],b=y[1];return[m*p,m*g,b*p,b*g]}(a,o,l):new Array(4).fill(0),4),y=v[0],m=v[1],b=v[2],x=v[3],E=function(e){return t.selectAll(Hk.line.class).data(e,(function(t,e){return e})).join((function(t){return t.append("line").attr("className",(function(t){return"".concat(Hk.line.name," ").concat(t.className)})).styles(n).transition((function(t){return $w(this,MM(t.line),!1)}))}),(function(t){return t.styles(n).transition((function(t){return $w(this,MM(t.line),i.update)}))}),(function(t){return t.remove()})).transitions()};if(!r||!s)return E([{line:[[h+y,d+m],[p+b,g+x]],className:Hk.line.name}]);var w=be(s,2),k=w[0],M=w[1],S=p-h,N=g-d,T=be([h+S*k,d+N*k],2),A=T[0],O=T[1],P=be([h+S*M,d+N*M],2),C=P[0],R=P[1],L=E([{line:[[h+y,d+m],[A,O]],className:Hk.lineFirst.name},{line:[[C,R],[p+b,g+x]],className:Hk.lineSecond.name}]);return function(t,e){e.truncRange,e.truncShape,e.lineExtension}(0,e),L}(t,e,hM(a,"arrow"),n):kM(t,e,hM(a,"arrow"),n),function(t,e,n,i){var r,a=n.showArrow,o=n.showTrunc,s=n.lineArrow,l=n.lineArrowOffset,u=n.lineArrowSize;if(r="arc"===e?t.select(Hk.line.class):o?t.select(Hk.lineSecond.class):t.select(Hk.line.class),!a||!s||"arc"===n.type&&EM(n.startAngle,n.endAngle)){var c=r.node();c&&(c.style.markerEnd=void 0)}else{var h=sk(s);h.attr(i),Xw(h,u,!0),r.style("markerEnd",h).style("markerEndOffset",-l)}}(t,r,e,a),i}function NM(t){var e=t.type,n=t.gridCenter;return"linear"===e?n:n||t.center}function TM(t,e,n,i){var r=Tw(n,"grid"),a=r.type,o=r.areaFill,s=NM(n),l=fM(e,n.gridFilter),u="segment"===a?function(t,e){var n=e.gridLength;return t.map((function(t,i){var r=t.value,a=be(mM(r,e),2),o=a[0],s=a[1],l=be(Yk(function(t,e){return vM(t,e.gridDirection,e)}(r,e),n),2);return{id:i,points:[[o,s],[o+l[0],s+l[1]]]}}))}(l,n):function(t,e){var n=e.gridControlAngles,i=NM(e);if(!i)throw new Error("grid center is not provide");if(t.length<2)throw new Error("Invalid grid data");if(!n||0===n.length)throw new Error("Invalid gridControlAngles");var r=be(i,2),a=r[0],o=r[1];return t.map((function(t,i){var r=be(mM(t.value,e),2),s=r[0],l=r[1],u=be([s-a,l-o],2),c=u[0],h=u[1],d=[];return n.forEach((function(t){var e=Jk(t),n=be([Math.cos(e),Math.sin(e)],2),i=n[0],r=n[1],s=c*i-h*r+a,l=c*r+h*i+o;d.push([s,l])})),{points:d,id:i}}))}(l,n),c=ge(ge({},r),{center:s,areaFill:gn(o)?l.map((function(t,e){return Vw(o,[t,e,l])})):o,animate:i,data:u});return t.selectAll(Hk.grid.class).data([1]).join((function(t){return t.append((function(){return new uM({style:c})})).attr("className",Hk.grid.name)}),(function(t){return t.transition((function(){return this.update(c)}))}),(function(t){return t.remove()})).transitions()}function AM(t,e,n,i,r){return void 0===i&&(i=!0),void 0===r&&(r=!1),!!(i&&t===e||r&&t===n)||t>e&&t<n}function OM(t,e){if(e)try{var n=e.replace(/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,(function(e,n,i){return"translate(".concat(function(t,e,n){var i=t.getBBox(),r=i.width,a=i.height,o=be([e,n].map((function(t,e){var n;return t.includes("%")?parseFloat((null===(n=t.match(/[+-]?([0-9]*[.])?[0-9]+/))||void 0===n?void 0:n[0])||"0")/100*(0===e?r:a):t})),2);return[o[0],o[1]]}(t,n,i),")")}));t.attr("transform",n)}catch(t){}}var PM=function(){function t(t,e,n,i){this.set(t,e,n,i)}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),t.prototype.rotatedPoints=function(t,e,n){var i=this,r=i.x1,a=i.y1,o=i.x2,s=i.y2,l=Math.cos(t),u=Math.sin(t),c=e-e*l+n*u,h=n-e*u-n*l;return[[l*r-u*s+c,u*r+l*s+h],[l*o-u*s+c,u*o+l*s+h],[l*r-u*a+c,u*r+l*a+h],[l*o-u*a+c,u*o+l*a+h]]},t.prototype.set=function(t,e,n,i){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),i<e?(this.y2=e,this.y1=i):(this.y1=e,this.y2=i),this},t.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE},t}();function CM(t,e){var n=t.getEulerAngles()||0;t.setEulerAngles(0);var i=t.getBounds(),r=be(i.min,2),a=r[0],o=r[1],s=be(i.max,2),l=s[0],u=s[1],c=t.getBBox(),h=c.width,d=c.height,f=0,p=0,g=a,v=o,y=hk(t);if(y){d-=1.5;var m=y.style.textAlign,b=y.style.textBaseline;"center"===m?g=(a+l)/2:"right"!==m&&"end"!==m||(g=l),"middle"===b?v=(o+u)/2:"bottom"===b&&(v=u)}var x=be(Iw(e),4),E=x[0],w=void 0===E?0:E,k=x[1],M=void 0===k?0:k,S=x[2],N=void 0===S?w:S,T=x[3],A=new PM((f+=a)-(void 0===T?M:T),(p+=o)-w,f+h+M,p+d+N);return t.setEulerAngles(n),A.rotatedPoints(Jk(n),g,v)}function RM(t,e){return e[0]<=Math.max(t[0][0],t[1][0])&&e[0]<=Math.min(t[0][0],t[1][0])&&e[1]<=Math.max(t[0][1],t[1][1])&&e[1]<=Math.min(t[0][1],t[1][1])}function LM(t,e,n){var i=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return 0===i?0:i<0?2:1}function DM(t,e){return[[t[0],t[1],t[2],t[3]],[t[2],t[3],t[4],t[5]],[t[4],t[5],t[6],t[7]],[t[6],t[7],t[0],t[1]]].some((function(t){return function(t,e){var n=be(t,4),i=n[0],r=n[1],a=n[2],o=n[3],s=be(e,4),l=s[0],u=s[1],c=a-i,h=o-r,d=s[2]-l,f=s[3]-u,p=c*f-d*h;if(0===p)return!1;var g=p>0,v=i-l,y=r-u,m=c*y-h*v;if(m<0===g)return!1;var b=d*y-f*v;return b<0!==g&&m>p!==g&&b>p!==g}(e,t)}))}function IM(t,e,n){var i,r,a,o,s=e.crossPadding,l=new Set,u=null,c=function(t,e){var n=t.type,i=t.labelDirection,r=t.crossSize;if(!r)return!1;if("arc"===n){var a=t.center,o=t.radius,s=be(a,2),l=s[0],u=s[1],c="negative"===i?0:r,h=-o-c,d=o+c,f=be(Iw(e),4),p=f[0],g=f[1],v=f[2],y=f[3];return new PM(l+h-y,u+h-p,l+d+g,u+d+v)}var m=be(t.startPos,2),b=m[0],x=m[1],E=be(t.endPos,2),w=E[0],k=E[1],M=be(xM(t)?[-e,0,e,0]:[0,e,0,-e],4),S=M[0],N=M[1],T=M[2],A=M[3],O=Yk(yM(0,t),r),P=new PM(b,x,w,k);return P.x1+=A,P.y1+=S,P.x2+=N+O[0],P.y2+=T+O[1],P}(e,s),h=function(t){return!c||(n=t,r=(e=c).x1,a=e.x2,o=e.y1,s=e.y2,i=[[r,o],[a,o],[a,s],[r,s]],CM(n,void 0).every((function(t){return function(t,e){var n=t.length;if(n<3)return!1;var i,r,a,o,s,l,u=[e,[9999,e[1]]],c=0,h=0;do{var d=[t[h],t[(h+1)%n]];if(a=LM((i=d)[0],i[1],(r=u)[0]),o=LM(i[0],i[1],r[1]),s=LM(r[0],r[1],i[0]),l=LM(r[0],r[1],i[1]),a!==o&&s!==l||0===a&&RM(i,r[0])||0===o&&RM(i,r[1])||0===s&&RM(r,i[0])||0===l&&RM(r,i[1])){if(0===LM(d[0],e,d[1]))return RM(d,e);c++}h=(h+1)%n}while(0!==h);return!!(1&c)}(i,t)})));var e,n,i,r,a,o,s};try{for(var d=me(t),f=d.next();!f.done;f=d.next()){var p=f.value;h(p)?u&&(o=p,(a=u)&&a.firstChild&&function(t,e,n){var i,r,a=CM(t,n).flat(1),o=CM(e,n).flat(1),s=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var l=me(s),u=l.next();!u.done;u=l.next())if(DM(o,u.value))return!0}catch(t){i={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}return!1}(a.firstChild,o.firstChild,Iw(n)))?(l.add(u),l.add(p)):u=p:l.add(p)}}catch(t){i={error:t}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(i)throw i.error}}return Array.from(l)}function _M(t,e){return void 0===e&&(e={}),ce(t)?0:"number"==typeof t?t:Math.floor(uk(t,e))}var BM=function(t){return void 0!==t&&null!=t&&!Number.isNaN(t)},FM=function(t,e){var n=e.seq,i=void 0===n?2:n;return t.filter((function(t,e){return!(e%i&&(vw(t),1))}))},jM=new Map([["hide",function(t,e,n,i){var r=t.length,a=e.keepHeader,o=e.keepTail;if(!(r<=1||2===r&&a&&o)){var s,l,u,c=FM,h=function(t){return t.forEach(i.show),t},d=2,f=t.slice(),p=t.slice(),g=Math.min.apply(Math,xe([1],be(t.map((function(t){return t.getBBox().width}))),!1));if("linear"===n.type&&(bM(n)||xM(n))){var v=ak(t[0]).left,y=ak(t[r-1]).right,m=Math.abs(y-v)||1;d=Math.max(Math.floor(r*g/m),d)}for(a&&(s=f.splice(0,1)[0]),o&&(l=f.splice(-1,1)[0],f.reverse()),h(f);d<t.length&&IM((u=l?xe(xe([l],be(p),!1),[s],!1):xe([s],be(p),!1),u.filter(BM)),n,null==e?void 0:e.margin).length;)(l&&!s&&d%2==0||l&&s)&&f.splice(0,1).forEach(i.hide),p=c(h(f),{seq:d}),d++}}],["rotate",function(t,e,n,i){var r,a,o=e.optionalAngles,s=void 0===o?[0,45,90]:o,l=e.margin,u=e.recoverWhenFailed,c=void 0===u||u,h=t.map((function(t){return t.getLocalEulerAngles()})),d=function(e){return t.forEach((function(t,n){var r=Array.isArray(e)?e[n]:e;i.rotate(t,+r)}))};try{for(var f=me(s),p=f.next();!p.done;p=f.next())if(d(p.value),IM(t,n,l).length<1)return}catch(t){r={error:t}}finally{try{p&&!p.done&&(a=f.return)&&a.call(f)}finally{if(r)throw r.error}}c&&d(h)}],["ellipsis",function(t,e,n,i){if(!(t.length<=0)){var r=e.suffix,a=void 0===r?"...":r,o=e.minLength,s=e.maxLength,l=void 0===s?1/0:s,u=e.step,c=void 0===u?" ":u,h=e.margin,d=void 0===h?[0,0,0,0]:h,f=ck(i.getTextShape(t[0])),p=_M(c,f),g=o?_M(o,f):p,v=_M(l,f);(ce(v)||v===1/0)&&(v=Math.max.apply(null,t.map((function(t){return t.getBBox().width}))));for(var y=t.slice(),m=be(d,4),b=(m[0],m[1],m[2],m[3],function(e){if(y.forEach((function(t){i.ellipsis(i.getTextShape(t),e,a)})),(y=IM(t,n,d)).length<1)return{value:void 0}}),x=v;x>g+p;x-=p){var E=b(x);if("object"==typeof E)return E.value}}}],["wrap",function(t,e,n,i,r){var a,o=e.maxLines,s=void 0===o?3:o,l=e.recoverWhenFailed,u=void 0===l||l,c=e.margin,h=void 0===c?[0,0,0,0]:c,d=Vw(null!==(a=e.wordWrapWidth)&&void 0!==a?a:50,[r]),f=t.map((function(t){return t.attr("maxLines")||1})),p=Math.min.apply(Math,xe([],be(f),!1)),g=function(){return IM(t,n,h).length<1},v=function(t){var e=t.type,n=t.labelDirection;return"linear"===e&&bM(t)?"negative"===n?"bottom":"top":"middle"}(n),y=function(e){return t.forEach((function(t,n){var r=Array.isArray(e)?e[n]:e;i.wrap(t,d,r,v)}))};if(!(p>s)){if("linear"===n.type&&bM(n)){if(y(s),g())return}else for(var m=p;m<=s;m++)if(y(m),g())return;u&&y(f)}}]]);function GM(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.reduce((function(t,e){return t*("positive"===e?-1:1)}),1)}function zM(t){for(var e=t;e<0;)e+=360;return Math.round(e%360)}function VM(t,e){var n=be(t,2),i=n[0],r=n[1],a=be(e,2),o=a[0],s=a[1],l=be([i*o+r*s,i*s-r*o],2),u=l[0],c=l[1];return Math.atan2(c,u)}function WM(t,e,n){var i=n.type,r=n.labelAlign,a=yM(t,n),o=zM(e),s=zM(tM(VM([1,0],a))),l="center",u="middle";return"linear"===i?[90,270].includes(s)&&0===o?(l="center",u=1===a[1]?"top":"bottom"):s%180||![90,270].includes(o)?0===s?(AM(o,0,90,!1,!0)||AM(o,0,90)||AM(o,270,360))&&(l="start"):90===s?AM(o,0,90,!1,!0)?l="start":(AM(o,90,180)||AM(o,270,360))&&(l="end"):270===s?AM(o,0,90,!1,!0)?l="end":(AM(o,90,180)||AM(o,270,360))&&(l="start"):180===s&&(90===o?l="start":(AM(o,0,90)||AM(o,270,360))&&(l="end")):l="center":"parallel"===r?u=AM(s,0,180,!0)?"top":"bottom":"horizontal"===r?AM(s,90,270,!1)?l="end":(AM(s,270,360,!1)||AM(s,0,90))&&(l="start"):"perpendicular"===r&&(l=AM(s,90,270)?"end":"start"),{textAlign:l,textBaseline:u}}function UM(t,e,n){var i=n.showTick,r=n.tickLength,a=n.tickDirection,o=n.labelDirection,s=n.labelSpacing,l=e.indexOf(t),u=Vw(s,[t,l,e]),c=be([yM(t.value,n),GM(o,a)],2),h=be($k(Yk(c[0],u+(1===c[1]?Vw(i?r:0,[t,l,e]):0)),mM(t.value,n)),2);return{x:h[0],y:h[1]}}function HM(t,e){"text"===t.nodeName&&t.attr(e)}function YM(t,e){!function(t,e,n,i){var r=e.labelOverlap,a=void 0===r?[]:r;a.length&&a.forEach((function(r){var a=r.type,o=jM.get(a);(function(t,e,n){return!(e.labelOverlap.length<1)&&("hide"===n?!function(t){for(var e=t;e;){if("offscreen"===e.className)return!0;e=e.parent}return!1}(t[0]):"rotate"===n?!t.some((function(t){var e;return!!(null===(e=t.attr("transform"))||void 0===e?void 0:e.includes("rotate"))})):"ellipsis"!==n&&"wrap"!==n||t.filter((function(t){return t.querySelector("text")})).length>=1)})(t,e,a)&&(null==o||o(t,r,e,i,n))}))}(this.node().childNodes,t,e,{hide:vw,show:gw,rotate:function(e,n){!function(t,e,n){e.setLocalEulerAngles(t);var i=WM(e.__data__.value,t,n),r=e.querySelector(Hk.labelItem.class);r&&HM(r,i)}(+n,e,t)},ellipsis:function(t,e,n){t&&fk(t,e||1/0,n)},wrap:function(t,e,n){var i,r;t&&(void 0===(i=n)&&(i=2),void 0===r&&(r="top"),dk(t,{wordWrap:!0,wordWrapWidth:e,maxLines:i,textBaseline:r}))},getTextShape:function(t){return t.querySelector("text")}})}function $M(t,e,n,i,r){var a=n.indexOf(e),o=Rw(t).append(function(t,e,n,i){var r=i.labelFormatter;return gn(r)?function(){return sk(Vw(r,[t,e,n,yM(t.value,i)]))}:function(){return sk(t.label||"")}}(e,a,n,r)).attr("className",Hk.labelItem.name).node(),s=be(Ow(dM(i,[e,a,n])),2),l=s[0],u=s[1],c=u.transform,h=ve(u,["transform"]);OM(o,c);var d=function(t,e,n){var i,r=n.labelAlign;if(null===(i=e.style.transform)||void 0===i?void 0:i.includes("rotate"))return e.getLocalEulerAngles();var a=yM(t.value,n),o=gM(t.value,n);return"horizontal"===r?0:function(t){var e=(t+360)%180;return AM(e,-90,90)||(e+=180),e}(tM("perpendicular"===r?VM([1,0],a):VM([o[0]<0?-1:1,0],o)))}(e,o,r);return o.getLocalEulerAngles()||o.setLocalEulerAngles(d),HM(o,ge(ge({},WM(e.value,d,r)),l)),t.attr(h),o}function XM(t,e,n,i,r){var a,o,s,l=fM(e,n.labelFilter),u=Tw(n,"label"),c=t.selectAll(Hk.label.class).data(l,(function(t,e){return e})).join((function(t){return t.append("g").attr("className",Hk.label.name).transition((function(t){$M(this,t,e,u,n);var i=UM(t,e,n),r=i.x,a=i.y;return this.style.transform="translate(".concat(r,", ").concat(a,")"),null}))}),(function(t){return t.transition((function(t){var r=function(t,e,n,i){if(void 0===i&&(i="destroy"),function(t,e){return"text"===t.nodeName&&"text"===e.nodeName&&t.attributes.text===e.attributes.text}(t,e))return t.remove(),[null];var r=function(){"destroy"===i?t.destroy():"hide"===i&&vw(t),e.isVisible()&&gw(e)};if(!n)return r(),[null];var a=n.duration,o=void 0===a?0:a,s=n.delay,l=void 0===s?0:s,u=Math.ceil(+o/2),c=+o/4,h=be(t.getGeometryBounds().center,2),d=h[0],f=h[1],p=be(e.getGeometryBounds().center,2),g=be([(d+p[0])/2-d,(f+p[1])/2-f],2),v=g[0],y=g[1],m=t.style.opacity,b=void 0===m?1:m,x=e.style.opacity,E=void 0===x?1:x,w=t.style.transform||"",k=e.style.transform||"",M=t.animate([{opacity:b,transform:"translate(0, 0) ".concat(w)},{opacity:0,transform:"translate(".concat(v,", ").concat(y,") ").concat(w)}],ge(ge({fill:"both"},n),{duration:l+u+c})),S=e.animate([{opacity:0,transform:"translate(".concat(-v,", ").concat(-y,") ").concat(k),offset:.01},{opacity:E,transform:"translate(0, 0) ".concat(k)}],ge(ge({fill:"both"},n),{duration:u+c,delay:l+u-c}));return Uw(S,r),[M,S]}(this.querySelector(Hk.labelItem.class),$M(this,t,e,u,n),i.update),a=UM(t,e,n),o=a.x,s=a.y,l=$w(this,{transform:"translate(".concat(o,", ").concat(s,")")},i.update);return xe(xe([],be(r),!1),[l],!1)}))}),(function(t){return a=t,t.transition((function(){var t=this,e=eM(this.childNodes[0],i.exit);return Uw(e,(function(){return Rw(t).remove()})),e})),a})).transitions();return s=function(){YM.call(t,n,r)},0===(o=c).length?s():Promise.all(o.map((function(t){return null==t?void 0:t.finished}))).then(s),c}function qM(t,e){return vM(t,e.tickDirection,e)}function KM(t,e,n,i,r,a){var o=function(t,e,n,i,r){var a=r.tickFormatter,o=qM(e.value,r),s="line";return gn(a)&&(s=function(){return Vw(a,[e,n,i,o])}),t.append(s).attr("className",Hk.tickItem.name)}(Rw(this),t,e,n,i);!function(t,e,n,i,r,a,o){var s=qM(t.value,a),l=function(t,e,n,i,r){var a=be(function(t,e){var n=be(t,2);return[[0,0],[n[0]*e,n[1]*e]]}(i,Vw(r.tickLength,[t,e,n])),2),o=be(a[0],2),s=o[0],l=o[1],u=be(a[1],2);return{x1:s,x2:u[0],y1:l,y2:u[1]}}(t,e,n,s,a),u=l.x1,c=l.x2,h=l.y1,d=l.y2,f=be(Ow(dM(o,[t,e,n,s])),2),p=f[0],g=f[1];"line"===i.node().nodeName&&i.styles(ge({x1:u,x2:c,y1:h,y2:d},p)),r.attr(g),i.styles(p)}(t,e,n,o,this,i,r);var s=be(mM(t.value,i),2),l=s[0],u=s[1];return $w(this,{transform:"translate(".concat(l,", ").concat(u,")")},a)}function ZM(t,e,n,i,r){var a=be(Ow(Tw(i,"title")),2),o=a[0],s=a[1],l=s.transform,u=s.transformOrigin,c=ve(s,["transform","transformOrigin"]);e.styles(c);var h=l||function(t,e,n){var i=2*t.getGeometryBounds().halfExtents[1];if("vertical"===e){if("left"===n)return"rotate(-90) translate(0, ".concat(i/2,")");if("right"===n)return"rotate(-90) translate(0, -".concat(i/2,")")}return""}(t.node(),o.direction,o.position);t.styles(ge(ge({},o),{transformOrigin:u})),OM(t.node(),h);var d=function(t,e,n){var i=n.titlePosition,r=void 0===i?"lb":i,a=n.titleSpacing,o=Fw(r),s=t.node().getLocalBounds(),l=be(s.min,2),u=l[0],c=l[1],h=be(s.halfExtents,2),d=h[0],f=h[1],p=be(e.node().getLocalBounds().halfExtents,2),g=p[0],v=p[1],y=be([u+d,c+f],2),m=y[0],b=y[1],x=be(Iw(a),4),E=x[0],w=x[1],k=x[2],M=x[3];if(["start","end"].includes(r)&&"linear"===n.type){var S=n.startPos,N=n.endPos,T=be("start"===r?[S,N]:[N,S],2),A=T[0],O=T[1],P=be(Yk(Qk([-O[0]+A[0],-O[1]+A[1]]),E),2),C=P[0],R=P[1];return{x:A[0]+C,y:A[1]+R}}return o.includes("t")&&(b-=f+v+E),o.includes("r")&&(m+=d+g+w),o.includes("l")&&(m-=d+g+M),o.includes("b")&&(b+=f+v+k),{x:m,y:b}}(Rw(n._offscreen||n.querySelector(Hk.mainGroup.class)),e,i),f=d.x,p=d.y;return $w(e.node(),{transform:"translate(".concat(f,", ").concat(p,")")},r)}function QM(t,e,n,i){var r=t.showLine,a=t.showTick,o=t.showLabel,s=_w(r,e.maybeAppendByClassName(Hk.lineGroup,"g"),(function(e){return SM(e,t,i)}))||[],l=_w(a,e.maybeAppendByClassName(Hk.tickGroup,"g"),(function(e){return function(t,e,n,i){var r=fM(e,n.tickFilter),a=Tw(n,"tick");return t.selectAll(Hk.tick.class).data(r,(function(t){return t.id||t.label})).join((function(t){return t.append("g").attr("className",Hk.tick.name).transition((function(t,e){return KM.call(this,t,e,r,n,a,!1)}))}),(function(t){return t.transition((function(t,e){return this.removeChildren(),KM.call(this,t,e,r,n,a,i.update)}))}),(function(t){return t.transition((function(){var t=this,e=eM(this.childNodes[0],i.exit);return Uw(e,(function(){return t.remove()})),e}))})).transitions()}(e,n,t,i)}))||[],u=_w(o,e.maybeAppendByClassName(Hk.labelGroup,"g"),(function(r){return XM(r,n,t,i,e.node())}))||[];return xe(xe(xe([],be(s),!1),be(l),!1),be(u),!1).filter((function(t){return!!t}))}var JM=function(t){function e(e){return t.call(this,e,Uk)||this}return pe(e,t),e.prototype.render=function(t,e,n){var i=this,r=t.titleText,a=t.data,o=t.animate,s=t.showTitle,l=t.showGrid,u=t.dataThreshold,c=t.truncRange,h=function(t,e){if(t.length<=e)return t;for(var n=Math.floor(t.length/e),i=[],r=0;r<t.length;r+=n)i.push(t[r]);return i}(a,u).filter((function(t){var e=t.value;return!(c&&e>c[0]&&e<c[1])})),d=Ww(void 0===n?o:n),f=_w(l,Rw(e).maybeAppendByClassName(Hk.gridGroup,"g"),(function(e){return TM(e,h,t,d)}))||[],p=Rw(e).maybeAppendByClassName(Hk.mainGroup,"g");r&&(!this.initialized&&d.enter||this.initialized&&d.update)&&QM(t,Rw(this.offscreenGroup),h,Ww(!1));var g=QM(t,Rw(p.node()),h,d),v=_w(s,Rw(e).maybeAppendByClassName(Hk.titleGroup,"g"),(function(e){return function(t,e,n,i){var r=n.titleText;return t.selectAll(Hk.title.class).data([{title:r}].filter((function(t){return!!t.title})),(function(t,e){return t.title})).join((function(a){return a.append((function(){return sk(r)})).attr("className",Hk.title.name).transition((function(){return ZM(Rw(this),t,e,n,i.enter)}))}),(function(r){return r.transition((function(){return ZM(Rw(this),t,e,n,i.update)}))}),(function(t){return t.remove()})).transitions()}(e,i,t,d)}))||[];return xe(xe(xe([],be(f),!1),be(g),!1),be(v),!1).flat().filter((function(t){return!!t}))},e}(kw);function tS(t){var e=t.canvas,n=t.touches,i=t.offsetX,r=t.offsetY;if(e)return[e.x,e.y];if(n){var a=n[0];return[a.clientX,a.clientY]}return i&&r?[i,r]:[0,0]}function eS(t,e){return+t.toPrecision(e)}const nS=function(t){return t};class iS{constructor(t){this.options=Vh({},this.getDefaultOptions()),this.update(t)}getOptions(){return this.options}update(t={}){this.options=Vh({},this.options,t),this.rescale(t)}rescale(t){}}function rS(t,e){return e-t?n=>(n-t)/(e-t):t=>.5}function aS(t,...e){return e.reduce(((t,e)=>n=>t(e(n))),t)}var oS=n(8854),sS=n.n(oS);function lS(t,e,n){let i=n;return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function uS(t){const e=sS().get(t);if(!e)return null;const{model:n,value:i}=e;return"rgb"===n?i:"hsl"===n?function(t){const e=t[0]/360,n=t[1]/100,i=t[2]/100,r=t[3];if(0===n)return[255*i,255*i,255*i,r];const a=i<.5?i*(1+n):i+n-i*n,o=2*i-a;return[255*lS(o,a,e+1/3),255*lS(o,a,e),255*lS(o,a,e-1/3),r]}(i):null}const cS=(t,e)=>n=>t*(1-n)+e*n,hS=(t,e)=>"number"==typeof t&&"number"==typeof e?cS(t,e):"string"==typeof t&&"string"==typeof e?((t,e)=>{const n=uS(t),i=uS(e);return null===n||null===i?n?()=>t:()=>e:t=>{const e=new Array(4);for(let r=0;r<4;r+=1){const a=n[r],o=i[r];e[r]=a*(1-t)+o*t}const[r,a,o,s]=e;return`rgba(${Math.round(r)}, ${Math.round(a)}, ${Math.round(o)}, ${s})`}})(t,e):()=>t,dS=(t,e)=>{const n=cS(t,e);return t=>Math.round(n(t))};function fS(t){return!(hn(t)||(e=t,null===e)||Number.isNaN(t));var e}const pS=Math.sqrt(50),gS=Math.sqrt(10),vS=Math.sqrt(2);function yS(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),a=i/10**r;return r>=0?(a>=pS?10:a>=gS?5:a>=vS?2:1)*10**r:-(10**-r)/(a>=pS?10:a>=gS?5:a>=vS?2:1)}const mS=(t,e,n=5)=>{const i=[t,e];let r,a=0,o=i.length-1,s=i[a],l=i[o];return l<s&&([s,l]=[l,s],[a,o]=[o,a]),r=yS(s,l,n),r>0?(s=Math.floor(s/r)*r,l=Math.ceil(l/r)*r,r=yS(s,l,n)):r<0&&(s=Math.ceil(s*r)/r,l=Math.floor(l*r)/r,r=yS(s,l,n)),r>0?(i[a]=Math.floor(s/r)*r,i[o]=Math.ceil(l/r)*r):r<0&&(i[a]=Math.ceil(s*r)/r,i[o]=Math.floor(l*r)/r),i},bS=(t,e,n)=>{const[i,r]=t,[a,o]=e;let s,l;return i<r?(s=rS(i,r),l=n(a,o)):(s=rS(r,i),l=n(o,a)),aS(l,s)},xS=(t,e,n)=>{const i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),o=t[0]>t[i],s=o?[...t].reverse():t,l=o?[...e].reverse():e;for(let t=0;t<i;t+=1)r[t]=rS(s[t],s[t+1]),a[t]=n(l[t],l[t+1]);return e=>{const n=function(t,e,n,i){let r=1,a=i||t.length;const o=t=>t;for(;r<a;){const n=Math.floor((r+a)/2);o(t[n])>e?a=n:r=n+1}return r}(t,e,0,i)-1,o=r[n];return aS(a[n],o)(e)}},ES=(t,e,n,i)=>(Math.min(t.length,e.length)>2?xS:bS)(t,e,i?dS:n);class wS extends iS{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:cS,tickCount:5}}map(t){return fS(t)?this.output(t):this.options.unknown}invert(t){return fS(t)?this.input(t):this.options.unknown}nice(){if(!this.options.nice)return;const[t,e,n,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(t,e,n,...i)}getTicks(){const{tickMethod:t}=this.options,[e,n,i,...r]=this.getTickMethodOptions();return t(e,n,i,...r)}getTickMethodOptions(){const{domain:t,tickCount:e}=this.options;return[t[0],t[t.length-1],e]}chooseNice(){return mS}rescale(){this.nice();const[t,e]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t)),this.composeInput(t,e,this.chooseClamp(e))}chooseClamp(t){const{clamp:e,range:n}=this.options,i=this.options.domain.map(t),r=Math.min(i.length,n.length);return e?function(t,e){const n=e<t?e:t,i=t>e?t:e;return t=>Math.min(Math.max(n,t),i)}(i[0],i[r-1]):nS}composeOutput(t,e){const{domain:n,range:i,round:r,interpolate:a}=this.options,o=ES(n.map(t),i,a,r);this.output=aS(o,e,t)}composeInput(t,e,n){const{domain:i,range:r}=this.options,a=ES(r,i.map(t),cS);this.input=aS(e,n,a)}}const kS=(t,e,n)=>{let i,r,a=t,o=e;if(a===o&&n>0)return[a];let s=yS(a,o,n);if(0===s||!Number.isFinite(s))return[];if(s>0){a=Math.ceil(a/s),o=Math.floor(o/s),r=new Array(i=Math.ceil(o-a+1));for(let t=0;t<i;t+=1)r[t]=(a+t)*s}else{s=-s,a=Math.ceil(a*s),o=Math.floor(o*s),r=new Array(i=Math.ceil(o-a+1));for(let t=0;t<i;t+=1)r[t]=(a+t)/s}return r};class MS extends wS{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:hS,tickMethod:kS,tickCount:5}}chooseTransforms(){return[nS,nS]}clone(){return new MS(this.options)}}function SS({map:t,initKey:e},n){const i=e(n);return t.has(i)?t.get(i):n}function NS(t){return"object"==typeof t?t.valueOf():t}class TS extends Map{constructor(t){if(super(),this.map=new Map,this.initKey=NS,null!==t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(SS({map:this.map,initKey:this.initKey},t))}has(t){return super.has(SS({map:this.map,initKey:this.initKey},t))}set(t,e){return super.set(function({map:t,initKey:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}({map:this.map,initKey:this.initKey},t),e)}delete(t){return super.delete(function({map:t,initKey:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}({map:this.map,initKey:this.initKey},t))}}const AS=Symbol("defaultUnknown");function OS(t,e,n){for(let i=0;i<e.length;i+=1)t.has(e[i])||t.set(n(e[i]),i)}function PS(t){const{value:e,from:n,to:i,mapper:r,notFoundReturn:a}=t;let o=r.get(e);if(void 0===o){if(a!==AS)return a;o=n.push(e)-1,r.set(e,o)}return i[o%i.length]}function CS(t){return t instanceof Date?t=>`${t}`:"object"==typeof t?t=>JSON.stringify(t):t=>t}class RS extends iS{getDefaultOptions(){return{domain:[],range:[],unknown:AS}}constructor(t){super(t)}map(t){return 0===this.domainIndexMap.size&&OS(this.domainIndexMap,this.getDomain(),this.domainKey),PS({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(t){return 0===this.rangeIndexMap.size&&OS(this.rangeIndexMap,this.getRange(),this.rangeKey),PS({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(t){const[e]=this.options.domain,[n]=this.options.range;if(this.domainKey=CS(e),this.rangeKey=CS(n),!this.rangeIndexMap)return this.rangeIndexMap=new Map,void(this.domainIndexMap=new Map);t&&!t.range||this.rangeIndexMap.clear(),(!t||t.domain||t.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new RS(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:t,compare:e}=this.options;return this.sortedDomain=e?[...t].sort(e):t,this.sortedDomain}}function LS(t){return Math.round(1e12*t)/1e12}class DS extends RS{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:AS,flex:[]}}constructor(t){super(t)}clone(){return new DS(this.options)}getStep(t){return void 0===this.valueStep?1:"number"==typeof this.valueStep?this.valueStep:void 0===t?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}getBandWidth(t){return void 0===this.valueBandWidth?1:"number"==typeof this.valueBandWidth?this.valueBandWidth:void 0===t?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:t,paddingInner:e}=this.options;return t>0?t:e}getPaddingOuter(){const{padding:t,paddingOuter:e}=this.options;return t>0?t:e}rescale(){super.rescale();const{align:t,domain:e,range:n,round:i,flex:r}=this.options,{adjustedRange:a,valueBandWidth:o,valueStep:s}=function(t){var e;const{domain:n}=t,i=n.length;if(0===i)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(null===(e=t.flex)||void 0===e?void 0:e.length)return function(t){const{domain:e,range:n,paddingOuter:i,paddingInner:r,flex:a,round:o,align:s}=t,l=e.length,u=function(t,e){const n=e-t.length;return n>0?[...t,...new Array(n).fill(1)]:n<0?t.slice(0,e):t}(a,l),[c,h]=n,d=h-c,f=d/(2/l*i+1-1/l*r),p=f*r/l,g=f-l*p,v=function(t){const e=Math.min(...t);return t.map((t=>t/e))}(u),y=g/v.reduce(((t,e)=>t+e)),m=new TS(e.map(((t,e)=>{const n=v[e]*y;return[t,o?Math.floor(n):n]}))),b=new TS(e.map(((t,e)=>{const n=v[e]*y+p;return[t,o?Math.floor(n):n]}))),x=Array.from(b.values()).reduce(((t,e)=>t+e)),E=c+(d-(x-x/l*r))*s;let w=o?Math.round(E):E;const k=new Array(l);for(let t=0;t<l;t+=1){k[t]=LS(w);const n=e[t];w+=b.get(n)}return{valueBandWidth:m,valueStep:b,adjustedRange:k}}(t);const{range:r,paddingOuter:a,paddingInner:o,round:s,align:l}=t;let u,c,h=r[0];const d=r[1]-h,f=2*a,p=i-o;u=d/Math.max(1,f+p),s&&(u=Math.floor(u)),h+=(d-u*(i-o))*l,c=u*(1-o),s&&(h=Math.round(h),c=Math.round(c));const g=new Array(i).fill(0).map(((t,e)=>h+e*u));return{valueStep:u,valueBandWidth:c,adjustedRange:g}}({align:t,range:n,round:i,flex:r,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:e});this.valueStep=s,this.valueBandWidth=o,this.adjustedRange=a}}var IS=function(t){function e(e){var n=this,i=e.style,r=ve(e,["style"]);return(n=t.call(this,Vh({},{type:"column"},ge({style:i},r)))||this).columnsGroup=new wl({name:"columns"}),n.appendChild(n.columnsGroup),n.render(),n}return pe(e,t),e.prototype.render=function(){var t=this.attributes,e=t.columns,n=t.x,i=t.y;this.columnsGroup.style.transform="translate(".concat(n,", ").concat(i,")"),Rw(this.columnsGroup).selectAll(".column").data(e.flat()).join((function(t){return t.append("rect").attr("className","column").each((function(t){this.attr(t)}))}),(function(t){return t.each((function(t){this.attr(t)}))}),(function(t){return t.remove()}))},e.prototype.update=function(t){this.attr(bw({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(yl),_S=function(t){function e(e){var n=this,i=e.style,r=ve(e,["style"]);return(n=t.call(this,Vh({},{type:"lines"},ge({style:i},r)))||this).linesGroup=n.appendChild(new wl),n.areasGroup=n.appendChild(new wl),n.render(),n}return pe(e,t),e.prototype.render=function(){var t=this.attributes,e=t.lines,n=t.areas,i=t.x,r=t.y;this.style.transform="translate(".concat(i,", ").concat(r,")"),e&&this.renderLines(e),n&&this.renderAreas(n)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(bw({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){Rw(this.linesGroup).selectAll(".line").data(t).join((function(t){return t.append("path").attr("className","line").each((function(t){this.attr(t)}))}),(function(t){return t.each((function(t){this.attr(t)}))}),(function(t){return t.remove()}))},e.prototype.renderAreas=function(t){Rw(this.linesGroup).selectAll(".area").data(t).join((function(t){return t.append("path").attr("className","area").each((function(t){this.attr(t)}))}),(function(t){return t.each((function(t){this.style(t)}))}),(function(t){return t.remove()}))},e}(yl);function BS(t,e){void 0===e&&(e=!1);var n=e?t.length-1:0,i=t.map((function(t,e){return xe([e===n?"M":"L"],be(t),!1)}));return e?i.reverse():i}function FS(t,e){if(void 0===e&&(e=!1),t.length<=2)return BS(t);for(var n=[],i=t.length,r=0;r<i;r+=1){var a=e?t[i-r-1]:t[r];Ku(a,n.slice(-2))||n.push.apply(n,xe([],be(a),!1))}var o=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=[[0,0],[1,1]]);for(var i=!!e,r=[],a=0,o=t.length;a<o;a+=2)r.push([t[a],t[a+1]]);var s,l,u,c=function(t,e,n,i){var r,a,o,s,l,u,c=[],h=!!i,d=[1/0,1/0],f=[-1/0,-1/0];if(h){d=(r=be(i,2))[0],f=r[1];for(var p=0,g=t.length;p<g;p+=1)d=qk(d,y=t[p]),f=Kk(f,y)}p=0;for(var v=t.length;p<v;p+=1){var y=t[p];if(0!==p||n)if(p!==v-1||n){a=t[[p?p-1:v-1,p-1][n?0:1]];var m=[0,0];m=Yk(m=Xk(o=t[n?(p+1)%v:p+1],a),.4);var b=Zk(y,a),x=Zk(y,o),E=b+x;0!==E&&(b/=E,x/=E);var w=Yk(m,-b),k=Yk(m,x);l=$k(y,w),s=qk(s=$k(y,k),Kk(o,y)),s=Kk(s,qk(o,y)),l=qk(l=$k(y,w=Yk(w=Xk(s,y),-b/x)),Kk(a,y)),s=$k(y,k=Yk(k=Xk(y,l=Kk(l,qk(a,y))),x/b)),h&&(l=qk(l=Kk(l,d),f),s=qk(s=Kk(s,d),f)),c.push(u),c.push(l),u=s}else l=y,c.push(u),c.push(l);else u=y}return n&&c.push(c.shift()),c}(r,0,i,n),h=r.length,d=[];for(a=0;a<h-1;a+=1)s=c[2*a],l=c[2*a+1],u=r[a+1],d.push(["C",s[0],s[1],l[0],l[1],u[0],u[1]]);return i&&(s=c[h],l=c[h+1],u=be(r,1)[0],d.push(["C",s[0],s[1],l[0],l[1],u[0],u[1]])),d}(n,!1);return e?o.unshift(xe(["M"],be(t[i-1]),!1)):o.unshift(xe(["M"],be(t[0]),!1)),o}function jS(t,e,n){var i=Lc(t);return i.push(["L",e,n],["L",0,n],["Z"]),i}const GS=function(t,e){if($e(t)){for(var n,i=1/0,r=0;r<t.length;r++){var a=t[r],o=gn(e)?e(a):a[e];o<i&&(n=a,i=o)}return n}},zS=function(t,e){if($e(t)){for(var n,i=-1/0,r=0;r<t.length;r++){var a=t[r],o=gn(e)?e(a):a[e];o>i&&(n=a,i=o)}return n}};function VS(t){return 0===t.length?[0,0]:[Xe(GS(t,(function(t){return Xe(t)||0}))),qe(zS(t,(function(t){return qe(t)||0})))]}function WS(t){for(var e=Lc(t),n=e[0].length,i=be([Array(n).fill(0),Array(n).fill(0)],2),r=i[0],a=i[1],o=0;o<e.length;o+=1)for(var s=e[o],l=0;l<n;l+=1)s[l]>=0?(s[l]+=r[l],r[l]=s[l]):(s[l]+=a[l],a[l]=s[l]);return e}var US=function(t){function e(e){return t.call(this,e,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return pe(e,t),Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||0===(null==t?void 0:t.length))return[[]];var e=Lc(t);return le(e[0])?[e]:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?WS(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,e=be(t.getOptions().domain||[0,0],2),n=e[0],i=e[1];return i<0?t.map(i):t.map(n<0?0:n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes;return{width:t.width,height:t.height}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,e=this.attributes,n=e.type,i=e.isStack,r=e.smooth;if("line"!==n)throw new Error("linesStyle can only be used in line type");var a=Tw(this.attributes,"area"),o=Tw(this.attributes,"line"),s=this.containerShape.width,l=this.data;if(0===l[0].length)return{lines:[],areas:[]};var u=this.scales,c=function(t,e){var n,i=e.x,r=e.y,a=be(r.getOptions().range||[0,0],2),o=a[0],s=a[1];return s>o&&(n=be([o,s],2),s=n[0],o=n[1]),t.map((function(t){return t.map((function(t,e){return[i.map(e),de(r.map(t),s,o)]}))}))}(l,{type:"line",x:u.x,y:u.y}),h=[];if(a){var d=this.baseline;h=i?r?function(t,e,n){for(var i=[],r=t.length-1;r>=0;r-=1){var a=t[r],o=FS(a),s=void 0;if(0===r)s=jS(o,e,n);else{var l=FS(t[r-1],!0),u=a[0];l[0][0]="L",s=xe(xe(xe([],be(o),!1),be(l),!1),[xe(["M"],be(u),!1),["Z"]],!1)}i.push(s)}return i}(c,s,d):function(t,e,n){for(var i=[],r=t.length-1;r>=0;r-=1){var a=BS(t[r]),o=void 0;if(0===r)o=jS(a,e,n);else{var s=BS(t[r-1],!0);s[0][0]="L",o=xe(xe(xe([],be(a),!1),be(s),!1),[["Z"]],!1)}i.push(o)}return i}(c,s,d):function(t,e,n,i){return t.map((function(t){return jS(e?FS(t):BS(t),n,i)}))}(c,r,s,d)}return{lines:c.map((function(e,n){return ge({stroke:t.getColor(n),d:r?FS(e):BS(e)},o)})),areas:h.map((function(e,n){return ge({d:e,fill:t.getColor(n)},a)}))}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,e=Tw(this.attributes,"column"),n=this.attributes,i=n.isStack,r=n.type,a=n.scale;if("column"!==r)throw new Error("columnsStyle can only be used in column type");var o=this.containerShape.height,s=this.rawData;if(!s)return{columns:[]};i&&(s=WS(s));var l=this.createScales(s),u=l.x,c=l.y,h=be(VS(s),2),d=h[0],f=h[1],p=new MS({domain:[0,f-(d>0?0:d)],range:[0,o*a]}),g=u.getBandWidth(),v=this.rawData;return{columns:s.map((function(n,r){return n.map((function(n,a){var o=g/s.length;return ge(ge({fill:t.getColor(r)},e),i?{x:u.map(a),y:c.map(n),width:g,height:p.map(v[r][a])}:{x:u.map(a)+o*r,y:n>=0?c.map(n):c.map(0),width:o,height:p.map(Math.abs(n))})}))}))}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){var n,i;(n=e,i=".container",n.querySelector(i)?Rw(n).select(i):Rw(n).append("rect")).attr("className","container").node();var r=t.type,a=t.x,o=t.y,s="spark".concat(r),l=ge({x:a,y:o},"line"===r?this.linesStyle:this.columnsStyle);Rw(e).selectAll(".spark").data([r]).join((function(t){return t.append((function(t){return"line"===t?new _S({className:s,style:l}):new IS({className:s,style:l})})).attr("className","spark ".concat(s))}),(function(t){return t.update(l)}),(function(t){return t.remove()}))},e.prototype.getColor=function(t){var e=this.attributes.color;return $e(e)?e[t%e.length]:gn(e)?e.call(null,t):e},e.prototype.createScales=function(t){var e,n,i=this.attributes,r=i.type,a=i.scale,o=i.range,s=void 0===o?[]:o,l=i.spacing,u=this.containerShape,c=u.width,h=u.height,d=be(VS(t),2),f=d[0],p=d[1],g=new MS({domain:[null!==(e=s[0])&&void 0!==e?e:f,null!==(n=s[1])&&void 0!==n?n:p],range:[h,h*(1-a)]});return"line"===r?{type:r,x:new MS({domain:[0,t[0].length-1],range:[0,c]}),y:g}:{type:r,x:new DS({domain:t[0].map((function(t,e){return e})),range:[0,c],paddingInner:l,paddingOuter:l/2,align:.5}),y:g}},e.tag="sparkline",e}(kw),HS={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},YS={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},$S={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},XS=Dw({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),qS=Dw({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),KS=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),e.prototype.render=function(t,e){var n=t.x,i=t.y,r=t.size,a=void 0===r?10:r,o=t.radius,s=void 0===o?a/4:o,l=t.orientation,u=ve(t,["x","y","size","radius","orientation"]),c=a,h=2.4*c,d=Rw(e).maybeAppendByClassName(qS.iconRect,"rect").styles(ge(ge({},u),{width:c,height:h,radius:s,x:n-c/2,y:i-h/2,transformOrigin:"center"})),f=n+1/3*c-c/2,p=n+2/3*c-c/2,g=i+1/4*h-h/2,v=i+3/4*h-h/2;d.maybeAppendByClassName("".concat(qS.iconLine,"-1"),"line").styles(ge({x1:f,x2:f,y1:g,y2:v},u)),d.maybeAppendByClassName("".concat(qS.iconLine,"-2"),"line").styles(ge({x1:p,x2:p,y1:g,y2:v},u)),"vertical"===l&&(d.node().style.transform="rotate(90)")},e}(kw),ZS=function(t){function e(e){return t.call(this,e,$S)||this}return pe(e,t),e.prototype.renderLabel=function(t){var e=this,n=this.attributes,i=n.x,r=n.y,a=n.showLabel,o=Tw(this.attributes,"label"),s=o.x,l=void 0===s?0:s,u=o.y,c=void 0===u?0:u,h=o.transform,d=o.transformOrigin,f=be(Ow(ve(o,["x","y","transform","transformOrigin"]),[]),2),p=f[0],g=f[1],v=Rw(t).maybeAppendByClassName(qS.labelGroup,"g").styles(g),y=ge(ge({},YS),p),m=y.text,b=ve(y,["text"]);_w(!!a,v,(function(t){e.label=t.maybeAppendByClassName(qS.label,"text").styles(ge(ge({},b),{x:i+l,y:r+c,transform:h,transformOrigin:d,text:"".concat(m)})),e.label.on("mousedown",(function(t){t.stopPropagation()})),e.label.on("touchstart",(function(t){t.stopPropagation()}))}))},e.prototype.renderIcon=function(t){var e=this.attributes,n=e.x,i=e.y,r=e.orientation,a=e.type,o=ge(ge({x:n,y:i,orientation:r},HS),Tw(this.attributes,"icon")),s=this.attributes.iconShape,l=void 0===s?function(){return new KS({style:o})}:s;Rw(t).maybeAppendByClassName(qS.iconGroup,"g").selectAll(qS.icon.class).data([l]).join((function(t){return t.append("string"==typeof l?l:function(){return l(a)}).attr("className",qS.icon.name)}),(function(t){return t.update(o)}),(function(t){return t.remove()}))},e.prototype.render=function(t,e){this.renderIcon(e),this.renderLabel(e)},e}(kw),QS=function(t){function e(e){var n=t.call(this,e,ge(ge(ge({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(t){return t.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},Aw($S,"handle")),Aw(HS,"handleIcon")),Aw(YS,"handleLabel")))||this;return n.range=[0,1],n.onDragStart=function(t){return function(e){e.stopPropagation(),n.target=t,n.prevPos=n.getOrientVal(tS(e));var i=n.availableSpace,r=i.x,a=i.y,o=n.getBBox(),s=o.x,l=o.y;n.selectionStartPos=n.getRatio(n.prevPos-n.getOrientVal([r,a])-n.getOrientVal([+s,+l])),n.selectionWidth=0,document.addEventListener("pointermove",n.onDragging),document.addEventListener("pointerup",n.onDragEnd)}},n.onDragging=function(t){var e=n.attributes,i=e.slidable,r=e.brushable,a=e.type;t.stopPropagation();var o=n.getOrientVal(tS(t)),s=o-n.prevPos;if(s){var l=n.getRatio(s);switch(n.target){case"start":i&&n.setValuesOffset(l);break;case"end":i&&n.setValuesOffset(0,l);break;case"selection":i&&n.setValuesOffset(l,l);break;case"track":if(!r)return;n.selectionWidth+=l,"range"===a?n.innerSetValues([n.selectionStartPos,n.selectionStartPos+n.selectionWidth].sort(),!0):n.innerSetValues([0,n.selectionStartPos+n.selectionWidth],!0)}n.prevPos=o}},n.onDragEnd=function(){document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointerup",n.onDragEnd),n.target="",n.updateHandlesPosition(!1)},n.onValueChange=function(t){var e=n.attributes,i=e.onChange,r=e.type,a="range"===r?t:t[1],o="range"===r?n.getValues():n.getValues()[1],s=new ys("valuechange",{detail:{oldValue:a,value:o}});n.dispatchEvent(s),null==i||i(o)},n.selectionStartPos=0,n.selectionWidth=0,n.prevPos=0,n.target="",n}return pe(e,t),Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){if("horizontal"!==this.attributes.orientation)return null;var t=Tw(this.attributes,"sparkline");return ge(ge({zIndex:0},this.availableSpace),t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,e=t.trackLength,n=t.trackSize,i=be(this.getOrientVal([[e,n],[n,e]]),2);return{width:i[0],height:i[1]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,e=(t.x,t.y,be(Iw(t.padding),4)),n=e[0],i=e[1],r=e[2],a=e[3],o=this.shape;return{x:a,y:n,width:o.width-(a+i),height:o.height-(n+r)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1),this.attributes.values=t;var n=!1!==e&&this.attributes.animate;this.updateSelectionArea(n),this.updateHandlesPosition(n)},e.prototype.updateSelectionArea=function(t){var e=this.calcSelectionArea();this.foregroundGroup.selectAll(XS.selection.class).each((function(n,i){$w(this,e[i],t)}))},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&$w(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&$w(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1);var n=this.values,i=this.clampValues(t);this.attributes.values=i,this.setValues(i),e&&this.onValueChange(n)},e.prototype.renderTrack=function(t){var e=this.attributes,n=e.x,i=e.y,r=Tw(this.attributes,"track");this.trackShape=Rw(t).maybeAppendByClassName(XS.track,"rect").styles(ge(ge({x:n,y:i},this.shape),r))},e.prototype.renderBrushArea=function(t){var e=this.attributes,n=e.x,i=e.y,r=e.brushable;this.brushArea=Rw(t).maybeAppendByClassName(XS.brushArea,"rect").styles(ge({x:n,y:i,fill:"transparent",cursor:r?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var e=this,n=this.attributes,i=n.x,r=n.y;_w("horizontal"===n.orientation,Rw(t).maybeAppendByClassName(XS.sparklineGroup,"g"),(function(t){var n=ge(ge({},e.sparklineStyle),{x:i,y:r});t.maybeAppendByClassName(XS.sparkline,(function(){return new US({style:n})})).update(n)}))},e.prototype.renderHandles=function(){var t,e=this,n=this.attributes,i=n.showHandle,r=n.type,a=i?"range"===r?["start","end"]:["end"]:[],o=this;null===(t=this.foregroundGroup)||void 0===t||t.selectAll(XS.handle.class).data(a.map((function(t){return{type:t}})),(function(t){return t.type})).join((function(t){return t.append((function(t){var n=t.type;return new ZS({style:e.getHandleStyle(n)})})).each((function(t){var e=t.type;this.attr("class","".concat(XS.handle.name," ").concat(e,"-handle"));var n="".concat(e,"Handle");o[n]=this,this.addEventListener("pointerdown",o.onDragStart(e))}))}),(function(t){return t.each((function(t){var e=t.type;this.update(o.getHandleStyle(e))}))}),(function(t){return t.each((function(t){var e=t.type,n="".concat(e,"Handle");o[n]=void 0})).remove()}))},e.prototype.renderSelection=function(t){var e=this.attributes,n=e.x,i=e.y,r=e.type,a=e.selectionType;this.foregroundGroup=Rw(t).maybeAppendByClassName(XS.foreground,"g");var o=Tw(this.attributes,"selection"),s=function(t){return t.style("visibility",(function(t){return t.show?"visible":"hidden"})).style("cursor",(function(t){return"select"===a?"grab":"invert"===a?"crosshair":"default"})).styles(ge(ge({},o),{transform:"translate(".concat(n,", ").concat(i,")")}))},l=this;this.foregroundGroup.selectAll(XS.selection.class).data("value"===r?[]:this.calcSelectionArea().map((function(t,e){return{style:ge({},t),index:e,show:"select"===a?1===e:1!==e}})),(function(t){return t.index})).join((function(t){return t.append("rect").attr("className",XS.selection.name).call(s).each((function(t,e){var n=this;1===e?(l.selectionShape=Rw(this),this.on("pointerdown",(function(t){n.attr("cursor","grabbing"),l.onDragStart("selection")(t)})),l.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),l.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),l.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",(function(){n.attr("cursor","grabbing")})),this.addEventListener("pointerup",(function(){n.attr("cursor","pointer")})),this.addEventListener("pointerover",(function(){n.attr("cursor","pointer")}))):this.on("pointerdown",l.onDragStart("track"))}))}),(function(t){return t.call(s)}),(function(t){return t.remove()})),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,e){this.renderTrack(e),this.renderSparkline(e),this.renderBrushArea(e),this.renderSelection(e)},e.prototype.clampValues=function(t,e){var n;void 0===e&&(e=4);var i=be(this.range,2),r=i[0],a=i[1],o=be(this.getValues().map((function(t){return eS(t,e)})),2),s=o[0],l=o[1],u=be(((Array.isArray(t)?t:[s,null!=t?t:l])||[s,l]).map((function(t){return eS(t,e)})),2),c=u[0],h=u[1];if("value"===this.attributes.type)return[0,de(h,r,a)];c>h&&(c=(n=be([h,c],2))[0],h=n[1]);var d=h-c;return d>a-r?[r,a]:c<r?s===r&&l===h?[r,h]:[r,d+r]:h>a?l===a&&s===c?[c,a]:[a-d,a]:[c,h]},e.prototype.calcSelectionArea=function(t){var e=be(this.clampValues(t),2),n=e[0],i=e[1],r=this.availableSpace,a=r.x,o=r.y,s=r.width,l=r.height;return this.getOrientVal([[{y:o,height:l,x:a,width:n*s},{y:o,height:l,x:n*s+a,width:(i-n)*s},{y:o,height:l,x:i*s,width:(1-i)*s}],[{x:a,width:s,y:o,height:n*l},{x:a,width:s,y:n*l+o,height:(i-n)*l},{x:a,width:s,y:i*l,height:(1-i)*l}]])},e.prototype.calcHandlePosition=function(t){var e=this.attributes.handleIconOffset,n=this.availableSpace,i=n.x,r=n.y,a=n.width,o=n.height,s=be(this.clampValues(),2),l=s[0],u=s[1],c="start"===t?-e:e,h=("start"===t?l:u)*this.getOrientVal([a,o])+c;return{x:i+this.getOrientVal([h,a/2]),y:r+this.getOrientVal([o/2,h])}},e.prototype.inferTextStyle=function(t){return"horizontal"===this.attributes.orientation?{}:"start"===t?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:"end"===t?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var e,n=this.attributes,i=n.type,r=n.orientation,a=n.formatter,o=n.autoFitLabel,s=Tw(this.attributes,"handle"),l=Tw(s,"label"),u=s.spacing,c=this.getHandleSize(),h=this.clampValues(),d=a("start"===t?h[0]:h[1]),f=new Pw({style:ge(ge(ge({},l),this.inferTextStyle(t)),{text:d})}),p=f.getBBox(),g=p.width,v=p.height;if(f.destroy(),!o){if("value"===i)return{text:d,x:0,y:-v-u};var y=u+c+("horizontal"===r?g/2:0);return(e={text:d})["horizontal"===r?"x":"y"]="start"===t?-y:y,e}var m=0,b=0,x=this.availableSpace,E=x.width,w=x.height,k=this.calcSelectionArea()[1],M=k.x,S=k.y,N=k.width,T=k.height,A=u+c;if("horizontal"===r){var O=A+g/2;m="start"===t?M-A-g>0?-O:O:E-M-N-A>g?O:-O}else{var P=v+A;b="start"===t?S-c>v?-P:A:w-(S+T)-c>v?P:-A}return{x:m,y:b,text:d}},e.prototype.getHandleLabelStyle=function(t){var e=Tw(this.attributes,"handleLabel");return ge(ge(ge({},e),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,e=Tw(this.attributes,"handleIcon"),n=this.getOrientVal(["ew-resize","ns-resize"]),i=this.getHandleSize();return ge({cursor:n,shape:t,size:i},e)},e.prototype.getHandleStyle=function(t){var e=this.attributes,n=e.x,i=e.y,r=e.showLabel,a=e.showLabelOnInteraction,o=e.orientation,s=this.calcHandlePosition(t),l=s.x,u=s.y,c=this.calcHandleText(t),h=r;return!r&&a&&(h=!!this.target),ge(ge(ge({},Aw(this.getHandleIconStyle(),"icon")),Aw(ge(ge({},this.getHandleLabelStyle(t)),c),"label")),{transform:"translate(".concat(l+n,", ").concat(u+i,")"),orientation:o,showLabel:h,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,e=t.handleIconSize,n=t.width,i=t.height;return e||Math.floor((this.getOrientVal([+i,+n])+4)/2.4)},e.prototype.getOrientVal=function(t){var e=be(t,2),n=e[0],i=e[1];return"horizontal"===this.attributes.orientation?n:i},e.prototype.setValuesOffset=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=!1);var i=this.attributes.type,r=be(this.getValues(),2),a=[r[0]+("range"===i?t:0),r[1]+e].sort();n?this.setValues(a):this.innerSetValues(a,!0)},e.prototype.getRatio=function(t){var e=this.availableSpace,n=e.width,i=e.height;return t/this.getOrientVal([n,i])},e.prototype.dispatchCustomEvent=function(t,e,n){var i=this;t.on(e,(function(t){t.stopPropagation(),i.dispatchEvent(new ys(n,{detail:t}))}))},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){if(this.attributes.scrollable){var e=t.deltaX,n=t.deltaY||e,i=this.getRatio(n);this.setValuesOffset(i,i,!0)}},e.tag="slider",e}(kw),JS={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(t){return t.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},tN=Dw({background:"background",labelGroup:"label-group",label:"label"},"indicator"),eN=function(t){function e(e){var n=t.call(this,e,JS)||this;return n.point=[0,0],n.group=n.appendChild(new wl({})),n.isMutationObserved=!0,n}return pe(e,t),e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,e=t.position,n=be(Iw(t.padding),4),i=n[0],r=n[1],a=n[2],o=n[3],s=this.label.node().getLocalBounds(),l=s.min,u=s.max,c=new Lw(l[0]-o,l[1]-i,u[0]+r-l[0]+o,u[1]+a-l[1]+i),h=this.getPath(e,c),d=Tw(this.attributes,"background");this.background=Rw(this.group).maybeAppendByClassName(tN.background,"path").styles(ge(ge({},d),{d:h})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,e=t.formatter,n=t.labelText,i=be(Ow(Tw(this.attributes,"label")),2),r=i[0],a=i[1],o=(r.text,ve(r,["text"]));this.label=Rw(this.group).maybeAppendByClassName(tN.labelGroup,"g").styles(a),n&&this.label.maybeAppendByClassName(tN.label,(function(){return sk(e(n))})).style("text",e(n).toString()).selectAll("text").styles(o)},e.prototype.adjustLayout=function(){var t=be(this.point,2),e=t[0],n=t[1],i=this.attributes,r=i.x,a=i.y;this.group.attr("transform","translate(".concat(r-e,", ").concat(a-n,")"))},e.prototype.getPath=function(t,e){var n=this.attributes.radius,i=e.x,r=e.y,a=e.width,o=e.height,s=[["M",i+n,r],["L",i+a-n,r],["A",n,n,0,0,1,i+a,r+n],["L",i+a,r+o-n],["A",n,n,0,0,1,i+a-n,r+o],["L",i+n,r+o],["A",n,n,0,0,1,i,r+o-n],["L",i,r+n],["A",n,n,0,0,1,i+n,r],["Z"]],l={top:4,right:6,bottom:0,left:2}[t],u=this.createCorner([s[l].slice(-2),s[l+1].slice(-2)]);return s.splice.apply(s,xe([l+1,1],be(u),!1)),s[0][0]="M",s},e.prototype.createCorner=function(t,e){void 0===e&&(e=10);var n=ok.apply(void 0,xe([],be(t),!1)),i=be(t,2),r=be(i[0],2),a=r[0],o=r[1],s=be(i[1],2),l=s[0],u=s[1],c=be(n?[l-a,[a,l]]:[u-o,[o,u]],2),h=c[0],d=be(c[1],2),f=d[0],p=d[1],g=h/2,v=e*(h/Math.abs(h)),y=v/2,m=v*Math.sqrt(3)/2*.8,b=be([f,f+g-y,f+g,f+g+y,p],5),x=b[0],E=b[1],w=b[2],k=b[3],M=b[4];return n?(this.point=[w,o-m],[["L",x,o],["L",E,o],["L",w,o-m],["L",k,o],["L",M,o]]):(this.point=[a+m,w],[["L",a,x],["L",a,E],["L",a+m,w],["L",a,k],["L",a,M]])},e.prototype.applyVisibility=function(){"hidden"===this.attributes.visibility?vw(this):gw(this)},e.prototype.bindEvents=function(){this.label.on(Ts.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(kw),nN=function(t){function e(n){var i=t.call(this,bw({},e.defaultOptions,n))||this;return i.hoverColor="#f5f5f5",i.selectedColor="#e6f7ff",i.background=i.appendChild(new Dl({})),i.label=i.background.appendChild(new wl({})),i}return pe(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return Iw(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,e=t.label,n=t.value,i=Tw(this.attributes,"label");Rw(this.label).maybeAppend(".label",(function(){return sk(e)})).attr("className","label").styles(i),this.label.attr("__data__",n)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),e=be(this.padding,4),n=e[0],i=e[1],r=e[2],a=e[3],o=t.width,s=t.height,l=o+a+i,u=s+n+r,c=Tw(this.attributes,"background"),h=this.style,d=h.width,f=void 0===d?0:d,p=h.height,g=void 0===p?0:p,v=h.selected;this.background.attr(ge(ge({},c),{width:Math.max(l,f),height:Math.max(u,g),fill:v?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(a,", ").concat((u-s)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",(function(){t.style.selected||t.background.attr("fill",t.hoverColor)})),this.addEventListener("pointerleave",(function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)}));var e=this;this.addEventListener("click",(function(){var n=t.style,i=n.label,r=n.value,a=n.onClick;null==a||a(r,{label:i,value:r},e)}))},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(kw),iN=function(t){function e(n){var i,r,a=t.call(this,bw({},e.defaultOptions,n))||this;a.currentValue=null===(i=e.defaultOptions.style)||void 0===i?void 0:i.defaultValue,a.isPointerInSelect=!1,a.select=a.appendChild(new Dl({className:"select",style:{cursor:"pointer",width:0,height:0}})),a.dropdown=a.appendChild(new Dl({className:"dropdown"}));var o=a.style.defaultValue;return o&&(null===(r=a.style.options)||void 0===r?void 0:r.some((function(t){return t.value===o})))&&(a.currentValue=o),a}return pe(e,t),e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return Iw(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t,e=this,n=this.style,i=n.x,r=n.y,a=n.width,o=n.height,s=n.bordered,l=n.showDropdownIcon,u=Tw(this.attributes,"select"),c=Tw(this.attributes,"placeholder");this.select.attr(ge(ge({x:i,y:r,width:a,height:o},u),{fill:"#fff",strokeWidth:s?1:0}));var h=this.dropdownPadding;l&&Rw(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(i+a-10-h[1]-h[3],", ").concat(r+o/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var d=null===(t=this.style.options)||void 0===t?void 0:t.find((function(t){return t.value===e.currentValue})),f=ge({x:i+h[3]},c);Rw(this.select).selectAll(".placeholder").data(d?[]:[1]).join((function(t){return t.append("text").attr("className","placeholder").styles(f).style("y",(function(){var t=this.getBBox();return r+(o-t.height)/2}))}),(function(t){return t.styles(f)}),(function(t){return t.remove()}));var p=Tw(this.attributes,"optionLabel"),g=ge({x:i+h[3]},p);Rw(this.select).selectAll(".value").data(d?[d]:[]).join((function(t){return t.append((function(t){return sk(t.label)})).attr("className","value").styles(g).style("y",(function(){var t=this.getBBox();return r+(o-t.height)/2}))}),(function(t){return t.styles(g)}),(function(t){return t.remove()}))},e.prototype.renderDropdown=function(){var t,e,n=this,i=this.style,r=i.x,a=i.y,o=i.width,s=i.height,l=i.options,u=i.onSelect,c=i.open,h=Tw(this.attributes,"dropdown"),d=Tw(this.attributes,"option"),f=this.dropdownPadding;Rw(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(l,(function(t){return t.value})).join((function(t){return t.append((function(t){return new nN({className:"dropdown-item",style:ge(ge(ge({},t),d),{width:o-f[1]-f[3],selected:t.value===n.currentValue,onClick:function(t,e,i){n.setValue(t),null==u||u(t,e,i),n.dispatchEvent(new ys("change",{detail:{value:t,option:e,item:i}})),vw(n.dropdown)}})})})).each((function(t,e){var n,i=(null===(n=this.parentNode)||void 0===n?void 0:n.children).reduce((function(t,n,i){return i<e&&(t+=n.getBBox().height),t}),0);this.attr("transform","translate(".concat(f[3],", ").concat(f[0]+i,")"))}))}),(function(t){return t.update((function(t){return{selected:t.value===n.currentValue}}))}),(function(t){return t.remove()}));var p=null===(e=null===(t=this.dropdown.getElementsByClassName("dropdown-container"))||void 0===t?void 0:t[0])||void 0===e?void 0:e.getBBox(),g=h.spacing;this.dropdown.attr(ge({transform:"translate(".concat(r,", ").concat(a+s+g,")"),width:p.width+f[1]+f[3],height:p.height+f[0]+f[2]},h)),!c&&vw(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",(function(t){t.stopPropagation()})),this.select.addEventListener("click",(function(){"visible"===t.dropdown.style.visibility?vw(t.dropdown):gw(t.dropdown)})),this.addEventListener("pointerenter",(function(){t.isPointerInSelect=!0})),this.addEventListener("pointerleave",(function(){t.isPointerInSelect=!1})),null===document||void 0===document||document.addEventListener("click",(function(){t.isPointerInSelect||vw(t.dropdown)}))},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(kw),rN=function(t){function e(n){var i=t.call(this,bw({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,n))||this;return i.showBackground=!0,i.background=i.appendChild(new Dl({})),i.icon=i.appendChild(new wl({})),i}return pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return Iw(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,e=be(this.padding,4),n=e[0],i=e[1],r=e[2],a=e[3];return Math.max(t-Math.max(a+i,n+r),2*this.lineWidth+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,n=t.y,i=t.size,r=i/2,a=Tw(this.attributes,"background");this.background.attr(ge({x:e-r,y:n-r,width:i,height:i},a))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,e=this.background.getBBox(),n=e.x,i=e.y;this.indicator.update({x:n+t/2,y:i-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){var e;t.prototype.connectedCallback.call(this);var n=this.attributes.size,i=this.background.getBBox(),r=i.x,a=i.y,o=null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView;o&&(this.indicator=o.appendChild(new eN({style:{x:r+n/2,y:a-n/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,n=this.attributes.onClick;if(this.addEventListener("click",(function(){null==n||n(t)})),this.showBackground){var i=function(){return t.background.attr({opacity:e.backgroundOpacities.default})};this.addEventListener("pointerenter",(function(){t.background.attr({opacity:e.backgroundOpacities.hover}),t.showIndicator()})),this.addEventListener("pointerleave",(function(){i(),t.hideIndicator()})),this.addEventListener("pointerdown",(function(){t.background.attr({opacity:e.backgroundOpacities.active})})),this.addEventListener("pointerup",(function(){i()}))}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(kw),aN=function(t,e){return void 0===e&&(e="#565758"),new Ol({style:{fill:e,d:"M ".concat(t,",").concat(t," L -").concat(t,",0 L ").concat(t,",-").concat(t," Z"),transformOrigin:"center"}})},oN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),e.prototype.arcPath=function(t,e,n){var i=be([n,n],2),r=i[0],a=i[1],o=function(i){return[t+n*Math.cos(i),e+n*Math.sin(i)]},s=be(o(-5/4*Math.PI),2),l=s[0],u=s[1],c=be(o(1/4*Math.PI),2),h=c[0],d=c[1];return"M".concat(l,",").concat(u,",A").concat(r,",").concat(a,",0,1,1,").concat(h,",").concat(d)},Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,i=t.color,r=this.iconSize,a=this.lineWidth,o=a+.5;Rw(this.icon).maybeAppend(".reset","path").styles({stroke:i,lineWidth:a,d:this.arcPath(e,n,r/2-a),markerStart:aN(o,i)})},e}(rN),sN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,i=t.color,r=this.iconSize,a=r/2,o=r/2/Math.pow(3,.5),s=[[e,n],[e,n-o],[e-a,n],[e,n+o],[e,n],[e+a,n-o],[e+a,n+o],[e,n]];Rw(this.icon).maybeAppend(".backward","polygon").styles({points:s,fill:i})},e}(rN),lN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,i=t.color,r=this.iconSize,a=r/2,o=r/2/Math.pow(3,.5),s=[[e,n],[e,n-o],[e+a,n],[e,n+o],[e,n],[e-a,n-o],[e-a,n+o],[e,n]];Rw(this.icon).maybeAppend(".forward","polygon").styles({points:s,fill:i})},e}(rN),uN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,i=t.color,r=this.iconSize,a=r/3*Math.pow(3,.5)*.8,o=[[e+a,n],[e-a/2,n-r/2*.8],[e-a/2,n+r/2*.8],[e+a,n]];Rw(this.icon).maybeAppend(".play","polygon").styles({points:o,fill:i})},e}(rN),cN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,i=t.color,r=this.iconSize,a=r/3,o=[[e-a,n-r/2],[e-a,n+r/2],[e-a/2,n+r/2],[e-a/2,n-r/2],[e-a,n-r/2],[e+a/2,n-r/2],[e+a/2,n+r/2],[e+a,n+r/2],[e+a,n-r/2]];Rw(this.icon).maybeAppend(".pause","polygon").styles({points:o,fill:i})},e}(rN),hN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,i=t.color,r=this.iconSize,a=this.lineWidth,o=a;Rw(this.icon).maybeAppend(".left-line","line").styles({x1:e-r/2,y1:n-r/2,x2:e-r/2,y2:n+r/2,stroke:i,lineWidth:a}),Rw(this.icon).maybeAppend(".right-line","line").styles({x1:e+r/2,y1:n-r/2,x2:e+r/2,y2:n+r/2,stroke:i,lineWidth:a}),Rw(this.icon).maybeAppend(".left-arrow","line").styles({x1:e,y1:n,x2:e-r/2+2*o,y2:n,stroke:i,lineWidth:a,markerEnd:aN(2*a,i)}),Rw(this.icon).maybeAppend(".right-arrow","line").styles({x1:e,y1:n,x2:e+r/2-2*o,y2:n,stroke:i,lineWidth:a,markerEnd:aN(2*a,i)})},e}(rN),dN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,i=t.color,r=this.iconSize,a=this.lineWidth;Rw(this.icon).maybeAppend(".line","line").styles({x1:e,y1:n-r/2,x2:e,y2:n+r/2,stroke:i,lineWidth:a});var o=a;Rw(this.icon).maybeAppend(".left-arrow","line").styles({x1:e-r/2-2*o,y1:n,x2:e-2*o,y2:n,stroke:i,lineWidth:a,markerEnd:aN(2*a,i)}),Rw(this.icon).maybeAppend(".right-arrow","line").styles({x1:e+r/2+2*o,y1:n,x2:e+2*o,y2:n,stroke:i,lineWidth:a,markerEnd:aN(2*a,i)})},e}(rN),fN=function(t){return[[-t/2,-t/2],[-t/2,t/2],[t/2,t/2]]},pN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,i=t.color,r=this.iconSize,a=this.lineWidth,o=(r-2*a-a)/4,s=(r-2*a-a)/2,l=be([e-r/2+a,n+r/2-2*a],2),u=l[0],c=l[1];Rw(this.icon).maybeAppend(".coordinate","polyline").styles({points:fN(r).map((function(t){var i=be(t,2),r=i[0],a=i[1];return[r+e,a+n]})),stroke:i,lineWidth:a}),Rw(this.icon).maybeAppend(".line","polyline").styles({points:[[u,c],[u+o,c-s],[u+2*o,c],[u+4*o,c-2*s]],stroke:i,lineWidth:a})},e}(rN),gN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,e=this.attributes,n=e.x,i=e.y,r=e.color,a=this.iconSize,o=this.lineWidth,s=o,l=(a-s)/t.length,u=(a-2*s)/4,c=be([n-a/2+2*s,i+a/2-s],2),h=c[0],d=c[1];Rw(this.icon).maybeAppend(".coordinate","polyline").styles({points:fN(a).map((function(t){var e=be(t,2),r=e[0],a=e[1];return[r+n,a+i]})),stroke:r,lineWidth:o}),Rw(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map((function(t,e){return{value:t,index:e}}))).join((function(t){return t.append("line").attr("className","column").style("x1",(function(t){var e=t.index;return h+l*e})).style("y1",d).style("x2",(function(t){var e=t.index;return h+l*e})).style("y2",(function(t){var e=t.value;return d-u*e})).styles({y1:d,stroke:r,lineWidth:o})}))},e}(rN),vN=function(t){function e(e){var n=t.call(this,bw({},{style:{color:"#d8d9d9"}},e))||this;return n.showBackground=!1,n}return pe(e,t),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,i=t.color,r=this.iconSize,a=this.lineWidth;Rw(this.icon).maybeAppend(".split","line").styles({x1:e,y1:n-r/2,x2:e,y2:n+r/2,stroke:i,lineWidth:a})},e}(rN),yN=function(t){function e(){var e=t.apply(this,xe([],be(arguments),!1))||this;return e.showBackground=!1,e}return pe(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return Iw(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,e=this.attributes,n=e.x,i=e.y,r=e.speed,a=void 0===r?1:r,o=Ax(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),s=de(t,20,1/0),l=ge(ge({},o),{x:n-s/2,y:i-10,width:s,height:20,defaultValue:a,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});Rw(this.icon).maybeAppend(".speed",(function(){return new iN({style:l})})).attr("className","speed").each((function(){this.update(l)}))},e.tag="SpeedSelect",e}(rN),mN=function(t){function e(e){var n=t.call(this,e)||this;return n.icon=n.appendChild(new wl({})),n.currentType=n.attributes.type,n}return pe(e,t),e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,e=this.attributes,n=(e.onChange,ve(e,["onChange"]));Rw(this.icon).selectAll(".icon").data([this.currentType]).join((function(e){return e.append((function(e){var n,i=null===(n=t.toggles.find((function(t){return be(t,1)[0]===e})))||void 0===n?void 0:n[1];if(!i)throw new Error("Invalid type: ".concat(e));return new i({})})).attr("className","icon").styles(n,!1).update({})}),(function(t){return t.styles({restStyles:n}).update({})}),(function(t){return t.remove()}))},e.prototype.bindEvents=function(){var t=this,e=this.attributes.onChange;this.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation();var i=(t.toggles.findIndex((function(e){return be(e,1)[0]===t.currentType}))+1)%t.toggles.length,r=t.toggles[i][0];null==e||e(t.currentType),t.currentType=r,t.render()}))},e.tag="ToggleIcon",e}(kw),bN=function(t){function e(e){var n=t.call(this,bw({},{style:{type:"play"}},e))||this;return n.toggles=[["play",uN],["pause",cN]],n}return pe(e,t),e}(mN),xN=function(t){function e(e){var n=t.call(this,bw({},{style:{type:"range"}},e))||this;return n.toggles=[["range",hN],["value",dN]],n}return pe(e,t),e}(mN),EN=function(t){function e(e){var n=t.call(this,bw({},{style:{type:"column"}},e))||this;return n.toggles=[["line",pN],["column",gN]],n}return pe(e,t),e}(mN),wN={reset:oN,speed:yN,backward:sN,playPause:bN,forward:lN,selectionType:xN,chartType:EN,split:vN},kN=function(t){function e(n){var i=t.call(this,bw({},e.defaultOptions,n))||this;return i.background=i.appendChild(new Dl({})),i.functions=i.appendChild(new wl({})),i}return pe(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return Iw(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,e=t.x,n=t.y,i=t.width,r=t.height,a=Tw(this.attributes,"background");this.background.attr(ge({x:e,y:n,width:i,height:r},a))},e.prototype.renderFunctions=function(){var t,e=this,n=this.attributes,i=n.functions,r=n.iconSize,a=n.iconSpacing,o=n.x,s=n.y,l=n.width,u=n.height,c=n.align,h=be(this.padding,4),d=h[1],f=h[3],p=i.reduce((function(t,e){return t.length&&e.length?t.concat.apply(t,xe(["split"],be(e),!1)):t.concat.apply(t,xe([],be(e),!1))}),[]),g=p.length*(r+a)-a,v={left:f+r/2,center:(l-g)/2+r/2,right:l-g-f-d+r/2}[c]||0;null===(t=this.speedSelect)||void 0===t||t.destroy(),this.functions.removeChildren(),p.forEach((function(t,n){var i,l=wN[t],c={x:o+n*(r+a)+v,y:s+u/2,size:r};if(l===yN?(c.speed=e.attributes.speed,c.onSelect=function(n){return e.handleFunctionChange(t,{value:n})}):[bN,xN,EN].includes(l)?(c.onChange=function(n){return e.handleFunctionChange(t,{value:n})},l===bN&&(c.type="play"===e.attributes.state?"pause":"play"),l===xN&&(c.type="range"===e.attributes.selectionType?"value":"range"),l===EN&&(c.type="line"===e.attributes.chartType?"column":"line")):c.onClick=function(){return e.handleFunctionChange(t,{value:t})},l===yN){var h=null===(i=e.ownerDocument)||void 0===i?void 0:i.defaultView;h&&(e.speedSelect=new l({style:ge(ge({},c),{zIndex:100})}),h.appendChild(e.speedSelect))}else e.functions.appendChild(new l({style:c}))}))},e.prototype.disconnectedCallback=function(){var e;t.prototype.disconnectedCallback.call(this),null===(e=this.speedSelect)||void 0===e||e.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,e){var n=this.attributes.onChange;null==n||n(t,e)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(kw),MN=function(t){function e(n){var i=t.call(this,bw({},e.defaultOptions,n))||this;return i.bindEvents(),i}return pe(e,t),e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",(function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))})),this.addEventListener("mouseleave",(function(){t.attr("lineWidth",0)}))},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(ml),SN=function(t){function e(n){return t.call(this,bw({},e.defaultOptions,n))||this}return pe(e,t),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,n=t.y,i=t.width,r=t.height,a=Tw(this.attributes,"background");Rw(this).maybeAppend("background","rect").attr("className","background").styles(ge({x:e-i/2,y:n-r/2,width:i,height:r},a))},e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,i=t.iconSize,r=Tw(this.attributes,"icon"),a=i/2;Rw(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(ge({x1:e-1,y1:n-a,x2:e-1,y2:n+a},r)),Rw(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(ge({x1:e+1,y1:n-a,x2:e+1,y2:n+a},r))},e.prototype.renderBorder=function(){var t=this.attributes,e=t.x,n=t.y,i=t.width,r=t.height,a=t.type,o=Tw(this.attributes,"border"),s="start"===a?+i/2:-i/2;Rw(this).maybeAppend("border","line").attr("className","border").styles(ge({x1:s+e,y1:n-r/2,x2:s+e,y2:n+r/2},o))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(kw);function NN(t){var e=String(Math.floor(t/3600)).padStart(2,"0"),n=String(Math.floor(t%3600/60)).padStart(2,"0"),i=String(Math.floor(t%60)).padStart(2,"0");return t<3600?"".concat(n,":").concat(i):"".concat(e,":").concat(n,":").concat(i)}var TN=function(t){function e(n){var i=t.call(this,bw({},e.defaultOptions,n))||this;i.axis=i.appendChild(new JM({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),i.timeline=i.appendChild(new QS({style:{onChange:function(t){i.handleSliderChange(t)}}})),i.controller=i.appendChild(new kN({})),i.states={},i.handleSliderChange=function(t){var e,n=(e=i.states.values,Array.isArray(e)?xe([],be(e),!1):e);i.setBySliderValues(t),i.dispatchOnChange(n)};var r=i.attributes,a=r.selectionType,o=r.chartType,s=r.speed,l=r.state,u=r.playMode,c=r.values;return i.states={chartType:o,playMode:u,selectionType:a,speed:s,state:l},i.setByTimebarValues(c),i}return pe(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.data.sort((function(t,e){return t.time<e.time?-1:t.time>e.time?1:0}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t=this.attributes,e=t.x,n=t.y,i=t.width,r=t.height,a=t.type,o=t.controllerHeight,s=de(+r-o,0,+r),l=new Lw(e,n+ +r-o,+i,o),u=0,c="time"===a?10:s;return{axisBBox:"chart"===a?new Lw(e,n+s-(u=35),+i,u):new Lw,controllerBBox:l,timelineBBox:new Lw(e,n+("time"===a?s:s-c),+i,c-u)}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var e,n,i=this.data,r=be(Array.isArray(t)?t:[0,t],2),a=r[0],o=r[1],s=i.length,l=i[Math.floor(a*s)],u=i[Math.ceil(o*s)-(Array.isArray(t)?0:1)];this.states.values=[null!==(e=null==l?void 0:l.time)&&void 0!==e?e:i[0].time,null!==(n=null==u?void 0:u.time)&&void 0!==n?n:1/0]},e.prototype.setByTimebarValues=function(t){var e,n,i,r=this.data,a=be(Array.isArray(t)?t:[void 0,t],2),o=a[0],s=a[1],l=r.find((function(t){return t.time===o})),u=r.find((function(t){return t.time===s}));this.states.values=[null!==(e=null==l?void 0:l.time)&&void 0!==e?e:null===(n=r[0])||void 0===n?void 0:n.time,null!==(i=null==u?void 0:u.time)&&void 0!==i?i:1/0]},e.prototype.setByIndex=function(t){var e,n,i,r,a=this.data,o=be(t,2),s=o[0],l=o[1];this.states.values=[null!==(n=null===(e=a[s])||void 0===e?void 0:e.time)&&void 0!==n?n:a[0].time,null!==(r=null===(i=this.data[l])||void 0===i?void 0:i.time)&&void 0!==r?r:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t,e=this.states,n=e.values,i=e.selectionType,r=be(Array.isArray(n)?n:[void 0,n],2),a=r[0],o=r[1],s=this.data,l=s.length,u="value"===i;return[(t=s.findIndex((function(t){return t.time===a})),u?0:t>-1?t/l:0),function(){if(o===1/0)return 1;var t=s.findIndex((function(t){return t.time===o}));return t>-1?t/l:u?.5:1}()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,e=t.values,n=t.selectionType,i=be(Array.isArray(e)?e:[this.data[0].time,e],2),r=i[0],a=i[1];return"value"===n?a:[r,a]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var e=this.data,n=e.length;return e[Math.floor(t*(n-1))]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,e=this.space.timelineBBox.height;return"range"===t?function(t){return new SN({style:{type:t,height:e,iconSize:e/6}})}:function(){return new Tl({style:{x1:0,y1:-e/2,x2:0,y2:e/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var e=this,n=t.x,i=t.y,r=t.width,a=t.height,o=this.states,s=o.selectionType,l=o.chartType,u=this.data,c=this.attributes,h=c.type,d=c.labelFormatter,f=Tw(this.attributes,"chart"),p=(f.type,ve(f,["type"])),g="range"===s;if("time"===h)return ge({handleIconShape:function(){return new MN({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:g?-15:0,autoFitLabel:g,handleSpacing:g?-15:0,trackFill:"#edeeef",trackLength:r,trackOpacity:.5,trackRadius:a/2,trackSize:a/2,type:s,values:this.sliderValues,formatter:function(t){if(d)return d(t);var n=e.getDatumByRatio(t).time;return"number"==typeof n?NN(n):Wk(n,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(n,", ").concat(i,")"),zIndex:1},p);var v="range"===s?5:0,y=u.map((function(t){return t.value}));return ge({handleIconOffset:v,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:y,sparklineType:l,sparklineScale:.8,trackLength:r,trackSize:a,type:s,values:this.sliderValues,transform:"translate(".concat(n,", ").concat(i,")"),zIndex:1},p)},e.prototype.renderChart=function(t){void 0===t&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var e=this.data,n=this.attributes,i=n.interval,r=n.labelFormatter,a=Tw(this.attributes,"axis"),o=t.x,s=t.y,l=t.width,u=xe(xe([],be(e),!1),[{time:0}],!1).map((function(t,e,n){var i=t.time;return{label:"".concat(i),value:e/(n.length-1),time:i}})),c=ge({startPos:[o,s],endPos:[o+l,s],data:u,labelFilter:function(t,e){return e<u.length-1},labelFormatter:function(t){var e=t.time;return r?r(e):function(t,e){return"number"==typeof t?NN(t):function(t,e){var n=new Date(t);switch(e){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(n.getHours())&&0===n.getMinutes()?Wk(n,"HH:mm\nYYYY-MM-DD"):Wk(n,"HH:mm");case"half-day":return n.getHours()<12?"AM\n".concat(Wk(n,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(n.getDate())?Wk(n,"DD\nYYYY-MM"):Wk(n,"DD");case"week":return n.getDate()<=7?Wk(n,"DD\nYYYY-MM"):Wk(n,"DD");case"month":return[0,6].includes(n.getMonth())?Wk(n,"MM\nYYYY"):Wk(n,"MM");case"season":return[0].includes(n.getMonth())?Wk(n,"MM\nYYYY"):Wk(n,"MM");case"year":return Wk(n,"YYYY");default:return Wk(n,"YYYY-MM-DD HH:mm")}}(t,e)}(e,i)}},a);return c},e.prototype.renderAxis=function(t){void 0===t&&(t=this.space.axisBBox),"chart"===this.attributes.type&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){void 0===t&&(t=this.space.controllerBBox);var e=this.attributes.type,n=this.states,i=n.state,r=n.speed,a=n.selectionType,o=n.chartType,s=Tw(this.attributes,"controller"),l=this,u=ge(ge(ge({},t),{iconSize:20,speed:r,state:i,selectionType:a,chartType:o,onChange:function(t,e){var n=e.value;switch(t){case"reset":l.internalReset();break;case"speed":l.handleSpeedChange(n);break;case"backward":l.internalBackward();break;case"playPause":"play"===n?l.internalPlay():l.internalPause();break;case"forward":l.internalForward();break;case"selectionType":l.handleSelectionTypeChange(n);break;case"chartType":l.handleChartTypeChange(n)}}}),s);"time"===e&&(u.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(u)},e.prototype.dispatchOnChange=function(t){var e=this.data,n=this.attributes.onChange,i=this.states,r=i.values,a=i.selectionType,o=be(r,2),s=o[0],l=o[1],u=l===1/0?e.at(-1).time:l;t&&function(t,e){if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t[0]===e[0]){if(t[1]===e[1])return!0;if(t[1]===1/0||e[1]===1/0)return!0}return!1}return!Array.isArray(e)&&t===e}(t,"range"===a?[s,u]:u)||null==n||n("range"===a?[s,u]:u)},e.prototype.internalReset=function(t){var e,n,i=this.states.selectionType;this.internalPause(),this.setBySliderValues("range"===i?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onReset)||void 0===n||n.call(e),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,e){var n=this.data,i=n.length,r=this.states,a=r.values,o=r.selectionType,s=r.playMode,l=be(a,2),u=l[0],c=l[1],h=n.findIndex((function(t){return t.time===u})),d=n.findIndex((function(t){return t.time===c}));-1===d&&(d=i);var f,p="backward"===t?-1:1;"range"===o?"acc"===s?(f=[h,d+p],-1===p&&h===d&&(f=[h,i])):f=[h+p,d+p]:f=[h,d+p];var g=function(t){var e=be(t.sort((function(t,e){return t-e})),2),n=e[0],r=e[1],a=function(t){return de(t,0,i)};return r>i?"value"===o?[0,0]:"acc"===s?[a(n),a(n)]:[0,a(r-n)]:n<0?"acc"===s?[0,a(r)]:[a(n+i-r),i]:[a(n),a(r)]}(f);return this.setByIndex(g),this.updateSelection(),g},e.prototype.internalBackward=function(t){var e,n,i=this.moveSelection("backward",t);return t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onBackward)||void 0===n||n.call(e),this.dispatchOnChange()),i},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var e,n,i=this,r=this.data,a=this.attributes.loop,o=this.states.speed,s=void 0===o?1:o;this.playInterval=window.setInterval((function(){i.internalForward()[1]!==r.length||a||(i.internalPause(),i.renderController())}),1e3/s),this.states.state="play",!t&&(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onPlay)||void 0===n||n.call(e))},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var e,n;clearInterval(this.playInterval),this.states.state="pause",!t&&(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onPause)||void 0===n||n.call(e))},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var e,n,i=this.moveSelection("forward",t);return t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onForward)||void 0===n||n.call(e),this.dispatchOnChange()),i},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var e,n;this.states.speed=t,"play"===this.states.state&&(this.internalPause(!0),this.internalPlay(!0)),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onSpeedChange)||void 0===n||n.call(e,t)},e.prototype.handleSelectionTypeChange=function(t){var e,n;this.states.selectionType=t,this.renderChart(),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onSelectionTypeChange)||void 0===n||n.call(e,t)},e.prototype.handleChartTypeChange=function(t){var e,n;this.states.chartType=t,this.renderChart(),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onChartTypeChange)||void 0===n||n.call(e,t)},e.prototype.render=function(){var t=this.space,e=t.axisBBox,n=t.controllerBBox,i=t.timelineBBox;this.renderController(n),this.renderAxis(e),this.renderChart(i),"play"===this.states.state&&this.internalPlay()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(kw);const AN=["timestamp","time","date","datetime"];class ON extends Ox{get padding(){return _c(this.options.padding)}constructor(t,e){super(t,Object.assign({},ON.defaultOptions,e)),this.backup(),this.upsertTimebar()}play(){var t;null===(t=this.timebar)||void 0===t||t.play()}pause(){var t;null===(t=this.timebar)||void 0===t||t.pause()}forward(){var t;null===(t=this.timebar)||void 0===t||t.forward()}backward(){var t;null===(t=this.timebar)||void 0===t||t.backward()}reset(){var t;null===(t=this.timebar)||void 0===t||t.reset()}update(t){super.update(t),this.backup(),this.upsertTimebar()}backup(){this.originalData=PN(this.context.graph.getData())}upsertTimebar(){const{canvas:t}=this.context,e=this.options,{onChange:n,timebarType:i,data:r,x:a,y:o,width:s,height:l,mode:u}=e,c=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["onChange","timebarType","data","x","y","width","height","mode"]),h=t.getSize(),[d]=this.padding;this.upsertCanvas().ready.then((()=>{var t;const e=Object.assign(Object.assign({x:h[0]/2-s/2,y:d,onChange:t=>{const e=($e(t)?t:[t,t]).map((t=>function(t){return t instanceof Date}(t)?t.getTime():t));"modify"===this.options.mode?this.filterElements(e):this.hiddenElements(e),null==n||n(e)}},c),{data:r.map((t=>le(t)?{time:t,value:0}:t)),width:s,height:l,type:i});this.timebar?this.timebar.update(e):(this.timebar=new TN({style:e}),null===(t=this.canvas)||void 0===t||t.appendChild(this.timebar))}))}upsertCanvas(){if(this.canvas)return this.canvas;const{className:t,height:e,position:n}=this.options,i=this.context.canvas,[r]=i.getSize(),[a,,o]=this.padding,[s,l]=Lk({width:r,height:e+a+o,graphCanvas:i,className:"timebar",placement:n});return this.container=s,t&&s.classList.add(t),this.canvas=l,this.canvas}filterElements(t){return e=this,n=void 0,r=function*(){var e;if(!this.originalData)return;const{elementTypes:n,getTime:i}=this.options,{graph:r,element:a}=this.context,o=PN(this.originalData);n.forEach((e=>{const n=`${e}s`;o[n]=(this.originalData[n]||[]).filter((e=>{const n=i(e);return!!CN(n,t)}))}));const s=[...o.nodes,...o.combos].map((t=>wh(t)));o.edges=o.edges.filter((t=>{const e=t.source,n=t.target;return s.includes(e)&&s.includes(n)})),r.setData(o),yield null===(e=a.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished},new((i=void 0)||(i=Promise))((function(t,a){function o(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,s)}l((r=r.apply(e,n||[])).next())}));var e,n,i,r}hiddenElements(t){const{graph:e}=this.context,{elementTypes:n,getTime:i}=this.options,r=[],a=[];n.forEach((e=>{var n;const o=`${e}s`;((null===(n=this.originalData)||void 0===n?void 0:n[o])||[]).forEach((e=>{const n=wh(e),o=i(e);CN(o,t)?a.push(n):r.push(n)}))})),e.hideElement(r,!1),e.showElement(a,!1)}destroy(){var t,e,n;const{graph:i}=this.context;this.originalData&&i.setData(Object.assign({},this.originalData)),null===(t=this.timebar)||void 0===t||t.destroy(),null===(e=this.canvas)||void 0===e||e.destroy(),null===(n=this.container)||void 0===n||n.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}ON.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:t=>RN(t,AN,void 0),loop:!1};const PN=t=>{const{nodes:e=[],edges:n=[],combos:i=[]}=t;return{nodes:[...e],edges:[...n],combos:[...i]}},CN=(t,e)=>{if(le(e))return t===e;const[n,i]=e;return t>=n&&t<=i},RN=(t,e,n)=>{var i;for(let n=0;n<e.length;n++){const r=e[n],a=null===(i=t.data)||void 0===i?void 0:i[r];if(a)return a}return n};var LN=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class DN extends Ox{constructor(t,e){super(t,Object.assign({},DN.defaultOptions,e)),this.$element=Px("toolbar",!1),this.onToolbarItemClick=t=>{const{onClick:e}=this.options;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){const n=t.target.getAttribute("value");null==e||e(n,t.target)}};const n=this.context.canvas.getContainer();this.$element.style.display="flex",n.appendChild(this.$element),Cx("g6-toolbar-css","style",{},"\n  .g6-toolbar {\n    position: absolute;\n    z-index: 100;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    border-radius: 4px;\n    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);\n    opacity: 0.65;\n  }\n  .g6-toolbar .g6-toolbar-item {\n    display: inline-block;\n    width: 16px;\n    height: 16px;\n    padding: 4px;\n    cursor: pointer;\n    box-sizing: content-box;\n  }\n\n  .g6-toolbar .g6-toolbar-item:hover {\n    background-color: #f0f0f0;\n  }\n\n  .g6-toolbar .g6-toolbar-item svg {\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n  }\n",document.head),Cx("g6-toolbar-svgicon","div",{display:"none"},'\n  <svg>\n    <symbol id="zoom-in" viewBox="64 64 896 896">\n      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="zoom-out" viewBox="64 64 896 896">\n      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="edit" viewBox="64 64 896 896">\n      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>\n    </symbol>\n    <symbol id="delete" viewBox="64 64 896 896">\n      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>\n    </symbol>\n    <symbol id="redo" viewBox="64 64 896 896">\n      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>\n    </symbol>\n    <symbol id="undo" viewBox="64 64 896 896">\n      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>\n    </symbol>\n    <symbol id="export" viewBox="64 64 896 896">\n      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>\n    </symbol>\n    <symbol id="auto-fit" viewBox="64 64 896 896">\n      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>\n      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>\n    </symbol>\n    <symbol id="reset" viewBox="64 64 896 896">\n      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>\n    </symbol>\n    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>\n    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>\n  </svg>\n'),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return LN(this,void 0,void 0,(function*(){e.update.call(this,t);const{className:n,position:i,style:r}=this.options;this.$element.className=`g6-toolbar ${n||""}`,Object.assign(this.$element.style,r,function(t){const e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return t.split("-").forEach((t=>{e[t]="8px"})),e.flexDirection=t.startsWith("top")||t.startsWith("bottom")?"row":"column",e}(i)),this.$element.innerHTML=yield this.getDOMContent()}))}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return LN(this,void 0,void 0,(function*(){return(yield this.options.getItems()).map((t=>{var e;return`\n          <div class="g6-toolbar-item" value="${t.value}" title="${null!==(e=t.title)&&void 0!==e?e:""}">\n            <svg aria-hidden="true" focusable="false">\n              <use xlink:href="#${t.id}"></use>\n            </svg>\n          </div>`})).join("")}))}}function IN(t){var e=document.createElement("div");e.innerHTML=t;var n=e.childNodes[0];return n&&e.contains(n)&&e.removeChild(n),n}DN.defaultOptions={position:"top-left"};var _N=function(t,e){null!=e?t.replaceChildren?Array.isArray(e)?t.replaceChildren.apply(t,xe([],be(e),!1)):t.replaceChildren(e):(t.innerHTML="",Array.isArray(e)?e.forEach((function(e){return t.appendChild(e)})):t.appendChild(e)):t.innerHTML=""};function BN(t){return void 0===t&&(t=""),{CONTAINER:"".concat(t,"tooltip"),TITLE:"".concat(t,"tooltip-title"),LIST:"".concat(t,"tooltip-list"),LIST_ITEM:"".concat(t,"tooltip-list-item"),NAME:"".concat(t,"tooltip-list-item-name"),MARKER:"".concat(t,"tooltip-list-item-marker"),NAME_LABEL:"".concat(t,"tooltip-list-item-name-label"),VALUE:"".concat(t,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(t,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(t,"tooltip-crosshair-y")}}var FN={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function jN(t){var e;void 0===t&&(t="");var n=BN(t);return(e={})[".".concat(n.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(n.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(n.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(n.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(n.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(n.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(n.NAME_LABEL)]=ge({flex:1},FN),e[".".concat(n.VALUE)]=ge({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},FN),e[".".concat(n.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(n.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var GN=function(t){function e(e){var n,i,r=this,a=null===(i=null===(n=e.style)||void 0===n?void 0:n.template)||void 0===i?void 0:i.prefixCls,o=BN(a);return(r=t.call(this,e,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(o.CONTAINER,'"></div>'),title:'<div class="'.concat(o.TITLE,'"></div>'),item:'<li class="'.concat(o.LIST_ITEM,'" data-index={index}>\n        <span class="').concat(o.NAME,'">\n          <span class="').concat(o.MARKER,'" style="background:{color}"></span>\n          <span class="').concat(o.NAME_LABEL,'" title="{name}">{name}</span>\n        </span>\n        <span class="').concat(o.VALUE,'" title="{value}">{value}</span>\n      </li>')},style:jN(a)})||this).timestamp=-1,r.prevCustomContentKey=r.attributes.contentKey,r.initShape(),r.render(r.attributes,r),r}return pe(e,t),Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){return{width:this.element.offsetWidth,height:this.element.offsetHeight}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,e=t.data,n=t.template;return e.map((function(t,e){var i,r,a=t.name,o=void 0===a?"":a,s=t.color,l=void 0===s?"black":s,u=t.index,c=ve(t,["name","color","index"]),h=ge({name:o,color:l,index:null!=u?u:e},c);return IN((i=n.item,r=h,i&&r?i.replace(/\\?\{([^{}]+)\}/g,(function(t,e){return"\\"===t.charAt(0)?t.slice(1):void 0===r[e]?"":r[e]})):i))}))},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var e;null===(e=this.element)||void 0===e||e.remove(),t.prototype.destroy.call(this)},e.prototype.show=function(t,e){var n=this;if(void 0!==t&&void 0!==e){var i=function(){n.attributes.x=null!=t?t:n.attributes.x,n.attributes.y=null!=e?e:n.attributes.y,n.updatePosition()};"hidden"===this.element.style.visibility?this.closeTransition(i):i()}this.element.style.visibility="visible"},e.prototype.hide=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.attributes.enterable&&this.isCursorEntered(t,e)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=IN(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(void 0===this.prevCustomContentKey||this.prevCustomContentKey!==this.attributes.contentKey){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&("string"==typeof t?this.element.innerHTML=t:_N(this.element,t))}},e.prototype.renderHTMLTooltipElement=function(){var t,e,n=this.attributes,i=n.template,r=n.title,a=n.enterable,o=n.style,s=n.content,l=BN(i.prefixCls),u=this.element;if(this.element.style.pointerEvents=a?"auto":"none",s)this.renderCustomContent();else{r?(u.innerHTML=i.title,u.getElementsByClassName(l.TITLE)[0].innerHTML=r):null===(e=null===(t=u.getElementsByClassName(l.TITLE))||void 0===t?void 0:t[0])||void 0===e||e.remove();var c=this.HTMLTooltipItemsElements,h=document.createElement("ul");h.className=l.LIST,_N(h,c);var d=this.element.querySelector(".".concat(l.LIST));d?d.replaceWith(h):u.appendChild(h)}!function(t,e){Object.entries(e).forEach((function(e){var n=be(e,2),i=n[0],r=n[1];xe([t],be(t.querySelectorAll(i)),!1).filter((function(t){return t.matches(i)})).forEach((function(t){t&&(t.style.cssText+=Object.entries(r).reduce((function(t,e){return"".concat(t).concat(e.join(":"),";")}),""))}))}))}(u,o)},e.prototype.getRelativeOffsetFromCursor=function(t){var e=this.attributes,n=e.position,i=e.offset,r=(t||n).split("-"),a={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},o=this.elementSize,s=o.width,l=o.height,u=[-s/2,-l/2];return r.forEach((function(t){var e=be(u,2),n=e[0],r=e[1],o=be(a[t],2),c=o[0],h=o[1];u=[n+(s/2+i[0])*c,r+(l/2+i[1])*h]})),u},e.prototype.setOffsetPosition=function(t){var e=be(t,2),n=e[0],i=e[1],r=this.attributes,a=r.x,o=void 0===a?0:a,s=r.y,l=void 0===s?0:s,u=r.container,c=u.x,h=u.y;this.element.style.left="".concat(+o+c+n,"px"),this.element.style.top="".concat(+l+h+i,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,e=void 0===t?60:t,n=Date.now();this.timestamp>0&&n-this.timestamp<e||(this.timestamp=n,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var e=be(t,2),n=e[0],i=e[1],r=this.attributes,a=r.x,o=r.y,s=r.bounding,l=r.position;if(!s)return[n,i];var u=this.element,c=u.offsetWidth,h=u.offsetHeight,d=be([+a+n,+o+i],2),f=d[0],p=d[1],g={left:"right",right:"left",top:"bottom",bottom:"top"},v=s.x,y=s.y,m={left:f<v,right:f+c>v+s.width,top:p<y,bottom:p+h>y+s.height},b=[];l.split("-").forEach((function(t){m[t]?b.push(g[t]):b.push(t)}));var x=b.join("-");return this.getRelativeOffsetFromCursor(x)},e.prototype.isCursorEntered=function(t,e){if(this.element){var n=this.element.getBoundingClientRect(),i=n.x,r=n.y,a=n.width,o=n.height;return new Lw(i,r,a,o).isPointIn(t,e)}return!1},e.prototype.closeTransition=function(t){var e=this,n=this.element.style.transition;this.element.style.transition="none",t(),setTimeout((function(){e.element.style.transition=n}),10)},e.tag="tooltip",e}(kw),zN=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class VN extends Ox{constructor(t,e){super(t,Object.assign({},VN.defaultOptions,e)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(t,e)=>{const{enable:n}=this.options;return"function"==typeof n?n(t,e):n},this.onClick=t=>{const{target:{id:e}}=t;this.currentTarget===e?this.hide(t):this.show(t)},this.onPointerMove=t=>{const{target:e}=t;this.currentTarget&&e.id!==this.currentTarget&&this.show(t)},this.onPointerLeave=t=>{this.hide(t)},this.onCanvasMove=t=>{this.hide(t)},this.onPointerOver=t=>{this.show(t)},this.showById=t=>zN(this,void 0,void 0,(function*(){const e={target:{id:t}};yield this.show(e)})),this.getElementData=(t,e)=>{const{model:n}=this.context;switch(e){case"node":return n.getNodeData([t]);case"edge":return n.getEdgeData([t]);case"combo":return n.getComboData([t]);default:return[]}},this.show=t=>zN(this,void 0,void 0,(function*(){var e,n;const{client:i,target:{id:r}}=t;if(ov(t.target))return;const a=this.context.graph.getElementType(r),{getContent:o,title:s}=this.options,l=this.getElementData(r,a);if(!this.tooltipElement||!this.isEnable(t,l))return;let u,c,h={};if(o){if(h.content=yield o(t,l),!h.content)return}else{const t=this.context.graph.getElementRenderStyle(r),e="node"===a?t.fill:t.stroke;h={title:s||a,data:l.map((t=>({name:"ID",value:t.id||`${t.source} -> ${t.target}`,color:e})))}}if(this.currentTarget=r,i)u=i.x,c=i.y;else{const t=_d(l,"0.style",{x:0,y:0});u=t.x,c=t.y}null===(n=(e=this.options).onOpenChange)||void 0===n||n.call(e,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:u,y:c,style:{".tooltip":{visibility:"visible"}}}),h))})),this.hide=t=>{var e,n,i,r,a;if(!t)return null===(n=(e=this.options).onOpenChange)||void 0===n||n.call(e,!1),null===(i=this.tooltipElement)||void 0===i||i.hide(),void(this.currentTarget=null);if(!this.tooltipElement)return;if(!this.currentTarget)return;const{client:{x:o,y:s}}=t;null===(a=(r=this.options).onOpenChange)||void 0===a||a.call(r,!1),this.tooltipElement.hide(o,s),this.currentTarget=null},this.initTooltip=()=>{var t;const e=new GN({className:"tooltip",style:this.tooltipStyleProps});return null===(t=this.container)||void 0===t||t.appendChild(e.HTMLTooltipElement),e},this.render(),this.bindEvents()}getEvents(){return"click"===this.options.trigger?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerover":this.onPointerOver,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerover":this.onPointerOver,"edge:pointermove":this.onPointerMove,"combo:pointerover":this.onPointerOver,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var e;this.unbindEvents(),super.update(t),this.tooltipElement&&(null===(e=this.container)||void 0===e||e.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:t}=this.context,e=t.getContainer();e&&(this.container=e,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach((n=>{t.off(n,e[n])}))}bindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach((n=>{t.on(n,e[n])}))}get tooltipStyleProps(){const{canvas:t}=this.context,{center:e}=t.getBounds(),n=t.getContainer(),{top:i,left:r}=n.getBoundingClientRect(),{style:a,position:o,enterable:s,container:l={x:-r,y:-i},title:u,offset:c}=this.options,[h,d]=e,[f,p]=t.getSize();return{x:h,y:d,container:l,title:u,bounding:{x:0,y:0,width:f,height:p},position:o,enterable:s,offset:c,style:a}}destroy(){var t;this.unbindEvents(),this.tooltipElement&&(null===(t=this.container)||void 0===t||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}VN.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var WN=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};let UN;function HN(t,e){return UN||(UN=document.createElement("canvas")),UN.width=t,UN.height=e,UN.getContext("2d").clearRect(0,0,t,e),UN}class YN extends Ox{constructor(t,e){super(t,Object.assign({},YN.defaultOptions,e)),this.$element=Px("watermark"),this.context.canvas.getContainer().appendChild(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return n=this,i=void 0,a=function*(){e.update.call(this,t);const n=this.options,{width:i,height:r,text:a,imageURL:o}=n,s=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(n,["width","height","text","imageURL"]);Object.keys(s).forEach((e=>{e.startsWith("background")&&(this.$element.style[e]=t[e])}));const l=o?yield function(t,e,n,i){return WN(this,void 0,void 0,(function*(){const r=HN(t,e),a=r.getContext("2d"),{rotate:o,opacity:s}=i;o&&a.rotate(o),s&&(a.globalAlpha=s);const l=new Image;return l.crossOrigin="anonymous",l.src=n,new Promise((n=>{l.onload=function(){const i=t>l.width?(t-l.width)/2:0,o=e>l.height?(e-l.height)/2:0;a.drawImage(l,0,0,l.width,l.height,i,o,t-2*i,e-2*o),n(r.toDataURL())}}))}))}(i,r,o,s):yield function(t,e,n,i){return WN(this,void 0,void 0,(function*(){const r=HN(t,e),a=r.getContext("2d"),{rotate:o,opacity:s,textFill:l,textFontSize:u,textFontFamily:c,textFontVariant:h,textFontWeight:d,textAlign:f,textBaseline:p}=i;return a.textAlign=f,a.textBaseline=p,a.translate(t/2,e/2),a.font=`${u}px ${c} ${h} ${d}`,o&&a.rotate(o),s&&(a.globalAlpha=s),l&&(a.fillStyle=l,a.fillText(`${n}`,0,0)),r.toDataURL()}))}(i,r,a,s);this.$element.style.backgroundImage=`url(${l})`},new((r=void 0)||(r=Promise))((function(t,e){function o(t){try{l(a.next(t))}catch(t){e(t)}}function s(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,s)}l((a=a.apply(n,i||[])).next())}));var n,i,r,a}destroy(){super.destroy(),this.$element.remove()}}YN.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};const $N=["#7E92B5","#F4664A","#FFBE3A"],XN={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},qN={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function KN(t){const{bgColor:e,textColor:n,nodeColor:i,nodeColorDisabled:r,nodeStroke:a,nodeHaloStrokeOpacityActive:o=.15,nodeHaloStrokeOpacitySelected:s=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:u=.85,nodeOpacityInactive:c=.25,nodeBadgePalette:h=$N,nodePaletteOptions:d=XN,edgeColor:f,edgeColorDisabled:p,edgePaletteOptions:g=qN,comboColor:v,comboColorDisabled:y,comboStroke:m,comboStrokeDisabled:b,edgeColorInactive:x}=t;return{background:e,node:{palette:d,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:h,fill:i,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:n,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:i,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:s,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:o},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:c,donutOpacity:c,fillOpacity:c,iconOpacity:u,labelFill:n,labelFillOpacity:c,strokeOpacity:c},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:r,fillOpacity:l,iconFill:r,iconOpacity:.25,labelFill:n,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:g,style:{badgeBackgroundFill:f,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:f,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:x,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:p,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:v,halo:!1,haloLineWidth:12,haloStroke:m,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:m},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:y,fillOpacity:.25,labelOpacity:.25,stroke:b,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const ZN=KN({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),QN=KN({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"});class JN extends _h{beforeDraw(t,e){return t}afterLayout(t,e){}}function tT(t,e,n,i,r){const a=wh(i),o=`${n}s`,s=r?i:t.add[o].get(a)||t.update[o].get(a)||t.remove[o].get(a)||i;Object.entries(t).forEach((([t,n])=>{e===t?n[o].set(a,s):n[o].delete(a)}))}function eT(t,e){return Object.keys(t).every((n=>t[n]===e[n]))}const nT=(t,e,n,i)=>{const r=`${n}s`,a=wh(i);t.add[r].has(a)||t.update[r].has(a)||t[e][r].set(wh(i),i)};function iT(t,e,n){dc[t][e]&&gc.warn(`The extension ${e} of ${t} has been registered before, and will be overridden.`),Object.assign(dc[t],{[e]:n})}new WeakMap;var rT=function(){function t(e){l(this,t),this.dragndropPluginOptions=e}return c(t,[{key:"apply",value:function(e){var n=this,i=e.renderingService,r=e.renderingContext.root.ownerDocument,a=r.defaultView,o=function(t){var e=t.target,i=e===r,o=i&&n.dragndropPluginOptions.isDocumentDraggable?r:e.closest&&e.closest("[draggable=true]");if(o){var s=!1,l=t.timeStamp,u=[t.clientX,t.clientY],c=null,h=[t.clientX,t.clientY],d=function(){var t=jn(Bn().mark((function t(a){var d,f,p,g,v,y;return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=8;break}if(d=a.timeStamp-l,f=ue([a.clientX,a.clientY],u),!(d<=n.dragndropPluginOptions.dragstartTimeThreshold||f<=n.dragndropPluginOptions.dragstartDistanceThreshold)){t.next=5;break}return t.abrupt("return");case 5:a.type="dragstart",o.dispatchEvent(a),s=!0;case 8:if(a.type="drag",a.dx=a.clientX-h[0],a.dy=a.clientY-h[1],o.dispatchEvent(a),h=[a.clientX,a.clientY],i){t.next=21;break}return p="pointer"===n.dragndropPluginOptions.overlap?[a.canvasX,a.canvasY]:e.getBounds().center,t.next=17,r.elementsFromPoint(p[0],p[1]);case 17:g=t.sent,v=g[g.indexOf(e)+1],y=(null==v?void 0:v.closest("[droppable=true]"))||(n.dragndropPluginOptions.isDocumentDroppable?r:null),c!==y&&(c&&(a.type="dragleave",a.target=c,c.dispatchEvent(a)),y&&(a.type="dragenter",a.target=y,y.dispatchEvent(a)),(c=y)&&(a.type="dragover",a.target=c,c.dispatchEvent(a)));case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();a.addEventListener("pointermove",d);var f=function(t){if(s){t.detail={preventClick:!0};var e=t.clone();c&&(e.type="drop",e.target=c,c.dispatchEvent(e)),e.type="dragend",o.dispatchEvent(e),s=!1}a.removeEventListener("pointermove",d)};e.addEventListener("pointerup",f,{once:!0}),e.addEventListener("pointerupoutside",f,{once:!0})}};i.hooks.init.tap(t.tag,(function(){a.addEventListener("pointerdown",o)})),i.hooks.destroy.tap(t.tag,(function(){a.removeEventListener("pointerdown",o)}))}}])}();rT.tag="Dragndrop";var aT=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),(t=v(this,e)).name="dragndrop",t.options=n,t}return m(e,t),c(e,[{key:"init",value:function(){this.addRenderingPlugin(new rT(s({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)}}])}(Yn),oT=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))},sT=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n};const lT=["main"],uT=["background","main","label","transient"];class cT{getConfig(){return this.config}getLayer(t="main"){return this.extends.layers[t]||this.getLayers().main}getLayers(){return this.extends.layers}getRenderer(t){return this.extends.renderers[t]}getCamera(t="main"){return this.getLayer(t).getCamera()}getRoot(t="main"){return this.getLayer(t).getRoot()}getContextService(t="main"){return this.getLayer(t).getContextService()}setCursor(t){this.config.cursor=t,this.getLayer().setCursor(t)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(t){this.config={enableMultiLayer:!0},Object.assign(this.config,t);const e=this.config,{renderer:n,background:i,cursor:r,enableMultiLayer:a}=e,o=sT(e,["renderer","background","cursor","enableMultiLayer"]),s=a?uT:lT,l=hT(n,s),u=Object.fromEntries(s.map((t=>[t,new Kl(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:a,renderer:l[t],background:a?"background"===t?i:void 0:i}))])));dT(u),this.extends={config:this.config,renderer:n,renderers:l,layers:u}}get ready(){return Promise.all(Object.entries(this.getLayers()).map((([,t])=>t.ready)))}resize(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach((n=>{const i=n.getCamera(),r=i.getPosition(),a=i.getFocalPoint();n.resize(t,e),i.setPosition(r),i.setFocalPoint(a)}))}getBounds(t){return Uc(Object.values(this.getLayers()).map((e=>t?e.getRoot().childNodes.find((e=>e.classList.includes(t))):e.getRoot())).filter((t=>(null==t?void 0:t.childNodes.length)>0)).map((t=>t.getBounds())))}getContainer(){const t=this.extends.config.container;return"string"==typeof t?document.getElementById(t):t}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(t,e){var n;const i=(null===(n=t.style)||void 0===n?void 0:n.$layer)||"main";return this.getLayer(i).appendChild(t,e)}setRenderer(t){if(t===this.extends.renderer)return;const e=hT(t,this.config.enableMultiLayer?uT:lT);this.extends.renderers=e,Object.entries(e).forEach((([t,e])=>this.getLayer(t).setRenderer(e))),dT(this.getLayers())}getCanvasByViewport(t){return cd(this.getLayer().viewport2Canvas(hd(t)))}getViewportByCanvas(t){return cd(this.getLayer().canvas2Viewport(hd(t)))}getViewportByClient(t){return cd(this.getLayer().client2Viewport(hd(t)))}getClientByViewport(t){return cd(this.getLayer().viewport2Client(hd(t)))}getClientByCanvas(t){return this.getClientByViewport(this.getViewportByCanvas(t))}getCanvasByClient(t){const e=this.getLayer(),n=e.client2Viewport(hd(t));return cd(e.viewport2Canvas(n))}toDataURL(){return oT(this,arguments,void 0,(function*(t={}){const e=globalThis.devicePixelRatio||1,{mode:n="viewport"}=t,i=sT(t,["mode"]);let[r,a,o,s]=[0,0,0,0];if("viewport"===n)[o,s]=this.getSize();else if("overall"===n){const t=this.getBounds(),e=Gc(t);[r,a]=t.min,[o,s]=e}const l=IN('<div id="virtual-image"></div>'),u=new Kl({width:o,height:s,renderer:new Fp,devicePixelRatio:e,container:l,background:this.extends.config.background});yield u.ready,u.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),u.appendChild(this.getRoot().cloneNode(!0));const c=this.getLayer("label").getRoot().cloneNode(!0),h=u.viewport2Canvas({x:0,y:0}),d=this.getCanvasByViewport([0,0]);c.translate([d[0]-h.x,d[1]-h.y]),c.scale(1/this.getCamera().getZoom()),u.appendChild(c),u.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const f=this.getCamera(),p=u.getCamera();if("viewport"===n)p.setZoom(f.getZoom()),p.setPosition(f.getPosition()),p.setFocalPoint(f.getFocalPoint());else if("overall"===n){const[t,e,n]=p.getPosition(),[i,o,s]=p.getFocalPoint();p.setPosition([t+r,e+a,n]),p.setFocalPoint([i+r,o+a,s])}const g=u.getContextService();return new Promise((t=>{u.addEventListener(Ul.RERENDER,(()=>oT(this,void 0,void 0,(function*(){yield new Promise((t=>setTimeout(t,300)));const e=yield g.toDataURL(i);t(e)}))))}))}))}destroy(){Object.values(this.getLayers()).forEach((t=>{t.getCamera().cancelLandmarkAnimation(),t.destroy()}))}}function hT(t,e){return Object.fromEntries(e.map((e=>{const n=(null==t?void 0:t(e))||new Fp;return n instanceof Fp&&n.setConfig({enableDirtyRectangleRendering:!1}),"main"===e?n.registerPlugin(new aT({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin("dom-interaction")),[e,n]})))}function dT(t){Object.entries(t).forEach((([t,e])=>{const n=e.getContextService().getDomElement();(null==n?void 0:n.style)&&(n.style.gridArea="1 / 1 / 2 / 2",n.style.outline="none",n.tabIndex=1,"main"!==t&&(n.style.pointerEvents="none")),(null==n?void 0:n.parentElement)&&(n.parentElement.style.display="grid",n.parentElement.style.isolation="isolate")}))}const fT=t=>t?parseInt(t):0;function pT(t){if(!t)return[0,0];let e=640,n=480;const[i,r]=function(t){const e=getComputedStyle(t),n=t.clientWidth||fT(e.width),i=t.clientHeight||fT(e.height);return[n-(fT(e.paddingLeft)+fT(e.paddingRight)),i-(fT(e.paddingTop)+fT(e.paddingBottom))]}(t);return e=i||e,n=r||n,[Math.max(le(e)?e:1,1),Math.max(le(n)?n:1,1)]}class gT{constructor(t){this.type=t}}class vT extends gT{constructor(t,e){super(t),this.data=e}}class yT extends gT{constructor(t,e,n,i){super(t),this.animationType=e,this.animation=n,this.data=i}}class mT extends gT{constructor(t,e,n){super(t),this.elementType=e,this.data=n}}class bT extends gT{constructor(t,e){super(t),this.data=e}}function xT(t,e){t.emit(e.type,e)}function ET(t){var e;return(null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.zIndex)||0}const wT="cachedStyle",kT=t=>`__${t}__`;function MT(t,e){return _d(t,[wT,kT(e)])}class ST{constructor(t){this.tasks=[],this.animations=new Set,this.context=t}getTasks(){const t=[...this.tasks];return this.tasks=[],t}add(t,e){this.tasks.push([t,e])}animate(t,e,n){var i,r,a;null===(i=null==e?void 0:e.before)||void 0===i||i.call(e);const o=this.getTasks().map((([e,i])=>{var r,a,o;const{element:s,elementType:l,stage:u}=e,c=function(t,e,n,i){var r,a;const{animation:o}=t;if(!1===o||!1===i)return[];const s=null===(r=null==t?void 0:t[e])||void 0===r?void 0:r.animation;if(!1===s)return[];const l=null==s?void 0:s[n];if(!1===l)return[];const u=null===(a=vc(t)[e])||void 0===a?void 0:a.animation,c=(t=[])=>function(t){return"string"==typeof t?fc(hc.ANIMATION,t)||(gc.warn(`The animation of ${t} is not registered.`),[]):t}(t).map((t=>Object.assign(Object.assign(Object.assign(Object.assign({},Qu),vn(o)&&o),t),vn(i)&&i)));if(l)return c(l);if(!u)return[];const h=u[n];return!1===h?[]:c(h)}(this.context.options,l,u,t);null===(r=null==i?void 0:i.before)||void 0===r||r.call(i);const h=c.length?wc(s,this.inferStyle(e,n),c):null;return h?(null===(a=null==i?void 0:i.beforeAnimate)||void 0===a||a.call(i,h),h.finished.then((()=>{var t,e;null===(t=null==i?void 0:i.afterAnimate)||void 0===t||t.call(i,h),null===(e=null==i?void 0:i.after)||void 0===e||e.call(i),this.animations.delete(h)}))):null===(o=null==i?void 0:i.after)||void 0===o||o.call(i),h})).filter(Boolean);o.forEach((t=>this.animations.add(t)));const s=yc(o);return s?(null===(r=null==e?void 0:e.beforeAnimate)||void 0===r||r.call(e,s),s.finished.then((()=>{var t,n;null===(t=null==e?void 0:e.afterAnimate)||void 0===t||t.call(e,s),null===(n=null==e?void 0:e.after)||void 0===n||n.call(e),this.release()}))):null===(a=null==e?void 0:e.after)||void 0===a||a.call(e),s}inferStyle(t,e){var n,i;const{element:r,elementType:a,stage:o,originalStyle:s,updatedStyle:l={}}=t;t.modifiedStyle||(t.modifiedStyle=Object.assign(Object.assign({},s),l));const{modifiedStyle:u}=t,c={},h={};if("enter"===o)Object.assign(c,{opacity:0});else if("exit"===o)Object.assign(h,{opacity:0});else if("show"===o)Object.assign(c,{opacity:0}),Object.assign(h,{opacity:null!==(n=MT(r,"opacity"))&&void 0!==n?n:bc("opacity")});else if("hide"===o)Object.assign(c,{opacity:null!==(i=MT(r,"opacity"))&&void 0!==i?i:bc("opacity")}),Object.assign(h,{opacity:0});else if("collapse"===o){const{collapse:t}=e||{},{target:n,descendants:i,position:o}=t;if("node"===a){if(i.includes(r.id)){const[t,e,n]=o;Object.assign(h,{x:t,y:e,z:n})}}else if("combo"===a){if(r.id===n||i.includes(r.id)){const[t,e]=o;Object.assign(h,{x:t,y:e,childrenNode:s.childrenNode})}}else"edge"===a&&Object.assign(h,{sourceNode:u.sourceNode,targetNode:u.targetNode})}else if("expand"===o){const{expand:t}=e||{},{target:n,descendants:i,position:o}=t;if("node"===a){if(r.id===n||i.includes(r.id)){const[t,e,n]=o;Object.assign(c,{x:t,y:e,z:n})}}else if("combo"===a){if(r.id===n||i.includes(r.id)){const[t,e,n]=o;Object.assign(c,{x:t,y:e,z:n,childrenNode:u.childrenNode})}}else"edge"===a&&Object.assign(c,{sourceNode:u.sourceNode,targetNode:u.targetNode})}return[Object.keys(c).length>0?Object.assign({},s,c):s,Object.keys(h).length>0?Object.assign({},u,h):u]}stop(){this.animations.forEach((t=>t.cancel()))}clear(){this.tasks=[]}release(){var t,e;const{canvas:n}=this.context,i=null===(e=null===(t=n.document)||void 0===t?void 0:t.timeline)||void 0===e?void 0:e.animationsWithPromises;i&&(n.document.timeline.animationsWithPromises=i.filter((t=>"finished"!==t.playState)))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class NT{constructor(t){this.batchCount=0,this.context=t}emit(t){const{graph:e}=this.context;e.emit(t.type,t)}startBatch(t=!0){this.batchCount++,1===this.batchCount&&this.emit(new vT(oc.BATCH_START,{initiate:t}))}endBatch(){this.batchCount--,0===this.batchCount&&this.emit(new vT(oc.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class TT extends Ih{constructor(t){super(t),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=t=>{const{target:e}=t,n=function(t){if(!t)return null;if(t instanceof Fl)return{type:"canvas",element:t};let e=t;for(;e;){if(Hg(e))return{type:"node",element:e};if(Yg(e))return{type:"edge",element:e};if($g(e))return{type:"combo",element:e};e=e.parentElement}return null}(e);if(!n)return;const{graph:i,canvas:r}=this.context,{type:a,element:o}=n;if("destroyed"in o&&(ov(o)||o.destroyed))return;const{type:s,detail:l,button:u}=t,c=Object.assign(Object.assign({},t),{target:o,targetType:a,originalTarget:e});s===ic.POINTER_MOVE&&(this.currentTarget!==o&&(this.currentTarget&&i.emit(`${this.currentTargetType}:${ic.POINTER_LEAVE}`,Object.assign(Object.assign({},c),{type:ic.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),o&&(Object.assign(c,{type:ic.POINTER_ENTER}),i.emit(`${a}:${ic.POINTER_ENTER}`,c))),this.currentTarget=o,this.currentTargetType=a),s===ic.CLICK&&2===u||(i.emit(`${a}:${s}`,c),i.emit(s,c)),s===ic.CLICK&&2===l&&(Object.assign(c,{type:ic.DBLCLICK}),i.emit(`${a}:${ic.DBLCLICK}`,c),i.emit(ic.DBLCLICK,c)),s===ic.POINTER_DOWN&&2===u&&(Object.assign(c,{type:ic.CONTEXT_MENU,preventDefault:()=>{var t;null===(t=r.getContainer())||void 0===t||t.addEventListener(ic.CONTEXT_MENU,(t=>t.preventDefault()),{once:!0})}}),i.emit(`${a}:${ic.CONTEXT_MENU}`,c),i.emit(ic.CONTEXT_MENU,c))},this.forwardContainerEvents=t=>{this.context.graph.emit(t.type,t)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){const t=this.context.canvas.getContainer();t&&[rc.KEY_DOWN,rc.KEY_UP].forEach((e=>{t.addEventListener(e,this.forwardContainerEvents)}));const e=this.context.canvas.document;e&&[ic.CLICK,ic.DBLCLICK,ic.POINTER_OVER,ic.POINTER_LEAVE,ic.POINTER_ENTER,ic.POINTER_MOVE,ic.POINTER_OUT,ic.POINTER_DOWN,ic.POINTER_UP,ic.CONTEXT_MENU,ic.DRAG_START,ic.DRAG,ic.DRAG_END,ic.DRAG_ENTER,ic.DRAG_OVER,ic.DRAG_LEAVE,ic.DROP,ic.WHEEL].forEach((t=>{e.addEventListener(t,this.forwardCanvasEvents)}))}destroy(){const t=this.context.canvas.getContainer();t&&[rc.KEY_DOWN,rc.KEY_UP].forEach((e=>{t.removeEventListener(e,this.forwardContainerEvents)})),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var AT=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n};function OT(t,e){const{data:n,style:i}=t,r=AT(t,["data","style"]),{data:a,style:o}=e,s=AT(e,["data","style"]),l=Object.assign(Object.assign({},r),s);return(n||a)&&Object.assign(l,{data:Object.assign(Object.assign({},n),a)}),(i||o)&&Object.assign(l,{style:Object.assign(Object.assign({},i),o)}),l}function PT(t){const{data:e,style:n}=t,i=AT(t,["data","style"]);return e&&(i.data=Object.assign({},e)),n&&(i.style=Object.assign({},n)),i}function CT(t={},e={}){const{states:n=[],data:i={},style:r={},children:a=[]}=t,o=AT(t,["states","data","style","children"]),{states:s=[],data:l={},style:u={},children:c=[]}=e,h=(t,e)=>t.length===e.length&&t.every(((t,n)=>t===e[n])),d=(t,e)=>{const n=Object.keys(t),i=Object.keys(e);return n.length===i.length&&n.every((n=>t[n]===e[n]))};return!!(d(o,AT(e,["states","data","style","children"]))&&h(a,c)&&h(n,s)&&d(i,l)&&d(r,u))}function RT(t){const{id:e=wh(t),style:n,data:i}=t,r=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(t,["id","style","data"]),a=Object.assign(Object.assign({},t),{style:Object.assign({},n),data:Object.assign({},i)});return function(t){return"source"in t&&"target"in t}(t)?Object.assign({id:e,data:a},r):{id:e,data:a}}function LT(t){return t.data}class DT{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new Mv}pushChange(t){if(this.isTraceless)return;const{type:e}=t;if(e===Ju.NodeUpdated||e===Ju.EdgeUpdated||e===Ju.ComboUpdated){const{value:n,original:i}=t;this.changes.push({value:PT(n),original:PT(i),type:e})}else this.changes.push({value:PT(t.value),type:e})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(t){this.batchCount++,this.model.batch(t),this.batchCount--}isBatching(){return this.batchCount>0}silence(t){this.isTraceless=!0,t(),this.isTraceless=!1}isCombo(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(t){return this.model.getAllNodes().reduce(((e,n)=>{const i=LT(n);return this.isCombo(wh(i))||(void 0===t||t.includes(wh(i)))&&e.push(i),e}),[])}getEdgeDatum(t){return LT(this.model.getEdge(t))}getEdgeData(t){return this.model.getAllEdges().reduce(((e,n)=>{const i=LT(n);return(void 0===t||t.includes(wh(i)))&&e.push(i),e}),[])}getComboData(t){return this.model.getAllNodes().reduce(((e,n)=>{const i=LT(n);return this.isCombo(wh(i))?((void 0===t||t.includes(wh(i)))&&e.push(i),e):e}),[])}getRootsData(t=cc){return this.model.getRoots(t).map(LT)}getAncestorsData(t,e){const{model:n}=this;return n.hasNode(t)&&n.hasTreeStructure(e)?n.getAncestors(t,e).map(LT):[]}getDescendantsData(t){const e=this.getElementDataById(t),n=[];return Od(e,(t=>{t!==e&&n.push(t)}),(t=>this.getChildrenData(wh(t))),"TB"),n}getParentData(t,e){const{model:n}=this;if(!e)return void gc.warn("The hierarchy structure key is not specified");if(!n.hasNode(t)||!n.hasTreeStructure(e))return;const i=n.getParent(t,e);return i?LT(i):void 0}getChildrenData(t){const e="node"===this.getElementType(t)?cc:uc,{model:n}=this;return n.hasNode(t)&&n.hasTreeStructure(e)?n.getChildren(t,e).map(LT):[]}getElementsDataByType(t){return"node"===t?this.getNodeData():"edge"===t?this.getEdgeData():"combo"===t?this.getComboData():[]}getElementDataById(t){return"edge"===this.getElementType(t)?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}getNodeLikeDatum(t){return LT(this.model.getNode(t))}getNodeLikeData(t){return this.model.getAllNodes().reduce(((e,n)=>{const i=LT(n);return t?t.includes(wh(i))&&e.push(i):e.push(i),e}),[])}getElementDataByState(t,e){return this.getElementsDataByType(t).filter((t=>{var n;return null===(n=t.states)||void 0===n?void 0:n.includes(e)}))}getElementState(t){var e;return(null===(e=this.getElementDataById(t))||void 0===e?void 0:e.states)||[]}hasNode(t){return this.model.hasNode(t)&&!this.isCombo(t)}hasEdge(t){return this.model.hasEdge(t)}hasCombo(t){return this.model.hasNode(t)&&this.isCombo(t)}getRelatedEdgesData(t,e="both"){return this.model.getRelatedEdges(t,e).map(LT)}getNeighborNodesData(t){return this.model.getNeighbors(t).map(LT)}setData(t){const{nodes:e=[],edges:n=[],combos:i=[]}=t,{nodes:r,edges:a,combos:o}=this.getData(),s=Lh(r,e,(t=>wh(t)),CT),l=Lh(a,n,(t=>wh(t)),CT),u=Lh(o,i,(t=>wh(t)),CT);this.batch((()=>{const t={nodes:s.enter,edges:l.enter,combos:u.enter};this.addData(t),this.computeZIndex(t,"add",!0);const e={nodes:s.update,edges:l.update,combos:u.update};this.updateData(e),this.computeZIndex(e,"update",!0);const n={nodes:s.exit.map(wh),edges:l.exit.map(wh),combos:u.exit.map(wh)};this.removeData(n)}))}addData(t){const{nodes:e,edges:n,combos:i}=t;this.batch((()=>{this.addComboData(i),this.addNodeData(e),this.addEdgeData(n)})),this.computeZIndex(t,"add")}addNodeData(t=[]){t.length&&(this.model.addNodes(t.map((t=>(this.pushChange({value:t,type:Ju.NodeAdded}),RT(t))))),this.updateNodeLikeHierarchy(t),this.computeZIndex({nodes:t},"add"))}addEdgeData(t=[]){t.length&&(this.model.addEdges(t.map((t=>(this.pushChange({value:t,type:Ju.EdgeAdded}),RT(t))))),this.computeZIndex({edges:t},"add"))}addComboData(t=[]){if(!t.length)return;const{model:e}=this;e.hasTreeStructure(uc)||e.attachTreeStructure(uc),e.addNodes(t.map((t=>(this.comboIds.add(wh(t)),this.pushChange({value:t,type:Ju.ComboAdded}),RT(t))))),this.updateNodeLikeHierarchy(t),this.computeZIndex({combos:t},"add")}addChildrenData(t,e){const n=this.getNodeLikeDatum(t),i=e.map(wh);this.addNodeData(e),this.updateNodeData([{id:t,children:[...n.children||[],...i]}]),this.addEdgeData(i.map((e=>({source:t,target:e}))))}computeZIndex(t,e,n=!1){!n&&this.isBatching()||this.batch((()=>{const{nodes:n=[],edges:i=[],combos:r=[]}=t;r.forEach((t=>{var n,i,r;const a=wh(t);if("add"===e&&le(null===(n=t.style)||void 0===n?void 0:n.zIndex))return;if("update"===e&&!("combo"in t))return;const o=this.getParentData(a,uc),s=o?(null!==(r=null===(i=o.style)||void 0===i?void 0:i.zIndex)&&void 0!==r?r:0)+1:0;this.preventUpdateNodeLikeHierarchy((()=>{this.updateComboData([{id:a,style:{zIndex:s}}])}))})),n.forEach((t=>{var n,i,r;const a=wh(t);if("add"===e&&le(null===(n=t.style)||void 0===n?void 0:n.zIndex))return;if("update"===e&&!("combo"in t)&&!("children"in t))return;let o=0;const s=this.getParentData(a,uc);if(s)o=((null===(i=s.style)||void 0===i?void 0:i.zIndex)||0)+1;else{const t=this.getParentData(a,cc);t&&(o=(null===(r=null==t?void 0:t.style)||void 0===r?void 0:r.zIndex)||0)}this.preventUpdateNodeLikeHierarchy((()=>{this.updateNodeData([{id:a,style:{zIndex:o}}])}))})),i.forEach((t=>{var e,n,i,r,a;if(le(null===(e=t.style)||void 0===e?void 0:e.zIndex))return;let{id:o,source:s,target:l}=t;if(o){const t=this.getEdgeDatum(o);s=t.source,l=t.target}else o=wh(t);if(!s||!l)return;const u=(null===(i=null===(n=this.getNodeLikeDatum(s))||void 0===n?void 0:n.style)||void 0===i?void 0:i.zIndex)||0,c=(null===(a=null===(r=this.getNodeLikeDatum(l))||void 0===r?void 0:r.style)||void 0===a?void 0:a.zIndex)||0;this.updateEdgeData([{id:wh(t),style:{zIndex:Math.max(u,c)-1}}])}))}))}getFrontZIndex(t){var e;const n=this.getElementType(t),i=this.getElementDataById(t),r=this.getData();if(Object.assign(r,{[`${n}s`]:r[`${n}s`].filter((e=>wh(e)!==t))}),"combo"===n&&!Id(i)){const e=new Set(this.getAncestorsData(t,uc).map(wh));r.nodes=r.nodes.filter((t=>!e.has(wh(t)))),r.combos=r.combos.filter((t=>!e.has(wh(t)))),r.edges=r.edges.filter((({source:t,target:n})=>!e.has(t)&&!e.has(n)))}return Math.max((null===(e=i.style)||void 0===e?void 0:e.zIndex)||0,0,...Object.values(r).flat().map((t=>{var e;return((null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.zIndex)||0)+1})))}updateNodeLikeHierarchy(t){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:e}=this;t.forEach((t=>{const n=wh(t),i=kh(t);void 0!==i&&(e.hasTreeStructure(uc)||e.attachTreeStructure(uc),null===i&&this.refreshComboData(n),this.setParent(n,kh(t),uc));const r=t.children||[];if(r.length){e.hasTreeStructure(cc)||e.attachTreeStructure(cc);const t=r.filter((t=>e.hasNode(t)));t.forEach((t=>this.setParent(t,n,cc))),t.length!==r.length&&this.updateNodeData([{id:n,children:t}])}}))}preventUpdateNodeLikeHierarchy(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}updateData(t){const{nodes:e,edges:n,combos:i}=t;this.batch((()=>{this.updateNodeData(e),this.updateComboData(i),this.updateEdgeData(n)})),this.computeZIndex(t,"update")}updateNodeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch((()=>{const n=[];t.forEach((t=>{const i=wh(t),r=LT(e.getNode(i));if(CT(r,t))return;const a=OT(r,t);this.pushChange({value:a,original:r,type:Ju.NodeUpdated}),e.mergeNodeData(i,a),n.push(a)})),this.updateNodeLikeHierarchy(n)})),this.computeZIndex({nodes:t},"update")}refreshData(){const{nodes:t,edges:e,combos:n}=this.getData();t.forEach((t=>{this.pushChange({value:t,original:t,type:Ju.NodeUpdated})})),e.forEach((t=>{this.pushChange({value:t,original:t,type:Ju.EdgeUpdated})})),n.forEach((t=>{this.pushChange({value:t,original:t,type:Ju.ComboUpdated})}))}syncNodeLikeDatum(t){const{model:e}=this,n=wh(t);if(!e.hasNode(n))return;const i=OT(LT(e.getNode(n)),t);e.mergeNodeData(n,i)}syncEdgeDatum(t){const{model:e}=this,n=wh(t);if(!e.hasEdge(n))return;const i=OT(LT(e.getEdge(n)),t);e.mergeEdgeData(n,i)}updateEdgeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch((()=>{t.forEach((t=>{const n=wh(t),i=LT(e.getEdge(n));if(CT(i,t))return;t.source&&i.source!==t.source&&e.updateEdgeSource(n,t.source),t.target&&i.target!==t.target&&e.updateEdgeTarget(n,t.target);const r=OT(i,t);this.pushChange({value:r,original:i,type:Ju.EdgeUpdated}),e.mergeEdgeData(n,r)}))})),this.computeZIndex({edges:t},"update")}updateComboData(t=[]){if(!t.length)return;const{model:e}=this;e.batch((()=>{const n=[];t.forEach((t=>{const i=wh(t),r=LT(e.getNode(i));if(CT(r,t))return;const a=OT(r,t);this.pushChange({value:a,original:r,type:Ju.ComboUpdated}),e.mergeNodeData(i,a),n.push(a)})),this.updateNodeLikeHierarchy(n)})),this.computeZIndex({combos:t},"update")}setParent(t,e,n,i=!0){if(t===e)return;const r=kh(this.getNodeLikeDatum(t));if(r!==e&&n===uc){const n={id:t,combo:e};this.isCombo(t),this.syncNodeLikeDatum(n)}this.model.setParent(t,e,n),i&&n===uc&&function(t,e){void 0===e&&(e=new Map);var n=[];if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++){var a=t[i];e.has(a)||(n.push(a),e.set(a,!0))}return n}([r,e]).forEach((t=>{void 0!==t&&this.refreshComboData(t)}))}refreshComboData(t){const e=this.getComboData([t])[0],n=this.getAncestorsData(t,uc);e&&this.pushChange({value:e,original:e,type:Ju.ComboUpdated}),n.forEach((t=>{this.pushChange({value:t,original:t,type:Ju.ComboUpdated})}))}getElementPosition(t){return sd(this.getElementDataById(t))}translateNodeLikeBy(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}translateNodeLikeTo(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}translateNodeBy(t,e){const n=Uh(this.getElementPosition(t),[...e,0].slice(0,3));this.translateNodeTo(t,n)}translateNodeTo(t,e){const[n=0,i=0,r=0]=e;this.preventUpdateNodeLikeHierarchy((()=>{this.updateNodeData([{id:t,style:{x:n,y:i,z:r}}])}))}translateComboBy(t,e){const[n=0,i=0,r=0]=e;if([n,i,r].some(isNaN)||[n,i,r].every((t=>0===t)))return;const a=this.getComboData([t])[0];if(!a)return;const o=new Set;Od(a,(t=>{const e=wh(t);if(o.has(e))return;o.add(e);const[a,s,l]=sd(t),u=OT(t,{style:{x:a+n,y:s+i,z:l+r}});this.pushChange({value:u,original:t,type:this.isCombo(e)?Ju.ComboUpdated:Ju.NodeUpdated}),this.model.mergeNodeData(e,u)}),(t=>this.getChildrenData(wh(t))),"BT")}translateComboTo(t,e){var n;if(e.some(isNaN))return;const[i=0,r=0,a=0]=e,o=null===(n=this.getComboData([t]))||void 0===n?void 0:n[0];if(!o)return;const[s,l,u]=sd(o),c=i-s,h=r-l,d=a-u;Od(o,(t=>{const e=wh(t),[n,i,r]=sd(t),a=OT(t,{style:{x:n+c,y:i+h,z:r+d}});this.pushChange({value:a,original:t,type:this.isCombo(e)?Ju.ComboUpdated:Ju.NodeUpdated}),this.model.mergeNodeData(e,a)}),(t=>this.getChildrenData(wh(t))),"BT")}removeData(t){const{nodes:e,edges:n,combos:i}=t;this.batch((()=>{this.removeEdgeData(n),this.removeNodeData(e),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)}))}removeNodeData(t=[]){t.length&&this.batch((()=>{t.forEach((t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(wh)),this.pushChange({value:this.getNodeData([t])[0],type:Ju.NodeRemoved}),this.removeNodeLikeHierarchy(t)})),this.model.removeNodes(t)}))}removeEdgeData(t=[]){t.length&&(t.forEach((t=>this.pushChange({value:this.getEdgeData([t])[0],type:Ju.EdgeRemoved}))),this.model.removeEdges(t))}removeComboData(t=[]){t.length&&this.batch((()=>{t.forEach((t=>{this.pushChange({value:this.getComboData([t])[0],type:Ju.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)})),this.model.removeNodes(t)}))}removeNodeLikeHierarchy(t){if(this.model.hasTreeStructure(uc)){const e=kh(this.getNodeLikeDatum(t));this.setParent(t,void 0,uc,!1),this.model.getChildren(t,uc).forEach((t=>{const n=LT(t),i=wh(n);this.setParent(wh(n),e,uc,!1);const r=OT(n,{id:wh(n),combo:e});this.pushChange({value:r,original:n,type:this.isCombo(i)?Ju.ComboUpdated:Ju.NodeUpdated}),this.model.mergeNodeData(wh(n),r)})),ce(e)||this.refreshComboData(e)}}getElementType(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw new Error(pc(`Unknown element type of id: ${t}`))}destroy(){const{model:t}=this,e=t.getAllNodes(),n=t.getAllEdges();t.removeEdges(n.map((t=>t.id))),t.removeNodes(e.map((t=>t.id))),this.context={}}}var IT=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class _T{constructor(t){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=t}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){const{canvas:t}=this.context;this.container=t.appendChild(new wl({className:"elements"}))}}emit(t,e){e.silence||xT(this.context.graph,t)}forEachElementData(t){Ad.forEach((e=>{const n=this.context.model.getElementsDataByType(e);t(e,n)}))}getElementType(t,e){var n;const{options:i,graph:r}=this.context,a=(null===(n=i[t])||void 0===n?void 0:n.type)||e.type;return a?"string"==typeof a?a:a.call(r,e):"edge"===t?"line":"circle"}getTheme(t){return vc(this.context.options)[t]||{}}getThemeStyle(t){return this.getTheme(t).style||{}}getThemeStateStyle(t,e){const{state:n={}}=this.getTheme(t);return Object.assign({},...e.map((t=>n[t]||{})))}computePaletteStyle(){const{options:t}=this.context;this.paletteStyle={},this.forEachElementData(((e,n)=>{var i,r;const a=Object.assign({},Yd(null===(i=this.getTheme(e))||void 0===i?void 0:i.palette),Yd(null===(r=t[e])||void 0===r?void 0:r.palette));(null==a?void 0:a.field)&&Object.assign(this.paletteStyle,function(t,e){if(!e)return{};const{type:n,color:i,field:r,invert:a}=e,o=t=>{const e="string"==typeof i?fc("palette",i):i;if("function"==typeof e){const n={};return t.forEach((([t,i])=>{n[t]=e(a?1-i:i)})),n}if(Array.isArray(e)){const n=a?[...e].reverse():e,i={};return t.forEach((([t,r])=>{i[t]=n[r%e.length]})),i}return{}},s=(t,e)=>{var n;return"string"==typeof t?null===(n=e.data)||void 0===n?void 0:n[t]:null==t?void 0:t(e)};if("group"===n){const e=Pc(t,(t=>{if(!r)return"default";const e=s(r,t);return e?String(e):"default"})),n=o(Object.keys(e).map(((t,e)=>[t,e]))),i={};return Object.entries(e).forEach((([t,e])=>{e.forEach((e=>{i[wh(e)]=n[t]}))})),i}if("value"===n){const[e,n]=t.reduce((([t,e],n)=>{const i=s(r,n);if("number"!=typeof i)throw new Error(pc(`Palette field ${r} is not a number`));return[Math.min(t,i),Math.max(e,i)]}),[1/0,-1/0]),i=n-e;return o(t.map((t=>[t.id,(s(r,t)-e)/i])))}}(n,a))}))}getPaletteStyle(t,e){const n=this.paletteStyle[e];return n?"edge"===t?{stroke:n}:{fill:n}:{}}computeElementDefaultStyle(t,e){var n;const{options:i}=this.context,r=(null===(n=i[t])||void 0===n?void 0:n.style)||{};"transform"in r&&Array.isArray(r.transform)&&(r.transform=[...r.transform]),this.defaultStyle[wh(e.datum)]=Ud(r,e)}computeElementsDefaultStyle(t){const{graph:e}=this.context;this.forEachElementData(((n,i)=>{const r=i.length;for(let a=0;a<r;a++){const r=i[a];(void 0===t||t.includes(wh(r)))&&this.computeElementDefaultStyle(n,{datum:r,graph:e})}}))}getDefaultStyle(t){return this.defaultStyle[t]||{}}getElementState(t){try{const{model:e}=this.context;return e.getElementState(t)}catch(t){return[]}}getElementStateStyle(t,e,n){var i,r;const{options:a}=this.context;return Ud((null===(r=null===(i=a[t])||void 0===i?void 0:i.state)||void 0===r?void 0:r[e])||{},n)}computeElementStatesStyle(t,e,n){this.stateStyle[wh(n.datum)]=Object.assign({},...e.map((e=>this.getElementStateStyle(t,e,n))))}computeElementsStatesStyle(t){const{graph:e}=this.context;this.forEachElementData(((n,i)=>{const r=i.length;for(let a=0;a<r;a++){const r=i[a];if(void 0===t||t.includes(wh(r))){const t=this.getElementState(wh(r));this.computeElementStatesStyle(n,t,{datum:r,graph:e})}}}))}getStateStyle(t){return this.stateStyle[t]||{}}computeStyle(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}getElement(t){return this.elementMap[t]}getNodes(){return this.context.model.getNodeData().map((({id:t})=>this.elementMap[t]))}getEdges(){return this.context.model.getEdgeData().map((t=>this.elementMap[wh(t)]))}getCombos(){return this.context.model.getComboData().map((({id:t})=>this.elementMap[t]))}getElementComputedStyle(t,e){const n=wh(e),i=this.getThemeStyle(t),r=this.getPaletteStyle(t,n),a=e.style||{},o=this.getDefaultStyle(n),s=this.getThemeStateStyle(t,this.getElementState(n)),l=this.getStateStyle(n),u=Object.assign({},i,r,a,o,s,l);if("combo"===t){const t=this.context.model.getChildrenData(n),e=u.collapsed?[]:t.map(wh).filter((t=>this.getElement(t)));Object.assign(u,{childrenNode:e,childrenData:t})}return u}getDrawData(t){this.init();const e=this.computeChangesAndDrawData(t);if(!e)return null;const{type:n="draw",stage:i=n}=t;return this.markDestroyElement(e.drawData),this.computeStyle(i),{type:n,stage:i,data:e}}draw(t={animation:!0}){const e=this.getDrawData(t);if(!e)return;const{data:{drawData:{add:n,update:i,remove:r}}}=e;return this.destroyElements(r,t),this.createElements(n,t),this.updateElements(i,t),this.setAnimationTask(t,e)}preLayoutDraw(){return IT(this,arguments,void 0,(function*(t={animation:!0}){var e,n;const i=this.getDrawData(t);if(!i)return;const{data:{drawData:r}}=i;yield null===(n=null===(e=this.context.layout)||void 0===e?void 0:e.preLayout)||void 0===n?void 0:n.call(e,r);const{add:a,update:o,remove:s}=r;return this.destroyElements(s,t),this.createElements(a,t),this.updateElements(o,t),this.setAnimationTask(t,i)}))}setAnimationTask(t,e){const{animation:n,silence:i}=t,{data:{dataChanges:r,drawData:a},stage:o,type:s}=e;return this.context.animation.animate(n,i?{}:{before:()=>this.emit(new vT(oc.BEFORE_DRAW,{dataChanges:r,animation:n,stage:o,render:"render"===s}),t),beforeAnimate:e=>this.emit(new yT(oc.BEFORE_ANIMATE,tc.DRAW,e,a),t),afterAnimate:e=>this.emit(new yT(oc.AFTER_ANIMATE,tc.DRAW,e,a),t),after:()=>this.emit(new vT(oc.AFTER_DRAW,{dataChanges:r,animation:n,stage:o,render:"render"===s,firstRender:!1===this.context.graph.rendered}),t)})}computeChangesAndDrawData(t){const{model:e}=this.context,n=e.getChanges(),i=LE(n);if(0===i.length)return null;const{NodeAdded:r=[],NodeUpdated:a=[],NodeRemoved:o=[],EdgeAdded:s=[],EdgeUpdated:l=[],EdgeRemoved:u=[],ComboAdded:c=[],ComboUpdated:h=[],ComboRemoved:d=[]}=Pc(i,(t=>t.type)),f=t=>new Map(t.map((t=>{const e=t.value;return[wh(e),e]}))),p={add:{nodes:f(r),edges:f(s),combos:f(c)},update:{nodes:f(a),edges:f(l),combos:f(h)},remove:{nodes:f(o),edges:f(u),combos:f(d)}},g=this.transformData(p,t);return e.clearChanges(),{dataChanges:n,drawData:g}}transformData(t,e){const n=this.context.transform.getTransformInstance();return Object.values(n).reduce(((t,n)=>n.beforeDraw(t,e)),t)}createElement(t,e,n){var i;const r=wh(e);if(this.getElement(r))return;const a=this.getElementType(t,e),o=this.getElementComputedStyle(t,e),s=fc(t,a);if(!s)return gc.warn(`The element ${a} of ${t} is not registered.`);this.emit(new mT(oc.BEFORE_ELEMENT_CREATE,t,e),n);const l=this.container.appendChild(new s({id:r,context:this.context,style:o}));this.shapeTypeMap[r]=a,this.elementMap[r]=l;const{stage:u="enter"}=n;null===(i=this.context.animation)||void 0===i||i.add({element:l,elementType:t,stage:u,originalStyle:Object.assign({},l.attributes),updatedStyle:o},{after:()=>{var i;this.emit(new mT(oc.AFTER_ELEMENT_CREATE,t,e),n),null===(i=l.onCreate)||void 0===i||i.call(l)}})}createElements(t,e){const{nodes:n,edges:i,combos:r}=t;[["node",n],["combo",r],["edge",i]].forEach((([t,n])=>{n.forEach((n=>this.createElement(t,n,e)))}))}getUpdateStageStyle(t,e,n){const{stage:i="update"}=n;if("translate"===i){if("node"===t||"combo"===t){const{style:{x:t=0,y:n=0,z:i=0}={}}=e;return{x:t,y:n,z:i}}return{}}return this.getElementComputedStyle(t,e)}updateElement(t,e,n){var i;const r=wh(e),{stage:a="update"}=n,o=this.getElement(r);if(!o)return()=>null;this.emit(new mT(oc.BEFORE_ELEMENT_UPDATE,t,e),n);const s=this.getElementType(t,e),l=this.getUpdateStageStyle(t,e,n);this.shapeTypeMap[r]!==s&&(o.destroy(),delete this.shapeTypeMap[r],delete this.elementMap[r],this.createElement(t,e,{animation:!1,silence:!0}));const u="visibility"!==a?a:"hidden"===l.visibility?"hide":"show";"hide"===u&&delete l.visibility,null===(i=this.context.animation)||void 0===i||i.add({element:o,elementType:t,stage:u,originalStyle:Object.assign({},o.attributes),updatedStyle:l},{before:()=>{const t=this.elementMap[r];"collapse"!==a&&av(t,l),"visibility"===a&&(function(t){return kT("opacity")in(_d(t,wT)||{})}(t)||function(t,e){const n=Array.isArray(e)?e:[e];_d(t,wT)||Bd(t,wT,{}),n.forEach((e=>{Bd(_d(t,wT),kT(e),t.attributes[e])}))}(t,"opacity"),this.visibilityCache.set(t,"show"===u?"visible":"hidden"),"show"===u&&Dh(t,"visible"))},after:()=>{var i;const o=this.elementMap[r];"collapse"===a&&av(o,l),"hide"===u&&Dh(o,this.visibilityCache.get(o)),this.emit(new mT(oc.AFTER_ELEMENT_UPDATE,t,e),n),null===(i=o.onUpdate)||void 0===i||i.call(o)}})}updateElements(t,e){const{nodes:n,edges:i,combos:r}=t;[["node",n],["combo",r],["edge",i]].forEach((([t,n])=>{n.forEach((n=>this.updateElement(t,n,e)))}))}markDestroyElement(t){Object.values(t.remove).forEach((t=>{t.forEach((t=>{const e=wh(t),n=this.getElement(e);n&&function(t){Bd(t,"__to_be_destroyed__",!0)}(n)}))}))}destroyElement(t,e,n){var i;const{stage:r="exit"}=n,a=wh(e),o=this.elementMap[a];if(!o)return()=>null;this.emit(new mT(oc.BEFORE_ELEMENT_DESTROY,t,e),n),null===(i=this.context.animation)||void 0===i||i.add({element:o,elementType:t,stage:r,originalStyle:Object.assign({},o.attributes),updatedStyle:{}},{after:()=>{var i;this.clearElement(a),o.destroy(),null===(i=o.onDestroy)||void 0===i||i.call(o),this.emit(new mT(oc.AFTER_ELEMENT_DESTROY,t,e),n)}})}destroyElements(t,e){const{nodes:n,edges:i,combos:r}=t;[["combo",r],["edge",i],["node",n]].forEach((([t,n])=>{n.forEach((n=>this.destroyElement(t,n,e)))}))}clearElement(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}alignLayoutResultToElement(t,e){var n,i;const r=null===(n=t.nodes)||void 0===n?void 0:n.find((t=>wh(t)===e));if(r){const n=Hh(sd(this.context.model.getNodeLikeDatum(e)),sd(r));null===(i=t.nodes)||void 0===i||i.forEach((t=>{var e,i,r;(null===(e=t.style)||void 0===e?void 0:e.x)&&(t.style.x+=n[0]),(null===(i=t.style)||void 0===i?void 0:i.y)&&(t.style.y+=n[1]),(null===(r=t.style)||void 0===r?void 0:r.z)&&(t.style.z+=n[2]||0)}))}}collapseNode(t,e){return IT(this,void 0,void 0,(function*(){var n;const{animation:i}=e,{model:r}=this.context,a=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!a)return;const{drawData:o}=a,{add:s,remove:l,update:u}=o;this.markDestroyElement(o);const c={animation:i,stage:"collapse",data:o};this.destroyElements(l,c),this.createElements(s,c),this.updateElements(u,c),yield null===(n=this.context.animation.animate(i,{beforeAnimate:t=>this.emit(new yT(oc.BEFORE_ANIMATE,tc.COLLAPSE,t,o),c),afterAnimate:t=>this.emit(new yT(oc.AFTER_ANIMATE,tc.COLLAPSE,t,o),c)},{collapse:{target:t,descendants:Array.from(l.nodes).map((([,t])=>wh(t))),position:sd(u.nodes.get(t))}}))||void 0===n?void 0:n.finished}))}expandNode(t,e){return IT(this,void 0,void 0,(function*(){var n;const{model:i,layout:r}=this.context,{animation:a,align:o}=e,s=sd(i.getNodeData([t])[0]),l=this.computeChangesAndDrawData({stage:"expand",animation:a});if(this.createElements(l.drawData.add,{animation:!1,stage:"expand",target:t}),this.context.animation.clear(),this.computeStyle("expand"),!l)return;const{drawData:u}=l,{update:c,add:h}=u,d={animation:a,stage:"expand",data:u};h.edges.forEach((t=>c.edges.set(wh(t),t))),h.nodes.forEach((t=>c.nodes.set(wh(t),t))),this.updateElements(c,d),yield null===(n=this.context.animation.animate(a,{beforeAnimate:t=>this.emit(new yT(oc.BEFORE_ANIMATE,tc.EXPAND,t,u),d),afterAnimate:t=>this.emit(new yT(oc.AFTER_ANIMATE,tc.EXPAND,t,u),d)},{expand:{target:t,descendants:Array.from(h.nodes).map((([,t])=>wh(t))),position:s}}))||void 0===n?void 0:n.finished}))}collapseCombo(t,e){return IT(this,void 0,void 0,(function*(){var n;const{model:i,element:r}=this.context;if(i.getAncestorsData(t,uc).some((t=>Id(t))))return;const a=r.getElement(t),o=a.getComboPosition(Object.assign(Object.assign({},a.attributes),{collapsed:!0})),s=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!s)return;const{dataChanges:l,drawData:u}=s;this.markDestroyElement(u);const{update:c,remove:h}=u,d={animation:e,stage:"collapse",data:u};this.destroyElements(h,d),this.updateElements(c,d);const f=t=>Array.from(t).map((([,t])=>wh(t)));yield null===(n=this.context.animation.animate(e,{before:()=>this.emit(new vT(oc.BEFORE_DRAW,{dataChanges:l,animation:e}),d),beforeAnimate:t=>this.emit(new yT(oc.BEFORE_ANIMATE,tc.COLLAPSE,t,u),d),afterAnimate:t=>this.emit(new yT(oc.AFTER_ANIMATE,tc.COLLAPSE,t,u),d),after:()=>this.emit(new vT(oc.AFTER_DRAW,{dataChanges:l,animation:e}),d)},{collapse:{target:t,descendants:[...f(h.nodes),...f(h.combos)],position:o}}))||void 0===n?void 0:n.finished}))}expandCombo(t,e){return IT(this,void 0,void 0,(function*(){var n;const{model:i}=this.context,r=sd(i.getComboData([t])[0]);this.computeStyle("expand");const a=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!a)return;const{dataChanges:o,drawData:s}=a,{add:l,update:u}=s,c={animation:e,stage:"expand",data:s,target:t};this.createElements(l,c),this.updateElements(u,c);const h=t=>Array.from(t).map((([,t])=>wh(t)));yield null===(n=this.context.animation.animate(e,{before:()=>this.emit(new vT(oc.BEFORE_DRAW,{dataChanges:o,animation:e}),c),beforeAnimate:t=>this.emit(new yT(oc.BEFORE_ANIMATE,tc.EXPAND,t,s),c),afterAnimate:t=>this.emit(new yT(oc.AFTER_ANIMATE,tc.EXPAND,t,s),c),after:()=>this.emit(new vT(oc.AFTER_DRAW,{dataChanges:o,animation:e}),c)},{expand:{target:t,descendants:[...h(l.nodes),...h(l.combos)],position:r}}))||void 0===n?void 0:n.finished}))}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}}const BT=Symbol("Comlink.proxy"),FT=Symbol("Comlink.endpoint"),jT=Symbol("Comlink.releaseProxy"),GT=Symbol("Comlink.finalizer"),zT=Symbol("Comlink.thrown"),VT=t=>"object"==typeof t&&null!==t||"function"==typeof t,WT=new Map([["proxy",{canHandle:t=>VT(t)&&t[BT],serialize(t){const{port1:e,port2:n}=new MessageChannel;return UT(t,e),[n,[n]]},deserialize:t=>(t.start(),YT(t))}],["throw",{canHandle:t=>VT(t)&&zT in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function UT(t,e=globalThis,n=["*"]){e.addEventListener("message",(function i(r){if(!r||!r.data)return;if(!function(t,e){for(const n of t){if(e===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(e))return!0}return!1}(n,r.origin))return void console.warn(`Invalid origin '${r.origin}' for comlink proxy`);const{id:a,type:o,path:s}=Object.assign({path:[]},r.data),l=(r.data.argumentList||[]).map(eA);let u;try{const e=s.slice(0,-1).reduce(((t,e)=>t[e]),t),n=s.reduce(((t,e)=>t[e]),t);switch(o){case"GET":u=n;break;case"SET":e[s.slice(-1)[0]]=eA(r.data.value),u=!0;break;case"APPLY":u=n.apply(e,l);break;case"CONSTRUCT":u=function(t){return Object.assign(t,{[BT]:!0})}(new n(...l));break;case"ENDPOINT":{const{port1:e,port2:n}=new MessageChannel;UT(t,n),u=function(t,e){return JT.set(t,e),t}(e,[e])}break;case"RELEASE":u=void 0;break;default:return}}catch(t){u={value:t,[zT]:0}}Promise.resolve(u).catch((t=>({value:t,[zT]:0}))).then((n=>{const[r,s]=tA(n);e.postMessage(Object.assign(Object.assign({},r),{id:a}),s),"RELEASE"===o&&(e.removeEventListener("message",i),HT(e),GT in t&&"function"==typeof t[GT]&&t[GT]())})).catch((t=>{const[n,i]=tA({value:new TypeError("Unserializable return value"),[zT]:0});e.postMessage(Object.assign(Object.assign({},n),{id:a}),i)}))})),e.start&&e.start()}function HT(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function YT(t,e){const n=new Map;return t.addEventListener("message",(function(t){const{data:e}=t;if(!e||!e.id)return;const i=n.get(e.id);if(i)try{i(e)}finally{n.delete(e.id)}})),ZT(t,n,[],e)}function $T(t){if(t)throw new Error("Proxy has been released and is not useable")}function XT(t){return nA(t,new Map,{type:"RELEASE"}).then((()=>{HT(t)}))}const qT=new WeakMap,KT="FinalizationRegistry"in globalThis&&new FinalizationRegistry((t=>{const e=(qT.get(t)||0)-1;qT.set(t,e),0===e&&XT(t)}));function ZT(t,e,n=[],i=function(){}){let r=!1;const a=new Proxy(i,{get(i,o){if($T(r),o===jT)return()=>{!function(t){KT&&KT.unregister(t)}(a),XT(t),e.clear(),r=!0};if("then"===o){if(0===n.length)return{then:()=>a};const i=nA(t,e,{type:"GET",path:n.map((t=>t.toString()))}).then(eA);return i.then.bind(i)}return ZT(t,e,[...n,o])},set(i,a,o){$T(r);const[s,l]=tA(o);return nA(t,e,{type:"SET",path:[...n,a].map((t=>t.toString())),value:s},l).then(eA)},apply(i,a,o){$T(r);const s=n[n.length-1];if(s===FT)return nA(t,e,{type:"ENDPOINT"}).then(eA);if("bind"===s)return ZT(t,e,n.slice(0,-1));const[l,u]=QT(o);return nA(t,e,{type:"APPLY",path:n.map((t=>t.toString())),argumentList:l},u).then(eA)},construct(i,a){$T(r);const[o,s]=QT(a);return nA(t,e,{type:"CONSTRUCT",path:n.map((t=>t.toString())),argumentList:o},s).then(eA)}});return function(t,e){const n=(qT.get(e)||0)+1;qT.set(e,n),KT&&KT.register(t,e,t)}(a,t),a}function QT(t){const e=t.map(tA);return[e.map((t=>t[0])),(n=e.map((t=>t[1])),Array.prototype.concat.apply([],n))];var n}const JT=new WeakMap;function tA(t){for(const[e,n]of WT)if(n.canHandle(t)){const[i,r]=n.serialize(t);return[{type:"HANDLER",name:e,value:i},r]}return[{type:"RAW",value:t},JT.get(t)||[]]}function eA(t){switch(t.type){case"HANDLER":return WT.get(t.name).deserialize(t.value);case"RAW":return t.value}}function nA(t,e,n,i){return new Promise((r=>{const a=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.set(a,r),t.start&&t.start(),t.postMessage(Object.assign({id:a},n),i)}))}class iA extends bv{constructor(t,e,n){super(),this.graph=t,this.layout=e,this.options=n,this.spawnWorker()}spawnWorker(){this.proxy=YT(new Worker(new URL(n.p+n.u(185),n.b),{type:void 0})),this.running&&(this.running=!1,this.execute())}execute(){var t;return ye(this,void 0,void 0,(function*(){if(this.running)return this;this.running=!0;const e=this.layout.options,{onTick:n}=e,i=ve(e,["onTick"]),r={};Object.keys(i).forEach((t=>{gn(i[t])||(r[t]=i[t])}));const a={layout:{id:this.layout.id,options:r,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),[s]=yield this.proxy.calculateLayout(a,[o]);return s}))}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[jT]()}isRunning(){return this.running}}var rA=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class aA{get presetOptions(){return{animation:!!xc(this.context.options,!0)}}get options(){const{options:t}=this.context;return t.layout}constructor(t){this.instances=[],this.context=t}getLayoutInstance(){return this.instances}preLayout(t){return rA(this,void 0,void 0,(function*(){var e,n,i,r;const{graph:a,model:o}=this.context,{add:s}=t;xT(a,new vT(oc.BEFORE_LAYOUT,{type:"pre"}));const l=yield null===(e=this.context.layout)||void 0===e?void 0:e.simulate();null===(n=null==l?void 0:l.nodes)||void 0===n||n.forEach((t=>{const e=wh(t),n=s.nodes.get(e);o.syncNodeLikeDatum(t),n&&Object.assign(n.style,t.style)})),null===(i=null==l?void 0:l.edges)||void 0===i||i.forEach((t=>{const e=wh(t),n=s.edges.get(e);o.syncEdgeDatum(t),n&&Object.assign(n.style,t.style)})),null===(r=null==l?void 0:l.combos)||void 0===r||r.forEach((t=>{const e=wh(t),n=s.combos.get(e);o.syncNodeLikeDatum(t),n&&Object.assign(n.style,t.style)})),xT(a,new vT(oc.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",t)}))}postLayout(){return rA(this,arguments,void 0,(function*(t=this.options){if(!t)return;const e=Array.isArray(t)?t:[t],{graph:n}=this.context;xT(n,new vT(oc.BEFORE_LAYOUT,{type:"post"}));for(let t=0;t<e.length;t++){const i=e[t],r=this.getLayoutData(i),a=Object.assign(Object.assign({},this.presetOptions),i);xT(n,new vT(oc.BEFORE_STAGE_LAYOUT,{options:a,index:t}));const o=yield this.stepLayout(r,a,t);xT(n,new vT(oc.AFTER_STAGE_LAYOUT,{options:a,index:t})),i.animation||this.updateElementPosition(o,!1)}xT(n,new vT(oc.AFTER_LAYOUT,{type:"post"})),this.transformDataAfterLayout("post")}))}transformDataAfterLayout(t,e){const n=this.context.transform.getTransformInstance();Object.values(n).forEach((n=>n.afterLayout(t,e)))}simulate(){return rA(this,void 0,void 0,(function*(){if(!this.options)return{};const t=Array.isArray(this.options)?this.options:[this.options];let e={};for(let n=0;n<t.length;n++){const i=t[n],r=this.getLayoutData(i);e=yield this.stepLayout(r,Object.assign(Object.assign(Object.assign({},this.presetOptions),i),{animation:!1}),n)}return e}))}stepLayout(t,e,n){return rA(this,void 0,void 0,(function*(){return function(t){const{type:e}=t;return["compact-box","mindmap","dendrogram","indented"].includes(e)}(e)?yield this.treeLayout(t,e,n):yield this.graphLayout(t,e,n)}))}graphLayout(t,e,n){return rA(this,void 0,void 0,(function*(){const{animation:i,enableWorker:r,iterations:a=300}=e,o=this.initGraphLayout(e);if(!o)return{};if(this.instances[n]=o,this.instance=o,r){const e=o;return this.supervisor=new iA(e.graphData2LayoutModel(t),e.instance,{iterations:a}),Nv(yield this.supervisor.execute())}if(cb(o))return i?yield o.execute(t,{onTick:t=>{this.updateElementPosition(t,!1)}}):(o.execute(t),o.stop(),o.tick(a));const s=yield o.execute(t);if(i){const t=this.updateElementPosition(s,i);yield null==t?void 0:t.finished}return s}))}treeLayout(t,e,n){return rA(this,void 0,void 0,(function*(){const{type:n,animation:i}=e,r=fc("layout",n);if(!r)return{};const{nodes:a=[],edges:o=[]}=t,s=new Mv({nodes:a.map((t=>({id:wh(t),data:t.data||{}}))),edges:o.map((t=>({id:wh(t),source:t.source,target:t.target,data:t.data||{}})))});!function(t){if(t.hasTreeStructure(cc))return;t.attachTreeStructure(cc);const e=t.getAllEdges();for(const n of e){const{source:e,target:i}=n;t.setParent(i,e,cc)}}(s);const l={nodes:[],edges:[]},u={nodes:[],edges:[]};s.getRoots(cc).forEach((t=>{Od(t,(t=>{t.children=s.getSuccessors(t.id)}),(t=>s.getSuccessors(t.id)),"TB");const n=r(t,e),{x:i,y:a,z:o=0}=n;Od(n,(t=>{const{id:e,x:n,y:r,z:s=0}=t;l.nodes.push({id:e,style:{x:i,y:a,z:o}}),u.nodes.push({id:e,style:{x:n,y:r,z:s}})}),(t=>t.children),"TB")}));const c=this.inferTreeLayoutOffset(u);if(oA(u,c),i){oA(l,c),this.updateElementPosition(l,!1);const t=this.updateElementPosition(u,i);yield null==t?void 0:t.finished}return u}))}inferTreeLayoutOffset(t){var e;let[n,i]=[1/0,-1/0],[r,a]=[1/0,-1/0];null===(e=t.nodes)||void 0===e||e.forEach((t=>{const{x:e=0,y:o=0}=t.style||{};n=Math.min(n,e),i=Math.max(i,e),r=Math.min(r,o),a=Math.max(a,o)}));const{canvas:o}=this.context,s=o.getSize(),[l,u]=o.getCanvasByViewport([0,0]),[c,h]=o.getCanvasByViewport(s);return n>=l&&i<=c&&r>=u&&a<=h?[0,0]:[(l+c)/2-(n+i)/2,(u+h)/2-(r+a)/2]}stopLayout(){this.instance&&cb(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(t){const{nodeFilter:e=()=>!0,preLayout:n=!1,isLayoutInvisibleNodes:i=!1}=t,{nodes:r,edges:a,combos:o}=this.context.model.getData(),{element:s,model:l}=this.context,u=t=>s.getElement(t),c=n?t=>{var n;if(!i){if("hidden"===(null===(n=t.style)||void 0===n?void 0:n.visibility))return!1;if(l.getAncestorsData(t.id,cc).some(Id))return!1;if(l.getAncestorsData(t.id,uc).some(Id))return!1}return e(t)}:t=>{const n=wh(t),i=u(n);return!!i&&!ov(i)&&e(t)},h=r.filter(c),d=new Map(h.map((t=>[wh(t),t])));return o.forEach((t=>d.set(wh(t),t))),{nodes:h,edges:a.filter((({source:t,target:e})=>d.has(t)&&d.has(e))),combos:o}}initGraphLayout(t){var e;const{element:n,viewport:i}=this.context,{type:r,enableWorker:a,animation:o,iterations:s}=t,l=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(t,["type","enableWorker","animation","iterations"]),[u,c]=i.getCanvasSize(),h=[u/2,c/2],d=null!==(e=null==t?void 0:t.nodeSize)&&void 0!==e?e:t=>{const e=null==n?void 0:n.getElement(t.id);return e?e.attributes.size:null==n?void 0:n.getElementComputedStyle("node",t).size},f=fc("layout",r);if(!f)return gc.warn(`The layout of ${r} is not registered.`);const p=Object.getPrototypeOf(f.prototype)===Sv.prototype?f:function(t,e){return class extends Sv{constructor(e,n){if(super(e,n),this.instance=new t({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const t=this.instance;this.stop=t.stop.bind(t),this.tick=e=>Nv(t.tick(e))}}execute(t,e){return n=this,i=void 0,a=function*(){return Nv(yield this.instance.execute(this.graphData2LayoutModel(t),this.transformOptions(Vh({},this.options,e))))},new((r=void 0)||(r=Promise))((function(t,e){function o(t){try{l(a.next(t))}catch(t){e(t)}}function s(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,s)}l((a=a.apply(n,i||[])).next())}));var n,i,r,a}transformOptions(t){if(!("onTick"in t))return t;const e=t.onTick;return t.onTick=t=>e(Nv(t)),t}graphData2LayoutModel(t){const{nodes:n=[],edges:i=[],combos:r=[]}=t,a=n.map((t=>{const e=wh(t),{data:n,style:i,combo:r}=t,a=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(t,["data","style","combo"]),o={id:e,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),{data:n}),r?{parentId:r}:{}),{style:i}),a)};return(null==i?void 0:i.x)&&Object.assign(o.data,{x:i.x}),(null==i?void 0:i.y)&&Object.assign(o.data,{y:i.y}),(null==i?void 0:i.z)&&Object.assign(o.data,{z:i.z}),o})),o=new Map(a.map((t=>[t.id,t]))),s=i.filter((t=>{const{source:e,target:n}=t;return o.has(e)&&o.has(n)})).map((t=>{const{source:e,target:n,data:i,style:r}=t;return{id:wh(t),source:e,target:n,data:Object.assign({},i),style:Object.assign({},r)}})),l=r.map((t=>({id:wh(t),data:Object.assign({_isCombo:!0},t.data),style:Object.assign({},t.style)}))),u=new Mv({nodes:[...a,...l],edges:s});return e.model.model.hasTreeStructure(uc)&&(u.attachTreeStructure(uc),a.forEach((t=>{const n=e.model.model.getParent(t.id,uc);n&&u.hasNode(n.id)&&u.setParent(t.id,n.id,uc)}))),u}}}(f,this.context),g=new p(this.context),v={nodeSize:d,width:u,height:c,center:h};switch(g.id){case"d3-force":case"d3-force-3d":Object.assign(v,{center:{x:u/2,y:c/2,z:0}})}return Vh(g.options,v,l),g}updateElementPosition(t,e){const{model:n,element:i}=this.context;return i?(n.updateData(t),i.draw({animation:e,silence:!0})):null}destroy(){var t;this.stopLayout(),this.context={},null===(t=this.supervisor)||void 0===t||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const oA=(t,e)=>{var n;const[i,r]=e;null===(n=t.nodes)||void 0===n||n.forEach((t=>{if(t.style){const{x:e=0,y:n=0}=t.style;t.style.x=e+i,t.style.y=n+r}else t.style={x:i,y:r}}))};function sA(t){return t.layout?(Array.isArray(t.layout)||"preLayout"in t.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(t.layout.type)&&(t.layout.preLayout=!0),t):t}class lA extends Ih{constructor(t){super(t),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){const e=this.extensionMap[t];if(e)return e;gc.warn(`Cannot find the plugin ${t}, will try to find it by type.`);const n=this.extensions.find((e=>e.type===t));return n?this.extensionMap[n.key]:void 0}}const uA=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class cA extends Ih{constructor(t){super(t),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([...uA.slice(0,uA.length-1),...t,uA[uA.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}var hA=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class dA{get padding(){return _c(this.context.options.padding)}get paddingOffset(){const[t,e,n,i]=this.padding,[r,a,o]=[(i-e)/2,(t-n)/2,0];return[r,a,o]}constructor(t){this.landmarkCounter=0,this.context=t;const[e,n]=this.paddingOffset,{zoom:i,rotation:r,x:a=e,y:o=n}=t.options;this.transform({mode:"absolute",scale:i,translate:[a,o],rotate:r},!1)}get camera(){const{canvas:t}=this.context;return new Proxy(t.getCamera(),{get:(e,n)=>{const i=Object.entries(t.getLayers()).filter((([t])=>!["main"].includes(t))).map((([,t])=>t.getCamera())),r=e[n];if("function"==typeof r)return(...t)=>{const a=r.apply(e,t);return i.forEach((e=>{e[n].apply(e,t)})),a}}})}createLandmark(t){return this.camera.createLandmark("landmark-"+this.landmarkCounter++,t)}getAnimation(t){const e=xc(this.context.options,t);return!!e&&zp(Object.assign({},e),["easing","duration"])}getCanvasSize(){const{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e,n]}getCanvasCenter(){const{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e/2,n/2,0]}getViewportCenter(){const[t,e]=this.camera.getPosition();return[t,e,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(t){const{camera:e}=this,{mode:n,translate:i=[]}=t,r=this.getZoom(),a=e.getPosition(),o=e.getFocalPoint(),[s,l]=this.getCanvasCenter(),[u=0,c=0,h=0]=i,d=$h([-u,-c,-h],r);return"relative"===n?{position:Uh(a,d),focalPoint:Uh(o,d)}:{position:Uh([s,l,a[2]],d),focalPoint:Uh([s,l,o[2]],d)}}getRotateOptions(t){const{mode:e,rotate:n=0}=t;return{roll:"relative"===e?this.camera.getRoll()+n:n}}getZoomOptions(t){const{zoomRange:e}=this.context.options,n=this.camera.getZoom(),{mode:i,scale:r=1}=t;return de("relative"===i?n*r:r,...e)}transform(t,e){return hA(this,void 0,void 0,(function*(){const{graph:n}=this.context,{translate:i,rotate:r,scale:a,origin:o}=t;this.cancelAnimation();const s=this.getAnimation(e);if(xT(n,new bT(oc.BEFORE_TRANSFORM,t)),!r&&a&&!i&&o&&!s)return this.camera.setZoomByViewportPoint(this.getZoomOptions(t),o),void xT(n,new bT(oc.AFTER_TRANSFORM,t));const l={};if(i&&Object.assign(l,this.getTranslateOptions(t)),le(r)&&Object.assign(l,this.getRotateOptions(t)),le(a)&&Object.assign(l,{zoom:this.getZoomOptions(t)}),s)return xT(n,new yT(oc.BEFORE_ANIMATE,tc.TRANSFORM,null,t)),new Promise((e=>{this.transformResolver=e,this.camera.gotoLandmark(this.createLandmark(l),Object.assign(Object.assign({},s),{onfinish:()=>{xT(n,new yT(oc.AFTER_ANIMATE,tc.TRANSFORM,null,t)),xT(n,new bT(oc.AFTER_TRANSFORM,t)),this.transformResolver=void 0,e()}}))}));this.camera.gotoLandmark(this.createLandmark(l),{duration:0}),xT(n,new bT(oc.AFTER_TRANSFORM,t))}))}fitView(t,e){return hA(this,void 0,void 0,(function*(){const[n,i,r,a]=this.padding,{when:o="always",direction:s="both"}=t||{},[l,u]=this.context.canvas.getSize(),c=l-a-i,h=u-n-r,d=this.context.canvas.getBounds(),f=this.getBBoxInViewport(d),[p,g]=Gc(f);if("overflow"===o&&!("x"===s&&p>=c||"y"===s&&g>=h||"both"===s&&p>=c&&g>=h))return yield this.fitCenter({animation:e});const v=c/p,y=h/g,m="x"===s?v:"y"===s?y:Math.min(v,y),b=this.getAnimation(e);yield this.transform({mode:"relative",scale:m,translate:Uh(Hh(this.getCanvasCenter(),this.getBBoxInViewport(d).center),$h(this.paddingOffset,m))},b)}))}fitCenter(t){return hA(this,void 0,void 0,(function*(){const e=this.context.canvas.getBounds();yield this.focus(e,t)}))}focusElements(t){return hA(this,arguments,void 0,(function*(t,e={}){const{element:n}=this.context;if(!n)return;const i=Uc(t.map((t=>{return i=n.getElement(t),e.shapes?i.getShape(e.shapes).getRenderBounds():i.getRenderBounds();var i})));yield this.focus(i,e)}))}focus(t,e){return hA(this,void 0,void 0,(function*(){const n=this.context.graph.getViewportByCanvas(t.center),i=Hh(e.position||this.getCanvasCenter(),n);yield this.transform({mode:"relative",translate:Uh(i,this.paddingOffset)},e.animation)}))}getBBoxInViewport(t){const{min:e,max:n}=t,{graph:i}=this.context,[r,a]=i.getViewportByCanvas(e),[o,s]=i.getViewportByCanvas(n),l=new ti;return l.setMinMax([r,a,0],[o,s,0]),l}isInViewport(t,e=!1,n=0){const{graph:i}=this.context,r=this.getCanvasSize(),[a,o]=i.getCanvasByViewport([0,0]),[s,l]=i.getCanvasByViewport(r);let u=new ti;return u.setMinMax([a,o,0],[s,l,0]),n&&(u=Wc(u,n)),Dc(t)?Hc(t,u):e?function(t,e){const[n,i]=t.min,[r,a]=t.max,[o,s]=e.min,[l,u]=e.max;return n>=o&&r<=l&&i>=s&&a<=u}(t,u):u.intersects(t)}cancelAnimation(){var t,e;(null===(t=this.camera.landmarks)||void 0===t?void 0:t.length)&&this.camera.cancelLandmarkAnimation(),null===(e=this.transformResolver)||void 0===e||e.call(this)}}var fA=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};class pA extends bv{constructor(t){var e;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new DT},this.isCollapsingExpanding=!1,this.onResize=fv((()=>{this.resize()}),300),this._setOptions(Object.assign({},pA.defaultOptions,t),!0),this.context.graph=this,this.options.autoResize&&(null===(e=globalThis.addEventListener)||void 0===e||e.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(t){this._setOptions(t,!1)}_setOptions(t,e){if(this.updateCanvas(t),Object.assign(this.options,function(t){return[sA].reduce(((t,e)=>e(t)),t)}(t)),e){const{data:e}=t;return void(e&&this.addData(e))}const{behaviors:n,combo:i,data:r,edge:a,layout:o,node:s,plugins:l,theme:u,transforms:c}=t;n&&this.setBehaviors(n),r&&this.setData(r),s&&this.setNode(s),a&&this.setEdge(a),i&&this.setCombo(i),o&&this.setLayout(o),u&&this.setTheme(u),l&&this.setPlugins(l),c&&this.setTransforms(c)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,e){t&&(this.options.width=t),e&&(this.options.height=e),this.resize(t,e)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=gn(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=gn(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var e;this.options.behaviors=gn(t)?t(this.getBehaviors()):t,null===(e=this.context.behavior)||void 0===e||e.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors((e=>e.map((e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var e;this.options.plugins=gn(t)?t(this.getPlugins()):t,null===(e=this.context.plugin)||void 0===e||e.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins((e=>e.map((e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var e;this.options.transforms=gn(t)?t(this.getTransforms()):t,null===(e=this.context.transform)||void 0===e||e.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms((e=>e.map((e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e)))),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map((t=>this.context.model.getElementDataById(t))):this.context.model.getElementDataById(t)}getNodeData(t){return void 0===t?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):this.context.model.getNodeLikeDatum(t)}getEdgeData(t){return void 0===t?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):this.context.model.getEdgeDatum(t)}getComboData(t){return void 0===t?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):this.context.model.getNodeLikeDatum(t)}setData(t){this.context.model.setData(gn(t)?t(this.getData()):t)}addData(t){this.context.model.addData(gn(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData(gn(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData(gn(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData(gn(t)?t(this.getComboData()):t)}addChildrenData(t,e){this.context.model.addChildrenData(t,e)}updateData(t){this.context.model.updateData(gn(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData(gn(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData(gn(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData(gn(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData(gn(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData(gn(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData(gn(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData(gn(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,e="both"){return this.context.model.getRelatedEdgesData(t,e)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,e){return this.context.model.getAncestorsData(t,e)}getParentData(t,e){return this.context.model.getParentData(t,e)}getChildrenData(t){return this.context.model.getChildrenData(t)}getDescendantsData(t){return this.context.model.getDescendantsData(t)}getElementDataByState(t,e){return this.context.model.getElementDataByState(t,e)}initCanvas(){return fA(this,void 0,void 0,(function*(){var t;if(this.context.canvas)return yield this.context.canvas.ready;const{container:e="container",width:n,height:i,renderer:r,cursor:a,background:o,canvas:s,devicePixelRatio:l=(null!==(t=globalThis.devicePixelRatio)&&void 0!==t?t:1)}=this.options;if(e instanceof cT)this.context.canvas=e,a&&e.setCursor(a),r&&e.setRenderer(r),yield e.ready;else{const t=he(e)?document.getElementById(e):e,u=pT(t);this.emit(oc.BEFORE_CANVAS_INIT,{container:t,width:n,height:i});const c=Object.assign(Object.assign({},s),{container:t,width:n||u[0],height:i||u[1],background:o,renderer:r,cursor:a,devicePixelRatio:l}),h=new cT(c);this.context.canvas=h,yield h.ready,this.emit(oc.AFTER_CANVAS_INIT,{canvas:h})}}))}updateCanvas(t){var e,n;const{renderer:i,cursor:r,height:a,width:o}=t,s=this.context.canvas;s&&(i&&(this.emit(oc.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),s.setRenderer(i),this.emit(oc.AFTER_RENDERER_CHANGE,{renderer:i})),r&&s.setCursor(r),(le(o)||le(a))&&this.setSize(null!==(e=null!=o?o:this.options.width)&&void 0!==e?e:0,null!==(n=null!=a?a:this.options.height)&&void 0!==n?n:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new NT(this.context)),this.context.plugin||(this.context.plugin=new lA(this.context)),this.context.viewport||(this.context.viewport=new dA(this.context)),this.context.transform||(this.context.transform=new cA(this.context)),this.context.element||(this.context.element=new _T(this.context)),this.context.animation||(this.context.animation=new ST(this.context)),this.context.layout||(this.context.layout=new aA(this.context)),this.context.behavior||(this.context.behavior=new TT(this.context))}prepare(){return fA(this,void 0,void 0,(function*(){yield Promise.resolve(),this.destroyed?console.error(pc("The graph instance has been destroyed")):(yield this.initCanvas(),this.initRuntime())}))}render(){return fA(this,void 0,void 0,(function*(){if(yield this.prepare(),xT(this,new vT(oc.BEFORE_RENDER)),this.options.layout)if(this.rendered||(t=this.options.layout,Array.isArray(t)||!(null==t?void 0:t.preLayout))){const t=this.context.element.draw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.context.layout.postLayout()]),yield this.autoFit()}else{const t=yield this.context.element.preLayoutDraw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.autoFit()])}else{const t=this.context.element.draw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.autoFit()])}var t;this.rendered=!0,xT(this,new vT(oc.AFTER_RENDER))}))}draw(){return fA(this,void 0,void 0,(function*(){var t;yield this.prepare(),yield null===(t=this.context.element.draw())||void 0===t?void 0:t.finished}))}layout(t){return fA(this,void 0,void 0,(function*(){yield this.context.layout.postLayout(t)}))}stopLayout(){this.context.layout.stopLayout()}clear(){return fA(this,void 0,void 0,(function*(){const{model:t,element:e}=this.context;t.setData({}),t.clearChanges(),null==e||e.clear()}))}destroy(){var t;xT(this,new vT(oc.BEFORE_DESTROY));const{layout:e,animation:n,element:i,model:r,canvas:a,behavior:o,plugin:s}=this.context;null==s||s.destroy(),null==o||o.destroy(),null==e||e.destroy(),null==n||n.destroy(),null==i||i.destroy(),r.destroy(),null==a||a.destroy(),this.options={},this.context={},this.off(),null===(t=globalThis.removeEventListener)||void 0===t||t.call(globalThis,"resize",this.onResize),this.destroyed=!0,xT(this,new vT(oc.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,e){var n;const i=pT(null===(n=this.context.canvas)||void 0===n?void 0:n.getContainer()),r=[t||i[0],e||i[1]];if(!this.context.canvas)return;const a=this.context.canvas.getSize();Ku(r,a)||(xT(this,new vT(oc.BEFORE_SIZE_CHANGE,{size:r})),this.context.canvas.resize(...r),xT(this,new vT(oc.AFTER_SIZE_CHANGE,{size:r})))}fitView(t,e){return fA(this,void 0,void 0,(function*(){var n;yield null===(n=this.context.viewport)||void 0===n?void 0:n.fitView(t,e)}))}fitCenter(t){return fA(this,void 0,void 0,(function*(){var e;yield null===(e=this.context.viewport)||void 0===e?void 0:e.fitCenter({animation:t})}))}autoFit(){return fA(this,void 0,void 0,(function*(){const{autoFit:t}=this.context.options;if(t)if(he(t))"view"===t?yield this.fitView():"center"===t&&(yield this.fitCenter());else{const{type:e,animation:n}=t;"view"===e?yield this.fitView(t.options,n):"center"===e&&(yield this.fitCenter(n))}}))}focusElement(t,e){return fA(this,void 0,void 0,(function*(){var n;yield null===(n=this.context.viewport)||void 0===n?void 0:n.focusElements(Array.isArray(t)?t:[t],{animation:e})}))}zoomBy(t,e,n){return fA(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:n},e)}))}zoomTo(t,e,n){return fA(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"absolute",scale:t,origin:n},e)}))}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,e,n){return fA(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:n},e)}))}rotateTo(t,e,n){return fA(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:n},e)}))}getRotation(){return this.context.viewport.getRotation()}translateBy(t,e){return fA(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"relative",translate:t},e)}))}translateTo(t,e){return fA(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},e)}))}getPosition(){return Hh([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,e){return fA(this,arguments,void 0,(function*(t,e,n=!0){var i,r;const[a,o]=vn(t)?[t,null===(i=e)||void 0===i||i]:[{[t]:e},n];Object.entries(a).forEach((([t,e])=>this.context.model.translateNodeLikeBy(t,e))),yield null===(r=this.context.element.draw({animation:o,stage:"translate"}))||void 0===r?void 0:r.finished}))}translateElementTo(t,e){return fA(this,arguments,void 0,(function*(t,e,n=!0){var i,r;const[a,o]=vn(t)?[t,null===(i=e)||void 0===i||i]:[{[t]:e},n];Object.entries(a).forEach((([t,e])=>this.context.model.translateNodeLikeTo(t,e))),yield null===(r=this.context.element.draw({animation:o,stage:"translate"}))||void 0===r?void 0:r.finished}))}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return Ax(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,e){return fA(this,arguments,void 0,(function*(t,e,n=!0){var i,r;const[a,o]=vn(t)?[t,null===(i=e)||void 0===i||i]:[{[t]:e},n],s={nodes:[],edges:[],combos:[]};Object.entries(a).forEach((([t,e])=>{const n=this.getElementType(t);s[`${n}s`].push({id:t,style:{visibility:e}})}));const{model:l,element:u}=this.context;l.preventUpdateNodeLikeHierarchy((()=>{l.updateData(s)})),yield null===(r=u.draw({animation:o,stage:"visibility"}))||void 0===r?void 0:r.finished}))}showElement(t,e){return fA(this,void 0,void 0,(function*(){const n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map((t=>[t,"visible"]))),e)}))}hideElement(t,e){return fA(this,void 0,void 0,(function*(){const n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map((t=>[t,"hidden"]))),e)}))}getElementVisibility(t){var e,n;const i=this.context.element.getElement(t);return null!==(n=null===(e=null==i?void 0:i.style)||void 0===e?void 0:e.visibility)&&void 0!==n?n:"visible"}setElementZIndex(t,e){return fA(this,void 0,void 0,(function*(){var n;const i={nodes:[],edges:[],combos:[]},r=vn(t)?t:{[t]:e};Object.entries(r).forEach((([t,e])=>{const n=this.getElementType(t);i[`${n}s`].push({id:t,style:{zIndex:e}})}));const{model:a,element:o}=this.context;a.preventUpdateNodeLikeHierarchy((()=>a.updateData(i))),yield null===(n=o.draw({animation:!1,stage:"zIndex"}))||void 0===n?void 0:n.finished}))}frontElement(t){return fA(this,void 0,void 0,(function*(){const e=Array.isArray(t)?t:[t],{model:n}=this.context,i={};e.map((t=>{const e=n.getFrontZIndex(t);if("combo"===n.getElementType(t)){const r=n.getAncestorsData(t,uc).at(-1)||this.getComboData(t),a=[r,...n.getDescendantsData(wh(r))],o=e-ET(r);a.forEach((t=>{i[wh(t)]=this.getElementZIndex(wh(t))+o}));const{internal:s}=yg(a.map(wh),(t=>n.getRelatedEdgesData(t)));s.forEach((t=>{const e=wh(t);i[e]=this.getElementZIndex(e)+o}))}else i[t]=e})),yield this.setElementZIndex(i)}))}getElementZIndex(t){return ET(this.context.model.getElementDataById(t))}setElementState(t,e){return fA(this,arguments,void 0,(function*(t,e,n=!0){var i,r;const[a,o]=vn(t)?[t,null===(i=e)||void 0===i||i]:[{[t]:e},n],s={nodes:[],edges:[],combos:[]};Object.entries(a).forEach((([t,e])=>{const n=this.getElementType(t);var i;s[`${n}s`].push({id:t,states:(i=e,i?Array.isArray(i)?i:[i]:[])})})),this.updateData(s),yield null===(r=this.context.element.draw({animation:o,stage:"state"}))||void 0===r?void 0:r.finished}))}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t){return fA(this,arguments,void 0,(function*(t,e=!0){const{model:n,element:i}=this.context;if(Id(n.getNodeLikeData([t])[0]))return;if(this.isCollapsingExpanding)return;"boolean"==typeof e&&(e={animation:e,align:!0});const r=n.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,n.updateData("node"===r?{nodes:[{id:t,style:{collapsed:!0}}]}:{combos:[{id:t,style:{collapsed:!0}}]}),"node"===r?yield i.collapseNode(t,e):"combo"===r&&(yield i.collapseCombo(t,!!e.animation)),this.isCollapsingExpanding=!1}))}expandElement(t){return fA(this,arguments,void 0,(function*(t,e=!0){const{model:n,element:i}=this.context;if(!Id(n.getNodeLikeData([t])[0]))return;if(this.isCollapsingExpanding)return;"boolean"==typeof e&&(e={animation:e,align:!0});const r=n.getElementType(t);this.isCollapsingExpanding=!0,n.updateData("node"===r?{nodes:[{id:t,style:{collapsed:!1}}]}:{combos:[{id:t,style:{collapsed:!1}}]}),"node"===r?yield i.expandNode(t,e):"combo"===r&&(yield i.expandCombo(t,!!e.animation)),this.isCollapsingExpanding=!1}))}setElementCollapsibility(t,e){const n=this.getElementType(t);"node"===n?this.updateNodeData([{id:t,style:{collapsed:e}}]):"combo"===n&&this.updateComboData([{id:t,style:{collapsed:e}}])}toDataURL(){return fA(this,arguments,void 0,(function*(t={}){return this.context.canvas.toDataURL(t)}))}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,e,n){return super.on(t,e,n)}once(t,e){return super.once(t,e)}off(t,e){return super.off(t,e)}}pA.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};const gA=(t,e)=>{const{source:n,target:i}=e,r=t.getElementDataById(n),a=t.getElementDataById(i),o=mg(r,(e=>t.getParentData(e,uc))),s=mg(a,(e=>t.getParentData(e,uc))),l={sourceNode:wh(o),targetNode:wh(s)};return e.style?Object.assign(e.style,l):e.style=l,e};class vA extends JN{constructor(t,e){super(t,Vh({},vA.defaultOptions,e)),this.assignSizeByCentrality=(t,e,n,i,r,a)=>{const o=[e,n],s=[i[0],r[0]],l=[i[1],r[1]],u=[i[2],r[2]],c=(t,e)=>{if("function"==typeof a)return a(t,o,e);switch(a){case"linear":return((t,e,n)=>{const[i,r]=e,[a,o]=n;return r===i?a:a+(t-i)/(r-i)*(o-a)})(t,o,e);case"log":return((t,e,n)=>{const[i,r]=e,[a,o]=n;return a+Math.log(t-i+1)/Math.log(r-i+1)*(o-a)})(t,o,e);case"pow":return((t,e,n,i=2)=>{const[r,a]=e,[o,s]=n;return o+Math.pow((t-r)/(a-r),i)*(s-o)})(t,o,e,2);case"sqrt":return((t,e,n)=>{const[i,r]=e,[a,o]=n;return a+Math.sqrt((t-i)/(r-i))*(o-a)})(t,o,e);default:return e[0]}};return[c(t,s),c(t,l),c(t,u)]}}beforeDraw(t){const{model:e}=this.context,n=e.getNodeData(),i=Wd(this.options.maxSize),r=Wd(this.options.minSize),a=this.getCentralities(this.options.centrality),o=a.size>0?Math.max(...a.values()):0,s=a.size>0?Math.min(...a.values()):0;return n.forEach((e=>{var n;const l=this.assignSizeByCentrality(a.get(wh(e))||0,s,o,r,i,this.options.scale),u=null===(n=this.context.element)||void 0===n?void 0:n.getElement(wh(e)),c={size:l};this.assignLabelStyle(c,l,e,u),u&&eT(c,u.attributes)||tT(t,u?"update":"add","node",Vh(e,{style:c}),!0)})),t}assignLabelStyle(t,e,n,i){var r;const a=i?i.config.style:null===(r=this.context.element)||void 0===r?void 0:r.getElementComputedStyle("node",n);if(Object.assign(t,zp(a,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){const n=this.getLabelSizeByNodeSize(e,1/0,Number(t.labelFontSize));Object.assign(t,{labelFontSize:n,labelLineHeight:n+Bc(t.labelPadding)})}return t}getLabelSizeByNodeSize(t,e,n){const i=Math.min(...t)/2,[r,a]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[n,e];return Math.min(a,Math.max(i,r))}getCentralities(t){const{model:e}=this.context,n=e.getData();if("function"==typeof t)return t(n);const i=e.getRelatedEdgesData.bind(e);return Sh(n,i,t)}}vA.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class yA extends JN{constructor(t,e){super(t,Object.assign({},yA.defaultOptions,e))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var t;const e=sd(this.ref),{graph:n,model:i}=this.context;null===(t=i.getData().nodes)||void 0===t||t.forEach((t=>{var r;if(wh(t)===wh(this.ref))return;const a=id(Hh(sd(t),e)),o=Math.abs(a)>Math.PI/2,s=!t.children||0===t.children.length,l=wh(t),u=null===(r=this.context.element)||void 0===r?void 0:r.getElement(l);if(!u||!u.isVisible())return;const c=(s?1:-1)*(Wd(n.getElementRenderStyle(l).size)[0]/2+this.options.offset),h=[["translate",c*Math.cos(a),c*Math.sin(a)],["rotate",o?pi(a)+180:pi(a)]];i.updateNodeData([{id:wh(t),style:{labelTextAlign:o===s?"right":"left",labelTextBaseline:"middle",labelTransform:h}}])})),n.draw()}}yA.defaultOptions={offset:5};const mA=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class bA extends JN{constructor(t,e){super(t,Object.assign({},bA.defaultOptions,e)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=t=>{const{add:{edges:e},update:{nodes:n,edges:i,combos:r},remove:{edges:a}}=t,{model:o}=this.context,s=new Map,l=(t,e)=>{o.getRelatedEdgesData(e).forEach((t=>!s.has(wh(t))&&s.set(wh(t),t)))};n.forEach(l),r.forEach(l);const u=t=>{const e=o.getEdgeData().map((t=>gA(o,t)));EA(t,e,!0).forEach((t=>!s.has(wh(t))&&s.set(wh(t),t)))};if(a.size&&a.forEach(u),e.size&&e.forEach(u),i.size){const t=DE(LE(o.getChanges())).update.edges;i.forEach((e=>{var n;u(e);const i=null===(n=t.find((t=>wh(t.value)===wh(e))))||void 0===n?void 0:n.original;i&&!wA(e,i)&&u(i)}))}Jd(this.options.edges)||s.forEach(((t,e)=>!this.options.edges.includes(e)&&s.delete(e)));const c=o.getEdgeData().map(wh);return new Map([...s].sort(((t,e)=>c.indexOf(t[0])-c.indexOf(e[0]))))},this.applyBundlingStyle=(t,e,n)=>{const{edgeMap:i,reverses:r}=xA(e);i.forEach((e=>{e.forEach(((e,i,a)=>{var o;const s=a.length,l=e.style||{};if(e.source===e.target){const t=mA.length;l.loopPlacement=mA[i%t],l.loopDist=Math.floor(i/t)*n+50}else if(1===s)l.curveOffset=0;else{const t=(i%2==0?1:-1)*(r[`${e.source}|${e.target}|${i}`]?-1:1);l.curveOffset=s%2==1?t*Math.ceil(i/2)*n*2:t*(Math.floor(i/2)*n*2+n)}const u=Object.assign(e,{type:"quadratic",style:l}),c=null===(o=this.context.element)||void 0===o?void 0:o.getElement(wh(e));c&&eT(u.style,c.attributes)||tT(t,c?"update":"add","edge",u,!0)}))}))},this.resetEdgeStyle=t=>{const e=t.style||{},n=this.cacheMergeStyle.get(wh(t))||{};return Object.keys(n).forEach((i=>{Ku(e[i],n[i])&&(t[i]?e[i]=t[i]:delete e[i])})),Object.assign(t,{style:e})},this.applyMergingStyle=(t,e)=>{const{edgeMap:n,reverses:i}=xA(e);n.forEach((e=>{var n;if(1===e.length){const i=e[0],r=null===(n=this.context.element)||void 0===n?void 0:n.getElement(wh(i)),a=this.resetEdgeStyle(i);return void(r&&eT(a,r.attributes)||tT(t,r?"update":"add","edge",a))}const r=e.map((({source:t,target:e,style:n={}},r)=>{const{startArrow:a,endArrow:o}=n,s={},[l,u]=i[`${t}|${e}|${r}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return pn(a)&&(s[l]=a),pn(o)&&(s[u]=o),s})).reduce(((t,e)=>Object.assign(Object.assign({},t),e)),{});e.forEach(((e,n,i)=>{var a;if(0!==n)return void tT(t,"remove","edge",e);const o=Object.assign({},gn(this.options.style)?this.options.style(i):this.options.style,{childrenData:i});this.cacheMergeStyle.set(wh(e),o);const s=Object.assign(Object.assign({},e),{type:"line",style:Object.assign(Object.assign(Object.assign({},e.style),r),o)}),l=null===(a=this.context.element)||void 0===a?void 0:a.getElement(wh(e));l&&eT(s.style,l.attributes)||tT(t,l?"update":"add","edge",s,!0)}))}))}}beforeDraw(t){const e=this.getAffectedParallelEdges(t);return 0===e.size||("bundle"===this.options.mode?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}}bA.defaultOptions={mode:"bundle",distance:15};const xA=t=>{const e=new Map,n=new Set,i={},r=new Map;for(const[a,o]of t){if(n.has(a))continue;const{source:s,target:l}=o,u=`${s}-${l}`;e.has(u)||(e.set(u,[]),r.set(u,new Set));const c=e.get(u),h=r.get(u);c&&h&&!h.has(a)&&(c.push(o),h.add(a),n.add(a));for(const[c,h]of t)if(!n.has(c)&&c!==a&&wA(o,h)){const t=e.get(u),a=r.get(u);t&&a&&!a.has(c)&&(t.push(h),a.add(c),s===h.target&&l===h.source&&(i[`${h.source}|${h.target}|${t.length-1}`]=!0),n.add(c))}}return{edgeMap:e,reverses:i}},EA=(t,e,n)=>e.filter((e=>(n||wh(e)!==wh(t))&&wA(e,t))),wA=(t,e)=>{const{sourceNode:n,targetNode:i}=t.style||{},{sourceNode:r,targetNode:a}=e.style||{};return n===r&&i===a||n===a&&i===r},kA={animation:{"combo-collapse":Tc,"combo-expand":Ac,"node-collapse":kc,"node-expand":Mc,"path-in":Sc,"path-out":Nc,fade:[{fields:["opacity"]}],translate:[{fields:["x","y"]}]},behavior:{"brush-select":Sd,"click-select":Dd,"collapse-expand":sv,"create-edge":dv,"drag-canvas":gv,"drag-element-force":class extends yv{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find((t=>["d3-force","d3-force-3d"].includes(null==t?void 0:t.id)))}validate(t){return!!this.context.layout&&(this.forceLayoutInstance?super.validate(t):(gc.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1))}moveElement(t,e){return n=this,i=void 0,a=function*(){const n=this.forceLayoutInstance;this.context.graph.getNodeData(t).forEach(((i,r)=>{const{x:a=0,y:o=0}=i.style||{};n&&Tv(n,"setFixedPosition",t[r],[...Uh([+a,+o],e)])}))},new((r=void 0)||(r=Promise))((function(t,e){function o(t){try{l(a.next(t))}catch(t){e(t)}}function s(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,s)}l((a=a.apply(n,i||[])).next())}));var n,i,r,a}onDragStart(t){if(this.enable=this.validate(t),!this.enable)return;this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const e=this.forceLayoutInstance;e&&Av(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach((t=>{const{x:n=0,y:i=0}=t.style||{};e&&Tv(e,"setFixedPosition",wh(t),[+n,+i])}))}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.moveElement(this.target,e)}onDragEnd(){const t=this.forceLayoutInstance;t&&Av(t,"simulation").alphaTarget(0),this.options.fixed||this.context.graph.getNodeData(this.target).forEach((e=>{t&&Tv(t,"setFixedPosition",wh(e),[null,null,null])}))}},"drag-element":yv,"fix-element-size":Pv,"focus-element":Cv,"hover-activate":Rv,"lasso-select":class extends Sd{onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;const{canvas:e}=this.context;this.pathShape=new Ol({id:"g6-lasso-select",style:this.options.style}),e.appendChild(this.pathShape),this.points=[Nd(t)]}onPointerMove(t){var e;if(!this.points)return;const{immediately:n,mode:i}=this.options;this.points.push(Nd(t)),null===(e=this.pathShape)||void 0===e||e.setAttribute("d",function(t,e=!0){const n=[];return t.forEach(((t,e)=>{n.push([0===e?"M":"L",...t])})),e&&n.push(["Z"]),n}(this.points)),n&&"default"===i&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){this.points&&(this.points.length<2||super.updateElementsStates(this.points),this.clearLasso())}clearLasso(){var t;null===(t=this.pathShape)||void 0===t||t.remove(),this.pathShape=void 0,this.points=void 0}},"auto-adapt-label":Fh,"optimize-viewport-transform":Lv,"scroll-canvas":Iv,"zoom-canvas":Bv},combo:{circle:Kp,rect:Zp},edge:{cubic:Ag,line:Rg,polyline:Vg,quadratic:Wg,"cubic-horizontal":Og,"cubic-radial":Pg,"cubic-vertical":Cg},layout:{"antv-dagre":class{constructor(t={}){this.options=t,this.id="antv-dagre",this.options=Object.assign(Object.assign({},bm),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericDagreLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericDagreLayout(!0,t,e)}))}genericDagreLayout(t,e,n){return ye(this,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},this.options),n),{nodeSize:r,align:a,rankdir:o="TB",ranksep:s,nodesep:l,ranksepFunc:u,nodesepFunc:c,edgeLabelSpace:h,ranker:d,nodeOrder:f,begin:p,controlPoints:g,radial:v,sortByCombo:y,preset:m}=i,b=new Mv({tree:[]}),x=pm(s||50,u),E=pm(l||50,c);let w=E,k=x;"LR"!==o&&"RL"!==o||(w=x,k=E);const M=gm(10,r,!1),S=e.getAllNodes(),N=e.getAllEdges();let T;S.forEach((t=>{const e=fm(M(t)),n=k(t),i=w(t),r=e[0]+2*i,a=e[1]+2*n,o=t.data.layer;le(o)?b.addNode({id:t.id,data:{width:r,height:a,layer:o}}):b.addNode({id:t.id,data:{width:r,height:a}})})),y&&(b.attachTreeStructure("combo"),S.forEach((t=>{const{parentId:e}=t.data;void 0!==e&&b.hasNode(e)&&b.setParent(t.id,e,"combo")}))),N.forEach((t=>{b.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),(null==m?void 0:m.length)&&(T=new Mv({nodes:m})),((t,e)=>{const{edgeLabelSpace:n,keepNodeOrder:i,prevGraph:r,rankdir:a,ranksep:o}=e;var s,l;!i&&r&&(l=r,(s=t).getAllNodes().forEach((t=>{const e=s.getNode(t.id);if(l.hasNode(t.id)){const n=l.getNode(t.id);e.data.fixorder=n.data._order,delete n.data._order}else delete e.data.fixorder})));const u=(t=>{const e=new Mv({tree:[]});return t.getAllNodes().forEach((n=>{const i=dm(t.getNode(n.id).data),r=Object.assign(Object.assign({},Ky),i),a=hm(r,qy);e.hasNode(n.id)||e.addNode({id:n.id,data:Object.assign({},a)});const o=t.hasTreeStructure("combo")?t.getParent(n.id,"combo"):t.getParent(n.id);ce(o)||(e.hasNode(o.id)||e.addNode(Object.assign({},o)),e.setParent(n.id,o.id))})),t.getAllEdges().forEach((n=>{const i=dm(t.getEdge(n.id).data),r={};null==Jy||Jy.forEach((t=>{void 0!==i[t]&&(r[t]=i[t])})),e.addEdge({id:n.id,source:n.source,target:n.target,data:Object.assign({},Qy,hm(i,Zy),r)})})),e})(t);let c;n&&(e.ranksep=((t,e)=>{const{ranksep:n=0,rankdir:i}=e;return t.getAllNodes().forEach((t=>{isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((t=>{var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===i||"BT"===i?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2})(u,{rankdir:a,ranksep:o}));try{c=Xy(u,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",t);throw t}((t,e)=>{t.getAllNodes().forEach((n=>{var i;const r=t.getNode(n.id);if(r){const t=e.getNode(n.id);r.data.x=t.data.x,r.data.y=t.data.y,r.data._order=t.data.order,r.data._rank=t.data.rank,(null===(i=e.getChildren(n.id))||void 0===i?void 0:i.length)&&(r.data.width=t.data.width,r.data.height=t.data.height)}})),t.getAllEdges().forEach((n=>{const i=t.getEdge(n.id),r=e.getEdge(n.id);i.data.points=r?r.data.points:[],r&&r.data.hasOwnProperty("x")&&(i.data.x=r.data.x,i.data.y=r.data.y)}))})(t,u)})(b,{prevGraph:T,edgeLabelSpace:h,keepNodeOrder:!!f,nodeOrder:f||[],acyclicer:"greedy",ranker:d,rankdir:o,nodesep:l,align:a});const A=[0,0];if(p){let t=1/0,e=1/0;b.getAllNodes().forEach((n=>{t>n.data.x&&(t=n.data.x),e>n.data.y&&(e=n.data.y)})),b.getAllEdges().forEach((n=>{var i;null===(i=n.data.points)||void 0===i||i.forEach((n=>{t>n.x&&(t=n.x),e>n.y&&(e=n.y)}))})),A[0]=p[0]-t,A[1]=p[1]-e}const O="LR"===o||"RL"===o;if(v);else{const t=new Set,e="BT"===o||"RL"===o?(t,e)=>e-t:(t,e)=>t-e;b.getAllNodes().forEach((e=>{e.data.x=e.data.x+A[0],e.data.y=e.data.y+A[1],t.add(O?e.data.x:e.data.y)}));const n=Array.from(t).sort(e),i=O?(t,e)=>t.x!==e.x:(t,e)=>t.y!==e.y,r=O?(t,e,n)=>{const i=Math.max(e.y,n.y),r=Math.min(e.y,n.y);return t.filter((t=>t.y<=i&&t.y>=r))}:(t,e,n)=>{const i=Math.max(e.x,n.x),r=Math.min(e.x,n.x);return t.filter((t=>t.x<=i&&t.x>=r))};b.getAllEdges().forEach(((t,e)=>{var a;h&&g&&"loop"!==t.data.type&&(t.data.controlPoints=((t,e,n,i,r,a,o)=>{let s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&n){let{x:t,y:l}=e.data,{x:u,y:c}=n.data;if(r&&(t=e.data.y,l=e.data.x,u=n.data.y,c=n.data.x),c!==l&&t!==u){const h=i.indexOf(l),d=i[h+1];if(d){const t=s[0],e=r?{x:(l+d)/2,y:(null==t?void 0:t.y)||u}:{x:(null==t?void 0:t.x)||u,y:(l+d)/2};t&&!a(t,e)||s.unshift(e)}const f=i.indexOf(c),p=Math.abs(f-h);if(1===p)s=o(s,e.data,n.data),s.length||s.push(r?{x:(l+c)/2,y:t}:{x:t,y:(l+c)/2});else if(p>1){const e=i[f-1];if(e){const n=s[s.length-1],i=r?{x:(c+e)/2,y:(null==n?void 0:n.y)||u}:{x:(null==n?void 0:n.x)||t,y:(c+e)/2};n&&!a(n,i)||s.push(i)}}}}return s})(null===(a=t.data.points)||void 0===a?void 0:a.map((({x:t,y:e})=>({x:t+A[0],y:e+A[1]}))),b.getNode(t.source),b.getNode(t.target),n,O,i,r))}))}let P=[];P=b.getAllNodes().map((t=>mm(t)));const C=b.getAllEdges();return t&&(P.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),C.forEach((t=>{e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),{nodes:P,edges:C}}))}},"combo-combined":class{constructor(t={}){this.options=t,this.id="comboCombined",this.options=Object.assign(Object.assign({},db),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericComboCombinedLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericComboCombinedLayout(!0,t,e)}))}genericComboCombinedLayout(t,e,n){return ye(this,void 0,void 0,(function*(){const i=this.initVals(Object.assign(Object.assign({},this.options),n)),{center:r,treeKey:a,outerLayout:o}=i,s=e.getAllNodes().filter((t=>!t.data._isCombo)),l=e.getAllNodes().filter((t=>t.data._isCombo)),u=e.getAllEdges(),c=null==s?void 0:s.length;if(!c||1===c)return xm(e,t,r);const h=[],d=new Map;s.forEach((t=>{d.set(t.id,t)}));const f=new Map;l.forEach((t=>{f.set(t.id,t)}));const p=new Map,g=this.getInnerGraphs(e,a,d,f,u,i,p);yield Promise.all(g);const v=new Map,y=[],m=new Map;let b=!0;e.getRoots(a).forEach((t=>{const n=p.get(t.id),i=f.get(t.id)||d.get(t.id),r={id:t.id,data:Object.assign(Object.assign({},t.data),{x:n.data.x||i.data.x,y:n.data.y||i.data.y,fx:n.data.fx||i.data.fx,fy:n.data.fy||i.data.fy,mass:n.data.mass||i.data.mass,size:n.data.size})};y.push(r),v.set(t.id,!0),isNaN(r.data.x)||0===r.data.x||isNaN(r.data.y)||0===r.data.y?(r.data.x=100*Math.random(),r.data.y=100*Math.random()):b=!1,ab(e,[t],(e=>{e.id!==t.id&&m.set(e.id,t.id)}),"TB",a)}));const x=[];let E;if(u.forEach((t=>{const e=m.get(t.source)||t.source,n=m.get(t.target)||t.target;e!==n&&v.has(e)&&v.has(n)&&x.push({id:t.id,source:e,target:n,data:{}})})),null==y?void 0:y.length){if(1===y.length)y[0].data.x=r[0],y[0].data.y=r[1];else{const t=new Mv({nodes:y,edges:x}),e=o||new $m;if(b&&hb[e.id]){const e=y.length<100?new sb:new Sm;yield e.assign(t)}const n=Object.assign({center:r,kg:5,preventOverlap:!0,animate:!1},"force"===e.id?{gravity:1,factor:4,linkDistance:(t,e,n)=>(Math.max(...e.data.size)||32)/2+(Math.max(...n.data.size)||32)/2+200}:{});E=yield fb(e,t,n)}p.forEach((t=>{var e;const n=E.nodes.find((e=>e.id===t.id));if(n){const{x:e,y:i}=n.data;t.data.visited=!0,t.data.x=e,t.data.y=i,h.push({id:t.id,data:{x:e,y:i}})}const{x:i,y:r}=t.data;null===(e=t.data.nodes)||void 0===e||e.forEach((t=>{h.push({id:t.id,data:{x:t.data.x+i,y:t.data.y+r}})}))})),p.forEach((({data:t})=>{const{x:e,y:n,visited:i,nodes:r}=t;null==r||r.forEach((t=>{if(!i){const i=h.find((e=>e.id===t.id));i.data.x+=e||0,i.data.y+=n||0}}))}))}return t&&h.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),{nodes:h,edges:u}}))}initVals(t){const e=Object.assign({},t),{nodeSize:n,spacing:i,comboPadding:r}=t;let a,o,s;if(o=le(i)?()=>i:gn(i)?i:()=>0,e.spacing=o,n)if(gn(n))a=t=>{const e=n(t),i=o(t);return km(t.size)?((t.size[0]>t.size[1]?t.size[0]:t.size[1])+i)/2:((e||32)+i)/2};else if(km(n)){const t=(n[0]>n[1]?n[0]:n[1])/2;a=e=>t+o(e)/2}else{const t=n/2;a=e=>t+o(e)/2}else a=t=>{const e=o(t);return t.size?km(t.size)?((t.size[0]>t.size[1]?t.size[0]:t.size[1])+e)/2:vn(t.size)?((t.size.width>t.size.height?t.size.width:t.size.height)+e)/2:(t.size+e)/2:32+e/2};return e.nodeSize=a,s=le(r)?()=>r:km(r)?()=>Math.max.apply(null,r):gn(r)?r:()=>0,e.comboPadding=s,e}getInnerGraphs(t,e,n,i,r,a,o){const{nodeSize:s,comboPadding:l,spacing:u,innerLayout:c}=a,h=c||new Sm({}),d={center:[0,0],preventOverlap:!0,nodeSpacing:u},f=[],p=t=>{let e=(null==l?void 0:l(t))||10;return km(e)&&(e=Math.max(...e)),{size:e?[2*e,2*e]:[30,30],padding:e}};return t.getRoots(e).forEach((a=>{o.set(a.id,{id:a.id,data:{nodes:[],size:p(a).size}});let l=Promise.resolve();ab(t,[a],(a=>{var u;if(!a.data._isCombo)return;const{size:c,padding:f}=p(a);if(null===(u=t.getChildren(a.id,e))||void 0===u?void 0:u.length){const u=o.get(a.id);o.set(a.id,{id:a.id,data:Object.assign({nodes:[]},null==u?void 0:u.data)});const c=new Map,p=t.getChildren(a.id,e).map((t=>{if(t.data._isCombo)return o.has(t.id)||o.set(t.id,{id:t.id,data:Object.assign({},t.data)}),c.set(t.id,!0),o.get(t.id);const e=n.get(t.id)||i.get(t.id);return c.set(t.id,!0),{id:t.id,data:Object.assign(Object.assign({},e.data),t.data)}})),g={nodes:p,edges:r.filter((t=>c.has(t.source)&&c.has(t.target)))};let v=1/0;p.forEach((t=>{var e;let{size:n}=t.data;n||(n=(null===(e=o.get(t.id))||void 0===e?void 0:e.data.size)||(null==s?void 0:s(t))||[30,30]),le(n)&&(n=[n,n]);const[i,r]=n;v>i&&(v=i),v>r&&(v=r),t.data.size=n})),l=l.then((()=>ye(this,void 0,void 0,(function*(){const t=new Mv(g);yield fb(h,t,d,!0);const{minX:e,minY:n,maxX:i,maxY:r}=(t=>{let e=1/0,n=1/0,i=-1/0,r=-1/0;return t.forEach((t=>{let a=t.data.size;km(a)?1===a.length&&(a=[a[0],a[0]]):le(a)?a=[a,a]:(void 0===a||isNaN(a))&&(a=[30,30]);const o=[a[0]/2,a[1]/2],s=t.data.x-o[0],l=t.data.x+o[0],u=t.data.y-o[1],c=t.data.y+o[1];e>s&&(e=s),n>u&&(n=u),i<l&&(i=l),r<c&&(r=c)})),{minX:e,minY:n,maxX:i,maxY:r}})(p),s=(i+e)/2,l=(r+n)/2;g.nodes.forEach((t=>{t.data.x-=s,t.data.y-=l}));const u=[Math.max(i-e,v)+2*f,Math.max(r-n,v)+2*f];o.get(a.id).data.size=u,o.get(a.id).data.nodes=p}))))}else o.set(a.id,{id:a.id,data:Object.assign(Object.assign({},a.data),{size:c})});return!0}),"BT",e),f.push(l)})),f}},"compact-box":Fv.compactBox,"d3-force":class{constructor(t){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:mb,manyBody:Yb,center:$b,collide:Kb,radial:Zb,x:Qb,y:Jb},this.options={link:{id:t=>t.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},Vh(this.options,t),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericLayout(!0,t,e)}))}stop(){this.simulation.stop()}tick(t){return this.simulation.tick(t),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(t,e){const n=this.context.nodes.find((e=>e.id===t));n&&e.forEach(((t,e)=>{"number"!=typeof t&&null!==t||(n[["fx","fy","fz"][e]]=t)}))}getOptions(t){var e,n;const i=Vh({},this.options,t);return i.collide&&void 0===(null===(e=i.collide)||void 0===e?void 0:e.radius)&&(i.collide=i.collide||{},i.collide.radius=null!==(n=i.nodeSize)&&void 0!==n?n:10),void 0===i.iterations&&(i.link&&void 0===i.link.iterations&&(i.iterations=i.link.iterations),i.collide&&void 0===i.collide.iterations&&(i.iterations=i.collide.iterations)),this.context.options=i,i}genericLayout(t,e,n){var i;return ye(this,void 0,void 0,(function*(){const r=this.getOptions(n),a=e.getAllNodes().map((({id:t,data:e})=>Object.assign(Object.assign({id:t},e),zp(e.data,this.config.inputNodeAttrs)))),o=e.getAllEdges().map((t=>Object.assign({},t)));Object.assign(this.context,{assign:t,nodes:a,edges:o,graph:e});const s=new Promise((t=>{this.resolver=t})),l=this.setSimulation(r);return l.nodes(a),null===(i=l.force("link"))||void 0===i||i.links(o),s}))}getResult(){const{assign:t,nodes:e,edges:n,graph:i}=this.context,r=e.map((t=>({id:t.id,data:Object.assign(Object.assign({},t.data),zp(t,this.config.outputNodeAttrs))}))),a=n.map((({id:t,source:e,target:n,data:i})=>({id:t,source:"object"==typeof e?e.id:e,target:"object"==typeof n?n.id:n,data:i})));return t&&r.forEach((t=>i.mergeNodeData(t.id,t.data))),{nodes:r,edges:a}}initSimulation(){return function(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),a=0,o=.6,s=new Map,l=Fb(h),u=Mb("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Vb)/Vb}();function h(){d(),u.call("tick",e),n<i&&(l.stop(),u.call("end",e))}function d(i){var l,u,c=t.length;void 0===i&&(i=1);for(var h=0;h<i;++h)for(n+=(a-n)*r,s.forEach((function(t){t(n)})),l=0;l<c;++l)null==(u=t[l]).fx?u.x+=u.vx*=o:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=o:(u.y=u.fy,u.vy=0);return e}function f(){for(var e,n=0,i=t.length;n<i;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var r=10*Math.sqrt(.5+n),a=n*Hb;e.x=r*Math.cos(a),e.y=r*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),f(),e={tick:d,restart:function(){return l.restart(h),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(r=+t,e):+r},alphaTarget:function(t){return arguments.length?(a=+t,e):a},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(c=t,s.forEach(p),e):c},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,i){var r,a,o,s,l,u=0,c=t.length;for(null==i?i=1/0:i*=i,u=0;u<c;++u)(o=(r=e-(s=t[u]).x)*r+(a=n-s.y)*a)<i&&(l=s,i=o);return l},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}()}setSimulation(t){const e=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=e.on("tick",(()=>{var e;return null===(e=t.onTick)||void 0===e?void 0:e.call(t,this.getResult())})).on("end",(()=>{var t;return null===(t=this.resolver)||void 0===t?void 0:t.call(this,this.getResult())}))),tx(e,this.config.simulationAttrs.map((e=>[e,t[e]]))),Object.entries(this.forceMap).forEach((([n,i])=>{const r=n;if(t[n]){let n=e.force(r);n||(n=i(),e.force(r,n)),tx(n,Object.entries(t[r]))}else e.force(r,null)})),e}},"force-atlas2":class{constructor(t={}){this.options=t,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},sx),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericForceAtlas2Layout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericForceAtlas2Layout(!0,t,e)}))}genericForceAtlas2Layout(t,e,n){return ye(this,void 0,void 0,(function*(){const i=e.getAllEdges(),r=e.getAllNodes(),a=this.formatOptions(n,r.length),{width:o,height:s,prune:l,maxIteration:u,nodeSize:c,center:h}=a;if(!(null==r?void 0:r.length)||1===r.length)return xm(e,t,h);const d=r.map((t=>mm(t,[o,s]))),f=i.filter((t=>{const{source:e,target:n}=t;return e!==n})),p=new Mv({nodes:d,edges:f}),g=this.getSizes(p,c);if(this.run(p,e,u,g,t,a),l){for(let t=0;t<f.length;t+=1){const{source:e,target:n}=f[t],i=p.getDegree(e),r=p.getDegree(e);if(i<=1){const t=p.getNode(n);p.mergeNodeData(e,{x:t.data.x,y:t.data.y})}else if(r<=1){const t=p.getNode(e);p.mergeNodeData(n,{x:t.data.x,y:t.data.y})}}const n=Object.assign(Object.assign({},a),{prune:!1,barnesHut:!1});this.run(p,e,100,g,t,n)}return{nodes:d,edges:i}}))}getSizes(t,e){const n=t.getAllNodes(),i={};for(let t=0;t<n.length;t+=1){const r=n[t];i[r.id]=vm(e,void 0)(r)}return i}formatOptions(t={},e){const n=Object.assign(Object.assign({},this.options),t),{center:i,width:r,height:a,barnesHut:o,prune:s,maxIteration:l,kr:u,kg:c}=n;return n.width=r||"undefined"==typeof window?r:window.innerWidth,n.height=a||"undefined"==typeof window?a:window.innerHeight,n.center=i||[n.width/2,n.height/2],void 0===o&&e>250&&(n.barnesHut=!0),void 0===s&&e>100&&(n.prune=!0),0!==l||s?0===l&&s&&(n.maxIteration=100,e<=200&&e>100?n.maxIteration=500:e>200&&(n.maxIteration=950)):(n.maxIteration=250,e<=200&&e>100?n.maxIteration=1e3:e>200&&(n.maxIteration=1200)),u||(n.kr=50,e>100&&e<=500?n.kr=20:e>500&&(n.kr=1)),c||(n.kg=20,e>100&&e<=500?n.kg=10:e>500&&(n.kg=1)),n}run(t,e,n,i,r,a){const{kr:o,barnesHut:s,onTick:l}=a,u=t.getAllNodes();let c=0,h=n;const d={},f={},p={};for(let e=0;e<u.length;e+=1){const{data:n,id:i}=u[e];if(d[i]=[0,0],s){const r={id:e,rx:n.x,ry:n.y,mass:1,g:o,degree:t.getDegree(i)};p[i]=new rx(r)}}for(;h>0;)c=this.oneStep(t,{iter:h,preventOverlapIters:50,krPrime:100,sg:c,forces:d,preForces:f,bodies:p,sizes:i},a),h--,null==l||l({nodes:u,edges:e.getAllEdges()});return t}oneStep(t,e,n){const{iter:i,preventOverlapIters:r,krPrime:a,sg:o,preForces:s,bodies:l,sizes:u}=e;let{forces:c}=e;const{preventOverlap:h,barnesHut:d}=n,f=t.getAllNodes();for(let t=0;t<f.length;t+=1){const{id:e}=f[t];s[e]=[...c[e]],c[e]=[0,0]}return c=this.getAttrForces(t,i,r,u,c,n),c=d&&(h&&i>r||!h)?this.getOptRepGraForces(t,c,l,n):this.getRepGraForces(t,i,r,c,a,u,n),this.updatePos(t,c,s,o,n)}getAttrForces(t,e,n,i,r,a){const{preventOverlap:o,dissuadeHubs:s,mode:l,prune:u}=a,c=t.getAllEdges();for(let a=0;a<c.length;a+=1){const{source:h,target:d}=c[a],f=t.getNode(h),p=t.getNode(d),g=t.getDegree(h),v=t.getDegree(d);if(u&&(g<=1||v<=1))continue;const y=[p.data.x-f.data.x,p.data.y-f.data.y];let m=Math.hypot(y[0],y[1]);m=m<1e-4?1e-4:m,y[0]=y[0]/m,y[1]=y[1]/m,o&&e<n&&(m=m-i[h]-i[d]);let b=m,x=b;"linlog"===l&&(b=Math.log(1+m),x=b),s&&(b=m/g,x=m/v),o&&e<n&&m<=0?(b=0,x=0):o&&e<n&&m>0&&(b=m,x=m),r[h][0]+=b*y[0],r[d][0]-=x*y[0],r[h][1]+=b*y[1],r[d][1]-=x*y[1]}return r}getOptRepGraForces(t,e,n,i){const{kg:r,center:a,prune:o}=i,s=t.getAllNodes(),l=s.length;let u=9e10,c=-9e10,h=9e10,d=-9e10;for(let e=0;e<l;e+=1){const{id:i,data:r}=s[e];o&&t.getDegree(i)<=1||(n[i].setPos(r.x,r.y),r.x>=c&&(c=r.x),r.x<=u&&(u=r.x),r.y>=d&&(d=r.y),r.y<=h&&(h=r.y))}const f=Math.max(c-u,d-h),p=new ax({xmid:(c+u)/2,ymid:(d+h)/2,length:f,massCenter:a,mass:l}),g=new ox(p);for(let e=0;e<l;e+=1){const{id:i}=s[e];o&&t.getDegree(i)<=1||n[i].in(p)&&g.insert(n[i])}for(let i=0;i<l;i+=1){const{id:l,data:u}=s[i],c=t.getDegree(l);if(o&&c<=1)continue;n[l].resetForce(),g.updateForce(n[l]),e[l][0]-=n[l].fx,e[l][1]-=n[l].fy;const h=[u.x-a[0],u.y-a[1]];let d=Math.hypot(h[0],h[1]);d=d<1e-4?1e-4:d,h[0]=h[0]/d,h[1]=h[1]/d;const f=r*(c+1);e[l][0]-=f*h[0],e[l][1]-=f*h[1]}return e}getRepGraForces(t,e,n,i,r,a,o){const{preventOverlap:s,kr:l,kg:u,center:c,prune:h}=o,d=t.getAllNodes(),f=d.length;for(let o=0;o<f;o+=1){const p=d[o],g=t.getDegree(p.id);for(let u=o+1;u<f;u+=1){const o=d[u],c=t.getDegree(o.id);if(h&&(g<=1||c<=1))continue;const f=[o.data.x-p.data.x,o.data.y-p.data.y];let v=Math.hypot(f[0],f[1]);v=v<1e-4?1e-4:v,f[0]=f[0]/v,f[1]=f[1]/v,s&&e<n&&(v=v-a[p.id]-a[o.id]);let y=l*(g+1)*(c+1)/v;s&&e<n&&v<0?y=r*(g+1)*(c+1):s&&e<n&&0===v?y=0:s&&e<n&&v>0&&(y=l*(g+1)*(c+1)/v),i[p.id][0]-=y*f[0],i[o.id][0]+=y*f[0],i[p.id][1]-=y*f[1],i[o.id][1]+=y*f[1]}const v=[p.data.x-c[0],p.data.y-c[1]],y=Math.hypot(v[0],v[1]);v[0]=v[0]/y,v[1]=v[1]/y;const m=u*(g+1);i[p.id][0]-=m*v[0],i[p.id][1]-=m*v[1]}return i}updatePos(t,e,n,i,r){const{ks:a,tao:o,prune:s,ksmax:l}=r,u=t.getAllNodes(),c=u.length,h=[],d=[];let f=0,p=0,g=i;for(let i=0;i<c;i+=1){const{id:r}=u[i],a=t.getDegree(r);if(s&&a<=1)continue;const o=[e[r][0]-n[r][0],e[r][1]-n[r][1]],l=Math.hypot(o[0],o[1]),c=[e[r][0]+n[r][0],e[r][1]+n[r][1]],g=Math.hypot(c[0],c[1]);h[i]=l,d[i]=g/2,f+=(a+1)*h[i],p+=(a+1)*d[i]}const v=g;g=o*p/f,0!==v&&(g=g>1.5*v?1.5*v:g);for(let n=0;n<c;n+=1){const{id:i,data:r}=u[n],o=t.getDegree(i);if(s&&o<=1)continue;if(le(r.fx)&&le(r.fy))continue;let c=a*g/(1+g*Math.sqrt(h[n])),d=Math.hypot(e[i][0],e[i][1]);d=d<1e-4?1e-4:d;const f=l/d;c=c>f?f:c;const p=c*e[i][0],v=c*e[i][1];t.mergeNodeData(i,{x:r.x+p,y:r.y+v})}return g}},circular:class{constructor(t={}){this.options=t,this.id="circular",this.options=Object.assign(Object.assign({},Em),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericCircularLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericCircularLayout(!0,t,e)}))}genericCircularLayout(t,e,n){return ye(this,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},this.options),n),{width:r,height:a,center:o,divisions:s,startAngle:l=0,endAngle:u=2*Math.PI,angleRatio:c,ordering:h,clockwise:d,nodeSpacing:f,nodeSize:p}=i,g=e.getAllNodes(),v=e.getAllEdges(),[y,m,b]=((t,e,n)=>{let i=t,r=e,a=n;return i||"undefined"==typeof window||(i=window.innerWidth),r||"undefined"==typeof window||(r=window.innerHeight),a||(a=[i/2,r/2]),[i,r,a]})(r,a,o),x=null==g?void 0:g.length;if(!x||1===x)return xm(e,t,b);const E=(u-l)/x;let{radius:w,startRadius:k,endRadius:M}=i;if(f){const t=pm(10,f),e=gm(10,p);let n=-1/0;g.forEach((t=>{const i=e(t);n<i&&(n=i)}));let i=0;g.forEach(((e,r)=>{i+=0===r?n||10:(t(e)||0)+(n||10)})),w=i/(2*Math.PI)}else w||k||M?!k&&M?k=M:k&&!M&&(M=k):w=Math.min(m,y)/2;const S=E*c;let N=[];N="topology"===h?wm(e,g):"topology-directed"===h?wm(e,g,!0):"degree"===h?function(t,e){const n=[];return e.forEach(((t,e)=>{n.push(mm(t))})),n.sort(((e,n)=>t.getDegree(e.id,"both")-t.getDegree(n.id,"both"))),n}(e,g):g.map((t=>mm(t)));const T=Math.ceil(x/s);for(let t=0;t<x;++t){let e=w;e||null===k||null===M||(e=k+t*(M-k)/(x-1)),e||(e=10+100*t/(x-1));let n=l+t%T*S+2*Math.PI/s*Math.floor(t/T);d||(n=u-t%T*S-2*Math.PI/s*Math.floor(t/T)),N[t].data.x=b[0]+Math.cos(n)*e,N[t].data.y=b[1]+Math.sin(n)*e}return t&&N.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),{nodes:N,edges:v}}))}},concentric:Sm,dagre:ix,dendrogram:Fv.dendrogram,fishbone:kx,force:$m,fruchterman:class{constructor(t={}){this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},lx),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericFruchtermanLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericFruchtermanLayout(!0,t,e)}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let e=0;e<t;e++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach((t=>this.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===this.options.dimensions?t.data.z:void 0}))),e}genericFruchtermanLayout(t,e,n){return ye(this,void 0,void 0,(function*(){if(this.running)return;const i=this.formatOptions(n),{dimensions:r,width:a,height:o,center:s,clustering:l,nodeClusterBy:u,maxIteration:c,onTick:h}=i,d=e.getAllNodes(),f=e.getAllEdges();if(!(null==d?void 0:d.length)){const t={nodes:[],edges:f};return this.lastResult=t,t}if(1===d.length){t&&e.mergeNodeData(d[0].id,{x:s[0],y:s[1],z:3===r?s[2]:void 0});const n={nodes:[Object.assign(Object.assign({},d[0]),{data:Object.assign(Object.assign({},d[0].data),{x:s[0],y:s[1],z:3===r?s[2]:void 0})})],edges:f};return this.lastResult=n,n}const p=d.map((t=>mm(t,[a,o]))),g=new Mv({nodes:p,edges:f}),v={};if(l&&p.forEach((t=>{const e=t.data[u];v[e]||(v[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=p,this.lastLayoutEdges=f,this.lastAssign=t,this.lastGraph=g,this.lastOptions=i,this.lastClusterMap=v,"undefined"==typeof window)return;let y=0;return new Promise((n=>{this.timeInterval=window.setInterval((()=>{this.running?(this.runOneStep(g,v,i),t&&p.forEach((({id:t,data:n})=>e.mergeNodeData(t,{x:n.x,y:n.y,z:3===r?n.z:void 0}))),null==h||h({nodes:p,edges:f}),y++,y>=c&&(window.clearInterval(this.timeInterval),n({nodes:p,edges:f}))):n({nodes:p,edges:f})}),0),this.running=!0}))}))}formatOptions(t={}){const e=Object.assign(Object.assign({},this.options),t),{clustering:n,nodeClusterBy:i}=e,{center:r,width:a,height:o}=e;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=o||"undefined"==typeof window?o:window.innerHeight,e.center=r||[e.width/2,e.height/2],e.clustering=n&&!!i,e}runOneStep(t,e,n){const{dimensions:i,height:r,width:a,gravity:o,center:s,speed:l,clustering:u,nodeClusterBy:c,clusterGravity:h}=n,d=r*a,f=Math.sqrt(d)/10,p=t.getAllNodes(),g=d/(p.length+1),v=Math.sqrt(g),y={};if(this.applyCalculate(t,y,v,g),u){for(const t in e)e[t].cx=0,e[t].cy=0,e[t].count=0;p.forEach((t=>{const{data:n}=t,i=e[n[c]];le(n.x)&&(i.cx+=n.x),le(n.y)&&(i.cy+=n.y),i.count++}));for(const t in e)e[t].cx/=e[t].count,e[t].cy/=e[t].count;const t=h||o;p.forEach(((n,i)=>{const{id:r,data:a}=n;if(!le(a.x)||!le(a.y))return;const o=e[a[c]],s=Math.sqrt((a.x-o.cx)*(a.x-o.cx)+(a.y-o.cy)*(a.y-o.cy)),l=v*t;y[r].x-=l*(a.x-o.cx)/s,y[r].y-=l*(a.y-o.cy)/s}))}p.forEach(((t,e)=>{const{id:n,data:r}=t;if(!le(r.x)||!le(r.y))return;const a=.01*v*o;y[n].x-=a*(r.x-s[0]),y[n].y-=a*(r.y-s[1]),3===i&&(y[n].z-=a*(r.z-s[2]))})),p.forEach(((e,n)=>{const{id:r,data:a}=e;if(le(a.fx)&&le(a.fy))return a.x=a.fx,a.y=a.fy,void(3===i&&(a.z=a.fz));if(!le(a.x)||!le(a.y))return;const o=Math.sqrt(y[r].x*y[r].x+y[r].y*y[r].y+(3===i?y[r].z*y[r].z:0));if(o>0){const e=Math.min(f*(l/800),o);t.mergeNodeData(r,{x:a.x+y[r].x/o*e,y:a.y+y[r].y/o*e,z:3===i?a.z+y[r].z/o*e:void 0})}}))}applyCalculate(t,e,n,i){this.calRepulsive(t,e,i),this.calAttractive(t,e,n)}calRepulsive(t,e,n){const i=t.getAllNodes();i.forEach((({data:t,id:r},a)=>{e[r]={x:0,y:0,z:0},i.forEach((({data:i,id:o},s)=>{if(a<=s||!le(t.x)||!le(i.x)||!le(t.y)||!le(i.y))return;let l=t.x-i.x,u=t.y-i.y,c=3===this.options.dimensions?t.z-i.z:0,h=l*l+u*u+c*c;0===h&&(h=1,l=.01,u=.01,c=.01);const d=n/h,f=l*d,p=u*d,g=c*d;e[r].x+=f,e[r].y+=p,e[o].x-=f,e[o].y-=p,3===this.options.dimensions&&(e[r].z+=g,e[o].z-=g)}))}))}calAttractive(t,e,n){t.getAllEdges().forEach((i=>{const{source:r,target:a}=i;if(!r||!a||r===a)return;const{data:o}=t.getNode(r),{data:s}=t.getNode(a);if(!(le(s.x)&&le(o.x)&&le(s.y)&&le(o.y)))return;const l=s.x-o.x,u=s.y-o.y,c=3===this.options.dimensions?s.z-o.z:0,h=Math.sqrt(l*l+u*u+c*c)/n,d=l*h,f=u*h,p=c*h;e[r].x+=d,e[r].y+=f,e[a].x-=d,e[a].y-=f,3===this.options.dimensions&&(e[r].z+=p,e[a].z-=p)}))}},grid:class{constructor(t={}){this.options=t,this.id="grid",this.options=Object.assign(Object.assign({},ux),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericGridLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericGridLayout(!0,t,e)}))}genericGridLayout(t,e,n){return ye(this,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},this.options),n),{begin:r=[0,0],condense:a,preventOverlapPadding:o,preventOverlap:s,rows:l,cols:u,nodeSpacing:c,nodeSize:h,width:d,height:f,position:p}=i;let{sortBy:g}=i;const v=e.getAllNodes(),y=e.getAllEdges(),m=null==v?void 0:v.length;if(!m||1===m)return xm(e,t,r);const b=v.map((t=>mm(t)));"id"===g||he(g)&&void 0!==b[0].data[g]||(g="degree"),"degree"===g?b.sort(((t,n)=>e.getDegree(n.id,"both")-e.getDegree(t.id,"both"))):"id"===g?b.sort(((t,e)=>le(e.id)&&le(t.id)?e.id-t.id:`${t.id}`.localeCompare(`${e.id}`))):b.sort(((t,e)=>e.data[g]-t.data[g]));const x=d||"undefined"==typeof window?d:window.innerWidth,E=f||"undefined"==typeof window?f:window.innerHeight,w=m,k={rows:l,cols:u};if(null!=l&&null!=u)k.rows=l,k.cols=u;else if(null!=l&&null==u)k.rows=l,k.cols=Math.ceil(w/k.rows);else if(null==l&&null!=u)k.cols=u,k.rows=Math.ceil(w/k.cols);else{const t=Math.sqrt(w*E/x);k.rows=Math.round(t),k.cols=Math.round(x/E*t)}if(k.rows=Math.max(k.rows,1),k.cols=Math.max(k.cols,1),k.cols*k.rows>w){const t=cx(k),e=hx(k);(t-1)*e>=w?cx(k,t-1):(e-1)*t>=w&&hx(k,e-1)}else for(;k.cols*k.rows<w;){const t=cx(k),e=hx(k);(e+1)*t>=w?hx(k,e+1):cx(k,t+1)}let M=a?0:x/k.cols,S=a?0:E/k.rows;if(s||c){const t=pm(10,c),n=gm(30,h,!1);b.forEach((i=>{i.data.x&&i.data.y||(i.data.x=0,i.data.y=0);const r=e.getNode(i.id),[a,s]=fm(n(r)||30),l=void 0!==t?t(i):o,u=a+l,c=s+l;M=Math.max(M,u),S=Math.max(S,c)}))}const N={},T={row:0,col:0},A={};for(let t=0;t<b.length;t++){const n=b[t];let i;if(p&&(i=p(e.getNode(n.id))),i&&(void 0!==i.row||void 0!==i.col)){const t={row:i.row,col:i.col};if(void 0===t.col)for(t.col=0;dx(N,t);)t.col++;else if(void 0===t.row)for(t.row=0;dx(N,t);)t.row++;A[n.id]=t,fx(N,t)}gx(n,r,M,S,A,k,T,N)}const O={nodes:b,edges:y};return t&&b.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),O}))}},indented:Fv.indented,mds:sb,mindmap:Fv.mindmap,radial:class{constructor(t={}){this.options=t,this.id="radial",this.options=Object.assign(Object.assign({},bx),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericRadialLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericRadialLayout(!0,t,e)}))}genericRadialLayout(t,e,n){return ye(this,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},this.options),n),{width:r,height:a,center:o,focusNode:s,unitRadius:l,nodeSize:u,nodeSpacing:c,strictRadial:h,preventOverlap:d,maxPreventOverlapIteration:f,sortBy:p,linkDistance:g=50,sortStrength:v=10,maxIteration:y=1e3}=i,m=e.getAllNodes(),b=e.getAllEdges(),x=r||"undefined"==typeof window?r:window.innerWidth,E=a||"undefined"==typeof window?a:window.innerHeight,w=o||[x/2,E/2];if(!(null==m?void 0:m.length)||1===m.length)return xm(e,t,w);let k=m[0];if(he(s)){for(let t=0;t<m.length;t++)if(m[t].id===s){k=m[t];break}}else k=s||m[0];const M=((t,e)=>{let n=-1;return t.forEach(((t,i)=>{t.id===e&&(n=i)})),Math.max(n,0)})(m,k.id),S=ib({nodes:m,edges:b},!1),N=nb(S),T=((t,e)=>{let n=0;for(let i=0;i<t[e].length;i++)t[e][i]!==1/0&&(n=t[e][i]>n?t[e][i]:n);return n})(N,M);((t,e,n)=>{const i=t.length;for(let r=0;r<i;r++)if(t[e][r]===1/0){t[e][r]=n,t[r][e]=n;for(let a=0;a<i;a++)t[r][a]!==1/0&&t[e][a]===1/0&&(t[e][a]=n+t[r][a],t[a][e]=n+t[r][a])}for(let n=0;n<i;n++)if(n!==e)for(let r=0;r<i;r++)if(t[n][r]===1/0){let i=Math.abs(t[e][n]-t[e][r]);i=0===i?1:i,t[n][r]=i}})(N,M,T+1);const A=N[M];let O=x-w[0]>w[0]?w[0]:x-w[0],P=E-w[1]>w[1]?w[1]:E-w[1];0===O&&(O=x/2),0===P&&(P=E/2);const C=Math.min(O,P),R=Math.max(...A),L=[],D=l||C/R;A.forEach(((t,e)=>{L[e]=t*D}));const I=((t,e,n,i,r,a,o)=>{if(!t)return[];const s=[];if(e){const l={};e.forEach(((e,u)=>{const c=[];e.forEach(((e,s)=>{var h,d;if(u===s)c.push(0);else if(i[u]===i[s])if("data"===a)c.push(e*(Math.abs(u-s)*o)/(i[u]/r));else if(a){let n,f;if(l[t[u].id])n=l[t[u].id];else{const e=("id"===a?t[u].id:null===(h=t[u].data)||void 0===h?void 0:h[a])||0;n=he(e)?e.charCodeAt(0):e,l[t[u].id]=n}if(l[t[s].id])f=l[t[s].id];else{const e=("id"===a?t[s].id:null===(d=t[s].data)||void 0===d?void 0:d[a])||0;f=he(e)?e.charCodeAt(0):e,l[t[s].id]=f}c.push(e*(Math.abs(n-f)*o)/(i[u]/r))}else c.push(e*n/(i[u]/r));else{const t=(n+r)/2;c.push(e*t)}})),s.push(c)}))}return s})(m,N,g,L,D,p,v),_=(t=>{const e=t.length,n=t[0].length,i=[];for(let r=0;r<e;r++){const e=[];for(let i=0;i<n;i++)0!==t[r][i]?e.push(1/(t[r][i]*t[r][i])):e.push(0);i.push(e)}return i})(I),B=((t,e,n)=>{try{const n=tb.mul(tb.pow(e,2),-.5),i=n.mean("row"),r=n.mean("column"),a=n.mean();n.add(a).subRowVector(i).subColumnVector(r);const o=new eb(n),s=tb.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map((e=>tb.mul([e],[s]).toJSON()[0].splice(0,t)))}catch(t){const i=[];for(let t=0;t<e.length;t++){const t=Math.random()*n,e=Math.random()*n;i.push([t,e])}return i}})(g,I,g);let F,j=B.map((([t,e])=>({x:(isNaN(t)?Math.random()*g:t)-B[M][0],y:(isNaN(e)?Math.random()*g:e)-B[M][1]})));if(this.run(y,j,_,I,L,M),d){F=vm(u,c);const t={nodes:m,nodeSizeFunc:F,positions:j,radii:L,height:E,width:x,strictRadial:Boolean(h),focusIdx:M,iterations:f||200,k:j.length/4.5};j=((t,e)=>{const n=Object.assign(Object.assign({},vx),e),{positions:i,iterations:r,width:a,k:o,speed:s=100,strictRadial:l,focusIdx:u,radii:c=[],nodeSizeFunc:h}=n,d=t.getAllNodes(),f=[],p=a/10;for(let t=0;t<r;t++)i.forEach(((t,e)=>{f[e]={x:0,y:0}})),yx(d,i,f,o,c,h),mx(i,f,s,l,u,p,a,c);return i})(e,t)}const G=[];return j.forEach(((t,e)=>{const n=mm(m[e]);n.data.x=t.x+w[0],n.data.y=t.y+w[1],G.push(n)})),t&&G.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y}))),{nodes:G,edges:b}}))}run(t,e,n,i,r,a){for(let o=0;o<=t;o++){const s=o/t;this.oneIteration(s,e,r,i,n,a)}}oneIteration(t,e,n,i,r,a){const o=1-t;e.forEach(((s,l)=>{const u=rb(s,{x:0,y:0}),c=0===u?0:1/u;if(l===a)return;let h=0,d=0,f=0;e.forEach(((t,e)=>{if(l===e)return;const n=rb(s,t),a=0===n?0:1/n,o=i[e][l];f+=r[l][e],h+=r[l][e]*(t.x+o*(s.x-t.x)*a),d+=r[l][e]*(t.y+o*(s.y-t.y)*a)}));const p=0===n[l]?0:1/n[l];f*=o,f+=t*p*p,h*=o,h+=t*p*s.x*c,s.x=h/f,d*=o,d+=t*p*s.y*c,s.y=d/f}))}},random:class{constructor(t={}){this.options=t,this.id="random",this.options=Object.assign(Object.assign({},xx),t)}execute(t,e){return ye(this,void 0,void 0,(function*(){return this.genericRandomLayout(!1,t,e)}))}assign(t,e){return ye(this,void 0,void 0,(function*(){yield this.genericRandomLayout(!0,t,e)}))}genericRandomLayout(t,e,n){return ye(this,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},this.options),n),{center:r,width:a,height:o}=i,s=e.getAllNodes(),l=a||"undefined"==typeof window?a:window.innerWidth,u=o||"undefined"==typeof window?o:window.innerHeight,c=r||[l/2,u/2],h=[];return s&&s.forEach((t=>{h.push({id:t.id,data:{x:.9*(Math.random()-.5)*l+c[0],y:.9*(Math.random()-.5)*u+c[1]}})})),t&&h.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y}))),{nodes:h,edges:e.getAllEdges()}}))}},snake:Tx},node:{circle:mf,diamond:xf,ellipse:Mf,hexagon:Sf,html:Vp,image:Up,rect:Hp,star:Yp,donut:Ef,triangle:$p},palette:{spectral:["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],tableau:["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],oranges:["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],greens:["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],blues:["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"]},theme:{dark:ZN,light:QN},plugin:{"bubble-sets":pE,"edge-bundling":bE,"edge-filter-lens":AE,"grid-line":RE,background:Dx,contextmenu:mE,fisheye:PE,fullscreen:CE,history:BE,hull:fw,legend:Dk,minimap:Ik,snapline:Gk,timebar:ON,toolbar:DN,tooltip:VN,watermark:YN},transform:{"arrange-draw-order":class extends JN{beforeDraw(t){const{model:e}=this.context,n=t.add.combos,i=t=>{const n=[];return t.forEach(((t,i)=>{const r=e.getAncestorsData(i,"combo").map((t=>wh(t))).reverse();n.push([i,t,r.length])})),new Map(n.sort((([,,t],[,,e])=>e-t)).map((([t,e])=>[t,e])))};return t.add.combos=i(n),t.update.combos=i(t.update.combos),t}},"collapse-expand-combo":class extends JN{beforeDraw(t,e){if("visibility"===e.stage)return t;if(!this.context.model.model.hasTreeStructure(uc))return t;const{model:n}=this.context,{add:i,update:r}=t,a=[...t.update.combos.entries(),...t.add.combos.entries()];for(;a.length;){const[e,o]=a.pop();if(Id(o)){const o=n.getDescendantsData(e),s=o.map(wh),{internal:l,external:u}=yg(s,(t=>n.getRelatedEdgesData(t)));o.forEach((e=>{const i=wh(e),r=a.findIndex((([t])=>t===i));-1!==r&&a.splice(r,1);const o=n.getElementType(i);tT(t,"remove",o,e)})),l.forEach((e=>tT(t,"remove","edge",e))),u.forEach((t=>{var e;const n=wh(t);(null===(e=this.context.element)||void 0===e?void 0:e.getElement(n))?r.edges.set(n,t):i.edges.set(n,t)}))}else{const i=n.getChildrenData(e),r=i.map(wh),{edges:o}=yg(r,(t=>n.getRelatedEdgesData(t)));[...i,...o].forEach((e=>{var i;const r=wh(e),o=n.getElementType(r),s=null===(i=this.context.element)||void 0===i?void 0:i.getElement(r);tT(t,s?"update":"add",o,e),"combo"===o&&a.push([r,e])}))}}return t}},"collapse-expand-node":class extends JN{getElement(t){return this.context.element.getElement(t)}handleExpand(t,e){if(nT(e,"add","node",t),Id(t))return;const n=wh(t);nT(e,"add","node",t),this.context.model.getRelatedEdgesData(n).forEach((t=>{tT(e,"add","edge",t)})),this.context.model.getChildrenData(n).forEach((t=>{this.handleExpand(t,e)}))}beforeDraw(t){const{graph:e,model:n}=this.context;if(!n.model.hasTreeStructure(cc))return t;const{add:{nodes:i,edges:r},update:{nodes:a}}=t,o=new Map,s=new Map;i.forEach(((t,e)=>{Id(t)&&o.set(e,t)})),r.forEach((t=>{if("node"!==e.getElementType(t.source))return;const n=e.getNodeData(t.source);Id(n)&&o.set(t.source,n)})),a.forEach(((t,e)=>{const n=this.getElement(e);if(!n)return;const i=n.attributes.collapsed;Id(t)?i||o.set(e,t):i&&s.set(e,t)}));const l=new Set;return o.forEach(((e,i)=>{n.getDescendantsData(i).forEach((e=>{const i=wh(e);l.has(i)||(tT(t,"remove","node",e),n.getRelatedEdgesData(i).forEach((e=>{tT(t,"remove","edge",e)})),l.add(i))}))})),s.forEach(((e,i)=>{n.getAncestorsData(i,cc).some(Id)?tT(t,"remove","node",e):this.handleExpand(e,t)})),t}},"get-edge-actual-ends":class extends JN{beforeDraw(t){const{add:e,update:n}=t,{model:i}=this.context;return[...e.edges.entries(),...n.edges.entries()].forEach((([,t])=>{gA(i,t)})),t}},"map-node-size":vA,"place-radial-labels":yA,"process-parallel-edges":bA,"update-related-edges":class extends JN{beforeDraw(t,e){const{stage:n}=e;if("visibility"===n)return t;const{model:i}=this.context,{update:{nodes:r,edges:a,combos:o}}=t,s=(t,e)=>{i.getRelatedEdgesData(e).forEach((t=>!a.has(wh(t))&&a.set(wh(t),t)))};return r.forEach(s),o.forEach(s),t}}},shape:{circle:ml,ellipse:El,group:wl,html:Ml,image:uf,line:Tl,path:Ol,polygon:Cl,polyline:Ll,rect:Dl,text:_l,label:rf,badge:af}};Object.entries(kA).forEach((([t,e])=>{Object.entries(e).forEach((([e,n])=>{iT(t,e,n)}))}));const MA=t=>{const e=(t,n="id")=>t?t.reduce(((t,i)=>(i.style&&Array.isArray(i.style.ports)&&(i.style.ports=e(i.style.ports,"key")),t[i[n]]=i,t)),{}):{},n=structuredClone(t);return Array.isArray(n.nodes)&&(n.nodes=e(n.nodes,"id")),Array.isArray(n.edges)&&(n.edges=e(n.edges,"id")),Array.isArray(n.combos)&&(n.combos=e(n.combos,"id")),n};let SA=new Map;const NA={labelFontWeight:700,labelBackgroundFill:"#dbeafe",labelBackgroundStroke:"#0D99FF"},TA=(t,e,n)=>{try{if(n){const n=t.getNodeData(e),i={labelFontWeight:n?.style?.labelFontWeight,labelBackgroundFill:n?.style?.labelBackgroundFill,labelBackgroundStroke:n?.style?.labelBackgroundStroke};SA.set(e,i),t.updateNodeData([{id:e,style:NA}])}else{const n=SA.get(e)||{};t.updateNodeData([{id:e,style:n}]),SA.delete(e)}t.draw()}catch(t){console.error("[selection] Failed to update node style:",t)}},AA=(t,e="prod")=>{try{return t()}catch(t){let n="";if(t&&t.stack){const e=t.stack.split("\n").find((t=>/Graph\.\w+/.test(t)));if(e){const t=e.match(/Graph\.\w+/);t&&(n=t[0])}}const i=n?`[${n}] ${t.message||t}`:`${t.message||t}`;throw"dev"===e&&OA(i,"error"),t}},OA=(t,e="error",n=null)=>{HTMLWidgets.shinyMode?Shiny.notifications.show({html:t,type:e,duration:n}):alert(t)},PA=(t,e)=>{const n={edge:["node","combo"],node:["edge","combo"],combo:["node","edge"]}[e];n&&n.forEach((e=>{Shiny.setInputValue(`${t}-selected_${e}`,null)}))},CA=(t,e)=>{const n=t.getEdgeData(),i={};return n.forEach((t=>{t.style&&t.style.sourcePort&&t.source===e&&(i[t.style.sourcePort]=(i[t.style.sourcePort]||0)+1),t.style&&t.style.targetPort&&t.target===e&&(i[t.style.targetPort]=(i[t.style.targetPort]||0)+1)})),i},RA=(t,e,n)=>{const i=t.options.container;HTMLWidgets.shinyMode&&(((t,e)=>{const n=e.options.container;for(let i of t)e.on(i,(t=>{const{target:i}=t,r=e.getElementType(i.id),a=`${n}-selected_${r}`,o=(s=e.getBehaviors(),l="click-select",s.filter((t=>"string"==typeof t?t===l:t.type===l)));var s,l;if(!o.length)return;const u=o[0].multiple;if(t.shiftKey||PA(n,i.type),"node"===r){t.shiftKey||SA.forEach(((t,n)=>{n!==i.id&&TA(e,n,!1)}));const n=SA.has(i.id);TA(e,i.id,!n)}if(u&&t.shiftKey)if(void 0===Shiny.shinyapp.$inputValues[a]||null===Shiny.shinyapp.$inputValues[a])Shiny.setInputValue(a,[i.id]);else if(0===e.getElementState(i.id).length||void 0===e.getElementState(i.id)[0])Shiny.shinyapp.$inputValues[a].push(i.id),Shiny.setInputValue(a,Shiny.shinyapp.$inputValues[a]);else{const t=Shiny.shinyapp.$inputValues[a].filter((function(t){return t!==i.id}));Shiny.setInputValue(a,t)}else 0===e.getElementState(i.id).length?Shiny.setInputValue(a,[i.id]):Shiny.setInputValue(a,null)}))})([lc.CLICK,ac.CLICK,nc.CLICK],t),((t,e)=>{const n=e.options.container;for(let i of t)e.on(i,(t=>{i===oc.AFTER_RENDER&&(Shiny.setInputValue(n+"-initialized",!0),Shiny.setInputValue(n+"-state",MA(e.getData()))),Shiny.shinyapp.$inputValues[n+"-initialized"]&&Shiny.setInputValue(n+"-state",MA(e.getData()))}))})([oc.AFTER_ELEMENT_CREATE,oc.AFTER_ELEMENT_DESTROY,oc.AFTER_DRAW,oc.AFTER_LAYOUT,oc.AFTER_ANIMATE,oc.AFTER_RENDER,nc.DROP,ec.DROP],t),t.on(ec.CLICK,(t=>{Shiny.setInputValue(i+"-selected_node",null),Shiny.setInputValue(i+"-selected_edge",null),Shiny.setInputValue(i+"-selected_combo",null)})),t.on(ic.CONTEXT_MENU,(t=>{const{targetType:e,target:n}=t;Shiny.setInputValue(i+"-contextmenu",{type:e,id:n.id})})),(t=>{const e=t.options.container,n=[ic.CONTEXT_MENU,ic.POINTER_UP],i=t=>{"contextmenu"===t.type&&t.preventDefault(),Shiny.setInputValue(e+"-mouse_position",{x:t.canvas.x,y:t.canvas.y})};n.forEach((e=>t.on(e,i)))})(t),!n.animation&&n.preservePosition&&(t=>{let e={};const n=(t,e)=>{const n=t.getData();n.nodes&&e(n.nodes,(t=>t.id)),n.combos&&e(n.combos,(t=>t.id))},i=(n,i)=>{n.forEach((n=>{try{t.getElementRenderStyle(i(n));const r=t.getElementPosition(i(n));0===r[0]&&0===r[1]||(e[i(n)]=[r[0],r[1]])}catch(t){}}))},r=(n,i)=>{n.forEach((n=>{const r=e[i(n)];r&&t.translateElementTo(i(n),r,!1)}))};t.on(oc.BEFORE_LAYOUT,(()=>{n(t,i)})),t.on(oc.AFTER_LAYOUT,(()=>{n(t,r)}))})(t),((t,e)=>{const n=t.options.container;Shiny.addCustomMessageHandler(n+"_g6-data",(i=>{AA((()=>{if("Data"===i.type)return t[`${i.action}Data`](i.data),void t.render();if("set"==i.action){t.setElementState(i.el);const e=Object.getOwnPropertyNames(i.el).map((t=>{if("selected"===i.el[t])return t}));if(e.length>0){const t=`${n}-selected_${i.type.toLowerCase()}`;Shiny.setInputValue(t,e)}}else{"get"===i.action||"remove"===i.action?Array.isArray(i.el)?i.el=i.el.map((t=>t.toString())):i.el=i.el.toString():i.el=i.el.map((t=>(t.id=t.id.toString(),null!=t.source&&"string"!=typeof t.source&&(t.source=t.source.toString()),null!=t.target&&"string"!=typeof t.target&&(t.target=t.target.toString()),null!=t.combo&&"string"!=typeof t.combo&&(t.combo=t.combo.toString()),t))),"Edge"===i.type&&("remove"===i.action?i.el.forEach((e=>{const n=t.getEdgeData(e);if(n){const{source:e,target:i}=n,r=t.getNodeData(e);if(r&&r.children&&r.children.includes(i)){const n=r.children.filter((t=>t!==i));t.updateNodeData([{id:e,children:n}]),t.context.model.setParent(i,void 0,"tree")}}})):"add"===i.action?i.el.forEach((e=>{const{source:n,target:i}=e,r=t.getNodeData(n);r&&(r.children||(r.children=[]),r.children.includes(i)||(r.children.push(i),t.updateNodeData([{id:n,children:r.children}])),t.context.model.setParent(i,n,"tree"))})):"update"===i.action&&i.el.forEach((e=>{const n=e.id,i=t.getEdgeData(n);if(i){const n=i.source,r=i.target,a=e.source||n,o=e.target||r;if(a!==n||o!==r){const e=t.getNodeData(n);e&&e.children&&e.children.includes(r)&&t.context.model.setParent(r,void 0,"tree");const i=t.getNodeData(a);i&&i.children&&i.children.includes(o)&&t.context.model.setParent(o,a,"tree")}}}))),"Node"===i.type&&"remove"===i.action&&i.el.forEach((e=>{const n=t.getParentData(e,"tree");if(n){const i=n.id,r=t.getNodeData(i);if(r&&r.children&&r.children.includes(e)){const n=r.children.filter((t=>t!==e));t.updateNodeData([{id:i,children:n}])}}}));let e=t[`${i.action}${i.type}Data`](i.el);if("get"===i.action){if(void 0===e)return;return Array.isArray(e)||(e=[e]),void e.map((t=>{Shiny.setInputValue(`${n}-${t.id}-state`,t)}))}t.draw(),i.layout&&t.layout()}}),e)})),Shiny.addCustomMessageHandler(n+"_g6-update-ports",(e=>{((t,e,n)=>{const i=t.getNodeData(),r=t.getEdgeData(),a=[];let o=new Set;if(e.forEach((t=>{const e=i.find((e=>e.id===t));if(!e)return;let r=e.style?{...e.style}:{},s=Array.isArray(r.ports)?[...r.ports]:[];const l=n[t]||{};if(l.remove){const e=l.remove.map((e=>e.startsWith(t+"-")?e:`${t}-${e}`));s=s.filter((t=>!e.includes(t.key))),e.forEach((t=>o.add(t)))}if(l.add){const e=l.add.map((e=>({...e,key:e.key.startsWith(t+"-")?e.key:`${t}-${e.key}`})));s=s.concat(e)}l.update&&l.update.forEach((e=>{const n=e.key.startsWith(t+"-")?e.key:`${t}-${e.key}`,i=s.findIndex((t=>t.key===n));-1!==i&&(s[i]={...s[i],...e,key:n})})),r.ports=s,a.push({id:t,style:r})})),a.length>0&&(t.updateNodeData(a),t.draw()),o.size>0){const e=r.filter((t=>{const e=t.style?.sourcePort,n=t.style?.targetPort;return e&&o.has(e)||n&&o.has(n)})).map((t=>t.id));e.length>0&&(t.removeEdgeData(e),t.draw())}})(t,e.ids,e.ops)})),Shiny.addCustomMessageHandler(n+"_g6-update-layout",(e=>{AA((()=>{t.setLayout((t=>"nodeOrder"in t?t:{...t,...e})),t.layout()}))})),Shiny.addCustomMessageHandler(n+"_g6-canvas-resize",(n=>{AA((()=>t.setSize(n.width,n.height)),e)})),Shiny.addCustomMessageHandler(n+"_g6-fit-center",(n=>{AA((()=>t.fitCenter(n)),e)})),Shiny.addCustomMessageHandler(n+"_g6-element-action",(n=>{AA((()=>t[`${n.action}Element`](n.ids,n.animation)),e)})),Shiny.addCustomMessageHandler(n+"_g6-combo-action",(n=>{AA((()=>{null===n.options?t[`${n.action}Element`](n.id):t[`${n.action}Element`](n.id,n.options)}),e)})),Shiny.addCustomMessageHandler(n+"_g6-set-options",(n=>{AA((()=>{t.setOptions(n),t.draw()}),e)})),Shiny.addCustomMessageHandler(n+"_g6-set-theme",(n=>{AA((()=>{t.setOptions(n.theme),t.draw()}),e)})),Shiny.addCustomMessageHandler(n+"_g6-update-plugin",(n=>{AA((()=>{for(var e=0;n.evals&&e<n.evals.length;e++)window.HTMLWidgets.evaluateStringMember(n.opts,n.evals[e]);t.updatePlugin(n.opts),t.render()}),e)})),Shiny.addCustomMessageHandler(n+"_g6-add-plugin",(n=>{AA((()=>{t.setPlugins((t=>{let e;return e=t.length?t.concat(n):n,e})),t.render()}),e)})),Shiny.addCustomMessageHandler(n+"_g6-update-behavior",(n=>{AA((()=>{for(var e=0;n.evals&&e<n.evals.length;e++)window.HTMLWidgets.evaluateStringMember(n.opts,n.evals[e]);t.updateBehavior(n.opts)}),e)}))})(t,n.mode)),t.render(),window.addEventListener("resize",(()=>{e.resize()}))};let LA=null;const DA=()=>LA,IA=new Map,_A=t=>{const e=t.getComboData();for(const n of e){if("hidden"===n.style?.visibility)continue;const e=t.context.element?.getElement(n.id);if(e){const i=t.context.element.getElementComputedStyle("combo",n);e.update(i)}}},BA=async t=>{const e=t.getComboData();if(!e||0===e.length)return;const n=t.getNodeData(),i={};for(const t of n){const e=t.combo;e&&(i[e]||(i[e]=[]),i[e].push(t))}const r=[],a=[];for(const t of e){const e=i[t.id];if(!e||0===e.length)continue;const n=e.every((t=>"hidden"===t.style?.visibility)),o="hidden"===t.style?.visibility;n&&!o?tO.has(t.id)||r.push(t.id):!n&&o&&a.push(t.id)}r.length>0&&await t.hideElement(r,!1),a.length>0&&await t.showElement(a,!1)},FA=t=>{const e=t.context?.plugin?.extensionMap;if(e)for(const n of Object.values(e)){if("function"!=typeof n.getMember||"function"!=typeof n.updateMember)continue;n._g6rOriginalMembers||(n._g6rOriginalMembers=[...n.getMember()]);const e=n._g6rOriginalMembers.filter((e=>{try{if("edge"===t.getElementType(e)){const n=t.getEdgeData(e);return"hidden"!==n?.style?.visibility}{const n=t.getNodeData(e);return"hidden"!==n?.style?.visibility}}catch(t){return!1}}));n.updateMember(e)}},jA=new Set,GA=(t,e,n)=>{const i=`_hasListener_${e}`;t[i]||(t.addEventListener(e,n),t[i]=!0)};let zA=null;const VA=(t,e)=>{VA.timeout&&(clearTimeout(VA.timeout),VA.timeout=null);let n=document.getElementById("g6-port-tooltip");n||(n=document.createElement("div"),n.id="g6-port-tooltip",n.style.position="fixed",n.style.pointerEvents="none",n.style.background=e.stroke,n.style.color=(t=>{let e=t.replace("#","");return 3===e.length&&(e=e.split("").map((t=>t+t)).join("")),(.299*parseInt(e.substr(0,2),16)+.587*parseInt(e.substr(2,2),16)+.114*parseInt(e.substr(4,2),16))/255>.5?"#000":"#fff"})(e.stroke),n.style.borderRadius="6px",n.style.padding="4px 10px",n.style.fontSize="12px",n.style.zIndex="9999",document.body.appendChild(n)),n.textContent=e.label||"",n.style.left=t.clientX+12+"px",n.style.top=t.clientY-12+"px",n.style.display="block",VA.timeout=setTimeout(WA,2e3)},WA=()=>{const t=document.getElementById("g6-port-tooltip");t&&(t.style.display="none")},UA=t=>class extends t{childrenData(){return this.context.model.getChildrenData(this.id)||[]}getNodeDepth(){const t=this.context.graph.getEdgeData(),e={};t.forEach((t=>{e[t.target]||(e[t.target]=[]),e[t.target].push(t.source)}));let n=0,i=new Set([this.id]);const r=new Set([this.id]);for(;i.size>0;){let t=!1;for(const n of i)if(!e[n]||0===e[n].length){t=!0;break}if(t)return n;n++;const a=new Set;for(const t of i)for(const n of e[t]||[])r.has(n)||(r.add(n),a.add(n));i=a}return 0}drawCollapseButton(t){const e=t.children||[],n=this.context.graph.getNodeData(this.id),i=n?.children||[],r=this.childrenData();if(!(e.length>0||i.length>0||r.length>0)){const t=this.shapeMap["collapse-button"],e=this.shapeMap["collapse-hit-area"];return t&&(t.remove(),delete this.shapeMap["collapse-button"]),void(e&&(e.remove(),delete this.shapeMap["collapse-hit-area"]))}const a=this.context.graph.options.maxCollapseDepth??1/0;if(a!==1/0&&this.getNodeDepth()>a){const t=this.shapeMap["collapse-button"],e=this.shapeMap["collapse-hit-area"];return t&&(t.remove(),delete this.shapeMap["collapse-button"]),void(e&&(e.remove(),delete this.shapeMap["collapse-hit-area"]))}if(!t.collapse){const t=this.shapeMap["collapse-button"],e=this.shapeMap["collapse-hit-area"];return t&&(t.remove(),delete this.shapeMap["collapse-button"]),void(e&&(e.remove(),delete this.shapeMap["collapse-hit-area"]))}const o=t.collapse,s=jA.has(this.id)||o.collapsed||t.collapsed||!1,[l,u]=this.getSize(t),c=o.placement||"right-top";let h,d;if(Array.isArray(c))h=(c[0]-.5)*l,d=(c[1]-.5)*u;else switch(c){case"top":h=0,d=-u/2;break;case"right":h=l/2,d=0;break;case"bottom":h=0,d=u/2;break;case"left":h=-l/2,d=0;break;case"right-top":default:h=l/2,d=-u/2;break;case"right-bottom":h=l/2,d=u/2;break;case"left-top":h=-l/2,d=-u/2;break;case"left-bottom":h=-l/2,d=u/2}const f=o.r||8,p=s?[["M",h-f+4,d],["L",h+f-4,d],["M",h,d-f+4],["L",h,d+f-4]]:[["M",h-f+4,d],["L",h+f-4,d]],g=o.visibility||"visible";this._collapseVisibility=g;const v=s||"visible"===g||"hover"===g&&this._isHoveringNode?.();this._isCollapsed=s;let y=null;if(s){const{descendants:t}=this.collectDAGDescendants(this.id);y=`+ ${t.length}`}const m=.4*f,b=1.1*f,x=y?y.length*b*.55:0,E=y?x+2*m:0;if(s){const t=this.shapeMap["collapse-hit-area"];t&&(t.remove(),delete this.shapeMap["collapse-hit-area"]),"string"==typeof c&&c.startsWith("left");const e=h-E/2;this.upsert("collapse-hit-area","rect",{x:e,y:d-f,width:E,height:2*f,radius:f,fill:o.fill||"#fff",stroke:o.stroke||"#CED4D9",lineWidth:o.lineWidth||1,cursor:o.cursor||"pointer",zIndex:o.zIndex||999,visibility:"visible",opacity:1},this);const n=this.shapeMap["collapse-button"];n&&(n.remove(),delete this.shapeMap["collapse-button"]),this.upsert("collapse-button","text",{x:h,y:d,text:y,fontSize:b,fontWeight:"bold",fill:o.iconStroke||"#000",textAlign:"center",textBaseline:"middle",cursor:o.cursor||"pointer",zIndex:(o.zIndex||999)+1,visibility:"visible",opacity:1},this.shapeMap["collapse-hit-area"])}else{const t=this.shapeMap["collapse-hit-area"];t&&(t.remove(),delete this.shapeMap["collapse-hit-area"]),this.upsert("collapse-hit-area","circle",{cx:h,cy:d,r:f,fill:o.fill||"#fff",stroke:o.stroke||"#CED4D9",lineWidth:o.lineWidth||1,cursor:o.cursor||"pointer",zIndex:o.zIndex||999,visibility:v?"visible":"hidden",opacity:v?1:0},this);const e=this.shapeMap["collapse-button"];e&&(e.remove(),delete this.shapeMap["collapse-button"]),this.upsert("collapse-button","path",{d:p,stroke:o.iconStroke||"#000",lineWidth:o.iconLineWidth||1.4,cursor:o.cursor||"pointer",zIndex:(o.zIndex||999)+1,visibility:v?"visible":"hidden",opacity:v?1:0},this.shapeMap["collapse-hit-area"])}const w=this.shapeMap["collapse-count"];if(w&&(w.remove(),delete this.shapeMap["collapse-count"]),this.bindCollapseListener(),"hover"===g){this.addNodeHoverHandlers(this._renderContainer||this);const t=this.shapeMap["collapse-hit-area"];GA(t,"mouseenter",(()=>{this._showPorts&&this._showPorts()})),GA(t,"mouseleave",(()=>{this._hidePorts&&this._hidePorts()}))}}collectDAGDescendants(t){const{graph:e}=this.context,n=e.getEdgeData(),i=[],r=new Set,a=t=>{n.forEach((e=>{e.source!==t||r.has(e.target)||e.id?.startsWith(eO)||(r.add(e.target),i.push(e.target),a(e.target))}))};return a(t),{descendants:i,allEdges:n}}refreshCollapseStates(){const{graph:t}=this.context,e=t.getNodeData(),n=t.getEdgeData(),i={};n.forEach((t=>{t.id?.startsWith(eO)||(i[t.source]||(i[t.source]=[]),i[t.source].push(t.target))})),e.forEach((e=>{const n=i[e.id]||[];if(0===n.length)return;if(!e.style?.collapse)return;if("hidden"===e.style?.visibility)return;const r=n.every((e=>{const n=t.getNodeData(e);return!("hidden"!==n?.style?.visibility||n?.combo&&tO.has(n.combo))})),a=n.some((e=>{const n=t.getNodeData(e);return"hidden"!==n?.style?.visibility}));r&&!jA.has(e.id)?jA.add(e.id):a&&jA.has(e.id)&&jA.delete(e.id);try{const n=t.context.element?.getElement(e.id);n?.drawCollapseButton&&n?.parsedAttributes&&n.drawCollapseButton(n.parsedAttributes)}catch(t){}}))}bindCollapseListener(){const t=this.shapeMap["collapse-hit-area"];if(t&&!t._collapseListenerBound){t._collapseListenerBound=!0;const{graph:e}=this.context;t.addEventListener("click",(async t=>{if(t.stopPropagation(),!e._g6rCollapseInProgress){e._g6rCollapseInProgress=!0;try{const t=jA.has(this.id),{descendants:n,allEdges:i}=this.collectDAGDescendants(this.id);if(0===n.length)return;const r=new Set(n);if(t){jA.delete(this.id),n.forEach((t=>jA.delete(t)));const t=[],a=e.getNodeData(this.id)?.style?.collapse;a&&t.push({id:this.id,style:{collapse:{...a,collapsed:!1}}}),n.forEach((n=>{const i=e.getNodeData(n)?.style?.collapse;i&&t.push({id:n,style:{collapse:{...i,collapsed:!1}}})})),t.length>0&&e.updateNodeData(t);const o=[...n];if(i.forEach((t=>{if(t.id&&!t.id.startsWith(eO)&&(r.has(t.source)||r.has(t.target))){const n=r.has(t.source)||t.source===this.id||"hidden"!==e.getNodeData(t.source)?.style?.visibility,i=r.has(t.target)||t.target===this.id||"hidden"!==e.getNodeData(t.target)?.style?.visibility;n&&i&&o.push(t.id)}})),o.length>0){await e.showElement(o,!1);for(const t of n)try{const n=e.context.element?.getElement(t);n?._hidePortsImmediately&&n._hidePortsImmediately()}catch(t){}}}else{jA.add(this.id);const t=e.getNodeData(this.id)?.style?.collapse||{};e.updateNodeData([{id:this.id,style:{collapse:{...t,collapsed:!0}}}]);const a=[...n];i.forEach((t=>{t.id&&!t.id.startsWith(eO)&&(r.has(t.source)||r.has(t.target))&&a.push(t.id)})),a.length>0&&await e.hideElement(a,!1)}if(await BA(e),!t&&tO.size>0){const t=[];for(const[n]of tO)try{const i=e.getComboData().find((t=>t.id===n));if(!i||"hidden"===i.style?.visibility)continue;const a=e.getNodeData().filter((t=>t.combo===n));a.length>0&&a.every((t=>r.has(t.id)))&&t.push(n)}catch(t){}t.length>0&&await e.hideElement(t,!1)}await aO(e),_A(e),FA(e),await sO(e),this.drawCollapseButton(this.parsedAttributes),this.refreshCollapseStates();const a=e.getNodeData().filter((t=>"hidden"!==t.style?.visibility));for(const t of a)try{const n=e.context.element?.getElement(t.id);n?._hidePortsImmediately&&n._hidePortsImmediately()}catch(t){}"hover"===this._collapseVisibility&&this.showCollapseButton()}finally{e._g6rCollapseInProgress=!1}}}))}}onCreate(){if(this.bindCollapseListener(),(this.attributes.collapse||{}).collapsed||this.attributes.collapsed){const{graph:t}=this.context;setTimeout((async()=>{jA.add(this.id);const{descendants:e,allEdges:n}=this.collectDAGDescendants(this.id);if(0===e.length)return;const i=new Set(e),r=[...e];n.forEach((t=>{t.id&&!t.id.startsWith(eO)&&(i.has(t.source)||i.has(t.target))&&r.push(t.id)})),r.length>0&&(await t.hideElement(r,!1),await BA(t),_A(t),FA(t),await sO(t))}),0)}}drawPortShapes(t,e){const n=this.getPortsStyle(t),i=this.context.graph.options.container;this._portShapes=[];const r=(t=>"number"==typeof t.portZIndex?t.portZIndex:10)(t);Object.keys(n).forEach((a=>{const o=n[a];if(!o)return;const[s,l]=this.getPortXY(t,o),u=o.r||4,c=o.visibility||"visible",h="visible"===c,d=((t,e,n,i,r,a,o)=>{const s={...n,zIndex:o,r:i,fill:n.fill,stroke:"transparent",lineWidth:0,visibility:"visible"===a?"visible":"hidden",pointerEvents:"none",class:"port"},l=t.createPortShape(`port-${e}`,s,r,e);return l._baseRadius=i,l._expandedRadius=2.5*i,l._originalFill=n.fill,l._visibility=a,l})(this,a,o,u,e,c,r),f=((t,e,n,i,r,a,o,s,l)=>{const u=this.createAddIndicator(e,n,i,2.5*r,a.fill,o,a,l);return u._visibility=s,u})(0,a,s,l,u,o,e,c,r);h&&f.hitArea&&f.hitArea.attr({visibility:"visible"}),this._portShapes.push({shape:d,indicator:f}),this.addPortEvents(d,o,f,i,this.id)})),this.addNodeHoverHandlers(e)}addNodeHoverHandlers(t){const e=(t=>t.querySelector('[class*="key"]')||t.children?.[0])(t);if(!e||e._hasZIndexHover)return;e._hasZIndexHover=!0;const n=(()=>({self:this,hideTimeout:null,isHoveringNode:!1}))(),i=(t=>()=>{if(t.isHoveringNode=!0,t.hideTimeout&&(clearTimeout(t.hideTimeout),t.hideTimeout=null),zA&&zA!==t.self&&zA._hidePortsImmediately?.(),zA=t.self,!t.self._portShapes)return;const e=CA(t.self.context.graph,t.self.id)||{};let n=!1;t.self._portShapes.forEach((({shape:i,indicator:r})=>{"hidden"!==(i._visibility||"visible")&&((e[i.key]??0)>=("Infinity"===i.arity?1/0:i.arity||1)||!r?(r&&(t.self.stopRotationAnimation(r.circle),r.circle.attr({visibility:"hidden"}),r.innerCircle.attr({visibility:"hidden"}),r.plus.attr({visibility:"hidden"})),"visible"!==i.attr("visibility")?(i.attr({visibility:"visible",zIndex:10,opacity:0}),n=!0):i.attr({opacity:1})):(i.attr({visibility:"hidden"}),"visible"!==r.circle.attr("visibility")&&(r.hitArea&&r.hitArea.attr({visibility:"visible"}),r.circle.attr({visibility:"visible",opacity:0}),r.innerCircle.attr({visibility:"visible",opacity:0}),r.plus.attr({visibility:"visible",opacity:0}),n=!0),t.self.startRotationAnimation(r.circle)))})),n&&t.self.animateAllIn(),t.self.showCollapseButton?.()})(n),r=(t=>()=>{t.isHoveringNode=!1,t.hideTimeout=setTimeout((()=>{t.self._portShapes&&(t.self._portsAnimation&&(cancelAnimationFrame(t.self._portsAnimation),t.self._portsAnimation=null),t.self._portShapes.forEach((({shape:e,indicator:n})=>{const i=e._visibility||"visible";"hover"===i?(e.attr({visibility:"hidden",zIndex:1,r:e._baseRadius,opacity:1}),n?.hitArea&&n.hitArea.attr({visibility:"hidden"})):"visible"===i&&e.attr({visibility:"visible",zIndex:1,r:e._baseRadius,opacity:1}),n&&(t.self.stopRotationAnimation(n.circle),n.circle.attr({visibility:"hidden",opacity:1}),n.innerCircle.attr({visibility:"hidden",opacity:1}),n.plus.attr({visibility:"hidden",opacity:1}))})),t.self.hideCollapseButton?.())}),0)})(n),a=(t=>()=>{t.isHoveringNode=!1,t.hideTimeout&&(clearTimeout(t.hideTimeout),t.hideTimeout=null),t.self._portsAnimation&&(cancelAnimationFrame(t.self._portsAnimation),t.self._portsAnimation=null),t.self._portShapes&&(t.self._portShapes.forEach((({shape:e,indicator:n})=>{const i=e._visibility||"visible";"hover"===i?(e.attr({visibility:"hidden",opacity:1}),n?.hitArea&&n.hitArea.attr({visibility:"hidden"})):"visible"===i&&e.attr({visibility:"visible",opacity:1}),n&&(t.self.stopRotationAnimation(n.circle),n.circle.attr({visibility:"hidden",opacity:1}),n.innerCircle.attr({visibility:"hidden",opacity:1}),n.plus.attr({visibility:"hidden",opacity:1}))})),t.self.hideCollapseButtonImmediate?.())})(n);this._showPorts=i,this._hidePorts=r,this._hidePortsImmediately=a,this._cancelHide=(t=>()=>{t.hideTimeout&&(clearTimeout(t.hideTimeout),t.hideTimeout=null)})(n),this._isHoveringNode=(t=>()=>t.isHoveringNode)(n),GA(e,"mouseenter",i),GA(e,"mouseleave",r),((t,e)=>{IA.set(String(t),e)})(this.id,i),(t=>{t._hasEdgeCreatedListener||(t._hasEdgeCreatedListener=!0,t.on(oc.AFTER_ELEMENT_CREATE,(t=>{if("edge"===t.elementType){const e=t.data,n=String(e.source),i=String(e.target);IA.has(n)&&IA.get(n)(),IA.has(i)&&IA.get(i)()}})))})(this.context.graph)}addPortEvents(t,e,n=null,i=null,r=null){n&&n.hitArea&&i&&r&&"hidden"!==e.visibility&&(GA(n.hitArea,"click",((t,e,n,i,r,a)=>i=>{(CA(t.context.graph,t.id)?.[e.key]??0)>=("Infinity"===e.arity?1/0:e.arity||1)||HTMLWidgets.shinyMode&&Shiny.setInputValue(`${r}-selected_port`,{node:a,port:e.key,type:n.type},{priority:"event"}),i.stopPropagation()})(this,t,e,0,i,r)),GA(n.hitArea,"mouseenter",((t,e,n,i)=>r=>{t._cancelHide&&t._cancelHide(),n.label&&VA(r,n),(CA(t.context.graph,t.id)?.[e.key]??0)>=("Infinity"===e.arity?1/0:e.arity)||(e.attr({visibility:"hidden"}),t.showIndicatorWithAnimation(i),t.startRotationAnimation(i.circle))})(this,t,e,n)),GA(n.hitArea,"mouseleave",(t=>e=>{WA(),t._hidePorts&&t._hidePorts()})(this)))}createPortShape(t,e,n,i){const r=this.upsert(t,ml,{...e},n);return r&&(r.key=i,r.arity="Infinity"===e.arity?1/0:e.arity),r}createAddIndicator(t,e,n,i,r,a,o={},s=10){const l=.75*i,u=((t,e,n,i,r,a,o,s)=>this.upsert(`port-hitarea-${e}`,ml,{cx:n,cy:i,r:r+2,fill:"transparent",stroke:"transparent",zIndex:s+1,cursor:"pointer",visibility:"hidden",class:"port",type:o.type||"input",arity:o.arity||1},a))(0,t,e,n,i,a,o,s);u.key=t,u.arity="Infinity"===o.arity?1/0:o.arity||1;const c=((t,e,n,i,r,a,o,s)=>this.upsert(`add-circle-${e}`,ml,{cx:n,cy:i,r,fill:"transparent",stroke:a,lineWidth:1.5,lineDash:[4,4],zIndex:s+2,cursor:"pointer",visibility:"hidden",transformOrigin:"center",pointerEvents:"none"},o))(0,t,e,n,i,r,a,s),h=((t,e,n,i,r,a,o,s)=>this.upsert(`add-inner-${e}`,ml,{cx:n,cy:i,r,fill:a,stroke:"transparent",zIndex:s+3,cursor:"pointer",visibility:"hidden",pointerEvents:"none"},o))(0,t,e,n,l,r,a,s),d=((t,e,n,i,r,a,o)=>this.upsert(`add-plus-${e}`,"text",{x:n-.5,y:i-.5,text:"+",fontSize:1.6*r,fill:"#fff",fontWeight:"400",textAlign:"center",textBaseline:"middle",zIndex:o+4,pointerEvents:"none",visibility:"hidden"},a))(0,t,e,n,l,a,s);return c._rotationAnimation=null,{circle:c,innerCircle:h,plus:d,hitArea:u}}startRotationAnimation(t){if(t._rotationAnimation)return;let e=0;const n=()=>{e=(e+1)%360,t.attr("transform",`rotate(${e}deg)`),t._rotationAnimation=requestAnimationFrame(n)};t._rotationAnimation=requestAnimationFrame(n)}stopRotationAnimation(t){t._rotationAnimation&&(cancelAnimationFrame(t._rotationAnimation),t._rotationAnimation=null,t.attr("transform","rotate(0deg)"))}showIndicatorWithAnimation(t){const{circle:e,innerCircle:n,plus:i}=t;if(t._hideAnimation&&(cancelAnimationFrame(t._hideAnimation),t._hideAnimation=null),"visible"===e.attr("visibility")&&e.attr("opacity")>=.9)return;e.attr({visibility:"visible",opacity:0}),n.attr({visibility:"visible",opacity:0}),i.attr({visibility:"visible",opacity:0});const r=performance.now(),a=o=>{const s=Math.min((o-r)/500,1),l=1-Math.pow(1-s,2);e.attr("opacity",l),n.attr("opacity",l),i.attr("opacity",l),t._showAnimation=s<1?requestAnimationFrame(a):null};t._showAnimation=requestAnimationFrame(a)}hideIndicatorWithAnimation(t,e){const{circle:n,innerCircle:i,plus:r}=t;t._showAnimation&&(cancelAnimationFrame(t._showAnimation),t._showAnimation=null);const a=performance.now(),o=s=>{const l=Math.min((s-a)/0,1),u=1-l;n.attr("opacity",u),i.attr("opacity",u),r.attr("opacity",u),l<1?t._hideAnimation=requestAnimationFrame(o):(t._hideAnimation=null,n.attr({visibility:"hidden",opacity:1}),i.attr({visibility:"hidden",opacity:1}),r.attr({visibility:"hidden",opacity:1}),e&&e())};t._hideAnimation=requestAnimationFrame(o)}animateAllIn(){if(!this._portShapes)return;this._portsAnimation&&cancelAnimationFrame(this._portsAnimation);const t=performance.now(),e=n=>{const i=Math.min((n-t)/500,1),r=1-Math.pow(1-i,2);this._portShapes.forEach((({shape:t,indicator:e})=>{"visible"===t.attr("visibility")&&t.attr("opacity",r),e&&"visible"===e.circle.attr("visibility")&&(e.circle.attr("opacity",r),e.innerCircle.attr("opacity",r),e.plus.attr("opacity",r))})),this._portsAnimation=i<1?requestAnimationFrame(e):null};this._portsAnimation=requestAnimationFrame(e)}showCollapseButton(){if("hover"!==this._collapseVisibility)return;const t=this.shapeMap["collapse-hit-area"],e=this.shapeMap["collapse-button"];if(!t)return;if(this._collapseHideTimeout&&(clearTimeout(this._collapseHideTimeout),this._collapseHideTimeout=null),"visible"===t.attr("visibility")&&t.attr("opacity")>=1)return;if(this._collapseShowAnimation)return;t.attr({visibility:"visible",opacity:0}),e&&e.attr({visibility:"visible",opacity:0});const n=performance.now(),i=r=>{const a=Math.min((r-n)/500,1),o=1-Math.pow(1-a,2);t.attr("opacity",o),e&&e.attr("opacity",o),this._collapseShowAnimation=a<1?requestAnimationFrame(i):null};this._collapseShowAnimation=requestAnimationFrame(i)}hideCollapseButton(){"hover"===this._collapseVisibility&&(this._isCollapsed||this.shapeMap["collapse-hit-area"]&&(this._collapseHideTimeout&&clearTimeout(this._collapseHideTimeout),this._collapseHideTimeout=setTimeout((()=>{this._collapseHideTimeout=null,this._collapseShowAnimation&&(cancelAnimationFrame(this._collapseShowAnimation),this._collapseShowAnimation=null);const t=this.shapeMap["collapse-hit-area"],e=this.shapeMap["collapse-button"];t&&t.attr({visibility:"hidden",opacity:0}),e&&e.attr({visibility:"hidden",opacity:0})}),150)))}hideCollapseButtonImmediate(){if("hover"!==this._collapseVisibility)return;if(this._isCollapsed)return;this._collapseHideTimeout&&(clearTimeout(this._collapseHideTimeout),this._collapseHideTimeout=null),this._collapseShowAnimation&&(cancelAnimationFrame(this._collapseShowAnimation),this._collapseShowAnimation=null);const t=this.shapeMap["collapse-hit-area"],e=this.shapeMap["collapse-button"];t&&t.attr({visibility:"hidden",opacity:0}),e&&e.attr({visibility:"hidden",opacity:0})}update(t){super.update(t),"hidden"===this.attributes?.visibility?this._portShapes&&this._portShapes.forEach((({shape:t,indicator:e})=>{t.attr({visibility:"hidden"}),e&&(e.circle?.attr({visibility:"hidden"}),e.innerCircle?.attr({visibility:"hidden"}),e.plus?.attr({visibility:"hidden"}),e.hitArea&&e.hitArea.attr({visibility:"hidden"}))})):this._isHoveringNode?.()?this._showPorts&&this._showPorts():this._hidePortsImmediately&&this._hidePortsImmediately(),"hover"!==this._collapseVisibility||this._isHoveringNode?.()||this.hideCollapseButtonImmediate?.()}render(t=this.parsedAttributes,e){super.render(t,e),this._renderContainer=e,this.drawCollapseButton(t)}},HA=UA(mf),YA=UA(Hp),$A=UA(Mf),XA=UA(xf),qA=UA($p),KA=UA(Yp),ZA=UA(Sf),QA=UA(Up),JA=UA(Ef),tO=new Map,eO="__combo_proxy__",nO=t=>class extends t{getContentBBox(t){const{childrenNode:e=[],padding:n}=t,i=e.map((t=>this.context.element?.getElement(t))).filter(Boolean);if(0===i.length)return super.getContentBBox(t);const r=i.filter((t=>"hidden"!==t.style?.visibility));if(0===r.length){const e=new ti,{collapsedSize:n=32}=t,i="number"==typeof n?n:n[0]||32,r=this._lastContentCenterX??t.x??0,a=this._lastContentCenterY??t.y??0;return e.setMinMax([r-i/2,a-i/2,0],[r+i/2,a+i/2,0]),e}const a=r.map((t=>t.getBounds()));let o=1/0,s=1/0,l=-1/0,u=-1/0;for(const t of a){const e=t.getMin(),n=t.getMax();e[0]<o&&(o=e[0]),e[1]<s&&(s=e[1]),n[0]>l&&(l=n[0]),n[1]>u&&(u=n[1])}const c=new ti;if(c.setMinMax([o,s,0],[l,u,0]),this._lastContentCenterX=(o+l)/2,this._lastContentCenterY=(s+u)/2,!n)return c;const h=Array.isArray(n)?n:[n,n,n,n],[d,f,p,g]=1===h.length?[h[0],h[0],h[0],h[0]]:2===h.length?[h[0],h[1],h[0],h[1]]:3===h.length?[h[0],h[1],h[2],h[1]]:h,v=c.getMin(),y=c.getMax(),m=new ti;return m.setMinMax([v[0]-g,v[1]-d,0],[y[0]+f,y[1]+p,0]),m}render(t,e){super.render(t,e),this.drawButton(t)}drawButton(t){const e=tO.get(this.id),n=!!e,i=t.collapse||{},[r,a]=this.getKeySize(t),o=i.r||8,s=i.placement||"bottom";let l,u;if(Array.isArray(s))l=(s[0]-.5)*r,u=(s[1]-.5)*a;else switch(s){case"top":l=0,u=-a/2-o;break;case"bottom":default:l=0,u=a/2+o;break;case"right":l=r/2+o,u=0;break;case"left":l=-r/2-o,u=0;break;case"right-top":l=r/2,u=-a/2;break;case"right-bottom":l=r/2,u=a/2;break;case"left-top":l=-r/2,u=-a/2;break;case"left-bottom":l=-r/2,u=a/2}const c=i.fill||"#fff",h=i.stroke||"#CED4D9",d=i.lineWidth||1,f=i.iconStroke||"#CED4D9",p=i.iconLineWidth||1.4,g=i.cursor||"pointer",v=i.zIndex||999,y=i.visibility||"visible";this._comboCollapseVisibility=y;const m=n||"visible"===y||"hover"===y&&this._isHoveringCombo,b=this._hitAreaType;let x=!1;if(n&&e.hiddenCount>0){const t=`+ ${e.hiddenCount}`,n=1.1*o,i=.4*o,r=t.length*n*.55+2*i;if("pill"!==b){const t=this.shapeMap["hit-area"];t&&(t.remove(),delete this.shapeMap["hit-area"]);const e=this.shapeMap.button;e&&(e.remove(),delete this.shapeMap.button),x=!0}this.upsert("hit-area",Dl,{x:l-r/2,y:u-o,width:r,height:2*o,radius:o,fill:c,stroke:h,lineWidth:d,cursor:g,zIndex:v,visibility:"visible"},this),this.upsert("button",_l,{x:l,y:u,text:t,fontSize:n,fontWeight:"bold",fill:f,textAlign:"center",textBaseline:"middle",cursor:g,zIndex:v+1},this.shapeMap["hit-area"]),this._hitAreaType="pill"}else{if("pill"===b){const t=this.shapeMap["hit-area"];t&&(t.remove(),delete this.shapeMap["hit-area"]);const e=this.shapeMap.button;e&&(e.remove(),delete this.shapeMap.button),x=!0}const t=n?((t,e,n)=>[["M",t-n+4,e],["L",t+n-4,e],["M",t,e-n+4],["L",t,e+n-4]])(l,u,o):((t,e,n)=>[["M",t-n+4,e],["L",t+n-4,e]])(l,u,o);this.upsert("hit-area",ml,{cx:l,cy:u,r:o,fill:c,stroke:h,lineWidth:d,cursor:g,zIndex:v,visibility:m?"visible":"hidden",opacity:m?1:0},this),this.upsert("button",Ol,{stroke:f,lineWidth:p,d:t,cursor:g,zIndex:v+1,visibility:m?"visible":"hidden",opacity:m?1:0},this.shapeMap["hit-area"]),this._hitAreaType="circle"}x&&this._comboClickHandler&&this.shapeMap["hit-area"].addEventListener("click",this._comboClickHandler),"hover"===y&&this._setupComboHoverHandlers()}_setupComboHoverHandlers(){const t=this.shapeMap?.key;t&&!t._hasComboCollapseHover&&(t._hasComboCollapseHover=!0,t.addEventListener("mouseenter",(()=>this.showComboCollapseButton())),t.addEventListener("mouseleave",(()=>this.hideComboCollapseButton())));const e=this.shapeMap?.["hit-area"];e&&!e._hasComboCollapseHover&&(e._hasComboCollapseHover=!0,e.addEventListener("mouseenter",(()=>this.showComboCollapseButton())),e.addEventListener("mouseleave",(()=>this.hideComboCollapseButton())))}showComboCollapseButton(){if("hover"!==this._comboCollapseVisibility)return;this._isHoveringCombo=!0;const t=this.shapeMap["hit-area"],e=this.shapeMap.button;if(!t)return;if(this._comboCollapseHideTimeout&&(clearTimeout(this._comboCollapseHideTimeout),this._comboCollapseHideTimeout=null),"visible"===t.attr("visibility")&&t.attr("opacity")>=1)return;if(this._comboCollapseShowAnimation)return;t.attr({visibility:"visible",opacity:0}),e&&e.attr({visibility:"visible",opacity:0});const n=performance.now(),i=r=>{const a=Math.min((r-n)/500,1),o=1-Math.pow(1-a,2);t.attr("opacity",o),e&&e.attr("opacity",o),this._comboCollapseShowAnimation=a<1?requestAnimationFrame(i):null};this._comboCollapseShowAnimation=requestAnimationFrame(i)}hideComboCollapseButton(){"hover"===this._comboCollapseVisibility&&(this._isHoveringCombo=!1,tO.has(this.id)||this.shapeMap["hit-area"]&&(this._comboCollapseHideTimeout&&clearTimeout(this._comboCollapseHideTimeout),this._comboCollapseHideTimeout=setTimeout((()=>{this._comboCollapseHideTimeout=null,this._comboCollapseShowAnimation&&(cancelAnimationFrame(this._comboCollapseShowAnimation),this._comboCollapseShowAnimation=null);const t=this.shapeMap["hit-area"],e=this.shapeMap.button;t&&t.attr({visibility:"hidden",opacity:0}),e&&e.attr({visibility:"hidden",opacity:0})}),150)))}onCreate(){this._comboClickHandler=async()=>{const{graph:t}=this.context,e=this.id,n=tO.has(e),i=t.getNodeData().filter((t=>t.combo===e)).map((t=>t.id));if(0===i.length)return;const r=new Set(i),a=t.getEdgeData(),o=a.filter((t=>t.id&&!t.id.startsWith(eO)&&(r.has(t.source)||r.has(t.target)))).map((t=>t.id));if(n){const n=tO.get(e)||{},s=n.alreadyHidden||new Set,l=n.dagCollapsedMembers||new Set;tO.delete(e);for(const e of l){jA.add(e);const n=t.getNodeData(e);n?.style?.collapse&&!n.style.collapse.collapsed&&t.updateNodeData([{id:e,style:{collapse:{...n.style.collapse,collapsed:!0}}}])}const u=i.filter((t=>!s.has(t)));u.length>0&&await t.showElement(u,!1);for(const e of u)try{const n=t.context.element?.getElement(e);n?._hidePortsImmediately&&n._hidePortsImmediately()}catch(t){}const c=o.filter((e=>{if(s.has(e))return!1;const n=a.find((t=>t.id===e));if(!n)return!1;const i=t.getNodeData(n.source),r=t.getNodeData(n.target);return"hidden"!==i?.style?.visibility&&"hidden"!==r?.style?.visibility}));c.length>0&&await t.showElement(c,!1);const h=t.getEdgeData(),d=t=>{const e=[],n=new Set,i=t=>{h.forEach((r=>{r.source!==t||n.has(r.target)||r.id?.startsWith(eO)||(n.add(r.target),e.push(r.target),i(r.target))}))};return i(t),e};for(const e of u){const n=t.getNodeData(e);if(n?.style?.collapse?.collapsed||jA.has(e)){const n=d(e),i=[],r=new Set(n);h.forEach((t=>{t.id&&!t.id.startsWith(eO)&&(r.has(t.source)||r.has(t.target))&&i.push(t.id)}));const a=[...n,...i].filter((e=>{try{const n="edge"===t.getElementType(e)?t.getEdgeData(e):t.getNodeData(e);return"hidden"!==n?.style?.visibility}catch(t){return!1}}));a.length>0&&await t.hideElement(a,!1)}}const f=t.getEdgeData(),p=[];for(const e of f){if(!e.id||e.id.startsWith(eO))continue;if("hidden"!==e.style?.visibility)continue;if(!r.has(e.source)&&!r.has(e.target))continue;const n=t.getNodeData(e.source),i=t.getNodeData(e.target);"hidden"!==n?.style?.visibility&&"hidden"!==i?.style?.visibility&&p.push(e.id)}p.length>0&&await t.showElement(p,!1);for(const e of l)try{const n=t.context.element?.getElement(e);n?.drawCollapseButton&&n?.parsedAttributes&&n.drawCollapseButton(n.parsedAttributes)}catch(t){}}else{const n=new Set;for(const e of i){const i=t.getNodeData(e);"hidden"===i?.style?.visibility&&n.add(e)}for(const e of o)try{const i=t.getEdgeData(e);"hidden"===i?.style?.visibility&&n.add(e)}catch(t){}const a=new Set;for(const t of i)jA.has(t)&&a.add(t);const s=[...i,...o].filter((t=>!n.has(t)));s.length>0&&await t.hideElement(s,!1);const l=i.length-[...n].filter((t=>r.has(t))).length;tO.set(e,{alreadyHidden:n,hiddenCount:l,dagCollapsedMembers:a})}await(async t=>{const e=t.getComboData();if(!e||0===e.length)return;const n=t.getNodeData(),i={};for(const t of n)t.combo&&(i[t.combo]||(i[t.combo]=[]),i[t.combo].push(t));const r=[],a=[];for(const t of e){if(tO.has(t.id))continue;const e=i[t.id];if(!e||0===e.length)continue;const n=e.every((t=>"hidden"===t.style?.visibility)),o="hidden"===t.style?.visibility;n&&!o?r.push(t.id):!n&&o&&a.push(t.id)}r.length>0&&await t.hideElement(r,!1),a.length>0&&await t.showElement(a,!1)})(t);const s=t.getComboData().find((t=>t.id===e));if(s){const n=t.context.element?.getElement(e);if(n){const e=t.context.element.getElementComputedStyle("combo",s);n.update(e)}}await sO(t),oO(t)},this.shapeMap["hit-area"].addEventListener("click",this._comboClickHandler)}},iO=nO(Kp),rO=nO(Zp),aO=async t=>{if(0===tO.size)return;const e=t.getEdgeData(),n=t=>{const n=[],i=new Set,r=t=>{e.forEach((e=>{e.source!==t||i.has(e.target)||e.id?.startsWith(eO)||(i.add(e.target),n.push(e.target),r(e.target))}))};return r(t),n};for(const[i,r]of tO){const a=t.getNodeData().filter((t=>t.combo===i)).map((t=>t.id));if(0===a.length)continue;const o=new Set(a),s=r.dagCollapsedMembers||new Set;if(s.size>0){const i=[];for(const e of s){jA.add(e);const n=t.getNodeData(e);n?.style?.collapse&&i.push({id:e,style:{collapse:{...n.style.collapse,collapsed:!0}}})}i.length>0&&t.updateNodeData(i);for(const i of s){const r=n(i);if(0===r.length)continue;const a=new Set(r),o=e.filter((t=>t.id&&!t.id.startsWith(eO)&&(a.has(t.source)||a.has(t.target)))).map((t=>t.id)),s=[...r,...o].filter((e=>{try{const n="edge"===t.getElementType(e)?t.getEdgeData(e):t.getNodeData(e);return"hidden"!==n?.style?.visibility}catch(t){return!1}}));s.length>0&&await t.hideElement(s,!1)}}const l=t.getEdgeData().filter((t=>t.id&&!t.id.startsWith(eO)&&(o.has(t.source)||o.has(t.target)))).map((t=>t.id)),u=[...a,...l].filter((e=>{try{const n="edge"===t.getElementType(e)?t.getEdgeData(e):t.getNodeData(e);return"hidden"!==n?.style?.visibility}catch(t){return!1}}));u.length>0&&await t.hideElement(u,!1),oO(t)}},oO=t=>{const e=t.getNodeData().filter((t=>"hidden"===t.style?.visibility));for(const n of e)try{const e=t.context.element?.getElement(n.id);if(!e?._portShapes)continue;e._portShapes.forEach((({shape:t,indicator:e})=>{t.attr({visibility:"hidden"}),e&&(e.circle?.attr({visibility:"hidden"}),e.innerCircle?.attr({visibility:"hidden"}),e.plus?.attr({visibility:"hidden"}),e.hitArea&&e.hitArea.attr({visibility:"hidden"}))}))}catch(t){}},sO=async t=>{const e=(t=>{if(0===tO.size)return new Map;const e=t.getNodeData(),n=new Map(e.map((t=>[t.id,t]))),i=new Set;for(const[e]of tO){const n=t.getComboData().find((t=>t.id===e));n&&"hidden"!==n.style?.visibility&&i.add(e)}const r=t=>{const e=n.get(t);return e?e.combo&&i.has(e.combo)?e.combo:"hidden"!==e.style?.visibility?t:null:null},a=t.getEdgeData(),o=new Map;for(const t of a){if(!t.id||t.id.startsWith(eO))continue;const e=r(t.source),n=r(t.target);if(!e||!n)continue;if(e===n)continue;if(!i.has(e)&&!i.has(n))continue;const a=`${e}_to_${n}`;o.has(a)||o.set(a,{source:e,target:n})}const s=new Set;for(const[t]of o){const[e,n]=t.split("_to_");o.has(`${n}_to_${e}`)&&s.add(t)}const l=t.options?.edge?.style||{},u={lineDash:[4,4],stroke:l.stroke||"#C0C0C0",endArrow:void 0===l.endArrow||l.endArrow},c=new Map;for(const[t,{source:e,target:n}]of o){const i={id:`${eO}${t}`,source:e,target:n,style:{...u,visibility:"visible"}};s.has(t)&&(i.type="quadratic",i.style.curveOffset=20),c.set(t,i)}return c})(t),n=t.getEdgeData(),i=new Map;for(const t of n)if(t.id&&t.id.startsWith(eO)){const e=t.id.slice(eO.length);i.set(e,t)}const r=[],a=[],o=[];for(const[t,n]of e)if(i.has(t)){const e=i.get(t);"hidden"===e.style?.visibility&&a.push(e.id)}else r.push(n);const s=[];for(const[t,n]of i)e.has(t)||s.push(n.id);const l=r.length>0||s.length>0;if(s.length>0&&t.removeEdgeData(s),r.length>0)for(const e of r)t.addEdgeData([e]);l&&await(async t=>{const e=t.getNodeData().filter((t=>"hidden"===t.style?.visibility)).map((t=>t.id)),n=t.getEdgeData().filter((t=>t.id&&!t.id.startsWith(eO)&&"hidden"===t.style?.visibility)).map((t=>t.id)),i=t.getComboData().filter((t=>"hidden"===t.style?.visibility)).map((t=>t.id));await t.draw();const r=[...e,...n,...i].filter((e=>{try{const n=t.getElementType(e),i="edge"===n?t.getEdgeData(e):"combo"===n?t.getComboData().find((t=>t.id===e)):t.getNodeData(e);return"hidden"!==i?.style?.visibility}catch(t){return!1}}));r.length>0&&await t.hideElement(r,!1);const a=t.getComboData();for(const e of a){if("hidden"===e.style?.visibility)continue;const n=t.context.element?.getElement(e.id);if(n){const i=t.context.element.getElementComputedStyle("combo",e);n.update(i)}}const o=t.getEdgeData().filter((t=>t.id?.startsWith(eO)&&"hidden"!==t.style?.visibility));for(const e of o)try{const n=t.context.element?.getElement(e.id);if(n){const i=t.context.element.getElementComputedStyle("edge",e);n.update(i)}}catch(t){}oO(t)})(t),a.length>0&&await t.showElement(a,!1),o.length>0&&await t.hideElement(o,!1);const u=[...e.values()].map((t=>t.id)).filter((e=>{try{const n=t.context.element?.getElement(e);return n&&"hidden"===n.style?.visibility}catch(t){return!1}}));u.length>0&&await t.showElement(u,!1)},lO="g6-create-edge-assist-edge-id",uO="g6-create-edge-assist-node-id";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;(function(){function t(t,n,r,a,o){e(t,n,r||0,a||t.length-1,o||i)}function e(t,i,r,a,o){for(;a>r;){if(a-r>600){var s=a-r+1,l=i-r+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);e(t,i,Math.max(r,Math.floor(i-l*c/s+h)),Math.min(a,Math.floor(i+(s-l)*c/s+h)),o)}var d=t[i],f=r,p=a;for(n(t,r,i),o(t[a],d)>0&&n(t,r,a);f<p;){for(n(t,f,p),f++,p--;o(t[f],d)<0;)f++;for(;o(t[p],d)>0;)p--}0===o(t[r],d)?n(t,r,p):n(t,++p,a),p<=i&&(r=p+1),i<=p&&(a=p-1)}}function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var a=e;a<n;a++){var o=t.children[a];l(r,t.leaf?i(o):o)}return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,n,i,r,a){for(var o=[n,i];o.length;)if(!((i=o.pop())-(n=o.pop())<=r)){var s=n+Math.ceil((i-n)/r/2)*r;t(e,s,n,i,a),o.push(n,s,s,i)}}r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!p(t,e))return n;for(var i=this.toBBox,r=[];e;){for(var a=0;a<e.children.length;a++){var o=e.children[a],s=e.leaf?i(o):o;p(t,s)&&(e.leaf?n.push(o):f(t,s)?this._all(o,n):r.push(o))}e=r.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var r=e.children[i],a=e.leaf?this.toBBox(r):r;if(p(t,a)){if(e.leaf||f(t,a))return!0;n.push(r)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=g([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,i,r,o=this.data,s=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),i=l[l.length-1],n=u.pop(),r=!0),o.leaf){var c=a(t,o.children,e);if(-1!==c)return o.children.splice(c,1),l.push(o),this._condense(l),this}r||o.leaf||!f(o,s)?i?(n++,o=i.children[n],r=!1):o=null:(l.push(o),u.push(n),n=0,i=o,o=o.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,i){var r,a=n-e+1,s=this._maxEntries;if(a<=s)return o(r=g(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,i-1))),(r=g([])).leaf=!1,r.height=i;var l=Math.ceil(a/s),u=l*Math.ceil(Math.sqrt(s));v(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);v(t,c,h,l,this.compareMinY);for(var d=c;d<=h;d+=l){var f=Math.min(d+l-1,h);r.children.push(this._build(t,d,f,i-1))}}return o(r,this.toBBox),r},r.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var r=1/0,a=1/0,o=void 0,s=0;s<e.children.length;s++){var l=e.children[s],u=h(l),c=(d=t,f=l,(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-u);c<a?(a=c,r=u<r?u:r,o=l):c===a&&u<r&&(r=u,o=l)}e=o||e.children[0]}var d,f;return e},r.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),r=[],a=this._chooseSubtree(i,this.data,e,r);for(a.children.push(t),l(a,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},r.prototype._split=function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var a=this._chooseSplitIndex(n,r,i),s=g(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var i,r=1/0,a=1/0,o=e;o<=n-e;o++){var l=s(t,0,o,this.toBBox),u=s(t,o,n,this.toBBox),c=(f=l,p=u,g=void 0,v=void 0,y=void 0,m=void 0,g=Math.max(f.minX,p.minX),v=Math.max(f.minY,p.minY),y=Math.min(f.maxX,p.maxX),m=Math.min(f.maxY,p.maxY),Math.max(0,y-g)*Math.max(0,m-v)),d=h(l)+h(u);c<r?(r=c,i=o,a=d<a?d:a):c===r&&d<a&&(a=d,i=o)}var f,p,g,v,y,m;return i||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},r.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var r=this.toBBox,a=s(t,0,e,r),o=s(t,n-e,n,r),u=d(a)+d(o),c=e;c<n-e;c++){var h=t.children[c];l(a,t.leaf?r(h):h),u+=d(a)}for(var f=n-e-1;f>=e;f--){var p=t.children[f];l(o,t.leaf?r(p):p),u+=d(o)}return u},r.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)l(e[i],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)}})();var cO=function(t){return t.GROUP="g",t.FRAGMENT="fragment",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh",t}({}),hO=function(t){return t[t.ZERO=0]="ZERO",t[t.NEGATIVE_ONE=1]="NEGATIVE_ONE",t}({}),dO=function(){return c((function t(){l(this,t),this.plugins=[]}),[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach((function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1)}))}}])}(),fO=function(){return c((function t(e){l(this,t),this.clipSpaceNearZ=hO.NEGATIVE_ONE,this.plugins=[],this.config=s({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},e)}),[{key:"registerPlugin",value:function(t){-1===this.plugins.findIndex((function(e){return e===t}))&&this.plugins.push(t)}},{key:"unregisterPlugin",value:function(t){var e=this.plugins.findIndex((function(e){return e===t}));e>-1&&this.plugins.splice(e,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(t){return this.plugins.find((function(e){return e.name===t}))}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(t){Object.assign(this.config,t)}}])}(),pO=O,gO=T,vO=L,yO=R,mO=D,bO=W,xO=function(){function t(){l(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return c(t,[{key:"update",value:function(t,e){gO(this.center,t),gO(this.halfExtents,e),bO(this.min,this.center,this.halfExtents),pO(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,e){pO(this.center,e,t),mO(this.center,this.center,.5),bO(this.halfExtents,e,t),mO(this.halfExtents,this.halfExtents,.5),gO(this.min,t),gO(this.max,e)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!t.isEmpty(e))if(t.isEmpty(this))this.setMinMax(e.getMin(),e.getMax());else{var n=this.center,i=n[0],r=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=i-s,h=i+s,d=r-l,f=r+l,p=a-u,g=a+u,v=e.center,y=v[0],m=v[1],b=v[2],x=e.halfExtents,E=x[0],w=x[1],k=x[2],M=y-E,S=y+E,N=m-w,T=m+w,A=b-k,O=b+k;M<c&&(c=M),S>h&&(h=S),N<d&&(d=N),T>f&&(f=T),A<p&&(p=A),O>g&&(g=O),n[0]=.5*(c+h),n[1]=.5*(d+f),n[2]=.5*(p+g),o[0]=.5*(h-c),o[1]=.5*(f-d),o[2]=.5*(g-p),this.min[0]=c,this.min[1]=d,this.min[2]=p,this.max[0]=h,this.max[1]=f,this.max[2]=g}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,i=this.halfExtents,r=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],p=e[10],g=Math.abs(o),v=Math.abs(s),y=Math.abs(l),m=Math.abs(u),b=Math.abs(c),x=Math.abs(h),E=Math.abs(d),w=Math.abs(f),k=Math.abs(p);n[0]=e[12]+o*r[0]+s*r[1]+l*r[2],n[1]=e[13]+u*r[0]+c*r[1]+h*r[2],n[2]=e[14]+d*r[0]+f*r[1]+p*r[2],i[0]=g*a[0]+v*a[1]+y*a[2],i[1]=m*a[0]+b*a[1]+x*a[2],i[2]=E*a[0]+w*a[1]+k*a[2],bO(this.min,n,i),pO(this.max,n,i)}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),i=t.getMax(),r=t.getMin();return n[0]<=i[0]&&e[0]>=r[0]&&n[1]<=i[1]&&e[1]>=r[1]&&n[2]<=i[2]&&e[2]>=r[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,i=vO([0,0,0],this.getMin(),e.getMin()),r=yO([0,0,0],this.getMax(),e.getMax());return n.setMinMax(i,r),n}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?gO([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?gO([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]}}])}(),EO=function(){return c((function t(e,n){l(this,t),this.distance=e||0,this.normal=n||N(0,1,0),this.updatePNVertexFlag()}),[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return _(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/H(this.normal);D(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,e,n){var i=this.distanceToPoint(t),r=i/(i-this.distanceToPoint(e)),a=r>=0&&r<=1;return a&&n&&F(n,t,e,r),a}}])}(),wO=function(){return c((function t(e){if(l(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new EO)}),[{key:"extractFromVPMatrix",value:function(t){var e=b(t,16),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],y=e[15];A(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-p,A(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+p,A(this.planes[2].normal,a+i,u+s,f+h),this.planes[2].distance=y+g,A(this.planes[3].normal,a-i,u-s,f-h),this.planes[3].distance=y-g,A(this.planes[4].normal,a-r,u-l,f-d),this.planes[4].distance=y-v,A(this.planes[5].normal,a+r,u+l,f+d),this.planes[5].distance=y+v,this.planes.forEach((function(t){t.normalize(),t.updatePNVertexFlag()}))}}])}(),kO=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;l(this,t),this.x=0,this.y=0,this.x=e,this.y=n}return c(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),MO=function(){function t(e,n,i,r){l(this,t),this.x=e,this.y=n,this.width=i,this.height=r,this.left=e,this.right=e+i,this.top=n,this.bottom=n+r}return c(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,n){var i=$(e.x,e.y,0,1),r=$(e.x+e.width,e.y,0,1),a=$(e.x,e.y+e.height,0,1),o=$(e.x+e.width,e.y+e.height,0,1),s=Y(),l=Y(),u=Y(),c=Y();X(s,i,n),X(l,r,n),X(u,a,n),X(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),p=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:p-d})}}])}(),SO="Method not implemented.";function NO(t){return void 0===t?0:t>360||t<-360?t%360:t}var TO=k();function AO(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)&&3===t.length?i?M(t):T(TO,t):le(t)?i?N(t,e,n):A(TO,t,e,n):i?N(t[0],t[1]||e,t[2]||n):A(TO,t[0],t[1]||e,t[2]||n)}var OO=Math.PI/180;function PO(t){return t*OO}var CO=180/Math.PI;function RO(t){return t*CO}var LO=Math.PI/2;function DO(t,e){return 16===e.length?function(t,e){var n,i,r=b(Et(k(),e),3),a=r[0],o=r[1],s=r[2],l=Math.asin(-e[2]/a);return l<LO?l>-LO?(n=Math.atan2(e[6]/o,e[10]/s),i=Math.atan2(e[1]/a,e[0]/a)):(i=0,n=-Math.atan2(e[4]/o,e[5]/o)):(i=0,n=Math.atan2(e[4]/o,e[5]/o)),t[0]=n,t[1]=l,t[2]=i,t}(t,e):function(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=i*i,s=r*r,l=a*a,u=n*n+o+s+l,c=n*a-i*r;return c>.499995*u?(t[0]=LO,t[1]=2*Math.atan2(i,n),t[2]=0):c<-.499995*u?(t[0]=-LO,t[1]=2*Math.atan2(i,n),t[2]=0):(t[0]=Math.asin(2*(n*r-a*i)),t[1]=Math.atan2(2*(n*a+i*r),1-2*(s+l)),t[2]=Math.atan2(2*(n*i+r*a),1-2*(o+s))),t}(t,e)}function IO(t){var e=t[0],n=t[1],i=t[3],r=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(i*i+r*r);if(e*r-n*i<0&&(e<r?a=-a:o=-o),a){var s=1/a;e*=s,n*=s}if(o){var l=1/o;i*=l,r*=l}var u=RO(Math.atan2(n,e));return[t[6],t[7],a,o,u]}var _O=q(),BO=q(),FO=Y(),jO=[k(),k(),k()],GO=k();function zO(t,e,n,i,r){t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r}var VO=function(t){return t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING",t}({}),WO=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC",t}({}),UO=function(t){return t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE",t}({}),HO=2e-4,YO=function(){return c((function t(){l(this,t),this.clipSpaceNearZ=hO.NEGATIVE_ONE,this.eventEmitter=new x,this.matrix=q(),this.right=N(1,0,0),this.up=N(0,1,0),this.forward=N(0,0,1),this.position=N(0,0,1),this.focalPoint=N(0,0,0),this.distanceVector=N(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=q(),this.projectionMatrixInverse=q(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=VO.EXPLORING,this.trackingMode=WO.DEFAULT,this.projectionMode=UO.PERSPECTIVE,this.frustum=new wO,this.orthoMatrix=q()}),[{key:"isOrtho",value:function(){return this.projectionMode===UO.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,e){return this.type=t,this.type===VO.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===VO.TRACKING&&void 0!==e&&this.setTrackingMode(e),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==VO.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return nt(q(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,e){var n=dt(q(),[t,e,0]);this.jitteredProjectionMatrix=at(q(),n,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===UO.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===UO.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,e,n,i,r,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.projectionMode===UO.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===UO.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===UO.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===UO.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),i=n.x,r=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(i,r),this.setFocalPoint(i,r),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=N(o.x-i,o.y-r,0),l=_(s,this.right)/S(this.right),u=_(s,this.up)/S(this.up),c=b(this.getPosition(),2),h=c[0],d=c[1],f=b(this.getFocalPoint(),2),p=f[0],g=f[1];return this.setPosition(h-l,d-u),this.setFocalPoint(p-l,g-u),this}},{key:"setPerspective",value:function(t,e,n,i){var r;this.projectionMode=UO.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=i;var a=this.near*Math.tan(PO(.5*this.fov))/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(r=this.view)&&void 0!==r&&r.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c}return function(t,e,n,i,r,a,o){var s,l,u=2*a,c=n-e,h=i-r,d=u/c,f=u/h,p=(n+e)/c,g=(i+r)/h,v=o-a,y=o*a;arguments.length>7&&void 0!==arguments[7]&&arguments[7]?(s=-o/v,l=-y/v):(s=-(o+a)/v,l=-2*y/v),t[0]=d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=p,t[9]=g,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===hO.ZERO),nt(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,e,n,i,r,a){var o;this.projectionMode=UO.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=i,this.near=r,this.far=a;var s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,p=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d=(h+=g*this.view.offsetX)+g*this.view.width,p=(f-=v*this.view.offsetY)-v*this.view.height}return this.clipSpaceNearZ===hO.NEGATIVE_ONE?Rt(this.projectionMatrix,h,d,f,p,r,a):Lt(this.projectionMatrix,h,d,f,p,r,a),nt(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var e=AO(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2]);return this._setPosition(e),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],i=N(0,1,0);if(this.focalPoint=AO(t,e,n),this.trackingMode===WO.CINEMATIC){var r=P(k(),this.focalPoint,this.position);t=r[0],e=r[1],n=r[2];var a=S(r),o=RO(Math.asin(e/a)),s=90+RO(Math.atan2(n,t)),l=q();ct(l,l,PO(s)),ut(l,l,PO(o)),i=j(k(),[0,1,0],l)}return nt(this.matrix,Dt(q(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<HO&&(this.distance=HO),this.dollyingStep=this.distance/100;var e=k();t=this.distance;var n=this.forward,i=this.focalPoint;return e[0]=t*n[0]+i[0],e[1]=t*n[1]+i[1],e[2]=t*n[2]+i[2],this._setPosition(e),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=NO(t),this.computeMatrix(),this._getAxes(),this.type===VO.ORBITING||this.type===VO.EXPLORING?this._getPosition():this.type===VO.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=NO(t),this.computeMatrix(),this._getAxes(),this.type===VO.ORBITING||this.type===VO.EXPLORING?this._getPosition():this.type===VO.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=NO(t),this.computeMatrix(),this._getAxes(),this.type===VO.ORBITING||this.type===VO.EXPLORING?this._getPosition():this.type===VO.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=Kt(qt(),[0,0,1],PO(this.roll));tt(this.matrix);var e=Kt(qt(),[1,0,0],PO((this.rotateWorld&&this.type!==VO.TRACKING||this.type===VO.TRACKING?1:-1)*this.elevation)),n=Kt(qt(),[0,1,0],PO((this.rotateWorld&&this.type!==VO.TRACKING||this.type===VO.TRACKING?1:-1)*this.azimuth)),i=Zt(qt(),n,e);i=Zt(qt(),i,t);var r=St(q(),i);this.type===VO.ORBITING||this.type===VO.EXPLORING?(ot(this.matrix,this.matrix,this.focalPoint),at(this.matrix,this.matrix,r),ot(this.matrix,this.matrix,[0,0,this.distance])):this.type===VO.TRACKING&&(ot(this.matrix,this.matrix,this.position),at(this.matrix,this.matrix,r))}},{key:"_setPosition",value:function(t,e,n){this.position=AO(t,e,n);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){T(this.right,AO(X(Y(),[1,0,0,0],this.matrix))),T(this.up,AO(X(Y(),[0,1,0,0],this.matrix))),T(this.forward,AO(X(Y(),[0,0,1,0],this.matrix))),I(this.right,this.right),I(this.up,this.up),I(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],i=S(this.distanceVector);if(0===i)return this.elevation=0,void(this.azimuth=0);this.type===VO.TRACKING||this.rotateWorld?(this.elevation=RO(Math.asin(e/i)),this.azimuth=RO(Math.atan2(-t,-n))):(this.elevation=-RO(Math.asin(e/i)),this.azimuth=-RO(Math.atan2(-t,-n)))}},{key:"_getPosition",value:function(){T(this.position,AO(X(Y(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){G(this.distanceVector,[0,0,-this.distance],$t(Yt(),this.matrix)),O(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=P(k(),this.focalPoint,this.position),this.distance=S(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===UO.ORTHOGRAPHIC){var t=this.position,e=Kt(qt(),[0,0,1],-this.roll*Math.PI/180);Mt(this.orthoMatrix,e,N((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),N(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=at(q(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit("updated")}}},{key:"rotate",value:function(t,e,n){throw new Error(SO)}},{key:"pan",value:function(t,e){throw new Error(SO)}},{key:"dolly",value:function(t){throw new Error(SO)}},{key:"createLandmark",value:function(t,e){throw new Error(SO)}},{key:"gotoLandmark",value:function(t,e){throw new Error(SO)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(SO)}}])}(),$O=function(t){return t[t.Standard=0]="Standard",t}({}),XO=function(t){return t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",t}({}),qO=k(),KO=q(),ZO=qt();function QO(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){Mt(t.localTransform,t.localRotation,t.localPosition,N(1,1,1),t.origin),0===t.localSkew[0]&&0===t.localSkew[1]||(tt(KO),KO[4]=Math.tan(t.localSkew[0]),KO[1]=Math.tan(t.localSkew[1]),at(t.localTransform,t.localTransform,KO));var e=Mt(KO,ne(ZO,0,0,0,1),A(qO,1,1,1),t.localScale,t.origin);at(t.localTransform,t.localTransform,e)}else{var n=t.localTransform,i=t.localPosition,r=t.localRotation,a=t.localScale,o=t.origin,s=0!==i[0]||0!==i[1]||0!==i[2],l=1!==r[3]||0!==r[0]||0!==r[1]||0!==r[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?Mt(n,r,i,a,o):s?dt(n,i):tt(n)}t.localDirtyFlag=!1}}var JO={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new MO(0,0,0,0)},tP=function(t){return t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_DISTANCE="<offset-distance>",t.DEFINED_PATH="<defined-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>",t}({});function eP(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function nP(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function iP(){}var rP=.7,aP=1.4285714285714286,oP="\\s*([+-]?\\d+)\\s*",sP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",lP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",uP=/^#([0-9a-f]{3,8})$/,cP=new RegExp(`^rgb\\(${oP},${oP},${oP}\\)$`),hP=new RegExp(`^rgb\\(${lP},${lP},${lP}\\)$`),dP=new RegExp(`^rgba\\(${oP},${oP},${oP},${sP}\\)$`),fP=new RegExp(`^rgba\\(${lP},${lP},${lP},${sP}\\)$`),pP=new RegExp(`^hsl\\(${sP},${lP},${lP}\\)$`),gP=new RegExp(`^hsla\\(${sP},${lP},${lP},${sP}\\)$`),vP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function yP(){return this.rgb().formatHex()}function mP(){return this.rgb().formatRgb()}function bP(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=uP.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?xP(e):3===n?new wP(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?EP(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?EP(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=cP.exec(t))?new wP(e[1],e[2],e[3],1):(e=hP.exec(t))?new wP(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=dP.exec(t))?EP(e[1],e[2],e[3],e[4]):(e=fP.exec(t))?EP(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=pP.exec(t))?AP(e[1],e[2]/100,e[3]/100,1):(e=gP.exec(t))?AP(e[1],e[2]/100,e[3]/100,e[4]):vP.hasOwnProperty(t)?xP(vP[t]):"transparent"===t?new wP(NaN,NaN,NaN,0):null}function xP(t){return new wP(t>>16&255,t>>8&255,255&t,1)}function EP(t,e,n,i){return i<=0&&(t=e=n=NaN),new wP(t,e,n,i)}function wP(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function kP(){return`#${TP(this.r)}${TP(this.g)}${TP(this.b)}`}function MP(){const t=SP(this.opacity);return`${1===t?"rgb(":"rgba("}${NP(this.r)}, ${NP(this.g)}, ${NP(this.b)}${1===t?")":`, ${t})`}`}function SP(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function NP(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function TP(t){return((t=NP(t))<16?"0":"")+t.toString(16)}function AP(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new PP(t,e,n,i)}function OP(t){if(t instanceof PP)return new PP(t.h,t.s,t.l,t.opacity);if(t instanceof iP||(t=bP(t)),!t)return new PP;if(t instanceof PP)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,l=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=l<.5?a+r:2-a-r,o*=60):s=l>0&&l<1?0:o,new PP(o,s,l,t.opacity)}function PP(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function CP(t){return(t=(t||0)%360)<0?t+360:t}function RP(t){return Math.max(0,Math.min(1,t||0))}function LP(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function DP(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var o=e?e.apply(this,r):r[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,r);return n.cache=s.set(o,l)||s,l};return n.cache=new(DP.Cache||Map),DP.cacheList.push(n.cache),n}eP(iP,bP,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:yP,formatHex:yP,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return OP(this).formatHsl()},formatRgb:mP,toString:mP}),eP(wP,(function(t,e,n,i){return 1===arguments.length?((r=t)instanceof iP||(r=bP(r)),r?new wP((r=r.rgb()).r,r.g,r.b,r.opacity):new wP):new wP(t,e,n,null==i?1:i);var r}),nP(iP,{brighter(t){return t=null==t?aP:Math.pow(aP,t),new wP(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?rP:Math.pow(rP,t),new wP(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new wP(NP(this.r),NP(this.g),NP(this.b),SP(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kP,formatHex:kP,formatHex8:function(){return`#${TP(this.r)}${TP(this.g)}${TP(this.b)}${TP(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:MP,toString:MP})),eP(PP,(function(t,e,n,i){return 1===arguments.length?OP(t):new PP(t,e,n,null==i?1:i)}),nP(iP,{brighter(t){return t=null==t?aP:Math.pow(aP,t),new PP(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?rP:Math.pow(rP,t),new PP(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new wP(LP(t>=240?t-240:t+120,r,i),LP(t,r,i),LP(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new PP(CP(this.h),RP(this.s),RP(this.l),SP(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=SP(this.opacity);return`${1===t?"hsl(":"hsla("}${CP(this.h)}, ${100*RP(this.s)}%, ${100*RP(this.l)}%${1===t?")":`, ${t})`}`}})),DP.Cache=Map,DP.cacheList=[],DP.clearCache=function(){DP.cacheList.forEach((function(t){return t.clear()}))};var IP=function(t){return t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger",t}({}),_P=function(t){return t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther",t}({}),BP=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),FP=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),jP=[{name:"em",unit_type:IP.kEms},{name:"px",unit_type:IP.kPixels},{name:"deg",unit_type:IP.kDegrees},{name:"rad",unit_type:IP.kRadians},{name:"grad",unit_type:IP.kGradians},{name:"ms",unit_type:IP.kMilliseconds},{name:"s",unit_type:IP.kSeconds},{name:"rem",unit_type:IP.kRems},{name:"turn",unit_type:IP.kTurns}],GP=function(t){return t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType",t}({}),zP=function(t){var e=1;switch(t){case IP.kPixels:case IP.kDegrees:case IP.kSeconds:break;case IP.kMilliseconds:e=.001;break;case IP.kRadians:e=180/Math.PI;break;case IP.kGradians:e=.9;break;case IP.kTurns:e=360}return e},VP=function(t){switch(t){case IP.kNumber:case IP.kInteger:return"";case IP.kPercentage:return"%";case IP.kEms:return"em";case IP.kRems:return"rem";case IP.kPixels:return"px";case IP.kDegrees:return"deg";case IP.kRadians:return"rad";case IP.kGradians:return"grad";case IP.kMilliseconds:return"ms";case IP.kSeconds:return"s";case IP.kTurns:return"turn"}return""},WP=function(){return c((function t(){l(this,t)}),[{key:"toString",value:function(){return this.buildCSSText(BP.kNo,FP.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=GP.kUnitType&&this.getType()<=GP.kClampType}}],[{key:"isAngle",value:function(t){return t===IP.kDegrees||t===IP.kRadians||t===IP.kGradians||t===IP.kTurns}},{key:"isLength",value:function(t){return t>=IP.kEms&&t<IP.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===IP.kPercentage||t===IP.kEms||t===IP.kRems}},{key:"isTime",value:function(t){return t===IP.kSeconds||t===IP.kMilliseconds}}])}(),UP=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).colorSpace=t,n}return m(e,t),c(e,[{key:"getType",value:function(){return GP.kColorType}},{key:"to",value:function(t){return this}}])}(WP),HP=function(t){return t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient",t}({}),YP=function(t){function e(t,n){var i;return l(this,e),(i=v(this,e)).type=t,i.value=n,i}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(t,e,n){return n}},{key:"getType",value:function(){return GP.kColorType}}])}(WP),$P=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).value=t,n}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return GP.kKeywordType}},{key:"buildCSSText",value:function(t,e,n){return n+this.value}}])}(WP),XP=function(t){return function(t){switch(t){case _P.kUNumber:return IP.kNumber;case _P.kULength:return IP.kPixels;case _P.kUPercent:return IP.kPercentage;case _P.kUTime:return IP.kSeconds;case _P.kUAngle:return IP.kDegrees;default:return IP.kUnknown}}(function(t){switch(t){case IP.kNumber:case IP.kInteger:return _P.kUNumber;case IP.kPercentage:return _P.kUPercent;case IP.kPixels:return _P.kULength;case IP.kMilliseconds:case IP.kSeconds:return _P.kUTime;case IP.kDegrees:case IP.kRadians:case IP.kGradians:case IP.kTurns:return _P.kUAngle;default:return _P.kUOther}}(t))},qP=function(t){function e(t){var n,i,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IP.kNumber;return l(this,e),n=v(this,e),i="string"==typeof a?(r=a)?"number"===r?IP.kNumber:"percent"===r||"%"===r?IP.kPercentage:function(t){return jP.find((function(e){return e.name===t})).unit_type}(r):IP.kUnknown:a,n.unit=i,n.value=t,n}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(t){var e=t;return this.value===e.value&&this.unit===e.unit}},{key:"getType",value:function(){return GP.kUnitType}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=XP(this.unit);if(n!==XP(t)||n===IP.kUnknown)return null;var i=zP(this.unit)/zP(t);return new e(this.value*i,t)}},{key:"buildCSSText",value:function(t,e,n){var i;switch(this.unit){case IP.kUnknown:break;case IP.kInteger:i=Number(this.value).toFixed(0);break;case IP.kNumber:case IP.kPercentage:case IP.kEms:case IP.kRems:case IP.kPixels:case IP.kDegrees:case IP.kRadians:case IP.kGradians:case IP.kMilliseconds:case IP.kSeconds:case IP.kTurns:var r=this.value,a=VP(this.unit);if(r<-999999||r>999999){var o=VP(this.unit);i=!Number.isFinite(r)||Number.isNaN(r)?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e}(r,o):r+(o||"")}else i="".concat(r).concat(a)}return n+i}}])}(WP),KP=new qP(0,"px");new qP(1,"px");var ZP=new qP(0,"deg"),QP=function(t){function e(t,n,i){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return l(this,e),(r=v(this,e,["rgb"])).r=t,r.g=n,r.b=i,r.alpha=a,r.isNone=o,r}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(UP),JP=new $P("unset"),tC={"":JP,unset:JP,initial:new $P("initial"),inherit:new $P("inherit")},eC=new QP(0,0,0,0,!0),nC=new QP(0,0,0,0),iC=DP((function(t,e,n,i){return new QP(t,e,n,i)}),(function(t,e,n,i){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(i,")")})),rC=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IP.kNumber;return new qP(t,e)};function aC(t){var e=t.type,n=t.value;return"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")")}new qP(50,"%");var oC=function(){var t=/^(linear\-gradient)/i,e=/^(repeating\-linear\-gradient)/i,n=/^(radial\-gradient)/i,i=/^(repeating\-radial\-gradient)/i,r=/^(conic\-gradient)/i,a=/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,o=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,s=/^(left|center|right|top|bottom)/i,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,d=/^\(/,f=/^\)/,p=/^,/,g=/^\#([0-9a-fA-F]+)/,v=/^([a-zA-Z]+)/,y=/^rgb/i,m=/^rgba/i,b=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,x="";function E(t){throw new Error("".concat(x,": ").concat(t))}function w(){return k("linear-gradient",t,S)||k("repeating-linear-gradient",e,S)||k("radial-gradient",n,N)||k("repeating-radial-gradient",i,N)||k("conic-gradient",r,N)}function k(t,e,n){return M(e,(function(e){var i=n();return i&&(B(p)||E("Missing comma before color stops")),{type:t,orientation:i,colorStops:C(R)}}))}function M(t,e){var n=B(t);if(n){B(d)||E("Missing (");var i=e(n);return B(f)||E("Missing )"),i}}function S(){return _("directional",a,1)||_("angular",h,1)}function N(){var t,e,n=T();return n&&((t=[]).push(n),e=x,B(p)&&((n=T())?t.push(n):x=e)),t}function T(){var t,e=function(){var t=_("shape",/^(circle)/i,0);return t&&(t.style=I()||A()),t}()||((t=_("shape",/^(ellipse)/i,0))&&(t.style=D()||A()),t);if(e)e.at=O();else{var n=A();if(n){e=n;var i=O();i&&(e.at=i)}else{var r=P();r&&(e={type:"default-radial",at:r})}}return e}function A(){return _("extent-keyword",o,1)}function O(){if(_("position",/^at/,0)){var t=P();return t||E("Missing positioning value"),t}}function P(){var t={x:D(),y:D()};if(t.x||t.y)return{type:"position",value:t}}function C(t){var e=t(),n=[];if(e)for(n.push(e);B(p);)(e=t())?n.push(e):E("One extra comma");return n}function R(){var t=_("hex",g,1)||M(m,(function(){return{type:"rgba",value:C(L)}}))||M(y,(function(){return{type:"rgb",value:C(L)}}))||_("literal",v,0);return t||E("Expected color definition"),t.length=D(),t}function L(){return B(b)[1]}function D(){return _("%",u,1)||_("position-keyword",s,1)||I()}function I(){return _("px",l,1)||_("em",c,1)}function _(t,e,n){var i=B(e);if(i)return{type:t,value:i[n]}}function B(t){var e=/^[\n\r\t\s]+/.exec(x);e&&F(e[0].length);var n=t.exec(x);return n&&F(n[0].length),n}function F(t){x=x.substring(t)}return function(t){return x=t,e=C(w),x.length>0&&E("Invalid input not EOF"),e;var e}}(),sC=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,lC=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,uC=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,cC=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,hC={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},dC=DP((function(t){var e;return e="angular"===t.type?Number(t.value):hC[t.value]||0,rC(e,"deg")})),fC=DP((function(t){var e=50,n=50,i="%",r="%";if("position"===(null==t?void 0:t.type)){var a=t.value,o=a.x,s=a.y;"position-keyword"===(null==o?void 0:o.type)&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),"position-keyword"===(null==s?void 0:s.type)&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),"px"!==(null==o?void 0:o.type)&&"%"!==(null==o?void 0:o.type)&&"em"!==(null==o?void 0:o.type)||(i=null==o?void 0:o.type,e=Number(o.value)),"px"!==(null==s?void 0:s.type)&&"%"!==(null==s?void 0:s.type)&&"em"!==(null==s?void 0:s.type)||(r=null==s?void 0:s.type,n=Number(s.value))}return{cx:rC(e,i),cy:rC(n,r)}})),pC=DP((function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return oC(t).map((function(t){var e=t.type,n=t.orientation,i=t.colorStops;!function(t){var e,n,i=t.length;t[i-1].length=null!==(e=t[i-1].length)&&void 0!==e?e:{type:"%",value:"100"},i>1&&(t[0].length=null!==(n=t[0].length)&&void 0!==n?n:{type:"%",value:"0"});for(var r=0,a=Number(t[0].length.value),o=1;o<i;o++){var s,l=null===(s=t[o].length)||void 0===s?void 0:s.value;if(!ce(l)&&!ce(a)){for(var u=1;u<o-r;u++)t[r+u].length={type:"%",value:"".concat(a+(Number(l)-a)*u/(o-r))};r=o,a=Number(l)}}}(i);var r,a=i.map((function(t){return{offset:rC(Number(t.length.value),"%"),color:aC(t)}}));if("linear-gradient"===e)return new YP(HP.LinearGradient,{angle:n?dC(n):ZP,steps:a});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var o,s=fC(n[0].at),l=s.cx,u=s.cy;if(n[0].style){var c=n[0].style,h=c.type,d=c.value;"extent-keyword"===h?(tC[r=d]||(tC[r]=new $P(r)),o=tC[r]):o=rC(d,h)}return new YP(HP.RadialGradient,{cx:l,cy:u,size:o,steps:a})}}));var e=t[0];if("("===t[1]||"("===t[2])if("l"===e){var n=sC.exec(t);if(n){var i,r=(null===(i=n[2].match(cC))||void 0===i?void 0:i.map((function(t){return t.split(":")})))||[];return[new YP(HP.LinearGradient,{angle:rC(parseFloat(n[1]),"deg"),steps:r.map((function(t){var e=b(t,2),n=e[0],i=e[1];return{offset:rC(100*Number(n),"%"),color:i}}))})]}}else if("r"===e){var a=function(t){var e=lC.exec(t);if(e){var n,i=(null===(n=e[4].match(cC))||void 0===n?void 0:n.map((function(t){return t.split(":")})))||[];return{cx:rC(50,"%"),cy:rC(50,"%"),steps:i.map((function(t){var e=b(t,2),n=e[0],i=e[1];return{offset:rC(100*Number(n),"%"),color:i}}))}}return null}(t);if(a){if(!he(a))return[new YP(HP.RadialGradient,a)];t=a}}else if("p"===e)return function(t){var e=uC.exec(t);if(e){var n=e[1],i=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat"}return{image:i,repetition:n}}return null}(t)}));function gC(t){return t&&!ce(t.r)&&!ce(t.g)&&!ce(t.b)}var vC=DP((function(t){if((e=t)&&e.image)return s({repetition:"repeat"},t);var e;if(ce(t)&&(t=""),"transparent"===t)return nC;if("currentColor"===t)t="black";else if("none"===t)return eC;var n=pC(t);if(n)return n;var i=bP(t),r=[0,0,0,0];return null!==i&&(r[0]=i.r||0,r[1]=i.g||0,r[2]=i.b||0,r[3]=i.opacity),iC.apply(void 0,r)}));function yC(t,e){if(gC(t)&&gC(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(de(e[n],0,255));return e[3]=de(e[3],0,1),"rgba(".concat(e.join(","),")")}]}function mC(t,e){if(ce(e))return rC(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(t)>=0)return rC(Number(e),"px");if("deg".search(t)>=0)return rC(Number(e),"deg")}var n=[];e=e.replace(t,(function(t){return n.push(t),"U".concat(t)}));var i="U(".concat(t.source,")");return n.map((function(t){return rC(Number(e.replace(new RegExp("U".concat(t),"g"),"").replace(new RegExp(i,"g"),"*0")),t)}))[0]}var bC=function(t){return mC(new RegExp("px","g"),t)},xC=DP(bC);DP((function(t){return mC(new RegExp("%","g"),t)}));var EC=function(t){return le(t)||isFinite(Number(t))?rC(Number(t)||0,"px"):mC(new RegExp("px|%|em|rem","g"),t)},wC=DP(EC),kC=function(t){return mC(new RegExp("deg|rad|grad|turn","g"),t)},MC=DP(kC);function SC(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=XP(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=VP(t.unit)):(qP.isLength(t.unit)||qP.isLength(e.unit))&&(o=AC(t,r,n),s=AC(e,r,n),a="px"),[o,s,function(t){return i&&(t=Math.max(t,0)),t+a}]}function NC(t){var e=0;return t.unit===IP.kDegrees?e=t.value:t.unit===IP.kRadians?e=RO(Number(t.value)):t.unit===IP.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e}function TC(t,e){var n;return Array.isArray(t)?n=t.map((function(t){return Number(t)})):he(t)?n=t.split(" ").map((function(t){return Number(t)})):le(t)&&(n=[t]),2===e?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat(f(n),f(n)):n}function AC(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===IP.kPixels)return Number(t.value);if(t.unit===IP.kPercentage&&n){var r=n.nodeName===cO.GROUP?n.getLocalBounds():n.getGeometryBounds();return(i?r.min[e]:0)+t.value/100*r.halfExtents[e]*2}return 0}var OC=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function PC(t){return t.toString()}var CC=function(t){return"number"==typeof t?rC(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?rC(Number(t)):rC(0)},RC=DP(CC);function LC(t,e){return[t,e,PC]}function DC(t,e){return function(n,i){return[n,i,function(n){return PC(de(n,t,e))}]}}function IC(t,e){if(t.length===e.length)return[t,e,function(t){return t}]}function _C(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=Ye(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength}function BC(t,e){return t[0]===e[0]&&t[1]===e[1]}function FC(t,e){var n=t.prePoint,i=t.currentPoint,r=t.nextPoint,a=Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2),o=Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2),s=Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||0===Math.sin(l)||Ke(l,0))return{xExtra:0,yExtra:0};var u=Math.abs(Math.atan2(r[1]-i[1],r[0]-i[0])),c=Math.abs(Math.atan2(r[0]-i[0],r[1]-i[1]));return u=u>Math.PI/2?Math.PI-u:u,c=c>Math.PI/2?Math.PI-c:c,{xExtra:Math.cos(l/2-u)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(c-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0}}function jC(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}DP((function(t){return he(t)?t.split(" ").map(RC):t.map(RC)}));var GC=function(t,e){var n=t.x*e.x+t.y*e.y,i=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/i)},zC=function(t,e,n,i,r,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=PO(i=Ze(i,360));if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2));f=f<0?0:f;var p=(r!==a?1:-1)*Math.sqrt(f),g=p*(e*h.y/n),v=p*(-n*h.x/e),y={x:Math.cos(l)*g-Math.sin(l)*v+(t.x+o.x)/2,y:Math.sin(l)*g+Math.cos(l)*v+(t.y+o.y)/2},m={x:(h.x-g)/e,y:(h.y-v)/n},b=GC({x:1,y:0},m),x=GC(m,{x:(-h.x-g)/e,y:(-h.y-v)/n});!a&&x>0?x-=2*Math.PI:a&&x<0&&(x+=2*Math.PI);var E=b+(x%=2*Math.PI)*s,w=e*Math.cos(E),k=n*Math.sin(E);return{x:Math.cos(l)*w-Math.sin(l)*k+y.x,y:Math.sin(l)*w+Math.cos(l)*k+y.y,ellipticalArcStartAngle:b,ellipticalArcEndAngle:b+x,ellipticalArcAngle:E,ellipticalArcCenter:y,resultantRx:e,resultantRy:n}};function VC(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.arcParams,r=i.rx,a=void 0===r?0:r,o=i.ry,s=void 0===o?0:o,l=i.xRotation,u=i.arcFlag,c=i.sweepFlag,h=zC({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=zC({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,p=d.y-h.y,g=Math.sqrt(f*f+p*p);return{x:-f/g,y:-p/g}}function WC(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function UC(t,e){return WC(t)*WC(e)?(t[0]*e[0]+t[1]*e[1])/(WC(t)*WC(e)):1}function HC(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(UC(t,e))}function YC(t,e){var n=e[1],i=e[2],r=Ze(PO(e[3]),2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(r)*(s-u)/2+Math.sin(r)*(l-c)/2,d=-1*Math.sin(r)*(s-u)/2+Math.cos(r)*(l-c)/2,f=h*h/(n*n)+d*d/(i*i);f>1&&(n*=Math.sqrt(f),i*=Math.sqrt(f));var p=n*n*(d*d)+i*i*(h*h),g=p?Math.sqrt((n*n*(i*i)-p)/p):1;a===o&&(g*=-1),isNaN(g)&&(g=0);var v=i?g*n*d/i:0,y=n?g*-i*h/n:0,m=(s+u)/2+Math.cos(r)*v-Math.sin(r)*y,b=(l+c)/2+Math.sin(r)*v+Math.cos(r)*y,x=[(h-v)/n,(d-y)/i],E=[(-1*h-v)/n,(-1*d-y)/i],w=HC([1,0],x),k=HC(x,E);return UC(x,E)<=-1&&(k=Math.PI),UC(x,E)>=1&&(k=0),0===o&&k>0&&(k-=2*Math.PI),1===o&&k<0&&(k+=2*Math.PI),{cx:m,cy:b,rx:BC(t,[u,c])?0:n,ry:BC(t,[u,c])?0:i,startAngle:w,endAngle:w+k,xRotation:r,arcFlag:a,sweepFlag:o}}var $C=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Ie(t)}catch(n){e=Ie(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],i=t[e];if("M"===i[0]&&n){var r=n[0],a=[i[1],i[2]],o=void 0;"L"===r||"M"===r?o=[n[1],n[2]]:"C"!==r&&"A"!==r&&"Q"!==r||(o=[n[n.length-2],n[n.length-1]]),o&&BC(a,o)&&(t.splice(e,1),e--)}}}(e);var n=function(t){for(var e=!1,n=t.length,i=0;i<n;i++){var r=t[i][0];if("C"===r||"A"===r||"Q"===r){e=!0;break}}return e}(e),i=function(t){for(var e=[],n=[],i=[],r=0;r<t.length;r++){var a=t[r],o=a[0];"M"===o?(i.length&&(n.push(i),i=[]),i.push([a[1],a[2]])):"Z"===o?i.length&&(e.push(i),i=[]):i.push([a[1],a[2]])}return i.length>0&&n.push(i),{polygons:e,polylines:n}}(e),r=i.polygons,a=i.polylines,o=function(t){for(var e=[],n=null,i=null,r=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];i=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":r=[l[1],l[2]],a=s;break;case"A":var h=YC(n,l);c.arcParams=h}if("Z"===u)n=r,i=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]]}i&&"Z"===i[0]&&(i=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&BC(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=i?[i[i.length-2],i[i.length-1]]:null;c.nextPoint=f;var p=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];else if("Q"===u){var g=[l[1],l[2]];c.startTangent=[p[0]-g[0],p[1]-g[1]],c.endTangent=[n[0]-g[0],n[1]-g[1]]}else if("T"===u){var v=e[s-1],y=jC(v.currentPoint,p);"Q"===v.command?(c.command="Q",c.startTangent=[p[0]-y[0],p[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]])}else if("C"===u){var m=[l[1],l[2]],b=[l[3],l[4]];c.startTangent=[p[0]-m[0],p[1]-m[1]],c.endTangent=[n[0]-b[0],n[1]-b[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-b[0],m[1]-b[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[b[0]-m[0],b[1]-m[1]])}else if("S"===u){var x=e[s-1],E=jC(x.currentPoint,p),w=[l[1],l[2]];"C"===x.command?(c.command="C",c.startTangent=[p[0]-E[0],p[1]-E[1]],c.endTangent=[n[0]-w[0],n[1]-w[1]]):(c.command="SQ",c.startTangent=[p[0]-w[0],p[1]-w[1]],c.endTangent=[n[0]-w[0],n[1]-w[1]])}else if("A"===u){var k=VC(c,0),M=k.x,S=k.y,N=VC(c,1,!1),T=N.x,A=N.y;c.startTangent=[M,S],c.endTangent=[T,A]}e.push(c)}return e}(e),s=function(t){for(var e=[],n=[],i=[],r=0;r<t.length;r++){var a=t[r],o=a.currentPoint,s=a.params,l=a.prePoint,u=void 0;switch(a.command){case"Q":u=In(l[0],l[1],s[1],s[2],s[3],s[4]);break;case"C":u=Pn(l[0],l[1],s[1],s[2],s[3],s[4],s[5],s[6]);break;case"A":var c=a.arcParams;u=Mn(c.cx,c.cy,c.rx,c.ry,c.xRotation,c.startAngle,c.endAngle);break;default:e.push(o[0]),n.push(o[1])}u&&(a.box=u,e.push(u.x,u.x+u.width),n.push(u.y,u.y+u.height))}e=e.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0})),n=n.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0}));var h=Xe(e),d=Xe(n),f=qe(e),p=qe(n);if(0===i.length)return{x:h,y:d,width:f-h,height:p-d};for(var g=0;g<i.length;g++){var v=i[g],y=v.currentPoint;y[0]===h?h-=FC(v,0).xExtra:y[0]===f&&(f+=FC(v,0).xExtra),y[1]===d?d-=FC(v,0).yExtra:y[1]===p&&(p+=FC(v,0).yExtra)}return{x:h,y:d,width:f-h,height:p-d}}(o),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:r,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}}},XC=DP($C);function qC(t){return he(t)?XC(t):$C(t)}function KC(t,e,n){var i=t.curve,r=e.curve;i&&0!==i.length||(i=rn(t.absolutePath,!1),t.curve=i),r&&0!==r.length||(r=rn(e.absolutePath,!1),e.curve=r);var a=[i,r];i.length!==r.length&&(a=on(i,r));var o=sn(a[0])!==sn(a[1])?ln(a[0]):un(a[0]);return[o,cn(a[1],o),function(t){return t}]}function ZC(t,e){return[t.points,e.points,function(t){return t}]}var QC=null,JC=/\s*(\w+)\(([^)]*)\)/g;function tR(t){return function(e){var n=0;return t.map((function(t){return t===QC?e[n++]:t}))}}function eR(t){return t}var nR={matrix:["NNNNNN",[QC,QC,0,0,QC,QC,0,0,0,0,1,0,QC,QC,0,1],eR],matrix3d:["NNNNNNNNNNNNNNNN",eR],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",tR([QC,QC,new qP(1)]),eR],scaleX:["N",tR([QC,new qP(1),new qP(1)]),tR([QC,new qP(1)])],scaleY:["N",tR([new qP(1),QC,new qP(1)]),tR([new qP(1),QC])],scaleZ:["N",tR([new qP(1),new qP(1),QC])],scale3d:["NNN",eR],skew:["Aa",null,eR],skewX:["A",null,tR([QC,ZP])],skewY:["A",null,tR([ZP,QC])],translate:["Tt",tR([QC,QC,KP]),eR],translateX:["T",tR([QC,KP,KP]),tR([QC,KP])],translateY:["T",tR([KP,QC,KP]),tR([KP,QC])],translateZ:["L",tR([KP,KP,QC])],translate3d:["TTL",eR]};function iR(t){for(var e=[],n=t.length,i=0;i<n;i++){var r=t[i],a=r[0],o=r.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!nR[a])return[];var s=o.map((function(t){return rC(t)}));e.push({t:a,d:s})}return e}function rR(t){if(Array.isArray(t))return iR(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],i=0;for(JC.lastIndex=0;e=JC.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var r=e[1],a=nR[r];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var l=[],u=0;u<s.length;u++){var c,h=o[u],d=s[u];if(void 0===(c=h?{A:function(t){return"0"===t.trim()?ZP:kC(t)},N:CC,T:EC,L:bC}[d.toUpperCase()](h):{a:ZP,n:l[0],t:KP}[d]))return[];l.push(c)}if(n.push({t:r,d:l}),JC.lastIndex===t.length)return n}return[]}function aR(t){var e,n,i,r;switch(t.t){case"rotateX":return r=PO(NC(t.d[0])),[1,0,0,0,0,Math.cos(r),Math.sin(r),0,0,-Math.sin(r),Math.cos(r),0,0,0,0,1];case"rotateY":return r=PO(NC(t.d[0])),[Math.cos(r),0,-Math.sin(r),0,0,1,0,0,Math.sin(r),0,Math.cos(r),0,0,0,0,1];case"rotate":case"rotateZ":return r=PO(NC(t.d[0])),[Math.cos(r),Math.sin(r),0,0,-Math.sin(r),Math.cos(r),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,i=t.d[2].value,r=PO(NC(t.d[3]));var a=e*e+n*n+i*i;if(0===a)e=1,n=0,i=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,i/=o}var s=Math.sin(r/2),l=s*Math.cos(r/2),u=s*s;return[1-2*(n*n+i*i)*u,2*(e*n*u+i*l),2*(e*i*u-n*l),0,2*(e*n*u-i*l),1-2*(e*e+i*i)*u,2*(n*i*u+e*l),0,2*(e*i*u+n*l),2*(n*i*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=PO(NC(t.d[0])),h=PO(NC(t.d[1]));return[1,Math.tan(h),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return r=PO(NC(t.d[0])),[1,0,0,0,Math.tan(r),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return r=PO(NC(t.d[0])),[1,Math.tan(r),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=AC(t.d[0],0,null)||0,n=AC(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=AC(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=AC(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,i=AC(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=AC(t.d[0],0,null)||0,n=AC(t.d[1],0,null)||0,i=AC(t.d[2],0,null)||0,1];case"perspective":var d=AC(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,d?-1/d:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map((function(t){return t.value}))}}function oR(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function sR(t){var e=[0,0,0],n=[1,1,1],i=[0,0,0],r=[0,0,0,1],a=[0,0,0,1];return function(t,e,n,i,r,a){if(!function(t,e){var n=e[15];if(0===n)return!1;for(var i=1/n,r=0;r<16;r++)t[r]=e[r]*i;return!0}(_O,t))return!1;if(Z(BO,_O),BO[3]=0,BO[7]=0,BO[11]=0,BO[15]=1,Math.abs(rt(BO))<1e-8)return!1;var o,s,l=_O[3],u=_O[7],c=_O[11],h=_O[12],d=_O[13],f=_O[14],p=_O[15];if(0!==l||0!==u||0!==c){if(FO[0]=l,FO[1]=u,FO[2]=c,FO[3]=p,!nt(BO,BO))return!1;et(BO,BO),X(r,FO,BO)}else r[0]=r[1]=r[2]=0,r[3]=1;if(e[0]=h,e[1]=d,e[2]=f,s=_O,(o=jO)[0][0]=s[0],o[0][1]=s[1],o[0][2]=s[2],o[1][0]=s[4],o[1][1]=s[5],o[1][2]=s[6],o[2][0]=s[8],o[2][1]=s[9],o[2][2]=s[10],n[0]=S(jO[0]),I(jO[0],jO[0]),i[0]=_(jO[0],jO[1]),zO(jO[1],jO[1],jO[0],1,-i[0]),n[1]=S(jO[1]),I(jO[1],jO[1]),i[0]/=n[1],i[1]=_(jO[0],jO[2]),zO(jO[2],jO[2],jO[0],1,-i[1]),i[2]=_(jO[1],jO[2]),zO(jO[2],jO[2],jO[1],1,-i[2]),n[2]=S(jO[2]),I(jO[2],jO[2]),i[1]/=n[2],i[2]/=n[2],B(GO,jO[1],jO[2]),_(jO[0],GO)<0)for(var g=0;g<3;g++)n[g]*=-1,jO[g][0]*=-1,jO[g][1]*=-1,jO[g][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+jO[0][0]-jO[1][1]-jO[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-jO[0][0]+jO[1][1]-jO[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-jO[0][0]-jO[1][1]+jO[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+jO[0][0]+jO[1][1]+jO[2][2],0)),jO[2][1]>jO[1][2]&&(a[0]=-a[0]),jO[0][2]>jO[2][0]&&(a[1]=-a[1]),jO[1][0]>jO[0][1]&&(a[2]=-a[2])}(function(t){return 0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(aR).reduce(oR)}(t),e,n,i,r,a),[[e,n,i,a,r]]}var lR=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],i=0;i<4;i++)for(var r=0;r<4;r++)for(var a=0;a<4;a++)n[i][r]+=e[i][a]*t[a][r];return n}return function(e,n,i,r,a){for(var o=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],s=0;s<4;s++)o[s][3]=a[s];for(var l=0;l<3;l++)for(var u=0;u<3;u++)o[3][l]+=e[u]*o[u][l];var c=r[0],h=r[1],d=r[2],f=r[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(h*h+d*d),p[0][1]=2*(c*h-d*f),p[0][2]=2*(c*d+h*f),p[1][0]=2*(c*h+d*f),p[1][1]=1-2*(c*c+d*d),p[1][2]=2*(h*d-c*f),p[2][0]=2*(c*d-h*f),p[2][1]=2*(h*d+c*f),p[2][2]=1-2*(c*c+h*h),o=t(o,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];i[2]&&(g[2][1]=i[2],o=t(o,g)),i[1]&&(g[2][1]=0,g[2][0]=i[0],o=t(o,g)),i[0]&&(g[2][0]=0,g[1][0]=i[0],o=t(o,g));for(var v=0;v<3;v++)for(var y=0;y<3;y++)o[v][y]*=n[v];return function(t){return 0===t[0][2]&&0===t[0][3]&&0===t[1][2]&&0===t[1][3]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]&&0===t[2][3]&&0===t[3][2]&&1===t[3][3]}(o)?[o[0][0],o[0][1],o[1][0],o[1][1],o[3][0],o[3][1]]:o[0].concat(o[1],o[2],o[3])}}();function uR(t){return t.toFixed(6).replace(".000000","")}function cR(t,e){var n,i;return t.decompositionPair!==e&&(t.decompositionPair=e,n=sR(t)),e.decompositionPair!==t&&(e.decompositionPair=t,i=sR(e)),null===n[0]||null===i[0]?[[!1],[!0],function(n){return n?e[0].d:t[0].d}]:(n[0].push(0),i[0].push(1),[n,i,function(t){var e=function(t,e,n){var i=function(t,e){for(var n=0,i=0;i<t.length;i++)n+=t[i]*e[i];return n}(t,e),r=[];if(1===(i=de(i,-1,1)))r=t;else for(var a=Math.acos(i),o=1*Math.sin(n*a)/Math.sqrt(1-i*i),s=0;s<4;s++)r.push(t[s]*(Math.cos(n*a)-i*o)+e[s]*o);return r}(n[0][3],i[0][3],t[5]);return lR(t[0],t[1],t[2],e,t[4]).map(uR).join(",")}])}function hR(t){return t.replace(/[XY]/,"")}function dR(t){return t.replace(/(X|Y|Z|3d)?$/,"3d")}function fR(t,e,n){var i=!1;if(!t.length||!e.length){t.length||(i=!0,t=e,e=[]);for(var r=function(){var n=t[a],i=n.t,r=n.d,o="scale"===i.substring(0,5)?1:0;e.push({t:i,d:r.map((function(t){return"number"==typeof t?rC(o):rC(o,t.unit)}))})},a=0;a<t.length;a++)r()}var o,s,l=[],u=[],c=[];if(t.length!==e.length){var h=cR(t,e);l=[h[0]],u=[h[1]],c=[["matrix",[h[2]]]]}else for(var d=0;d<t.length;d++){var f=t[d].t,p=e[d].t,g=t[d].d,v=e[d].d,y=nR[f],m=nR[p],b=void 0;if(s=p,"perspective"===(o=f)&&"perspective"===s||!("matrix"!==o&&"matrix3d"!==o||"matrix"!==s&&"matrix3d"!==s)){var x=cR([t[d]],[e[d]]);l.push(x[0]),u.push(x[1]),c.push(["matrix",[x[2]]])}else{if(f===p)b=f;else if(y[2]&&m[2]&&hR(f)===hR(p))b=hR(f),g=y[2](g),v=m[2](v);else{if(!y[1]||!m[1]||dR(f)!==dR(p)){var E=cR(t,e);l=[E[0]],u=[E[1]],c=[["matrix",[E[2]]]];break}b=dR(f),g=y[1](g),v=m[1](v)}for(var w=[],k=[],M=[],S=0;S<g.length;S++){var N=SC(g[S],v[S],n,!1,S);w[S]=N[0],k[S]=N[1],M.push(N[2])}l.push(w),u.push(k),c.push([b,M])}}if(i){var T=l;l=u,u=T}return[l,u,function(t){return t.map((function(t,e){var n=t.map((function(t,n){return c[e][1][n](t)})).join(",");return"matrix"===c[e][0]&&16===n.split(",").length&&(c[e][0]="matrix3d"),"matrix3d"===c[e][0]&&6===n.split(",").length&&(c[e][0]="matrix"),"".concat(c[e][0],"(").concat(n,")")})).join(" ")}]}var pR=DP((function(t){if(he(t)){if("text-anchor"===t)return[rC(0,"px"),rC(0,"px")];var e=t.split(" ");return 1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length?null:[wC(gR(e[0])),wC(gR(e[1]))]}return[rC(t[0]||0,"px"),rC(t[1]||0,"px")]}));function gR(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t}var vR=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:tP.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:tP.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:tP.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:tP.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:tP.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:tP.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:tP.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:tP.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:tP.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:tP.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:tP.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:tP.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:tP.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:tP.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:tP.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:tP.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:tP.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:tP.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:tP.FILTER},{n:"clipPath",syntax:tP.DEFINED_PATH},{n:"textPath",syntax:tP.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:tP.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:tP.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:tP.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:tP.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:tP.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:tP.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:tP.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:tP.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:tP.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:tP.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:tP.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:tP.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:tP.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:tP.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:tP.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:tP.COORDINATE},{n:"y1",int:!0,l:!0,syntax:tP.COORDINATE},{n:"z1",int:!0,l:!0,syntax:tP.COORDINATE},{n:"x2",int:!0,l:!0,syntax:tP.COORDINATE},{n:"y2",int:!0,l:!0,syntax:tP.COORDINATE},{n:"z2",int:!0,l:!0,syntax:tP.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:tP.PATH,p:50},{n:"points",int:!0,l:!0,syntax:tP.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:tP.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:tP.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:tP.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:tP.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:tP.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:tP.NUMBER,d:function(t){return t===cO.PATH||t===cO.POLYGON||t===cO.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:tP.MARKER},{n:"markerEnd",syntax:tP.MARKER},{n:"markerMid",syntax:tP.MARKER},{n:"markerStartOffset",syntax:tP.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:tP.LENGTH,l:!0,int:!0,d:"0"}],yR=new Set(vR.filter((function(t){return!!t.l})).map((function(t){return t.n}))),mR={},bR=function(){return c((function t(e){var n=this;l(this,t),this.runtime=e,vR.forEach((function(t){n.registerMetadata(t)}))}),[{key:"registerMetadata",value:function(t){[t.n].concat(f(t.a||[])).forEach((function(e){mR[e]=t}))}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,r=t.parsedStyle.offsetPath;!function(t,e){var n=xR(t);for(var i in e)n.has(i)&&(t.parsedStyle[i]=e[i])}(t,e);var a=!!n.forceUpdateGeometry;if(!a)for(var o in e)if(yR.has(o)){a=!0;break}var l,u=xR(t);u.has("fill")&&e.fill&&(t.parsedStyle.fill=vC(e.fill)),u.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=vC(e.stroke)),u.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=vC(e.shadowColor)),u.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,i=[],r=0;e=n.exec(t);){if(e.index!==r)return[];if(r=e.index+e[0].length,OC.indexOf(e[1])>-1&&i.push({name:e[1],params:e[2].split(" ").map((function(t){return mC(/deg|rad|grad|turn|px|%/g,t)||vC(t)}))}),n.lastIndex===t.length)return i}return[]}(e.filter)),u.has("radius")&&!ce(e.radius)&&(t.parsedStyle.radius=TC(e.radius,4)),u.has("lineDash")&&!ce(e.lineDash)&&(t.parsedStyle.lineDash=TC(e.lineDash,"even")),u.has("points")&&e.points&&(t.parsedStyle.points={points:he(l=e.points)?l.split(" ").map((function(t){var e=b(t.split(","),2),n=e[0],i=e[1];return[Number(n),Number(i)]})):l,totalLength:0,segments:[]}),u.has("d")&&""===e.d&&(t.parsedStyle.d=s({},JO)),u.has("d")&&e.d&&(t.parsedStyle.d=qC(e.d)),u.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[tP.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),u.has("clipPath")&&!hn(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[tP.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),u.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[tP.DEFINED_PATH].calculator("offsetPath",r,e.offsetPath,t,this.runtime),u.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return iR(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],i=0;for(JC.lastIndex=0;e=JC.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var r=e[1],a=nR[r];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var l=[],u=0;u<s.length;u++){var c,h=o[u],d=s[u];if(void 0===(c=h?{A:function(t){return"0"===t.trim()?ZP:MC(t)},N:RC,T:wC,L:xC}[d.toUpperCase()](h):{a:ZP,n:l[0],t:KP}[d]))return[];l.push(c)}if(n.push({t:r,d:l}),JC.lastIndex===t.length)return n}return[]}(e.transform)),u.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=pR(e.transformOrigin)),u.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[tP.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),u.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[tP.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),u.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[tP.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),u.has("zIndex")&&!ce(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[tP.Z_INDEX].postProcessor(t),u.has("offsetDistance")&&!ce(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[tP.OFFSET_DISTANCE].postProcessor(t),u.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[tP.TRANSFORM].postProcessor(t),u.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[tP.TRANSFORM_ORIGIN].postProcessor(t),a&&(t.geometry.dirty=!0,t.dirty(!0,!0),n.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t))}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var i=t.geometry;i.contentBounds||(i.contentBounds=new xO),i.renderBounds||(i.renderBounds=new xO);var r=t.parsedStyle,a=n.update(r,t),o=a.cx,s=void 0===o?0:o,l=a.cy,u=void 0===l?0:l,c=a.cz,h=void 0===c?0:c,d=a.hwidth,f=void 0===d?0:d,p=a.hheight,g=void 0===p?0:p,v=a.hdepth,y=void 0===v?0:v,m=[Math.abs(f),Math.abs(g),y],b=r.stroke,x=r.lineWidth,E=void 0===x?1:x,w=r.increasedLineWidthForHitTesting,k=void 0===w?0:w,M=r.shadowType,S=void 0===M?"outer":M,N=r.shadowColor,T=r.filter,A=void 0===T?[]:T,P=r.transformOrigin,C=[s,u,h];i.contentBounds.update(C,m);var R=e===cO.POLYLINE||e===cO.POLYGON||e===cO.PATH?Math.SQRT2:.5;if(b&&!b.isNone){var L=((E||0)+(k||0))*R;m[0]+=L,m[1]+=L}if(i.renderBounds.update(C,m),N&&S&&"inner"!==S){var D=i.renderBounds,I=D.min,_=D.max,B=r.shadowBlur||0,F=r.shadowOffsetX||0,j=r.shadowOffsetY||0,G=I[0]-B+F,z=_[0]+B+F,V=I[1]-B+j,W=_[1]+B+j;I[0]=Math.min(I[0],G),_[0]=Math.max(_[0],z),I[1]=Math.min(I[1],V),_[1]=Math.max(_[1],W),i.renderBounds.setMinMax(I,_)}A.forEach((function(t){var e=t.name,n=t.params;if("blur"===e){var r=n[0].value;i.renderBounds.update(i.renderBounds.center,O(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[r,r,0]))}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=i.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,p=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],p),i.renderBounds.setMinMax(u,c)}})),t.geometry.dirty=!1;var U=g<0,H=(f<0?-1:1)*(P?AC(P[0],0,t,!0):0),Y=(U?-1:1)*(P?AC(P[1],1,t,!0):0);(H||Y)&&t.setOrigin(H,Y)}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===cO.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===cO.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}])}();function xR(t){return t.constructor.PARSED_STYLE_LIST}var ER=function(){return c((function t(){l(this,t),this.mixer=LC}),[{key:"calculator",value:function(t,e,n,i){return NC(n)}}])}(),wR=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i,r){return n instanceof $P&&(n=null),r.sceneGraphService.updateDisplayObjectDependency(t,e,n,i),"clipPath"===t&&i.forEach((function(t){0===t.childNodes.length&&r.sceneGraphService.dirtyToRoot(t)})),n}}])}(),kR=function(){return c((function t(){l(this,t),this.parser=vC,this.mixer=yC}),[{key:"calculator",value:function(t,e,n,i){return n instanceof $P?"none"===n.value?eC:nC:n}}])}(),MR=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n){return n instanceof $P?[]:n}}])}();function SR(t){var e=t.parsedStyle.fontSize;return ce(e)?null:e}var NR=function(){return c((function t(){l(this,t),this.mixer=LC}),[{key:"calculator",value:function(t,e,n,i,r){if(le(n))return n;if(!qP.isRelativeUnit(n.unit))return n.value;if(n.unit===IP.kPercentage)return 0;if(n.unit===IP.kEms){if(i.parentNode){var a=SR(i.parentNode);if(a)return a*n.value}return 0}if(n.unit===IP.kRems){var o;if(null!=i&&null!==(o=i.ownerDocument)&&void 0!==o&&o.documentElement){var s=SR(i.ownerDocument.documentElement);if(s)return s*n.value}return 0}}}])}(),TR=function(){return c((function t(){l(this,t),this.mixer=IC}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),AR=function(){return c((function t(){l(this,t),this.mixer=IC}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),OR=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){var r;n instanceof $P&&(n=null);var a=null===(r=n)||void 0===r?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a}}])}(),PR=function(){return c((function t(){l(this,t),this.mixer=LC}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),CR=function(){return c((function t(){l(this,t),this.mixer=DC(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,i=e.offsetDistance;if(n){var r=n.nodeName;if(r===cO.LINE||r===cO.PATH||r===cO.POLYLINE){var a=n.getPoint(i);a&&t.setLocalPosition(a.x,a.y)}}}}])}(),RR=function(){return c((function t(){l(this,t),this.mixer=DC(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),LR=function(){return c((function t(){l(this,t),this.parser=qC,this.mixer=KC}),[{key:"calculator",value:function(t,e,n){return n instanceof $P&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new MO(0,0,0,0)}:n}}])}(),DR=c((function t(){l(this,t),this.mixer=ZC})),IR=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).mixer=DC(0,1/0),t}return m(e,t),c(e)}(NR),_R=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){return n instanceof $P?"unset"===n.value?"":n.value:"".concat(n)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}])}(),BR=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){var r=i.getAttribute("text");if(r){var a=r;"capitalize"===n.value?a=r.charAt(0).toUpperCase()+r.slice(1):"lowercase"===n.value?a=r.toLowerCase():"uppercase"===n.value&&(a=r.toUpperCase()),i.parsedStyle.text=a}return n.value}}])}();new WeakMap,"undefined"!=typeof window&&window.document;var FR={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},jR="object"==typeof performance&&performance.now?performance:Date;function GR(t){return t.nodeName===cO.FRAGMENT||t.getRootNode().nodeName===cO.FRAGMENT}var zR=1,VR="object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:{},WR=Date.now(),UR={},HR=Date.now(),YR=function(t){if("function"!=typeof t)throw new TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-HR,i=n>16?0:16-n,r=zR++;return UR[r]=t,Object.keys(UR).length>1||setTimeout((function(){HR=e;var t=UR;UR={},Object.keys(t).forEach((function(e){return t[e](VR.performance&&"function"==typeof VR.performance.now?VR.performance.now():Date.now()-WR)}))}),i),r},$R=function(t){delete UR[t]},XR=function(t){return"string"!=typeof t?YR:""===t?VR.requestAnimationFrame:VR["".concat(t,"RequestAnimationFrame")]},qR=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1}}(["","webkit","moz","ms","o"],(function(t){return!!XR(t)})),KR=XR(qR),ZR=function(t){return"string"!=typeof t?$R:""===t?VR.cancelAnimationFrame:VR["".concat(t,"CancelAnimationFrame")]||VR["".concat(t,"CancelRequestAnimationFrame")]}(qR);VR.requestAnimationFrame=KR,VR.cancelAnimationFrame=ZR;var QR=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],JR=/([\"\'])[^\'\"]+\1/;function tL(t){var e=t.fontSize,n=void 0===e?16:e,i=t.fontFamily,r=void 0===i?"sans-serif":i,a=t.fontStyle,o=void 0===a?"normal":a,s=t.fontVariant,l=void 0===s?"normal":s,u=t.fontWeight;return{fontSize:n,fontFamily:r,fontStyle:o,fontVariant:l,fontWeight:void 0===u?"normal":u}}var eL=DP((function(t){for(var e=tL(t),n=e.fontSize,i=e.fontFamily,r=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=le(n)&&"".concat(n,"px")||"16px",l=i.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!JR.test(c)&&QR.indexOf(c)<0&&(c='"'.concat(c,'"')),l[u]=c}return"".concat(r," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","))}),(function(t){var e=tL(t),n=e.fontSize,i=e.fontFamily,r=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(r,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(i)})),nL=function(t){return Math.max(t,1e-6)};function iL(t,e,n){return tt(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t}var rL=q(),aL=q(),oL={scale:function(t){ft(rL,[t[0].value,t[1].value,1].map((function(t){return nL(t)})))},scaleX:function(t){ft(rL,[t[0].value,1,1].map((function(t){return nL(t)})))},scaleY:function(t){ft(rL,[1,t[0].value,1].map((function(t){return nL(t)})))},scaleZ:function(t){ft(rL,[1,1,t[0].value].map((function(t){return nL(t)})))},scale3d:function(t){ft(rL,[t[0].value,t[1].value,t[2].value].map((function(t){return nL(t)})))},translate:function(t){dt(rL,[t[0].value,t[1].value,0])},translateX:function(t){dt(rL,[t[0].value,0,0])},translateY:function(t){dt(rL,[0,t[0].value,0])},translateZ:function(t){dt(rL,[0,0,t[0].value])},translate3d:function(t){dt(rL,[t[0].value,t[1].value,t[2].value])},rotate:function(t){yt(rL,PO(NC(t[0])))},rotateX:function(t){gt(rL,PO(NC(t[0])))},rotateY:function(t){vt(rL,PO(NC(t[0])))},rotateZ:function(t){yt(rL,PO(NC(t[0])))},rotate3d:function(t){pt(rL,PO(NC(t[3])),[t[0].value,t[1].value,t[2].value])},skew:function(t){iL(rL,PO(t[0].value),PO(t[1].value))},skewX:function(t){iL(rL,PO(t[0].value),0)},skewY:function(t){iL(rL,0,PO(t[0].value))},matrix:function(t){J(rL,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1)},matrix3d:function(e){J.apply(t,[rL].concat(f(e.map((function(t){return t.value})))))}},sL=N(1,1,1),lL=k(),uL={translate:function(t,e){oD.sceneGraphService.setLocalScale(t,sL,!1),oD.sceneGraphService.setLocalEulerAngles(t,lL,void 0,void 0,!1),oD.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),oD.sceneGraphService.dirtyLocalTransform(t,t.transformable)}},cL=function(){return c((function t(){l(this,t),this.parser=rR,this.mixer=fR}),[{key:"calculator",value:function(t,e,n,i){return n instanceof $P?[]:n}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&uL[t[0].t])return void uL[t[0].t](e,t[0].d);for(var n=tt(aL),i=0;i<t.length;i++){var r=t[i],a=r.t,o=r.d,s=oL[a];s&&(s(o),Ut(n,n,rL))}e.setLocalTransform(n)}else e.resetLocalTransform();e.getLocalTransform()}(t.parsedStyle.transform,t)}}])}(),hL=function(){return c((function t(){l(this,t)}),[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===IP.kPixels&&e[1].unit===IP.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds()}}])}(),dL=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){return n.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,i=e.sortable;n&&e.dirty(),i&&(i.dirty=!0,i.dirtyReason=XO.Z_INDEX_CHANGED)}}}])}(),fL=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,i=void 0===n?0:n,r=t.cy,a=void 0===r?0:r,o=t.r,s=void 0===o?0:o;return{cx:i,cy:a,hwidth:s,hheight:s}}}])}(),pL=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,i=void 0===n?0:n,r=t.cy,a=void 0===r?0:r,o=t.rx,s=void 0===o?0:o,l=t.ry;return{cx:i,cy:a,hwidth:s,hheight:void 0===l?0:l}}}])}(),gL=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){var e=t.x1,n=t.y1,i=t.x2,r=t.y2,a=Math.min(e,i),o=Math.max(e,i),s=Math.min(n,r),l=(o-a)/2,u=(Math.max(n,r)-s)/2;return{cx:a+l,cy:s+u,hwidth:l,hheight:u}}}])}(),vL=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){var e=t.d.rect,n=e.x,i=e.y,r=e.width/2,a=e.height/2;return{cx:n+r,cy:i+a,hwidth:r,hheight:a}}}])}(),yL=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){if(t.points&&$e(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,f(e.map((function(t){return t[0]})))),i=Math.max.apply(Math,f(e.map((function(t){return t[0]})))),r=Math.min.apply(Math,f(e.map((function(t){return t[1]})))),a=Math.max.apply(Math,f(e.map((function(t){return t[1]})))),o=(i-n)/2,s=(a-r)/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),mL=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.x,i=void 0===n?0:n,r=t.y,a=void 0===r?0:r,o=t.src,s=t.width,l=void 0===s?0:s,u=t.height,c=l,h=void 0===u?0:u;return o&&!he(o)&&(c||(c=o.width,t.width=c),h||(h=o.height,t.height=h)),{cx:i+c/2,cy:a+h/2,hwidth:c/2,hheight:h/2}}}])}(),bL=function(){return c((function t(e){l(this,t),this.globalRuntime=e}),[{key:"isReadyToMeasure",value:function(t,e){return t.text}},{key:"update",value:function(t,e){var n,i=t.text,r=t.textAlign,a=void 0===r?"start":r,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,p=t.x,g=void 0===p?0:p,v=t.y,y=void 0===v?0:v;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var m=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(i,t,m);t.metrics=b;var x=b.width/2,E=b.height/2,w=g+x;"center"===a||"middle"===a?w+=s/2-x:"right"!==a&&"end"!==a||(w+=s-2*x);var k=y-E;return"middle"===u?k+=E:"top"===u||"hanging"===u?k+=2*E:"alphabetic"===u||"bottom"!==u&&"ideographic"!==u||(k+=0),h&&(w+=h),f&&(k+=f),{cx:w,cy:k,hwidth:x,hheight:E}}}])}(),xL=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),EL=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.x,i=void 0===n?0:n,r=t.y,a=void 0===r?0:r,o=t.width,s=void 0===o?0:o,l=t.height,u=void 0===l?0:l;return{cx:i+s/2,cy:a+u/2,hwidth:s/2,hheight:u/2}}}])}(),wL=function(){return c((function t(e){l(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new kO,this.page=new kO,this.canvas=new kO,this.viewport=new kO,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}),[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(SO)}}])}(),kL=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).client=new kO,t.movement=new kO,t.offset=new kO,t.global=new kO,t.screen=new kO,t}return m(e,t),c(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw new Error(SO)}}])}(wL),ML=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).width=0,t.height=0,t.isPrimary=!1,t}return m(e,t),c(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(kL),SL=function(t){function e(){return l(this,e),v(this,e,arguments)}return m(e,t),c(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(kL),NL=function(t){function e(t,n){var i;return l(this,e),(i=v(this,e,[null])).type=t,i.detail=n,Object.assign(i,n),i}return m(e,t),c(e)}(wL),TL=function(){return c((function t(){l(this,t),this.emitter=new x}),[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this}},{key:"addEventListener",value:function(t,e,n){var i=!1,r=!1;if(pn(n))i=n;else if(n){var a=n.capture;i=void 0!==a&&a;var o=n.once;r=void 0!==o&&o}i&&(t+="capture"),e=gn(e)?e:e.handleEvent;var s=gn(e)?void 0:e;return r?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,e,n){var i;if(!this.emitter)return this;(pn(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=gn(e)?e:null===(i=e)||void 0===i?void 0:i.handleEvent;var r=gn(e)?void 0:e;return this.emitter.off(t,e,r),this}},{key:"emit",value:function(t,e){this.dispatchEvent(new NL(t,e))}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t)}},{key:"dispatchEvent",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(arguments.length>2?arguments[2]:void 0)return this.dispatchEventToSelf(t),!0;if(this.document)e=this;else if(this.defaultView)e=this.defaultView;else{var i;e=null===(i=this.ownerDocument)||void 0===i?void 0:i.defaultView}if(e){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],n||(t.target=this),t.manager.dispatchEvent(t,t.type,n)}else this.dispatchEventToSelf(t);return!t.defaultPrevented}}])}(),AL=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t.destroyed=!1,t}return m(e,t),c(e,[{key:"textContent",get:function(){var t="";this.nodeName===cO.TEXT&&(t+=this.style.text);var e,n=Gn(this.childNodes);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.nodeName===cO.TEXT?t+=i.nodeValue:t+=i.textContent}}catch(t){n.e(t)}finally{n.f()}return t},set:function(t){var e=this;this.childNodes.slice().forEach((function(t){e.removeChild(t)})),this.nodeName===cO.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(t){throw new Error(SO)}},{key:"lookupNamespaceURI",value:function(t){throw new Error(SO)}},{key:"lookupPrefix",value:function(t){throw new Error(SO)}},{key:"normalize",value:function(){throw new Error(SO)}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n=t,i=this,r=[n],a=[i];null!==(o=n.parentNode)&&void 0!==o?o:i.parentNode;){var o;n=n.parentNode?(r.push(n.parentNode),n.parentNode):n,i=i.parentNode?(a.push(i.parentNode),i.parentNode):i}if(n!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=r.length>a.length?r:a,l=s===r?a:r;if(s[s.length-l.length]===l[0])return s===r?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;return f.indexOf(h)<f.indexOf(d)?l===r?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:s===r?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var i=n.childNodes.length-1;i>=0;i--)e.push(n.childNodes[i])}}}],[{key:"isNode",value:function(t){return!!t.childNodes}}])}(TL);AL.DOCUMENT_POSITION_DISCONNECTED=1,AL.DOCUMENT_POSITION_PRECEDING=2,AL.DOCUMENT_POSITION_FOLLOWING=4,AL.DOCUMENT_POSITION_CONTAINS=8,AL.DOCUMENT_POSITION_CONTAINED_BY=16,AL.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var OL=function(){return c((function t(){l(this,t)}),[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||oD.offscreenCanvas)this.canvas=t||oD.offscreenCanvas,this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(t){}try{return document.createElement("canvas")}catch(t){}return null}}])}(),PL=/\[\s*(.*)=(.*)\s*\]/,CL=function(){return c((function t(){l(this,t)}),[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find((function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.find((function(e){return e.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var i=this.getAttribute(t),r=i.name,a=i.value;return r?e.find((function(t){return e!==t&&("name"===r?t.name===a:n.attributeToString(t,r)===a)})):null}return e.find((function(n){return e!==n&&n.nodeName===t}))}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll((function(i){return e!==i&&((null==i?void 0:i.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.findAll((function(i){return e!==i&&i.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var i=this.getAttribute(t),r=i.name,a=i.value;return r?e.findAll((function(t){return e!==t&&("name"===r?t.name===a:n.attributeToString(t,r)===a)})):[]}return e.findAll((function(n){return e!==n&&n.nodeName===t}))}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),i=n.name,r=n.value;return"name"===i?e.name===r:this.attributeToString(e,i)===r}return e.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var e=t.match(PL),n="",i="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),i=e[2].replace(/"/g,"")),{name:n,value:i}}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return ce(n)?"":n.toString?n.toString():""}}])}(),RL=function(t){return t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.MOUNTED="DOMNodeInsertedIntoDocument",t.REMOVED="removed",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.REPARENT="reparent",t.DESTROY="destroy",t.BOUNDS_CHANGED="bounds-changed",t.CULLED="culled",t}({}),LL=function(t){function e(t,n,i,r,a,o,s,u){var c;return l(this,e),(c=v(this,e,[null])).relatedNode=n,c.prevValue=i,c.newValue=r,c.attrName=a,c.attrChange=o,c.prevParsedValue=s,c.newParsedValue=u,c.type=t,c}return m(e,t),c(e)}(wL);LL.ADDITION=2,LL.MODIFICATION=1,LL.REMOVAL=3;var DL=new LL(RL.REPARENT,null,"","","",0,"",""),IL=ae(),_L=k(),BL=N(1,1,1),FL=q(),jL=ae(),GL=k(),zL=q(),VL=qt(),WL=k(),UL=qt(),HL=k(),YL=k(),$L=k(),XL=q(),qL=qt(),KL=qt(),ZL=qt(),QL={affectChildren:!0},JL=function(){return c((function t(e){l(this,t),this.pendingEvents=new Map,this.boundsChangedEvent=new NL(RL.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e}),[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e)}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e)}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e)}},{key:"attach",value:function(t,e,n){var i,r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var a=t.nodeName===cO.FRAGMENT,o=GR(e);t.parentNode=e;var s=a?t.childNodes:[t];le(n)?s.forEach((function(t){e.childNodes.splice(n,0,t),t.parentNode=e})):s.forEach((function(t){e.childNodes.push(t),t.parentNode=e}));var l=e.sortable;if((null!=l&&null!==(i=l.sorted)&&void 0!==i&&i.length||l.dirty||t.parsedStyle.zIndex)&&(-1===l.dirtyChildren.indexOf(t)&&l.dirtyChildren.push(t),l.dirty=!0,l.dirtyReason=XO.ADDED),!o){if(a)this.dirtifyFragment(t);else{var u=t.transformable;u&&this.dirtyWorldTransform(t,u)}if(r){var c,h=!0===(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation);t.dispatchEvent(DL,h,h)}}}},{key:"detach",value:function(t){var e,n;if(t.parentNode){var i=t.transformable,r=t.parentNode.sortable;(null!=r&&null!==(e=r.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===r.dirtyChildren.indexOf(t)&&r.dirtyChildren.push(t),r.dirty=!0,r.dirtyReason=XO.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),i&&this.dirtyWorldTransform(t,i),t.parentNode=null}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return QO(e),e.localTransform}},{key:"setLocalPosition",value:function(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.transformable;YL[0]=e[0],YL[1]=e[1],YL[2]=null!==(n=e[2])&&void 0!==n?n:0,V(r.localPosition,YL)||(T(r.localPosition,YL),i&&this.dirtyLocalTransform(t,r))}},{key:"translateLocal",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;V(e,_L)||(z(e,e,n.localRotation),O(n.localPosition,n.localPosition,e),this.dirtyLocalTransform(t,n))}},{key:"setLocalRotation",value:function(t,e,n,i,r){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];"number"==typeof e&&(e=ne(VL,e,n,i,r));var o=t.transformable;ee(o.localRotation,e),a&&this.dirtyLocalTransform(t,o)}},{key:"rotateLocal",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;Jt(KL,e[0],e[1],e[2]),ie(n.localRotation,n.localRotation,KL),this.dirtyLocalTransform(t,n)}},{key:"setLocalScale",value:function(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.transformable;A(GL,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:r.localScale[2]),V(GL,r.localScale)||(T(r.localScale,GL),i&&this.dirtyLocalTransform(t,r))}},{key:"scaleLocal",value:function(t,e){var n,i=t.transformable;C(i.localScale,i.localScale,A(GL,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,i)}},{key:"setLocalSkew",value:function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];"number"==typeof e&&(e=se(jL,e,n));var r=t.transformable;oe(r.localSkew,e),i&&this.dirtyLocalTransform(t,r)}},{key:"setLocalEulerAngles",value:function(t,e){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var i=t.transformable;Jt(i.localRotation,e[0],e[1],e[2]),n&&this.dirtyLocalTransform(t,i)}},{key:"setLocalTransform",value:function(t,e){var n=xt(WL,e),i=wt(UL,e),r=Et(HL,e);this.setLocalScale(t,r,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,i,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,BL,!1),this.setLocalPosition(t,_L,!1),this.setLocalEulerAngles(t,_L,void 0,void 0,!1),this.setLocalSkew(t,IL,void 0,!1),this.dirtyLocalTransform(t,t.transformable)}},{key:"getPosition",value:function(t){var e=t.transformable;return xt(e.position,this.getWorldTransform(t,e))}},{key:"getRotation",value:function(t){var e=t.transformable;return wt(e.rotation,this.getWorldTransform(t,e))}},{key:"getScale",value:function(t){var e=t.transformable;return Et(e.scaling,this.getWorldTransform(t,e))}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return e.localDirtyFlag||e.dirtyFlag?(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t),e.worldTransform):e.worldTransform}},{key:"setPosition",value:function(t,e){var n,i=t.transformable;if($L[0]=e[0],$L[1]=e[1],$L[2]=null!==(n=e[2])&&void 0!==n?n:0,!V(this.getPosition(t),$L)){if(T(i.position,$L),null!==t.parentNode&&t.parentNode.transformable){var r=t.parentNode.transformable;Z(XL,r.worldTransform),nt(XL,XL),j(i.localPosition,$L,XL)}else T(i.localPosition,$L);this.dirtyLocalTransform(t,i)}}},{key:"translate",value:function(t,e){"number"==typeof e&&(e=A(GL,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)),V(e,_L)||(O(GL,this.getPosition(t),e),this.setPosition(t,GL))}},{key:"setRotation",value:function(t,e,n,i,r){var a=t.transformable;if("number"==typeof e&&(e=te(e,n,i,r)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);ee(VL,o),Qt(VL,VL),Zt(a.localRotation,VL,e),re(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a)}else this.setLocalRotation(t,e)}},{key:"rotate",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){var i=VL;Jt(i,e[0],e[1],e[2]);var r=this.getRotation(t),a=this.getRotation(t.parentNode);ee(ZL,a),Qt(ZL,ZL),Zt(i,ZL,i),Zt(n.localRotation,i,r),re(n.localRotation,n.localRotation),this.dirtyLocalTransform(t,n)}else this.rotateLocal(t,e)}},{key:"setOrigin",value:function(t,e){"number"==typeof e&&(e=[e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0]);var n=t.transformable;if(e[0]!==n.origin[0]||e[1]!==n.origin[1]||e[2]!==n.origin[2]){var i=n.origin;i[0]=e[0],i[1]=e[1],i[2]=e[2]||0,this.dirtyLocalTransform(t,n)}}},{key:"setEulerAngles",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){Jt(n.localRotation,e[0],e[1],e[2]);var i=this.getRotation(t.parentNode);ee(qL,Qt(VL,i)),ie(n.localRotation,n.localRotation,qL),this.dirtyLocalTransform(t,n)}else this.setLocalEulerAngles(t,e)}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=this.getGeometryBounds(t,e);if(!xO.isEmpty(i)){var r=n||new xO;return r.setFromTransformedAABB(i,this.getWorldTransform(t)),r}return null}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&oD.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new xO}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.renderable;if(!i.boundsDirty&&!n&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&n&&i.renderBounds)return i.renderBounds;var r=n?i.renderBounds:i.bounds,a=this.getTransformedGeometryBounds(t,n,r);if(t.childNodes.forEach((function(t){var i=e.getBounds(t,n);i&&(a?a.add(i):(a=r||new xO).update(i.center,i.halfExtents))})),a||(a=new xO),n){var o=function(t){var e=t;do{var n;if(null===(n=e.parsedStyle)||void 0===n?void 0:n.clipPath)return e;e=e.parentElement}while(null!==e);return null}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents)}}return n?(i.renderBounds=a,i.renderBoundsDirty=!1):(i.bounds=a,i.boundsDirty=!1),a}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=FL;t.parentNode.transformable&&(e=nt(zL,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!xO.isEmpty(n)){var i=new xO;return i.setFromTransformedAABB(n,e),i}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var e,n,i=this.getGeometryBounds(t);xO.isEmpty(i)||(n=new xO).setFromTransformedAABB(i,this.getWorldTransform(t));var r=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=b(n.getMin(),2),o=a[0],s=a[1],l=b(n.getMax(),2),u=l[0],c=l[1];return new MO(o+((null==r?void 0:r.left)||0),s+((null==r?void 0:r.top)||0),u-o,c-s)}return new MO((null==r?void 0:r.left)||0,(null==r?void 0:r.top)||0,0,0)}},{key:"internalUpdateTransform",value:function(t){var e,n=null===(e=t.parentNode)||void 0===e?void 0:e.transformable;QO(t.transformable),function(t,e){t.dirtyFlag&&(e?at(t.worldTransform,e.worldTransform,t.localTransform):Z(t.worldTransform,t.localTransform),t.dirtyFlag=!1)}(t.transformable,n)}},{key:"internalUpdateElement",value:function(t,e){var n,i,r,a,o,s,l=!0===(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization),u=e[e.length-1],c=(null==u?void 0:u.transformDirty)||(null===(i=t.transformable)||void 0===i?void 0:i.localDirtyFlag);t.transformable&&((o=t.transformable).dirtyFlag||(o.dirtyFlag=c)),this.internalUpdateTransform(t),c&&(null===(s=t.dirty)||void 0===s||s.call(t,!0,!0));var h=(null===(r=t.renderable)||void 0===r?void 0:r.boundsDirty)||(null===(a=t.renderable)||void 0===a?void 0:a.renderBoundsDirty);if((c||h)&&!1===(null==u?void 0:u.shapeUpdated)&&l)for(var d=e.length-1;d>=0;){var f,p,g=e[d];if(g.shapeUpdated)break;null===(f=(p=g.node).dirty)||void 0===f||f.call(p,!0,!0),g.shapeUpdated=!0,d-=1}return c}},{key:"syncHierarchy",value:function(t){for(var e,n,i=[t],r=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];i.length>0;){for(var a=i.pop(),o=r[r.length-1];r.length>0&&a.parentNode!==o.node;)o=r.pop();var s=this.internalUpdateElement(a,r);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)i.push(a.childNodes[l]);r.push({node:a,transformDirty:s,shapeUpdated:!1})}}}},{key:"dirtyLocalTransform",value:function(t,e){GR(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e))}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtifyWorldInternal(t,e),this.dirtyToRoot(t,!0)}},{key:"dirtifyWorldInternal",value:function(t,e){var n,i=this,r=!0===(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization);e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),r||t.childNodes.forEach((function(t){var e=t.transformable;i.dirtifyWorldInternal(t,e)})))}},{key:"dirtyToRoot",value:function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t,r=!0===(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization);i;){var a,o;if(null===(a=(o=i).dirty)||void 0===a||a.call(o,!0,!0),r)break;i=i.parentNode}n&&t.forEach((function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0)})),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,n)}},{key:"dirtifyFragment",value:function(t){var e,n,i=t.transformable;i&&(i.dirtyFlag=!0,i.localDirtyFlag=!0),null===(e=(n=t).dirty)||void 0===e||e.call(n,!0,!0);for(var r=t.childNodes.length,a=0;a<r;a++)this.dirtifyFragment(t.childNodes[a]);t.nodeName===cO.FRAGMENT&&this.pendingEvents.set(t,!1)}},{key:"triggerPendingEvents",value:function(){var t,e,n=this,i=new Set,r=function(e,r){if(e.isConnected&&!i.has(e)&&e.nodeName!==cO.FRAGMENT){var a;if(n.boundsChangedEvent.detail=r,n.boundsChangedEvent.target=e,e.isMutationObserved)e.dispatchEvent(n.boundsChangedEvent);else void 0===t&&(t=!0===(null===(a=e.ownerDocument.defaultView)||void 0===a||null===(a=a.getConfig())||void 0===a||null===(a=a.future)||void 0===a?void 0:a.experimentalCancelEventPropagation)),e.ownerDocument.defaultView.dispatchEvent(n.boundsChangedEvent,!0,t);i.add(e)}};this.pendingEvents.forEach((function(t,n){var i;n.nodeName!==cO.FRAGMENT&&(void 0===e&&(e=!0===(null===(i=n.ownerDocument)||void 0===i||null===(i=i.defaultView)||void 0===i||null===(i=i.getConfig())||void 0===i||null===(i=i.future)||void 0===i?void 0:i.experimentalAttributeUpdateOptimization)),QL.affectChildren=t,e?r(n,QL):t?n.forEach((function(t){r(t,QL)})):r(n,QL))})),i.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"updateDisplayObjectDependency",value:function(t,e,n,i){if(e&&e!==n){var r=this.displayObjectDependencyMap.get(e);if(r&&r[t]){var a=r[t].indexOf(i);r[t].splice(a,1)}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(i)}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,i=this.displayObjectDependencyMap.get(t);if(i){var r=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(i).forEach((function(t){i[t].forEach((function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new LL(RL.ATTR_MODIFIED,e,n,n,t,LL.MODIFICATION,n,n),r,r),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n)}))}))}}}])}(),tD=function(){return c((function t(e){if(l(this,t),e<=0)throw new Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map}),[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n)}}},{key:"len",value:function(){return this.cache.size}},{key:"clear",value:function(){this.cache.clear()}}])}(),eD={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},nD=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,iD=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),rD=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),aD=function(){return c((function t(e){var n=this;l(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!(!t||!rD.exec(e)&&!iD.exec(t))},this.trimByKinsokuShorui=function(t){var e=f(t),n=e[e.length-2];if(!n)return t;var i=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=i+e[e.length-1],e},this.runtime=e,this.charWidthCache=new tD(100)}),[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),r=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});r.font=t;var a=eD.MetricsString+eD.BaselineSymbol,o=Math.ceil(r.measureText(a).width),s=Math.ceil(r.measureText(eD.BaselineSymbol).width),l=eD.HeightMultiplier*s;s=s*eD.BaselineMultiplier|0,i.width=o,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,o,l),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(a,0,s);var u=r.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,p=!1;for(d=0;d<s;++d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){p=!0;break}if(p)break;f+=h}for(n.ascent=s-d,f=c-h,p=!1,d=l;d>s;--d){for(var v=0;v<h;v+=4)if(255!==u[f+v]){p=!0;break}if(p)break;f-=h}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n}},{key:"measureText",value:function(t,e,n){var i=e.fontSize,r=void 0===i?16:i,a=e.wordWrap,o=void 0!==a&&a,s=e.lineHeight,l=e.lineWidth,u=void 0===l?1:l,c=e.textBaseline,h=void 0===c?"alphabetic":c,d=e.textAlign,f=void 0===d?"start":d,p=e.letterSpacing,g=void 0===p?0:p,v=e.textPath;e.textPathSide,e.textPathStartOffset;var y=e.leading,m=void 0===y?0:y,b=eL(e),x=this.measureFont(b,n);0===x.fontSize&&(x.fontSize=r,x.ascent=r);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=b,e.isOverflowing=!1;var w=(o?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),k=new Array(w.length),M=0;if(!v){for(var S=0;S<w.length;S++){var N=E.measureText(w[S]).width+(w[S].length-1)*g;k[S]=N,M=Math.max(M,N)}var T=M+u,A=s||x.fontSize+u,O=Math.max(A,x.fontSize+u)+(w.length-1)*(A+m),P=0;return"middle"===h?P=-O/2:"bottom"===h||"alphabetic"===h||"ideographic"===h?P=-O:"top"!==h&&"hanging"!==h||(P=0),{font:b,width:T,height:O,lines:w,lineWidths:k,lineHeight:A+=m,maxLineWidth:M,fontProperties:x,lineMetrics:k.map((function(t,e){var n=0;return"center"===f||"middle"===f?n-=t/2:"right"!==f&&"end"!==f||(n-=t),new MO(n-u/2,P+e*A,t+u,A)}))}}v.getTotalLength();for(var C=0;C<w.length;C++)E.measureText(w[C]).width,w[C].length}},{key:"wordWrap",value:function(t,e,n){var i=this,r=Array.from(t);if(0===r.length)return"";var a=this,o=e.wordWrapWidth,s=void 0===o?0:o,l=e.letterSpacing,u=void 0===l?0:l,c=e.maxLines,h=void 0===c?1/0:c,d=e.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),p=s+u,g="";"ellipsis"===d?g="...":d&&"clip"!==d&&(g=d);var v=[""],y=0,m=0,b=-1,x=eL(e),E=this.charWidthCache.get(x);E||(E=new tD(500),this.charWidthCache.put(x,E));var w=function(t){return i.getFromCache(t,u,E,f)},k=w(g);function M(t,e,n,i){for(;w(t)<i&&e<r.length-1&&!a.isNewline(r[e+1]);)t+=r[e+=1];for(;w(t)>i&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e}}function S(t,e){if(!(k<=0||k>p))if(v[t]){var n=M(v[t],e,b+1,p-k);v[t]=n.lineTxt+g}else v[t]=g}for(var N=0;N<r.length;N++){var T=r[N],A=r[N-1],O=r[N+1],P=w(T);if(this.isNewline(T)){if(y+1>=h){N<r.length-1&&S(y,N-1),e.isOverflowing=!0;break}b=N-1,m=0,v[y+=1]=""}else{if(P>p){S(y,N-1),e.isOverflowing=!0;break}if(m>0&&m+P>p){var C=M(v[y],N-1,b+1,p);if(C.txtLastCharIndex!==N-1){if(v[y]=C.lineTxt,C.txtLastCharIndex===r.length-1)break;N=C.txtLastCharIndex+1,T=r[N],A=r[N-1],O=r[N+1],P=w(T)}if(y+1>=h){S(y,N-1),e.isOverflowing=!0;break}if(b=N-1,m=0,v[y+=1]="",this.isBreakingSpace(T))continue;this.canBreakInLastChar(T)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[y]||"",w)),this.shouldBreakByKinsokuShorui(T,O)&&(v=this.trimByKinsokuShorui(v),m+=w(A||""))}m+=P,v[y]+=T}}return v.join("\n")}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&eD.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return"string"==typeof t&&eD.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var e=f(t),n=e[e.length-2],i=this.findBreakableIndex(n);if(-1===i||!n)return e;var r=n.slice(i,i+1),a=i+1,o=i+(this.isBreakingSpace(r)?0:1);return e[e.length-1]+=n.slice(a,n.length),e[e.length-2]=n.slice(0,o),e}},{key:"canBreakInLastChar",value:function(t){return!t||!nD.test(t)}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce((function(t,n){return t+e(n)}),0)}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!nD.test(t[e]))return e;return-1}},{key:"getFromCache",value:function(t,e,n,i){var r=n.get(t);if("number"!=typeof r){var a=t.length*e;r=i.measureText(t).width+a,n.put(t,r)}return r}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear()}}])}(),oD={},sD=function(t){var e=new mL,n=new yL;return a(a(a(a(a(a(a(a(a(a(t={},cO.FRAGMENT,null),cO.CIRCLE,new fL),cO.ELLIPSE,new pL),cO.RECT,e),cO.IMAGE,e),cO.GROUP,new xL),cO.LINE,new gL),cO.TEXT,new bL(oD)),cO.POLYLINE,n),cO.POLYGON,n),a(a(a(t,cO.PATH,new vL),cO.HTML,new EL),cO.MESH,null)}(),lD=function(t){var e=new kR,n=new NR;return a(a(a(a(a(a(a(a(a(a(t={},tP.PERCENTAGE,null),tP.NUMBER,new PR),tP.ANGLE,new ER),tP.DEFINED_PATH,new wR),tP.PAINT,e),tP.COLOR,e),tP.FILTER,new MR),tP.LENGTH,n),tP.LENGTH_PERCENTAGE,n),tP.LENGTH_PERCENTAGE_12,new TR),a(a(a(a(a(a(a(a(a(a(t,tP.LENGTH_PERCENTAGE_14,new AR),tP.COORDINATE,new NR),tP.OFFSET_DISTANCE,new CR),tP.OPACITY_VALUE,new RR),tP.PATH,new LR),tP.LIST_OF_POINTS,new DR),tP.SHADOW_BLUR,new IR),tP.TEXT,new _R),tP.TEXT_TRANSFORM,new BR),tP.TRANSFORM,new cL),a(a(a(t,tP.TRANSFORM_ORIGIN,new hL),tP.Z_INDEX,new dL),tP.MARKER,new OR)}();oD.CameraContribution=YO,oD.AnimationTimeline=null,oD.EasingFunction=null,oD.offscreenCanvasCreator=new OL,oD.sceneGraphSelector=new CL,oD.sceneGraphService=new JL(oD),oD.textService=new aD(oD),oD.geometryUpdaterFactory=sD,oD.CSSPropertySyntaxFactory=lD,oD.styleValueRegistry=new bR(oD),oD.layoutRegistry=null,oD.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},oD.enableStyleSyntax=!0,oD.enableSizeAttenuation=!1;var uD=0,cD=new LL(RL.INSERTED,null,"","","",0,"",""),hD=new LL(RL.REMOVED,null,"","","",0,"",""),dD=new NL(RL.DESTROY),fD=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).entity=uD++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:$O.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return m(e,t),c(e,[{key:"dirty",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.renderable.dirty=t,e&&(this.renderable.boundsDirty=t,this.renderable.renderBoundsDirty=t)}},{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter((function(t){return""!==t}))}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}},{key:"cloneNode",value:function(t){throw new Error(SO)}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw new Error("Cannot append a destroyed element.");return oD.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(GR(this)||t.nodeName!==cO.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(cD.relatedNode=this,t.dispatchEvent(cD)),t}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n)}else this.appendChild(t);return t}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e}},{key:"removeChild",value:function(t){var e,n,i=!0===(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation);return hD.relatedNode=this,t.dispatchEvent(hD,i,i),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),oD.sceneGraphService.detach(t),t}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e)}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy()}}},{key:"matches",value:function(t){return oD.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return oD.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return oD.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return oD.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return oD.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return oD.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return oD.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var e=this;do{if(oD.sceneGraphService.matches(t,e))return e;e=e.parentElement}while(null!==e);return null}},{key:"find",value:function(t){var e=this,n=null;return this.forEach((function(i){return i===e||!t(i)||(n=i,!1)})),n}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach((function(i){i!==e&&t(i)&&n.push(i)})),n}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];i.forEach((function(n,i){var r;return null===(r=t.parentNode)||void 0===r?void 0:r.appendChild(n,e+i+1)}))}}},{key:"before",value:function(){if(this.parentNode){for(var t,e=this.parentNode.childNodes.indexOf(this),n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=i[0],o=i.slice(1);this.parentNode.appendChild(a,e),(t=a).after.apply(t,f(o))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e){return t.appendChild(e)}))}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e,n){return t.appendChild(e,n)}))}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){var t,e=!0===(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation);this.destroyChildren(),this.dispatchEvent(dD,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return oD.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return oD.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return oD.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return oD.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return oD.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t]}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,e,n,i){this.attributes[t]=e}},{key:"getAttributeNS",value:function(t,e){throw new Error(SO)}},{key:"getAttributeNode",value:function(t){throw new Error(SO)}},{key:"getAttributeNodeNS",value:function(t,e){throw new Error(SO)}},{key:"hasAttributeNS",value:function(t,e){throw new Error(SO)}},{key:"removeAttributeNS",value:function(t,e){throw new Error(SO)}},{key:"removeAttributeNode",value:function(t){throw new Error(SO)}},{key:"setAttributeNS",value:function(t,e,n){throw new Error(SO)}},{key:"setAttributeNode",value:function(t){throw new Error(SO)}},{key:"setAttributeNodeNS",value:function(t){throw new Error(SO)}},{key:"toggleAttribute",value:function(t,e){throw new Error(SO)}}])}(AL);function pD(t){return!(null==t||!t.nodeName)}var gD=oD.globalThis.Proxy?oD.globalThis.Proxy:function(){},vD=new LL(RL.ATTR_MODIFIED,null,null,null,null,LL.MODIFICATION,null,null),yD=k(),mD=qt(),bD=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||cO.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),oD.enableStyleSyntax&&(n.style=new gD({setProperty:function(t,e){n.setAttribute(t,e)},getPropertyValue:function(t){return n.getAttribute(t)},removeProperty:function(t){n.removeAttribute(t)},item:function(){return""}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e)},set:function(t,e,i){return n.setAttribute(e,i),!0}})),n}return m(e,t),c(e,[{key:"destroy",value:function(){bn(e,"destroy",this,3)([]),this.getAnimations().forEach((function(t){t.cancel()}))}},{key:"cloneNode",value:function(t,e){var n=s({},this.attributes);for(var i in n){var r=n[i];pD(r)&&"clipPath"!==i&&"offsetPath"!==i&&"textPath"!==i&&(n[i]=r.cloneNode(t)),e&&(n[i]=e(i,r))}var a=new this.constructor(s(s({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach((function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n)}})),a}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};oD.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty()}},{key:"setAttribute",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];hn(n)||(i||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:r}),bn(e,"setAttribute",this,3)([t,n]))}},{key:"internalSetAttribute",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],r=this.parsedStyle[t];oD.styleValueRegistry.processProperties(this,a({},t,e),n),this.dirty();var o,s=this.parsedStyle[t];if(this.isConnected)if(vD.relatedNode=this,vD.prevValue=i,vD.newValue=e,vD.attrName=t,vD.prevParsedValue=r,vD.newParsedValue=s,this.isMutationObserved)this.dispatchEvent(vD);else{var l,u=!0===(null===(l=this.ownerDocument.defaultView.getConfig().future)||void 0===l?void 0:l.experimentalCancelEventPropagation);vD.target=this,this.ownerDocument.defaultView.dispatchEvent(vD,!0,u)}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(o=this.attributeChangedCallback)||void 0===o||o.call(this,t,i,e,r,s))}},{key:"getBBox",value:function(){var t=this.getBounds(),e=b(t.getMin(),2),n=e[0],i=e[1],r=b(t.getMax(),2),a=r[0],o=r[1];return new MO(n,i,a-n,o-i)}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return oD.sceneGraphService.setOrigin(this,AO(t,e,n,!1)),this}},{key:"getOrigin",value:function(){return oD.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return oD.sceneGraphService.setPosition(this,AO(t,e,n,!1)),this}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return oD.sceneGraphService.setLocalPosition(this,AO(t,e,n,!1)),this}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return oD.sceneGraphService.translate(this,AO(t,e,n,!1)),this}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return oD.sceneGraphService.translateLocal(this,AO(t,e,n,!1)),this}},{key:"getPosition",value:function(){return oD.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return oD.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n)}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(t=AO(t,e=e||t,n=n||t,!1)),oD.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(t=AO(t,e=e||t,n=n||t,!1)),oD.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return oD.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return oD.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){return RO(b(DO(yD,oD.sceneGraphService.getWorldTransform(this)),3)[2])}},{key:"getLocalEulerAngles",value:function(){return RO(b(DO(yD,oD.sceneGraphService.getLocalRotation(this)),3)[2])}},{key:"setEulerAngles",value:function(t){return oD.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return oD.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,e,n){return ce(e)&&ce(n)?oD.sceneGraphService.rotateLocal(this,0,0,t):oD.sceneGraphService.rotateLocal(this,t,e,n),this}},{key:"rotate",value:function(t,e,n){return ce(e)&&ce(n)?oD.sceneGraphService.rotate(this,0,0,t):oD.sceneGraphService.rotate(this,t,e,n),this}},{key:"setRotation",value:function(t,e,n,i){return oD.sceneGraphService.setRotation(this,t,e,n,i),this}},{key:"setLocalRotation",value:function(t,e,n,i){return oD.sceneGraphService.setLocalRotation(this,t,e,n,i),this}},{key:"setLocalSkew",value:function(t,e){return oD.sceneGraphService.setLocalSkew(this,t,e),this}},{key:"getRotation",value:function(){return oD.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return oD.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return oD.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return oD.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return oD.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return oD.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){oD.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,e){var n,i=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return i?i.play(this,t,e):null}},{key:"isVisible",value:function(){var t;return"hidden"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return"none"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)}},{key:"isCulled",value:function(){return!(!this.cullable||!this.cullable.enable||this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,f(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,f(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n[0],a=n[1];return r?vn(r)?(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),this):2===n.length?(this.setAttribute(r,a),this):this.attributes[r]:this.attributes}},{key:"getMatrix",value:function(t){var e=t||this.getWorldTransform(),n=b(xt(yD,e),2),i=n[0],r=n[1],a=b(Et(yD,e),2),o=a[0],s=a[1],l=wt(mD,e),u=b(DO(yD,l),3),c=u[0],h=u[2];return function(t,e,n,i,r){var a=Math.cos(t),o=Math.sin(t);return Xt(i*a,r*o,0,-i*o,r*a,0,e,n,1)}(c||h,i,r,o,s)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var e=b(IO(t),5),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4];this.setEulerAngles(o).setPosition(n,i).setLocalScale(r,a)}},{key:"setLocalMatrix",value:function(t){var e=b(IO(t),5),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4];this.setLocalEulerAngles(o).setLocalPosition(n,i).setLocalScale(r,a)}},{key:"show",value:function(){this.forEach((function(t){t.style.visibility="visible"}))}},{key:"hide",value:function(){this.forEach((function(t){t.style.visibility="hidden"}))}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,e){return this.appendChild(t,e)}},{key:"set",value:function(t,e){this.config[t]=e}},{key:"get",value:function(t){return this.config[t]}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}}])}(fD);bD.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var xD=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:cO.CIRCLE},t)])}return m(e,t),c(e)}(bD);xD.PARSED_STYLE_LIST=new Set([].concat(f(bD.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var ED=["style"],wD=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,ED);return l(this,e),(t=v(this,e,[s({style:i},r)])).isCustomElement=!0,t}return m(e,t),c(e)}(bD);wD.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var kD=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:cO.ELLIPSE},t)])}return m(e,t),c(e)}(bD);kD.PARSED_STYLE_LIST=new Set([].concat(f(bD.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),(function(t){function e(){return l(this,e),v(this,e,[{type:cO.FRAGMENT}])}return m(e,t),c(e)}(bD)).PARSED_STYLE_LIST=new Set(["class","className"]);var MD=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:cO.GROUP},t)])}return m(e,t),c(e)}(bD);MD.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var SD=["style"],ND=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,SD);return l(this,e),(t=v(this,e,[s({type:cO.HTML,style:i},r)])).cullable.enable=!1,t}return m(e,t),c(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=nt(q(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!xO.isEmpty(e)){var n=new xO;return n.setFromTransformedAABB(e,t),n}}return this.getBounds()}}])}(bD);ND.PARSED_STYLE_LIST=new Set([].concat(f(bD.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"])),(function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:cO.IMAGE},t)])}return m(e,t),c(e)}(bD)).PARSED_STYLE_LIST=new Set([].concat(f(bD.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var TD=["style"],AD=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,TD);l(this,e),(t=v(this,e,[s({type:cO.LINE,style:s({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},r)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd;return o&&pD(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&pD(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&pD(i)&&(this.markerStartAngle=0,i.remove()),r&&pD(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t&&(i&&pD(i)&&(this.markerEndAngle=0,i.remove()),r&&pD(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1)))}},{key:"transformMarker",value:function(t){var e,n,i,r,a,o,s,l=this.parsedStyle,u=l.markerStart,c=l.markerEnd,h=l.markerStartOffset,d=l.markerEndOffset,f=l.x1,p=l.x2,g=l.y1,v=l.y2,y=t?u:c;y&&pD(y)&&(t?(r=f,a=g,n=p-f,i=v-g,o=h||0,s=this.markerStartAngle):(r=p,a=v,n=f-p,i=g-v,o=d||0,s=this.markerEndAngle),e=Math.atan2(i,n),y.setLocalEulerAngles(180*e/Math.PI+s),y.setLocalPosition(r+Math.cos(e)*o,a+Math.sin(e)*o))}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,i=Tn(n.x1,n.y1,n.x2,n.y2,t),r=i.x,a=i.y,o=j(k(),N(r,a,0),e?this.getWorldTransform():this.getLocalTransform());return new kO(o[0],o[1])}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle;return Nn(t.x1,t.y1,t.x2,t.y2)}}])}(bD);AD.PARSED_STYLE_LIST=new Set([].concat(f(bD.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var OD=["style"],PD=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,OD);l(this,e),(t=v(this,e,[s({type:cO.PATH,style:i,initialParsedStyle:{miterLimit:4,d:s({},JO)}},r)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd,c=a.markerMid;return o&&pD(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),c&&pD(c)&&t.placeMarkerMid(c),u&&pD(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&pD(i)&&(this.markerStartAngle=0,i.remove()),r&&pD(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t?(i&&pD(i)&&(this.markerEndAngle=0,i.remove()),r&&pD(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(r)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,i=e.markerEnd,r=e.markerStartOffset,a=e.markerEndOffset,o=t?n:i;if(o&&pD(o)){var s,l,u,c,h,d,f;if(t){var p=b(this.getStartTangent(),2),g=p[0],v=p[1];c=v[0],h=v[1],l=g[0]-v[0],u=g[1]-v[1],d=r||0,f=this.markerStartAngle}else{var y=b(this.getEndTangent(),2),m=y[0],x=y[1];c=x[0],h=x[1],l=m[0]-x[0],u=m[1]-x[1],d=a||0,f=this.markerEndAngle}s=Math.atan2(u,l),o.setLocalEulerAngles(180*s/Math.PI+f),o.setLocalPosition(c+Math.cos(s)*d,h+Math.sin(s)*d)}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach((function(t){t.remove()})),t&&pD(t))for(var n=1;n<e.length-1;n++){var i=b(e[n].currentPoint,2),r=i[0],a=i[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(r,a)}}},{key:"getTotalLength",value:function(){return _C(this)}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=yn(this.parsedStyle.d.absolutePath,t),i=n.x,r=n.y,a=j(k(),N(i,r,0),e?this.getWorldTransform():this.getLocalTransform());return new kO(a[0],a[1])}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*_C(this),e)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,i=t[1].currentPoint,r=t[1].startTangent;e=[],r?(e.push([n[0]-r[0],n[1]-r[1]]),e.push([n[0],n[1]])):(e.push([i[0],i[1]]),e.push([n[0],n[1]]))}return e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var i=t[e-2].currentPoint,r=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?(n.push([r[0]-a[0],r[1]-a[1]]),n.push([r[0],r[1]])):(n.push([i[0],i[1]]),n.push([r[0],r[1]]))}return n}}])}(bD);PD.PARSED_STYLE_LIST=new Set([].concat(f(bD.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var CD=["style"],RD=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,CD);l(this,e),(t=v(this,e,[s({type:cO.POLYGON,style:i,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},r)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd,c=a.markerMid;return o&&pD(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),c&&pD(c)&&t.placeMarkerMid(c),u&&pD(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&pD(i)&&(this.markerStartAngle=0,i.remove()),r&&pD(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t?(i&&pD(i)&&(this.markerEndAngle=0,i.remove()),r&&pD(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(r)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,i=e.markerEnd,r=e.markerStartOffset,a=e.markerEndOffset,o=(e.points||{}).points,s=t?n:i;if(s&&pD(s)&&o){var l,u,c,h,d,f,p;if(h=o[0][0],d=o[0][1],t)u=o[1][0]-o[0][0],c=o[1][1]-o[0][1],f=r||0,p=this.markerStartAngle;else{var g=o.length;this.parsedStyle.isClosed?(u=o[g-1][0]-o[0][0],c=o[g-1][1]-o[0][1]):(h=o[g-1][0],d=o[g-1][1],u=o[g-2][0]-o[g-1][0],c=o[g-2][1]-o[g-1][1]),f=a||0,p=this.markerEndAngle}l=Math.atan2(c,u),s.setLocalEulerAngles(180*l/Math.PI+p),s.setLocalPosition(h+Math.cos(l)*f,d+Math.sin(l)*f)}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach((function(t){t.remove()})),this.markerMidList=[],t&&pD(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var i=e[n][0],r=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(i,r)}}}])}(bD);RD.PARSED_STYLE_LIST=new Set([].concat(f(bD.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var LD=["style"],DD=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,i=zn(t,LD);return l(this,e),v(this,e,[s({type:cO.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i)])}return m(e,t),c(e,[{key:"getTotalLength",value:function(){return 0===(t=this).parsedStyle.points.totalLength&&(t.parsedStyle.points.totalLength=Rn(t.parsedStyle.points.points)),t.parsedStyle.points.totalLength;var t}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var i,r,a=[],o=0,s=this.getTotalLength();n.forEach((function(t,e){n[e+1]&&((i=[0,0])[0]=o/s,r=Nn(t[0],t[1],n[e+1][0],n[e+1][1]),o+=r,i[1]=o/s,a.push(i))})),this.parsedStyle.points.segments=a}var l=0,u=0;this.parsedStyle.points.segments.forEach((function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n)}));var c=Tn(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=j(k(),N(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new kO(f[0],f[1])}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n}}])}(RD);DD.PARSED_STYLE_LIST=new Set([].concat(f(RD.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var ID=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:cO.RECT},t)])}return m(e,t),c(e)}(bD);ID.PARSED_STYLE_LIST=new Set([].concat(f(bD.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var _D=["style"],BD=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,i=zn(t,_D);return l(this,e),v(this,e,[s({type:cO.TEXT,style:s({fill:"black"},n)},i)])}return m(e,t),c(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(bD);BD.PARSED_STYLE_LIST=new Set([].concat(f(bD.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var FD=function(){function t(e){l(this,t),this.strategies=e}return c(t,[{key:"apply",value:function(e){var n=e.config,i=e.camera,r=e.renderingService,a=e.renderingContext,o=this.strategies;r.hooks.cull.tap(t.tag,(function(t){if(t){var e,r=t.cullable;if(0===o.length?r.visible=a.unculledEntities.indexOf(t.entity)>-1:r.visible=o.every((function(e){return e.isVisible(i,t)})),!t.isCulled()&&t.isVisible())return t;var s=!0===(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation);return t.dispatchEvent(new NL(RL.CULLED),s,s),null}return t})),r.hooks.afterRender.tap(t.tag,(function(t){t.cullable.visibilityPlaneMask=-1}))}}])}();FD.tag="Culling";var jD=function(){function t(){var e=this;l(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new ML(null),this.rootWheelEvent=new SL(null),this.onPointerMove=function(t){var n,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView;if(!i.supportsTouchEvents||"touch"!==t.pointerType){var r,a=Gn(e.normalizeToPointerEvent(t,i));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=e.bootstrapEvent(e.rootPointerEvent,o,i,t);e.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var n,i,r=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=Gn(e.normalizeToPointerEvent(t,r));try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.bootstrapEvent(e.rootPointerEvent,o,r,t);e.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}}return c(t,[{key:"apply",value:function(e){var n=this;this.context=e;var i=e.renderingService,r=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler((function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null})),i.hooks.pointerWheel.tap(t.tag,(function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e)})),i.hooks.pointerDown.tap(t.tag,(function(t){if(!r.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,r);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var i,a=Gn(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=n.bootstrapEvent(n.rootPointerEvent,o,r,t);n.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}n.setCursor(n.context.eventService.cursor)}})),i.hooks.pointerUp.tap(t.tag,(function(t){if(!r.supportsTouchEvents||"touch"!==t.pointerType){var e,i=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(i,t)?"":"outside",o=Gn(n.normalizeToPointerEvent(t,r));try{for(o.s();!(e=o.n()).done;){var s=e.value,l=n.bootstrapEvent(n.rootPointerEvent,s,r,t);l.type+=a,n.context.eventService.mapEvent(l)}}catch(t){o.e(t)}finally{o.f()}n.setCursor(n.context.eventService.cursor)}})),i.hooks.pointerMove.tap(t.tag,this.onPointerMove),i.hooks.pointerOver.tap(t.tag,this.onPointerMove),i.hooks.pointerOut.tap(t.tag,this.onPointerMove),i.hooks.click.tap(t.tag,this.onClick),i.hooks.pointerCancel.tap(t.tag,(function(t){var e,i=Gn(n.normalizeToPointerEvent(t,r));try{for(i.s();!(e=i.n()).done;){var a=e.value,o=n.bootstrapEvent(n.rootPointerEvent,a,r,t);n.context.eventService.mapEvent(o)}}catch(t){i.e(t)}finally{i.f()}n.setCursor(n.context.eventService.cursor)}))}},{key:"bootstrapEvent",value:function(t,e,n,i){t.view=n,t.originalEvent=null,t.nativeEvent=i,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=r.x,o=r.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=i.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=FR[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),i=n.x,r=n.y;e.viewport.x=i,e.viewport.y=r;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=jR.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var i=0;i<t.changedTouches.length;i++){var r=t.changedTouches[i];hn(r.button)&&(r.button=0),hn(r.buttons)&&(r.buttons=1),hn(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),hn(r.width)&&(r.width=r.radiusX||1),hn(r.height)&&(r.height=r.radiusY||1),hn(r.tiltX)&&(r.tiltX=0),hn(r.tiltY)&&(r.tiltY=0),hn(r.pointerType)&&(r.pointerType="touch"),hn(r.pointerId)&&(r.pointerId=r.identifier||0),hn(r.pressure)&&(r.pressure=r.force||.5),hn(r.twist)&&(r.twist=0),hn(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,r.type=t.type,n.push(r)}else if(e.isMouseEvent(t)){var a=t;hn(a.isPrimary)&&(a.isPrimary=!0),hn(a.width)&&(a.width=1),hn(a.height)&&(a.height=1),hn(a.tiltX)&&(a.tiltX=0),hn(a.tiltY)&&(a.tiltY=0),hn(a.pointerType)&&(a.pointerType="mouse"),hn(a.pointerId)&&(a.pointerId=1),hn(a.pressure)&&(a.pressure=.5),hn(a.twist)&&(a.twist=0),hn(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}else n.push(t);return n}}])}();jD.tag="Event",cO.CIRCLE,cO.ELLIPSE,cO.IMAGE,cO.RECT,cO.LINE,cO.POLYLINE,cO.POLYGON,cO.TEXT,cO.PATH,cO.HTML;var GD=function(){function t(){l(this,t),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return c(t,[{key:"apply",value:function(e){var n,i,r=this,a=e.config,o=e.renderingService,s=e.renderingContext,l=e.rBushRoot,u=s.root.ownerDocument.defaultView;this.rBush=l;var c=function(t){o.dirtify()},h=function(t){r.syncTasks.set(t.target,t.detail.affectChildren),o.dirtify()},d=function(t){var e=t.target;oD.enableSizeAttenuation&&oD.styleValueRegistry.updateSizeAttenuation(e,u.getCamera().getZoom())},f=function(t){var e=t.target,n=e.rBushNode;null!=n&&n.aabb&&r.rBush.remove(n.aabb),r.syncTasks.delete(e),oD.sceneGraphService.dirtyToRoot(e),o.dirtify()};o.hooks.init.tap(t.tag,(function(){u.addEventListener(RL.MOUNTED,d),u.addEventListener(RL.UNMOUNTED,f),u.addEventListener(RL.ATTR_MODIFIED,c),u.addEventListener(RL.BOUNDS_CHANGED,h)})),o.hooks.destroy.tap(t.tag,(function(){u.removeEventListener(RL.MOUNTED,d),u.removeEventListener(RL.UNMOUNTED,f),u.removeEventListener(RL.ATTR_MODIFIED,c),u.removeEventListener(RL.BOUNDS_CHANGED,h),r.syncTasks.clear()}));var p=null!==(n=oD.globalThis.requestIdleCallback)&&void 0!==n?n:KR.bind(oD.globalThis),g=!0===(null===(i=a.future)||void 0===i?void 0:i.experimentalRICSyncRTree);o.hooks.endFrame.tap(t.tag,(function(){r.isFirstTimeRendering?(r.isFirstTimeRendering=!1,r.syncing=!0,p((function(){r.syncRTree(!0),r.isFirstTimeRenderingFinished=!0}))):g&&oD.globalThis.requestIdleCallback&&oD.globalThis.cancelIdleCallback?(oD.globalThis.cancelIdleCallback(r.ricSyncRTreeId),r.ricSyncRTreeId=oD.globalThis.requestIdleCallback((function(){return r.syncRTree()}))):r.syncRTree()}))}},{key:"syncNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isConnected){var n=t.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var i=t.getRenderBounds();if(i){var r=t.renderable;e&&(r.dirtyRenderBounds||(r.dirtyRenderBounds=new xO),r.dirtyRenderBounds.update(i.center,i.halfExtents));var a=b(i.getMin(),2),o=a[0],s=a[1],l=b(i.getMax(),2),u=l[0],c=l[1];n.aabb||(n.aabb={}),n.aabb.displayObject=t,n.aabb.minX=o,n.aabb.minY=s,n.aabb.maxX=u,n.aabb.maxY=c}return n.aabb&&!(isNaN(n.aabb.maxX)||isNaN(n.aabb.maxX)||isNaN(n.aabb.minX)||isNaN(n.aabb.minY))?n.aabb:void 0}}},{key:"syncRTree",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var n=[],i=new Set,r=function(r){if(!i.has(r)&&r.renderable){var a=t.syncNode(r,e);a&&(n.push(a),i.add(r))}};this.syncTasks.forEach((function(t,e){t&&e.forEach(r);for(var n=e;n;)r(n),n=n.parentElement})),this.rBush.load(n),n.length=0,this.syncing=!1}}}])}();GD.tag="Prepare";var zD=function(t){return t.READY="ready",t.BEFORE_RENDER="beforerender",t.RERENDER="rerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle",t.RENDERER_CHANGED="rendererchanged",t}({}),VD=(new NL(RL.MOUNTED),new NL(RL.UNMOUNTED),new NL(zD.BEFORE_RENDER),new NL(zD.RERENDER),new NL(zD.AFTER_RENDER),function(){function t(){l(this,t)}return c(t,[{key:"apply",value:function(e,n){var i=this,r=e.renderingService,a=e.renderingContext,o=e.config;this.context=e;var s=a.root.ownerDocument.defaultView,l=function(t){r.hooks.pointerMove.call(t)},u=function(t){r.hooks.pointerUp.call(t)},c=function(t){r.hooks.pointerDown.call(t)},h=function(t){r.hooks.pointerOver.call(t)},d=function(t){r.hooks.pointerOut.call(t)},f=function(t){r.hooks.pointerCancel.call(t)},p=function(t){r.hooks.pointerWheel.call(t)},g=function(t){r.hooks.click.call(t)};r.hooks.init.tap(t.tag,(function(){var t=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="none",t.style.msTouchAction="none"):s.supportsPointerEvents&&(t.style.touchAction="none"),s.supportsPointerEvents?function(t){n.globalThis.document.addEventListener("pointermove",l,!0),t.addEventListener("pointerdown",c,!0),t.addEventListener("pointerleave",d,!0),t.addEventListener("pointerover",h,!0),n.globalThis.addEventListener("pointerup",u,!0),n.globalThis.addEventListener("pointercancel",f,!0)}(t):function(t){n.globalThis.document.addEventListener("mousemove",l,!0),t.addEventListener("mousedown",c,!0),t.addEventListener("mouseout",d,!0),t.addEventListener("mouseover",h,!0),n.globalThis.addEventListener("mouseup",u,!0)}(t),s.supportsTouchEvents&&function(t){t.addEventListener("touchstart",c,!0),t.addEventListener("touchend",u,!0),t.addEventListener("touchmove",l,!0),t.addEventListener("touchcancel",f,!0)}(t),o.useNativeClickEvent&&t.addEventListener("click",g,!0),t.addEventListener("wheel",p,{passive:!0,capture:!0})})),r.hooks.destroy.tap(t.tag,(function(){var t=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="",t.style.msTouchAction=""):s.supportsPointerEvents&&(t.style.touchAction=""),s.supportsPointerEvents?function(t){n.globalThis.document.removeEventListener("pointermove",l,!0),t.removeEventListener("pointerdown",c,!0),t.removeEventListener("pointerleave",d,!0),t.removeEventListener("pointerover",h,!0),n.globalThis.removeEventListener("pointerup",u,!0),n.globalThis.removeEventListener("pointercancel",f,!0)}(t):function(t){n.globalThis.document.removeEventListener("mousemove",l,!0),t.removeEventListener("mousedown",c,!0),t.removeEventListener("mouseout",d,!0),t.removeEventListener("mouseover",h,!0),n.globalThis.removeEventListener("mouseup",u,!0)}(t),s.supportsTouchEvents&&function(t){t.removeEventListener("touchstart",c,!0),t.removeEventListener("touchend",u,!0),t.removeEventListener("touchmove",l,!0),t.removeEventListener("touchcancel",f,!0)}(t),o.useNativeClickEvent&&t.removeEventListener("click",g,!0),t.removeEventListener("wheel",p,!0)}))}}])}());VD.tag="DOMInteraction";var WD=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).name="dom-interaction",t}return m(e,t),c(e,[{key:"init",value:function(){this.addRenderingPlugin(new VD)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(dO);!function(t){t.exports=function(){function t(t,n,r,a,o){e(t,n,r||0,a||t.length-1,o||i)}function e(t,i,r,a,o){for(;a>r;){if(a-r>600){var s=a-r+1,l=i-r+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);e(t,i,Math.max(r,Math.floor(i-l*c/s+h)),Math.min(a,Math.floor(i+(s-l)*c/s+h)),o)}var d=t[i],f=r,p=a;for(n(t,r,i),o(t[a],d)>0&&n(t,r,a);f<p;){for(n(t,f,p),f++,p--;o(t[f],d)<0;)f++;for(;o(t[p],d)>0;)p--}0===o(t[r],d)?n(t,r,p):n(t,++p,a),p<=i&&(r=p+1),i<=p&&(a=p-1)}}function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var a=e;a<n;a++){var o=t.children[a];l(r,t.leaf?i(o):o)}return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,n,i,r,a){for(var o=[n,i];o.length;)if(!((i=o.pop())-(n=o.pop())<=r)){var s=n+Math.ceil((i-n)/r/2)*r;t(e,s,n,i,a),o.push(n,s,s,i)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!p(t,e))return n;for(var i=this.toBBox,r=[];e;){for(var a=0;a<e.children.length;a++){var o=e.children[a],s=e.leaf?i(o):o;p(t,s)&&(e.leaf?n.push(o):f(t,s)?this._all(o,n):r.push(o))}e=r.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var r=e.children[i],a=e.leaf?this.toBBox(r):r;if(p(t,a)){if(e.leaf||f(t,a))return!0;n.push(r)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=g([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,i,r,o=this.data,s=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),i=l[l.length-1],n=u.pop(),r=!0),o.leaf){var c=a(t,o.children,e);if(-1!==c)return o.children.splice(c,1),l.push(o),this._condense(l),this}r||o.leaf||!f(o,s)?i?(n++,o=i.children[n],r=!1):o=null:(l.push(o),u.push(n),n=0,i=o,o=o.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,i){var r,a=n-e+1,s=this._maxEntries;if(a<=s)return o(r=g(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,i-1))),(r=g([])).leaf=!1,r.height=i;var l=Math.ceil(a/s),u=l*Math.ceil(Math.sqrt(s));v(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);v(t,c,h,l,this.compareMinY);for(var d=c;d<=h;d+=l){var f=Math.min(d+l-1,h);r.children.push(this._build(t,d,f,i-1))}}return o(r,this.toBBox),r},r.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var r=1/0,a=1/0,o=void 0,s=0;s<e.children.length;s++){var l=e.children[s],u=h(l),c=(d=t,f=l,(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-u);c<a?(a=c,r=u<r?u:r,o=l):c===a&&u<r&&(r=u,o=l)}e=o||e.children[0]}var d,f;return e},r.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),r=[],a=this._chooseSubtree(i,this.data,e,r);for(a.children.push(t),l(a,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},r.prototype._split=function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var a=this._chooseSplitIndex(n,r,i),s=g(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var i,r=1/0,a=1/0,o=e;o<=n-e;o++){var l=s(t,0,o,this.toBBox),u=s(t,o,n,this.toBBox),c=(f=l,p=u,g=void 0,v=void 0,y=void 0,m=void 0,g=Math.max(f.minX,p.minX),v=Math.max(f.minY,p.minY),y=Math.min(f.maxX,p.maxX),m=Math.min(f.maxY,p.maxY),Math.max(0,y-g)*Math.max(0,m-v)),d=h(l)+h(u);c<r?(r=c,i=o,a=d<a?d:a):c===r&&d<a&&(a=d,i=o)}var f,p,g,v,y,m;return i||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},r.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var r=this.toBBox,a=s(t,0,e,r),o=s(t,n-e,n,r),u=d(a)+d(o),c=e;c<n-e;c++){var h=t.children[c];l(a,t.leaf?r(h):h),u+=d(a)}for(var f=n-e-1;f>=e;f--){var p=t.children[f];l(o,t.leaf?r(p):p),u+=d(o)}return u},r.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)l(e[i],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}()}(("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self,{exports:{}}));var UD=function(t){return t.GROUP="g",t.FRAGMENT="fragment",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh",t}({}),HD=function(t){return t[t.ZERO=0]="ZERO",t[t.NEGATIVE_ONE=1]="NEGATIVE_ONE",t}({}),YD=function(){return c((function t(){l(this,t),this.plugins=[]}),[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach((function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1)}))}}])}(),$D=O,XD=T,qD=L,KD=R,ZD=D,QD=W,JD=function(){function t(){l(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return c(t,[{key:"update",value:function(t,e){XD(this.center,t),XD(this.halfExtents,e),QD(this.min,this.center,this.halfExtents),$D(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,e){$D(this.center,e,t),ZD(this.center,this.center,.5),QD(this.halfExtents,e,t),ZD(this.halfExtents,this.halfExtents,.5),XD(this.min,t),XD(this.max,e)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!t.isEmpty(e))if(t.isEmpty(this))this.setMinMax(e.getMin(),e.getMax());else{var n=this.center,i=n[0],r=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=i-s,h=i+s,d=r-l,f=r+l,p=a-u,g=a+u,v=e.center,y=v[0],m=v[1],b=v[2],x=e.halfExtents,E=x[0],w=x[1],k=x[2],M=y-E,S=y+E,N=m-w,T=m+w,A=b-k,O=b+k;M<c&&(c=M),S>h&&(h=S),N<d&&(d=N),T>f&&(f=T),A<p&&(p=A),O>g&&(g=O),n[0]=.5*(c+h),n[1]=.5*(d+f),n[2]=.5*(p+g),o[0]=.5*(h-c),o[1]=.5*(f-d),o[2]=.5*(g-p),this.min[0]=c,this.min[1]=d,this.min[2]=p,this.max[0]=h,this.max[1]=f,this.max[2]=g}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,i=this.halfExtents,r=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],p=e[10],g=Math.abs(o),v=Math.abs(s),y=Math.abs(l),m=Math.abs(u),b=Math.abs(c),x=Math.abs(h),E=Math.abs(d),w=Math.abs(f),k=Math.abs(p);n[0]=e[12]+o*r[0]+s*r[1]+l*r[2],n[1]=e[13]+u*r[0]+c*r[1]+h*r[2],n[2]=e[14]+d*r[0]+f*r[1]+p*r[2],i[0]=g*a[0]+v*a[1]+y*a[2],i[1]=m*a[0]+b*a[1]+x*a[2],i[2]=E*a[0]+w*a[1]+k*a[2],QD(this.min,n,i),$D(this.max,n,i)}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),i=t.getMax(),r=t.getMin();return n[0]<=i[0]&&e[0]>=r[0]&&n[1]<=i[1]&&e[1]>=r[1]&&n[2]<=i[2]&&e[2]>=r[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,i=qD([0,0,0],this.getMin(),e.getMin()),r=KD([0,0,0],this.getMax(),e.getMax());return n.setMinMax(i,r),n}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?XD([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?XD([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]}}])}(),tI=function(){return c((function t(e,n){l(this,t),this.distance=e||0,this.normal=n||N(0,1,0),this.updatePNVertexFlag()}),[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return _(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/H(this.normal);D(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,e,n){var i=this.distanceToPoint(t),r=i/(i-this.distanceToPoint(e)),a=r>=0&&r<=1;return a&&n&&F(n,t,e,r),a}}])}(),eI=function(){return c((function t(e){if(l(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new tI)}),[{key:"extractFromVPMatrix",value:function(t){var e=b(t,16),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],y=e[15];A(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-p,A(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+p,A(this.planes[2].normal,a+i,u+s,f+h),this.planes[2].distance=y+g,A(this.planes[3].normal,a-i,u-s,f-h),this.planes[3].distance=y-g,A(this.planes[4].normal,a-r,u-l,f-d),this.planes[4].distance=y-v,A(this.planes[5].normal,a+r,u+l,f+d),this.planes[5].distance=y+v,this.planes.forEach((function(t){t.normalize(),t.updatePNVertexFlag()}))}}])}(),nI=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;l(this,t),this.x=0,this.y=0,this.x=e,this.y=n}return c(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),iI=function(){function t(e,n,i,r){l(this,t),this.x=e,this.y=n,this.width=i,this.height=r,this.left=e,this.right=e+i,this.top=n,this.bottom=n+r}return c(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,n){var i=$(e.x,e.y,0,1),r=$(e.x+e.width,e.y,0,1),a=$(e.x,e.y+e.height,0,1),o=$(e.x+e.width,e.y+e.height,0,1),s=Y(),l=Y(),u=Y(),c=Y();X(s,i,n),X(l,r,n),X(u,a,n),X(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),p=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:p-d})}}])}(),rI="Method not implemented.";function aI(t){return void 0===t?0:t>360||t<-360?t%360:t}var oI=k();function sI(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)&&3===t.length?i?M(t):T(oI,t):le(t)?i?N(t,e,n):A(oI,t,e,n):i?N(t[0],t[1]||e,t[2]||n):A(oI,t[0],t[1]||e,t[2]||n)}var lI=Math.PI/180;function uI(t){return t*lI}var cI=180/Math.PI;function hI(t){return t*cI}var dI=Math.PI/2;function fI(t,e){return 16===e.length?function(t,e){var n,i,r=b(Et(k(),e),3),a=r[0],o=r[1],s=r[2],l=Math.asin(-e[2]/a);return l<dI?l>-dI?(n=Math.atan2(e[6]/o,e[10]/s),i=Math.atan2(e[1]/a,e[0]/a)):(i=0,n=-Math.atan2(e[4]/o,e[5]/o)):(i=0,n=Math.atan2(e[4]/o,e[5]/o)),t[0]=n,t[1]=l,t[2]=i,t}(t,e):function(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=i*i,s=r*r,l=a*a,u=n*n+o+s+l,c=n*a-i*r;return c>.499995*u?(t[0]=dI,t[1]=2*Math.atan2(i,n),t[2]=0):c<-.499995*u?(t[0]=-dI,t[1]=2*Math.atan2(i,n),t[2]=0):(t[0]=Math.asin(2*(n*r-a*i)),t[1]=Math.atan2(2*(n*a+i*r),1-2*(s+l)),t[2]=Math.atan2(2*(n*i+r*a),1-2*(o+s))),t}(t,e)}function pI(t){var e=t[0],n=t[1],i=t[3],r=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(i*i+r*r);if(e*r-n*i<0&&(e<r?a=-a:o=-o),a){var s=1/a;e*=s,n*=s}if(o){var l=1/o;i*=l,r*=l}var u=hI(Math.atan2(n,e));return[t[6],t[7],a,o,u]}var gI=q(),vI=q(),yI=Y(),mI=[k(),k(),k()],bI=k();function xI(t,e,n,i,r){t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r}var EI=function(t){return t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING",t}({}),wI=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC",t}({}),kI=function(t){return t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE",t}({}),MI=2e-4,SI=function(){return c((function t(){l(this,t),this.clipSpaceNearZ=HD.NEGATIVE_ONE,this.eventEmitter=new x,this.matrix=q(),this.right=N(1,0,0),this.up=N(0,1,0),this.forward=N(0,0,1),this.position=N(0,0,1),this.focalPoint=N(0,0,0),this.distanceVector=N(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=q(),this.projectionMatrixInverse=q(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=EI.EXPLORING,this.trackingMode=wI.DEFAULT,this.projectionMode=kI.PERSPECTIVE,this.frustum=new eI,this.orthoMatrix=q()}),[{key:"isOrtho",value:function(){return this.projectionMode===kI.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,e){return this.type=t,this.type===EI.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===EI.TRACKING&&void 0!==e&&this.setTrackingMode(e),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==EI.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return nt(q(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,e){var n=dt(q(),[t,e,0]);this.jitteredProjectionMatrix=at(q(),n,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===kI.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===kI.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,e,n,i,r,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.projectionMode===kI.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===kI.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===kI.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===kI.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),i=n.x,r=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(i,r),this.setFocalPoint(i,r),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=N(o.x-i,o.y-r,0),l=_(s,this.right)/S(this.right),u=_(s,this.up)/S(this.up),c=b(this.getPosition(),2),h=c[0],d=c[1],f=b(this.getFocalPoint(),2),p=f[0],g=f[1];return this.setPosition(h-l,d-u),this.setFocalPoint(p-l,g-u),this}},{key:"setPerspective",value:function(t,e,n,i){var r;this.projectionMode=kI.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=i;var a=this.near*Math.tan(uI(.5*this.fov))/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(r=this.view)&&void 0!==r&&r.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c}return function(t,e,n,i,r,a,o){var s,l,u=2*a,c=n-e,h=i-r,d=u/c,f=u/h,p=(n+e)/c,g=(i+r)/h,v=o-a,y=o*a;arguments.length>7&&void 0!==arguments[7]&&arguments[7]?(s=-o/v,l=-y/v):(s=-(o+a)/v,l=-2*y/v),t[0]=d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=p,t[9]=g,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===HD.ZERO),nt(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,e,n,i,r,a){var o;this.projectionMode=kI.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=i,this.near=r,this.far=a;var s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,p=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d=(h+=g*this.view.offsetX)+g*this.view.width,p=(f-=v*this.view.offsetY)-v*this.view.height}return this.clipSpaceNearZ===HD.NEGATIVE_ONE?Rt(this.projectionMatrix,h,d,f,p,r,a):Lt(this.projectionMatrix,h,d,f,p,r,a),nt(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var e=sI(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2]);return this._setPosition(e),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],i=N(0,1,0);if(this.focalPoint=sI(t,e,n),this.trackingMode===wI.CINEMATIC){var r=P(k(),this.focalPoint,this.position);t=r[0],e=r[1],n=r[2];var a=S(r),o=hI(Math.asin(e/a)),s=90+hI(Math.atan2(n,t)),l=q();ct(l,l,uI(s)),ut(l,l,uI(o)),i=j(k(),[0,1,0],l)}return nt(this.matrix,Dt(q(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<MI&&(this.distance=MI),this.dollyingStep=this.distance/100;var e=k();t=this.distance;var n=this.forward,i=this.focalPoint;return e[0]=t*n[0]+i[0],e[1]=t*n[1]+i[1],e[2]=t*n[2]+i[2],this._setPosition(e),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=aI(t),this.computeMatrix(),this._getAxes(),this.type===EI.ORBITING||this.type===EI.EXPLORING?this._getPosition():this.type===EI.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=aI(t),this.computeMatrix(),this._getAxes(),this.type===EI.ORBITING||this.type===EI.EXPLORING?this._getPosition():this.type===EI.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=aI(t),this.computeMatrix(),this._getAxes(),this.type===EI.ORBITING||this.type===EI.EXPLORING?this._getPosition():this.type===EI.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=Kt(qt(),[0,0,1],uI(this.roll));tt(this.matrix);var e=Kt(qt(),[1,0,0],uI((this.rotateWorld&&this.type!==EI.TRACKING||this.type===EI.TRACKING?1:-1)*this.elevation)),n=Kt(qt(),[0,1,0],uI((this.rotateWorld&&this.type!==EI.TRACKING||this.type===EI.TRACKING?1:-1)*this.azimuth)),i=Zt(qt(),n,e);i=Zt(qt(),i,t);var r=St(q(),i);this.type===EI.ORBITING||this.type===EI.EXPLORING?(ot(this.matrix,this.matrix,this.focalPoint),at(this.matrix,this.matrix,r),ot(this.matrix,this.matrix,[0,0,this.distance])):this.type===EI.TRACKING&&(ot(this.matrix,this.matrix,this.position),at(this.matrix,this.matrix,r))}},{key:"_setPosition",value:function(t,e,n){this.position=sI(t,e,n);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){T(this.right,sI(X(Y(),[1,0,0,0],this.matrix))),T(this.up,sI(X(Y(),[0,1,0,0],this.matrix))),T(this.forward,sI(X(Y(),[0,0,1,0],this.matrix))),I(this.right,this.right),I(this.up,this.up),I(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],i=S(this.distanceVector);if(0===i)return this.elevation=0,void(this.azimuth=0);this.type===EI.TRACKING||this.rotateWorld?(this.elevation=hI(Math.asin(e/i)),this.azimuth=hI(Math.atan2(-t,-n))):(this.elevation=-hI(Math.asin(e/i)),this.azimuth=-hI(Math.atan2(-t,-n)))}},{key:"_getPosition",value:function(){T(this.position,sI(X(Y(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){G(this.distanceVector,[0,0,-this.distance],$t(Yt(),this.matrix)),O(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=P(k(),this.focalPoint,this.position),this.distance=S(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===kI.ORTHOGRAPHIC){var t=this.position,e=Kt(qt(),[0,0,1],-this.roll*Math.PI/180);Mt(this.orthoMatrix,e,N((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),N(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=at(q(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit("updated")}}},{key:"rotate",value:function(t,e,n){throw new Error(rI)}},{key:"pan",value:function(t,e){throw new Error(rI)}},{key:"dolly",value:function(t){throw new Error(rI)}},{key:"createLandmark",value:function(t,e){throw new Error(rI)}},{key:"gotoLandmark",value:function(t,e){throw new Error(rI)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(rI)}}])}(),NI=function(t){return t[t.Standard=0]="Standard",t}({}),TI=function(t){return t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",t}({}),AI=k(),OI=q(),PI=qt();function CI(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){Mt(t.localTransform,t.localRotation,t.localPosition,N(1,1,1),t.origin),0===t.localSkew[0]&&0===t.localSkew[1]||(tt(OI),OI[4]=Math.tan(t.localSkew[0]),OI[1]=Math.tan(t.localSkew[1]),at(t.localTransform,t.localTransform,OI));var e=Mt(OI,ne(PI,0,0,0,1),A(AI,1,1,1),t.localScale,t.origin);at(t.localTransform,t.localTransform,e)}else{var n=t.localTransform,i=t.localPosition,r=t.localRotation,a=t.localScale,o=t.origin,s=0!==i[0]||0!==i[1]||0!==i[2],l=1!==r[3]||0!==r[0]||0!==r[1]||0!==r[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?Mt(n,r,i,a,o):s?dt(n,i):tt(n)}t.localDirtyFlag=!1}}var RI={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new iI(0,0,0,0)},LI=function(t){return t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_DISTANCE="<offset-distance>",t.DEFINED_PATH="<defined-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>",t}({});function DI(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function II(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function _I(){}var BI=.7,FI=1.4285714285714286,jI="\\s*([+-]?\\d+)\\s*",GI="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zI="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",VI=/^#([0-9a-f]{3,8})$/,WI=new RegExp(`^rgb\\(${jI},${jI},${jI}\\)$`),UI=new RegExp(`^rgb\\(${zI},${zI},${zI}\\)$`),HI=new RegExp(`^rgba\\(${jI},${jI},${jI},${GI}\\)$`),YI=new RegExp(`^rgba\\(${zI},${zI},${zI},${GI}\\)$`),$I=new RegExp(`^hsl\\(${GI},${zI},${zI}\\)$`),XI=new RegExp(`^hsla\\(${GI},${zI},${zI},${GI}\\)$`),qI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function KI(){return this.rgb().formatHex()}function ZI(){return this.rgb().formatRgb()}function QI(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=VI.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?JI(e):3===n?new e_(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t_(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=WI.exec(t))?new e_(e[1],e[2],e[3],1):(e=UI.exec(t))?new e_(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=HI.exec(t))?t_(e[1],e[2],e[3],e[4]):(e=YI.exec(t))?t_(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=$I.exec(t))?s_(e[1],e[2]/100,e[3]/100,1):(e=XI.exec(t))?s_(e[1],e[2]/100,e[3]/100,e[4]):qI.hasOwnProperty(t)?JI(qI[t]):"transparent"===t?new e_(NaN,NaN,NaN,0):null}function JI(t){return new e_(t>>16&255,t>>8&255,255&t,1)}function t_(t,e,n,i){return i<=0&&(t=e=n=NaN),new e_(t,e,n,i)}function e_(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function n_(){return`#${o_(this.r)}${o_(this.g)}${o_(this.b)}`}function i_(){const t=r_(this.opacity);return`${1===t?"rgb(":"rgba("}${a_(this.r)}, ${a_(this.g)}, ${a_(this.b)}${1===t?")":`, ${t})`}`}function r_(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function a_(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function o_(t){return((t=a_(t))<16?"0":"")+t.toString(16)}function s_(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new u_(t,e,n,i)}function l_(t){if(t instanceof u_)return new u_(t.h,t.s,t.l,t.opacity);if(t instanceof _I||(t=QI(t)),!t)return new u_;if(t instanceof u_)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,l=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=l<.5?a+r:2-a-r,o*=60):s=l>0&&l<1?0:o,new u_(o,s,l,t.opacity)}function u_(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function c_(t){return(t=(t||0)%360)<0?t+360:t}function h_(t){return Math.max(0,Math.min(1,t||0))}function d_(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function f_(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var o=e?e.apply(this,r):r[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,r);return n.cache=s.set(o,l)||s,l};return n.cache=new(f_.Cache||Map),f_.cacheList.push(n.cache),n}DI(_I,QI,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:KI,formatHex:KI,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return l_(this).formatHsl()},formatRgb:ZI,toString:ZI}),DI(e_,(function(t,e,n,i){return 1===arguments.length?((r=t)instanceof _I||(r=QI(r)),r?new e_((r=r.rgb()).r,r.g,r.b,r.opacity):new e_):new e_(t,e,n,null==i?1:i);var r}),II(_I,{brighter(t){return t=null==t?FI:Math.pow(FI,t),new e_(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?BI:Math.pow(BI,t),new e_(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new e_(a_(this.r),a_(this.g),a_(this.b),r_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:n_,formatHex:n_,formatHex8:function(){return`#${o_(this.r)}${o_(this.g)}${o_(this.b)}${o_(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:i_,toString:i_})),DI(u_,(function(t,e,n,i){return 1===arguments.length?l_(t):new u_(t,e,n,null==i?1:i)}),II(_I,{brighter(t){return t=null==t?FI:Math.pow(FI,t),new u_(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?BI:Math.pow(BI,t),new u_(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new e_(d_(t>=240?t-240:t+120,r,i),d_(t,r,i),d_(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new u_(c_(this.h),h_(this.s),h_(this.l),r_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=r_(this.opacity);return`${1===t?"hsl(":"hsla("}${c_(this.h)}, ${100*h_(this.s)}%, ${100*h_(this.l)}%${1===t?")":`, ${t})`}`}})),f_.Cache=Map,f_.cacheList=[],f_.clearCache=function(){f_.cacheList.forEach((function(t){return t.clear()}))};var p_=function(t){return t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger",t}({}),g_=function(t){return t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther",t}({}),v_=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),y_=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),m_=[{name:"em",unit_type:p_.kEms},{name:"px",unit_type:p_.kPixels},{name:"deg",unit_type:p_.kDegrees},{name:"rad",unit_type:p_.kRadians},{name:"grad",unit_type:p_.kGradians},{name:"ms",unit_type:p_.kMilliseconds},{name:"s",unit_type:p_.kSeconds},{name:"rem",unit_type:p_.kRems},{name:"turn",unit_type:p_.kTurns}],b_=function(t){return t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType",t}({}),x_=function(t){var e=1;switch(t){case p_.kPixels:case p_.kDegrees:case p_.kSeconds:break;case p_.kMilliseconds:e=.001;break;case p_.kRadians:e=180/Math.PI;break;case p_.kGradians:e=.9;break;case p_.kTurns:e=360}return e},E_=function(t){switch(t){case p_.kNumber:case p_.kInteger:return"";case p_.kPercentage:return"%";case p_.kEms:return"em";case p_.kRems:return"rem";case p_.kPixels:return"px";case p_.kDegrees:return"deg";case p_.kRadians:return"rad";case p_.kGradians:return"grad";case p_.kMilliseconds:return"ms";case p_.kSeconds:return"s";case p_.kTurns:return"turn"}return""},w_=function(){return c((function t(){l(this,t)}),[{key:"toString",value:function(){return this.buildCSSText(v_.kNo,y_.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=b_.kUnitType&&this.getType()<=b_.kClampType}}],[{key:"isAngle",value:function(t){return t===p_.kDegrees||t===p_.kRadians||t===p_.kGradians||t===p_.kTurns}},{key:"isLength",value:function(t){return t>=p_.kEms&&t<p_.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===p_.kPercentage||t===p_.kEms||t===p_.kRems}},{key:"isTime",value:function(t){return t===p_.kSeconds||t===p_.kMilliseconds}}])}(),k_=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).colorSpace=t,n}return m(e,t),c(e,[{key:"getType",value:function(){return b_.kColorType}},{key:"to",value:function(t){return this}}])}(w_),M_=function(t){return t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient",t}({}),S_=function(t){function e(t,n){var i;return l(this,e),(i=v(this,e)).type=t,i.value=n,i}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(t,e,n){return n}},{key:"getType",value:function(){return b_.kColorType}}])}(w_),N_=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).value=t,n}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return b_.kKeywordType}},{key:"buildCSSText",value:function(t,e,n){return n+this.value}}])}(w_),T_=function(t){return function(t){switch(t){case g_.kUNumber:return p_.kNumber;case g_.kULength:return p_.kPixels;case g_.kUPercent:return p_.kPercentage;case g_.kUTime:return p_.kSeconds;case g_.kUAngle:return p_.kDegrees;default:return p_.kUnknown}}(function(t){switch(t){case p_.kNumber:case p_.kInteger:return g_.kUNumber;case p_.kPercentage:return g_.kUPercent;case p_.kPixels:return g_.kULength;case p_.kMilliseconds:case p_.kSeconds:return g_.kUTime;case p_.kDegrees:case p_.kRadians:case p_.kGradians:case p_.kTurns:return g_.kUAngle;default:return g_.kUOther}}(t))},A_=function(t){function e(t){var n,i,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p_.kNumber;return l(this,e),n=v(this,e),i="string"==typeof a?(r=a)?"number"===r?p_.kNumber:"percent"===r||"%"===r?p_.kPercentage:function(t){return m_.find((function(e){return e.name===t})).unit_type}(r):p_.kUnknown:a,n.unit=i,n.value=t,n}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(t){var e=t;return this.value===e.value&&this.unit===e.unit}},{key:"getType",value:function(){return b_.kUnitType}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=T_(this.unit);if(n!==T_(t)||n===p_.kUnknown)return null;var i=x_(this.unit)/x_(t);return new e(this.value*i,t)}},{key:"buildCSSText",value:function(t,e,n){var i;switch(this.unit){case p_.kUnknown:break;case p_.kInteger:i=Number(this.value).toFixed(0);break;case p_.kNumber:case p_.kPercentage:case p_.kEms:case p_.kRems:case p_.kPixels:case p_.kDegrees:case p_.kRadians:case p_.kGradians:case p_.kMilliseconds:case p_.kSeconds:case p_.kTurns:var r=this.value,a=E_(this.unit);if(r<-999999||r>999999){var o=E_(this.unit);i=!Number.isFinite(r)||Number.isNaN(r)?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e}(r,o):r+(o||"")}else i="".concat(r).concat(a)}return n+i}}])}(w_),O_=new A_(0,"px");new A_(1,"px");var P_=new A_(0,"deg"),C_=function(t){function e(t,n,i){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return l(this,e),(r=v(this,e,["rgb"])).r=t,r.g=n,r.b=i,r.alpha=a,r.isNone=o,r}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(k_),R_=new N_("unset"),L_={"":R_,unset:R_,initial:new N_("initial"),inherit:new N_("inherit")},D_=new C_(0,0,0,0,!0),I_=new C_(0,0,0,0),__=f_((function(t,e,n,i){return new C_(t,e,n,i)}),(function(t,e,n,i){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(i,")")})),B_=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p_.kNumber;return new A_(t,e)};function F_(t){var e=t.type,n=t.value;return"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")")}new A_(50,"%");var j_=function(){var t=/^(linear\-gradient)/i,e=/^(repeating\-linear\-gradient)/i,n=/^(radial\-gradient)/i,i=/^(repeating\-radial\-gradient)/i,r=/^(conic\-gradient)/i,a=/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,o=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,s=/^(left|center|right|top|bottom)/i,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,d=/^\(/,f=/^\)/,p=/^,/,g=/^\#([0-9a-fA-F]+)/,v=/^([a-zA-Z]+)/,y=/^rgb/i,m=/^rgba/i,b=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,x="";function E(t){throw new Error("".concat(x,": ").concat(t))}function w(){return k("linear-gradient",t,S)||k("repeating-linear-gradient",e,S)||k("radial-gradient",n,N)||k("repeating-radial-gradient",i,N)||k("conic-gradient",r,N)}function k(t,e,n){return M(e,(function(e){var i=n();return i&&(B(p)||E("Missing comma before color stops")),{type:t,orientation:i,colorStops:C(R)}}))}function M(t,e){var n=B(t);if(n){B(d)||E("Missing (");var i=e(n);return B(f)||E("Missing )"),i}}function S(){return _("directional",a,1)||_("angular",h,1)}function N(){var t,e,n=T();return n&&((t=[]).push(n),e=x,B(p)&&((n=T())?t.push(n):x=e)),t}function T(){var t,e=function(){var t=_("shape",/^(circle)/i,0);return t&&(t.style=I()||A()),t}()||((t=_("shape",/^(ellipse)/i,0))&&(t.style=D()||A()),t);if(e)e.at=O();else{var n=A();if(n){e=n;var i=O();i&&(e.at=i)}else{var r=P();r&&(e={type:"default-radial",at:r})}}return e}function A(){return _("extent-keyword",o,1)}function O(){if(_("position",/^at/,0)){var t=P();return t||E("Missing positioning value"),t}}function P(){var t={x:D(),y:D()};if(t.x||t.y)return{type:"position",value:t}}function C(t){var e=t(),n=[];if(e)for(n.push(e);B(p);)(e=t())?n.push(e):E("One extra comma");return n}function R(){var t=_("hex",g,1)||M(m,(function(){return{type:"rgba",value:C(L)}}))||M(y,(function(){return{type:"rgb",value:C(L)}}))||_("literal",v,0);return t||E("Expected color definition"),t.length=D(),t}function L(){return B(b)[1]}function D(){return _("%",u,1)||_("position-keyword",s,1)||I()}function I(){return _("px",l,1)||_("em",c,1)}function _(t,e,n){var i=B(e);if(i)return{type:t,value:i[n]}}function B(t){var e=/^[\n\r\t\s]+/.exec(x);e&&F(e[0].length);var n=t.exec(x);return n&&F(n[0].length),n}function F(t){x=x.substring(t)}return function(t){return x=t,e=C(w),x.length>0&&E("Invalid input not EOF"),e;var e}}(),G_=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,z_=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,V_=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,W_=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,U_={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},H_=f_((function(t){var e;return e="angular"===t.type?Number(t.value):U_[t.value]||0,B_(e,"deg")})),Y_=f_((function(t){var e=50,n=50,i="%",r="%";if("position"===(null==t?void 0:t.type)){var a=t.value,o=a.x,s=a.y;"position-keyword"===(null==o?void 0:o.type)&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),"position-keyword"===(null==s?void 0:s.type)&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),"px"!==(null==o?void 0:o.type)&&"%"!==(null==o?void 0:o.type)&&"em"!==(null==o?void 0:o.type)||(i=null==o?void 0:o.type,e=Number(o.value)),"px"!==(null==s?void 0:s.type)&&"%"!==(null==s?void 0:s.type)&&"em"!==(null==s?void 0:s.type)||(r=null==s?void 0:s.type,n=Number(s.value))}return{cx:B_(e,i),cy:B_(n,r)}})),$_=f_((function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return j_(t).map((function(t){var e=t.type,n=t.orientation,i=t.colorStops;!function(t){var e,n,i=t.length;t[i-1].length=null!==(e=t[i-1].length)&&void 0!==e?e:{type:"%",value:"100"},i>1&&(t[0].length=null!==(n=t[0].length)&&void 0!==n?n:{type:"%",value:"0"});for(var r=0,a=Number(t[0].length.value),o=1;o<i;o++){var s,l=null===(s=t[o].length)||void 0===s?void 0:s.value;if(!ce(l)&&!ce(a)){for(var u=1;u<o-r;u++)t[r+u].length={type:"%",value:"".concat(a+(Number(l)-a)*u/(o-r))};r=o,a=Number(l)}}}(i);var r,a=i.map((function(t){return{offset:B_(Number(t.length.value),"%"),color:F_(t)}}));if("linear-gradient"===e)return new S_(M_.LinearGradient,{angle:n?H_(n):P_,steps:a});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var o,s=Y_(n[0].at),l=s.cx,u=s.cy;if(n[0].style){var c=n[0].style,h=c.type,d=c.value;"extent-keyword"===h?(L_[r=d]||(L_[r]=new N_(r)),o=L_[r]):o=B_(d,h)}return new S_(M_.RadialGradient,{cx:l,cy:u,size:o,steps:a})}}));var e=t[0];if("("===t[1]||"("===t[2])if("l"===e){var n=G_.exec(t);if(n){var i,r=(null===(i=n[2].match(W_))||void 0===i?void 0:i.map((function(t){return t.split(":")})))||[];return[new S_(M_.LinearGradient,{angle:B_(parseFloat(n[1]),"deg"),steps:r.map((function(t){var e=b(t,2),n=e[0],i=e[1];return{offset:B_(100*Number(n),"%"),color:i}}))})]}}else if("r"===e){var a=function(t){var e=z_.exec(t);if(e){var n,i=(null===(n=e[4].match(W_))||void 0===n?void 0:n.map((function(t){return t.split(":")})))||[];return{cx:B_(50,"%"),cy:B_(50,"%"),steps:i.map((function(t){var e=b(t,2),n=e[0],i=e[1];return{offset:B_(100*Number(n),"%"),color:i}}))}}return null}(t);if(a){if(!he(a))return[new S_(M_.RadialGradient,a)];t=a}}else if("p"===e)return function(t){var e=V_.exec(t);if(e){var n=e[1],i=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat"}return{image:i,repetition:n}}return null}(t)}));function X_(t){return t&&!ce(t.r)&&!ce(t.g)&&!ce(t.b)}var q_=f_((function(t){if((e=t)&&e.image)return s({repetition:"repeat"},t);var e;if(ce(t)&&(t=""),"transparent"===t)return I_;if("currentColor"===t)t="black";else if("none"===t)return D_;var n=$_(t);if(n)return n;var i=QI(t),r=[0,0,0,0];return null!==i&&(r[0]=i.r||0,r[1]=i.g||0,r[2]=i.b||0,r[3]=i.opacity),__.apply(void 0,r)}));function K_(t,e){if(X_(t)&&X_(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(de(e[n],0,255));return e[3]=de(e[3],0,1),"rgba(".concat(e.join(","),")")}]}function Z_(t,e){if(ce(e))return B_(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(t)>=0)return B_(Number(e),"px");if("deg".search(t)>=0)return B_(Number(e),"deg")}var n=[];e=e.replace(t,(function(t){return n.push(t),"U".concat(t)}));var i="U(".concat(t.source,")");return n.map((function(t){return B_(Number(e.replace(new RegExp("U".concat(t),"g"),"").replace(new RegExp(i,"g"),"*0")),t)}))[0]}var Q_=function(t){return Z_(new RegExp("px","g"),t)},J_=f_(Q_);f_((function(t){return Z_(new RegExp("%","g"),t)}));var tB=function(t){return le(t)||isFinite(Number(t))?B_(Number(t)||0,"px"):Z_(new RegExp("px|%|em|rem","g"),t)},eB=f_(tB),nB=function(t){return Z_(new RegExp("deg|rad|grad|turn","g"),t)},iB=f_(nB);function rB(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=T_(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=E_(t.unit)):(A_.isLength(t.unit)||A_.isLength(e.unit))&&(o=sB(t,r,n),s=sB(e,r,n),a="px"),[o,s,function(t){return i&&(t=Math.max(t,0)),t+a}]}function aB(t){var e=0;return t.unit===p_.kDegrees?e=t.value:t.unit===p_.kRadians?e=hI(Number(t.value)):t.unit===p_.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e}function oB(t,e){var n;return Array.isArray(t)?n=t.map((function(t){return Number(t)})):he(t)?n=t.split(" ").map((function(t){return Number(t)})):le(t)&&(n=[t]),2===e?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat(f(n),f(n)):n}function sB(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===p_.kPixels)return Number(t.value);if(t.unit===p_.kPercentage&&n){var r=n.nodeName===UD.GROUP?n.getLocalBounds():n.getGeometryBounds();return(i?r.min[e]:0)+t.value/100*r.halfExtents[e]*2}return 0}var lB=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function uB(t){return t.toString()}var cB=function(t){return"number"==typeof t?B_(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?B_(Number(t)):B_(0)},hB=f_(cB);function dB(t,e){return[t,e,uB]}function fB(t,e){return function(n,i){return[n,i,function(n){return uB(de(n,t,e))}]}}function pB(t,e){if(t.length===e.length)return[t,e,function(t){return t}]}function gB(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=Ye(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength}function vB(t,e){return t[0]===e[0]&&t[1]===e[1]}function yB(t,e){var n=t.prePoint,i=t.currentPoint,r=t.nextPoint,a=Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2),o=Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2),s=Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||0===Math.sin(l)||Ke(l,0))return{xExtra:0,yExtra:0};var u=Math.abs(Math.atan2(r[1]-i[1],r[0]-i[0])),c=Math.abs(Math.atan2(r[0]-i[0],r[1]-i[1]));return u=u>Math.PI/2?Math.PI-u:u,c=c>Math.PI/2?Math.PI-c:c,{xExtra:Math.cos(l/2-u)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(c-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0}}function mB(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}f_((function(t){return he(t)?t.split(" ").map(hB):t.map(hB)}));var bB=function(t,e){var n=t.x*e.x+t.y*e.y,i=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/i)},xB=function(t,e,n,i,r,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=uI(i=Ze(i,360));if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2));f=f<0?0:f;var p=(r!==a?1:-1)*Math.sqrt(f),g=p*(e*h.y/n),v=p*(-n*h.x/e),y={x:Math.cos(l)*g-Math.sin(l)*v+(t.x+o.x)/2,y:Math.sin(l)*g+Math.cos(l)*v+(t.y+o.y)/2},m={x:(h.x-g)/e,y:(h.y-v)/n},b=bB({x:1,y:0},m),x=bB(m,{x:(-h.x-g)/e,y:(-h.y-v)/n});!a&&x>0?x-=2*Math.PI:a&&x<0&&(x+=2*Math.PI);var E=b+(x%=2*Math.PI)*s,w=e*Math.cos(E),k=n*Math.sin(E);return{x:Math.cos(l)*w-Math.sin(l)*k+y.x,y:Math.sin(l)*w+Math.cos(l)*k+y.y,ellipticalArcStartAngle:b,ellipticalArcEndAngle:b+x,ellipticalArcAngle:E,ellipticalArcCenter:y,resultantRx:e,resultantRy:n}};function EB(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.arcParams,r=i.rx,a=void 0===r?0:r,o=i.ry,s=void 0===o?0:o,l=i.xRotation,u=i.arcFlag,c=i.sweepFlag,h=xB({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=xB({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,p=d.y-h.y,g=Math.sqrt(f*f+p*p);return{x:-f/g,y:-p/g}}function wB(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function kB(t,e){return wB(t)*wB(e)?(t[0]*e[0]+t[1]*e[1])/(wB(t)*wB(e)):1}function MB(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(kB(t,e))}function SB(t,e){var n=e[1],i=e[2],r=Ze(uI(e[3]),2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(r)*(s-u)/2+Math.sin(r)*(l-c)/2,d=-1*Math.sin(r)*(s-u)/2+Math.cos(r)*(l-c)/2,f=h*h/(n*n)+d*d/(i*i);f>1&&(n*=Math.sqrt(f),i*=Math.sqrt(f));var p=n*n*(d*d)+i*i*(h*h),g=p?Math.sqrt((n*n*(i*i)-p)/p):1;a===o&&(g*=-1),isNaN(g)&&(g=0);var v=i?g*n*d/i:0,y=n?g*-i*h/n:0,m=(s+u)/2+Math.cos(r)*v-Math.sin(r)*y,b=(l+c)/2+Math.sin(r)*v+Math.cos(r)*y,x=[(h-v)/n,(d-y)/i],E=[(-1*h-v)/n,(-1*d-y)/i],w=MB([1,0],x),k=MB(x,E);return kB(x,E)<=-1&&(k=Math.PI),kB(x,E)>=1&&(k=0),0===o&&k>0&&(k-=2*Math.PI),1===o&&k<0&&(k+=2*Math.PI),{cx:m,cy:b,rx:vB(t,[u,c])?0:n,ry:vB(t,[u,c])?0:i,startAngle:w,endAngle:w+k,xRotation:r,arcFlag:a,sweepFlag:o}}var NB=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Ie(t)}catch(n){e=Ie(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],i=t[e];if("M"===i[0]&&n){var r=n[0],a=[i[1],i[2]],o=void 0;"L"===r||"M"===r?o=[n[1],n[2]]:"C"!==r&&"A"!==r&&"Q"!==r||(o=[n[n.length-2],n[n.length-1]]),o&&vB(a,o)&&(t.splice(e,1),e--)}}}(e);var n=function(t){for(var e=!1,n=t.length,i=0;i<n;i++){var r=t[i][0];if("C"===r||"A"===r||"Q"===r){e=!0;break}}return e}(e),i=function(t){for(var e=[],n=[],i=[],r=0;r<t.length;r++){var a=t[r],o=a[0];"M"===o?(i.length&&(n.push(i),i=[]),i.push([a[1],a[2]])):"Z"===o?i.length&&(e.push(i),i=[]):i.push([a[1],a[2]])}return i.length>0&&n.push(i),{polygons:e,polylines:n}}(e),r=i.polygons,a=i.polylines,o=function(t){for(var e=[],n=null,i=null,r=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];i=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":r=[l[1],l[2]],a=s;break;case"A":var h=SB(n,l);c.arcParams=h}if("Z"===u)n=r,i=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]]}i&&"Z"===i[0]&&(i=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&vB(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=i?[i[i.length-2],i[i.length-1]]:null;c.nextPoint=f;var p=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];else if("Q"===u){var g=[l[1],l[2]];c.startTangent=[p[0]-g[0],p[1]-g[1]],c.endTangent=[n[0]-g[0],n[1]-g[1]]}else if("T"===u){var v=e[s-1],y=mB(v.currentPoint,p);"Q"===v.command?(c.command="Q",c.startTangent=[p[0]-y[0],p[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]])}else if("C"===u){var m=[l[1],l[2]],b=[l[3],l[4]];c.startTangent=[p[0]-m[0],p[1]-m[1]],c.endTangent=[n[0]-b[0],n[1]-b[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-b[0],m[1]-b[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[b[0]-m[0],b[1]-m[1]])}else if("S"===u){var x=e[s-1],E=mB(x.currentPoint,p),w=[l[1],l[2]];"C"===x.command?(c.command="C",c.startTangent=[p[0]-E[0],p[1]-E[1]],c.endTangent=[n[0]-w[0],n[1]-w[1]]):(c.command="SQ",c.startTangent=[p[0]-w[0],p[1]-w[1]],c.endTangent=[n[0]-w[0],n[1]-w[1]])}else if("A"===u){var k=EB(c,0),M=k.x,S=k.y,N=EB(c,1,!1),T=N.x,A=N.y;c.startTangent=[M,S],c.endTangent=[T,A]}e.push(c)}return e}(e),s=function(t){for(var e=[],n=[],i=[],r=0;r<t.length;r++){var a=t[r],o=a.currentPoint,s=a.params,l=a.prePoint,u=void 0;switch(a.command){case"Q":u=In(l[0],l[1],s[1],s[2],s[3],s[4]);break;case"C":u=Pn(l[0],l[1],s[1],s[2],s[3],s[4],s[5],s[6]);break;case"A":var c=a.arcParams;u=Mn(c.cx,c.cy,c.rx,c.ry,c.xRotation,c.startAngle,c.endAngle);break;default:e.push(o[0]),n.push(o[1])}u&&(a.box=u,e.push(u.x,u.x+u.width),n.push(u.y,u.y+u.height))}e=e.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0})),n=n.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0}));var h=Xe(e),d=Xe(n),f=qe(e),p=qe(n);if(0===i.length)return{x:h,y:d,width:f-h,height:p-d};for(var g=0;g<i.length;g++){var v=i[g],y=v.currentPoint;y[0]===h?h-=yB(v,0).xExtra:y[0]===f&&(f+=yB(v,0).xExtra),y[1]===d?d-=yB(v,0).yExtra:y[1]===p&&(p+=yB(v,0).yExtra)}return{x:h,y:d,width:f-h,height:p-d}}(o),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:r,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}}},TB=f_(NB);function AB(t){return he(t)?TB(t):NB(t)}function OB(t,e,n){var i=t.curve,r=e.curve;i&&0!==i.length||(i=rn(t.absolutePath,!1),t.curve=i),r&&0!==r.length||(r=rn(e.absolutePath,!1),e.curve=r);var a=[i,r];i.length!==r.length&&(a=on(i,r));var o=sn(a[0])!==sn(a[1])?ln(a[0]):un(a[0]);return[o,cn(a[1],o),function(t){return t}]}function PB(t,e){return[t.points,e.points,function(t){return t}]}var CB=null,RB=/\s*(\w+)\(([^)]*)\)/g;function LB(t){return function(e){var n=0;return t.map((function(t){return t===CB?e[n++]:t}))}}function DB(t){return t}var IB={matrix:["NNNNNN",[CB,CB,0,0,CB,CB,0,0,0,0,1,0,CB,CB,0,1],DB],matrix3d:["NNNNNNNNNNNNNNNN",DB],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",LB([CB,CB,new A_(1)]),DB],scaleX:["N",LB([CB,new A_(1),new A_(1)]),LB([CB,new A_(1)])],scaleY:["N",LB([new A_(1),CB,new A_(1)]),LB([new A_(1),CB])],scaleZ:["N",LB([new A_(1),new A_(1),CB])],scale3d:["NNN",DB],skew:["Aa",null,DB],skewX:["A",null,LB([CB,P_])],skewY:["A",null,LB([P_,CB])],translate:["Tt",LB([CB,CB,O_]),DB],translateX:["T",LB([CB,O_,O_]),LB([CB,O_])],translateY:["T",LB([O_,CB,O_]),LB([O_,CB])],translateZ:["L",LB([O_,O_,CB])],translate3d:["TTL",DB]};function _B(t){for(var e=[],n=t.length,i=0;i<n;i++){var r=t[i],a=r[0],o=r.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!IB[a])return[];var s=o.map((function(t){return B_(t)}));e.push({t:a,d:s})}return e}function BB(t){if(Array.isArray(t))return _B(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],i=0;for(RB.lastIndex=0;e=RB.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var r=e[1],a=IB[r];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var l=[],u=0;u<s.length;u++){var c,h=o[u],d=s[u];if(void 0===(c=h?{A:function(t){return"0"===t.trim()?P_:nB(t)},N:cB,T:tB,L:Q_}[d.toUpperCase()](h):{a:P_,n:l[0],t:O_}[d]))return[];l.push(c)}if(n.push({t:r,d:l}),RB.lastIndex===t.length)return n}return[]}function FB(t){var e,n,i,r;switch(t.t){case"rotateX":return r=uI(aB(t.d[0])),[1,0,0,0,0,Math.cos(r),Math.sin(r),0,0,-Math.sin(r),Math.cos(r),0,0,0,0,1];case"rotateY":return r=uI(aB(t.d[0])),[Math.cos(r),0,-Math.sin(r),0,0,1,0,0,Math.sin(r),0,Math.cos(r),0,0,0,0,1];case"rotate":case"rotateZ":return r=uI(aB(t.d[0])),[Math.cos(r),Math.sin(r),0,0,-Math.sin(r),Math.cos(r),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,i=t.d[2].value,r=uI(aB(t.d[3]));var a=e*e+n*n+i*i;if(0===a)e=1,n=0,i=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,i/=o}var s=Math.sin(r/2),l=s*Math.cos(r/2),u=s*s;return[1-2*(n*n+i*i)*u,2*(e*n*u+i*l),2*(e*i*u-n*l),0,2*(e*n*u-i*l),1-2*(e*e+i*i)*u,2*(n*i*u+e*l),0,2*(e*i*u+n*l),2*(n*i*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=uI(aB(t.d[0])),h=uI(aB(t.d[1]));return[1,Math.tan(h),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return r=uI(aB(t.d[0])),[1,0,0,0,Math.tan(r),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return r=uI(aB(t.d[0])),[1,Math.tan(r),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=sB(t.d[0],0,null)||0,n=sB(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=sB(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=sB(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,i=sB(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=sB(t.d[0],0,null)||0,n=sB(t.d[1],0,null)||0,i=sB(t.d[2],0,null)||0,1];case"perspective":var d=sB(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,d?-1/d:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map((function(t){return t.value}))}}function jB(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function GB(t){var e=[0,0,0],n=[1,1,1],i=[0,0,0],r=[0,0,0,1],a=[0,0,0,1];return function(t,e,n,i,r,a){if(!function(t,e){var n=e[15];if(0===n)return!1;for(var i=1/n,r=0;r<16;r++)t[r]=e[r]*i;return!0}(gI,t))return!1;if(Z(vI,gI),vI[3]=0,vI[7]=0,vI[11]=0,vI[15]=1,Math.abs(rt(vI))<1e-8)return!1;var o,s,l=gI[3],u=gI[7],c=gI[11],h=gI[12],d=gI[13],f=gI[14],p=gI[15];if(0!==l||0!==u||0!==c){if(yI[0]=l,yI[1]=u,yI[2]=c,yI[3]=p,!nt(vI,vI))return!1;et(vI,vI),X(r,yI,vI)}else r[0]=r[1]=r[2]=0,r[3]=1;if(e[0]=h,e[1]=d,e[2]=f,s=gI,(o=mI)[0][0]=s[0],o[0][1]=s[1],o[0][2]=s[2],o[1][0]=s[4],o[1][1]=s[5],o[1][2]=s[6],o[2][0]=s[8],o[2][1]=s[9],o[2][2]=s[10],n[0]=S(mI[0]),I(mI[0],mI[0]),i[0]=_(mI[0],mI[1]),xI(mI[1],mI[1],mI[0],1,-i[0]),n[1]=S(mI[1]),I(mI[1],mI[1]),i[0]/=n[1],i[1]=_(mI[0],mI[2]),xI(mI[2],mI[2],mI[0],1,-i[1]),i[2]=_(mI[1],mI[2]),xI(mI[2],mI[2],mI[1],1,-i[2]),n[2]=S(mI[2]),I(mI[2],mI[2]),i[1]/=n[2],i[2]/=n[2],B(bI,mI[1],mI[2]),_(mI[0],bI)<0)for(var g=0;g<3;g++)n[g]*=-1,mI[g][0]*=-1,mI[g][1]*=-1,mI[g][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+mI[0][0]-mI[1][1]-mI[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-mI[0][0]+mI[1][1]-mI[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-mI[0][0]-mI[1][1]+mI[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+mI[0][0]+mI[1][1]+mI[2][2],0)),mI[2][1]>mI[1][2]&&(a[0]=-a[0]),mI[0][2]>mI[2][0]&&(a[1]=-a[1]),mI[1][0]>mI[0][1]&&(a[2]=-a[2])}(function(t){return 0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(FB).reduce(jB)}(t),e,n,i,r,a),[[e,n,i,a,r]]}var zB=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],i=0;i<4;i++)for(var r=0;r<4;r++)for(var a=0;a<4;a++)n[i][r]+=e[i][a]*t[a][r];return n}return function(e,n,i,r,a){for(var o=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],s=0;s<4;s++)o[s][3]=a[s];for(var l=0;l<3;l++)for(var u=0;u<3;u++)o[3][l]+=e[u]*o[u][l];var c=r[0],h=r[1],d=r[2],f=r[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(h*h+d*d),p[0][1]=2*(c*h-d*f),p[0][2]=2*(c*d+h*f),p[1][0]=2*(c*h+d*f),p[1][1]=1-2*(c*c+d*d),p[1][2]=2*(h*d-c*f),p[2][0]=2*(c*d-h*f),p[2][1]=2*(h*d+c*f),p[2][2]=1-2*(c*c+h*h),o=t(o,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];i[2]&&(g[2][1]=i[2],o=t(o,g)),i[1]&&(g[2][1]=0,g[2][0]=i[0],o=t(o,g)),i[0]&&(g[2][0]=0,g[1][0]=i[0],o=t(o,g));for(var v=0;v<3;v++)for(var y=0;y<3;y++)o[v][y]*=n[v];return function(t){return 0===t[0][2]&&0===t[0][3]&&0===t[1][2]&&0===t[1][3]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]&&0===t[2][3]&&0===t[3][2]&&1===t[3][3]}(o)?[o[0][0],o[0][1],o[1][0],o[1][1],o[3][0],o[3][1]]:o[0].concat(o[1],o[2],o[3])}}();function VB(t){return t.toFixed(6).replace(".000000","")}function WB(t,e){var n,i;return t.decompositionPair!==e&&(t.decompositionPair=e,n=GB(t)),e.decompositionPair!==t&&(e.decompositionPair=t,i=GB(e)),null===n[0]||null===i[0]?[[!1],[!0],function(n){return n?e[0].d:t[0].d}]:(n[0].push(0),i[0].push(1),[n,i,function(t){var e=function(t,e,n){var i=function(t,e){for(var n=0,i=0;i<t.length;i++)n+=t[i]*e[i];return n}(t,e),r=[];if(1===(i=de(i,-1,1)))r=t;else for(var a=Math.acos(i),o=1*Math.sin(n*a)/Math.sqrt(1-i*i),s=0;s<4;s++)r.push(t[s]*(Math.cos(n*a)-i*o)+e[s]*o);return r}(n[0][3],i[0][3],t[5]);return zB(t[0],t[1],t[2],e,t[4]).map(VB).join(",")}])}function UB(t){return t.replace(/[XY]/,"")}function HB(t){return t.replace(/(X|Y|Z|3d)?$/,"3d")}function YB(t,e,n){var i=!1;if(!t.length||!e.length){t.length||(i=!0,t=e,e=[]);for(var r=function(){var n=t[a],i=n.t,r=n.d,o="scale"===i.substring(0,5)?1:0;e.push({t:i,d:r.map((function(t){return"number"==typeof t?B_(o):B_(o,t.unit)}))})},a=0;a<t.length;a++)r()}var o,s,l=[],u=[],c=[];if(t.length!==e.length){var h=WB(t,e);l=[h[0]],u=[h[1]],c=[["matrix",[h[2]]]]}else for(var d=0;d<t.length;d++){var f=t[d].t,p=e[d].t,g=t[d].d,v=e[d].d,y=IB[f],m=IB[p],b=void 0;if(s=p,"perspective"===(o=f)&&"perspective"===s||!("matrix"!==o&&"matrix3d"!==o||"matrix"!==s&&"matrix3d"!==s)){var x=WB([t[d]],[e[d]]);l.push(x[0]),u.push(x[1]),c.push(["matrix",[x[2]]])}else{if(f===p)b=f;else if(y[2]&&m[2]&&UB(f)===UB(p))b=UB(f),g=y[2](g),v=m[2](v);else{if(!y[1]||!m[1]||HB(f)!==HB(p)){var E=WB(t,e);l=[E[0]],u=[E[1]],c=[["matrix",[E[2]]]];break}b=HB(f),g=y[1](g),v=m[1](v)}for(var w=[],k=[],M=[],S=0;S<g.length;S++){var N=rB(g[S],v[S],n,!1,S);w[S]=N[0],k[S]=N[1],M.push(N[2])}l.push(w),u.push(k),c.push([b,M])}}if(i){var T=l;l=u,u=T}return[l,u,function(t){return t.map((function(t,e){var n=t.map((function(t,n){return c[e][1][n](t)})).join(",");return"matrix"===c[e][0]&&16===n.split(",").length&&(c[e][0]="matrix3d"),"matrix3d"===c[e][0]&&6===n.split(",").length&&(c[e][0]="matrix"),"".concat(c[e][0],"(").concat(n,")")})).join(" ")}]}var $B=f_((function(t){if(he(t)){if("text-anchor"===t)return[B_(0,"px"),B_(0,"px")];var e=t.split(" ");return 1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length?null:[eB(XB(e[0])),eB(XB(e[1]))]}return[B_(t[0]||0,"px"),B_(t[1]||0,"px")]}));function XB(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t}var qB=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:LI.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:LI.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:LI.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:LI.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:LI.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:LI.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:LI.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:LI.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:LI.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:LI.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:LI.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:LI.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:LI.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:LI.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:LI.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:LI.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:LI.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:LI.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:LI.FILTER},{n:"clipPath",syntax:LI.DEFINED_PATH},{n:"textPath",syntax:LI.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:LI.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:LI.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:LI.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:LI.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:LI.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:LI.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:LI.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:LI.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:LI.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:LI.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:LI.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:LI.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:LI.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:LI.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:LI.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:LI.COORDINATE},{n:"y1",int:!0,l:!0,syntax:LI.COORDINATE},{n:"z1",int:!0,l:!0,syntax:LI.COORDINATE},{n:"x2",int:!0,l:!0,syntax:LI.COORDINATE},{n:"y2",int:!0,l:!0,syntax:LI.COORDINATE},{n:"z2",int:!0,l:!0,syntax:LI.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:LI.PATH,p:50},{n:"points",int:!0,l:!0,syntax:LI.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:LI.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:LI.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:LI.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:LI.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:LI.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:LI.NUMBER,d:function(t){return t===UD.PATH||t===UD.POLYGON||t===UD.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:LI.MARKER},{n:"markerEnd",syntax:LI.MARKER},{n:"markerMid",syntax:LI.MARKER},{n:"markerStartOffset",syntax:LI.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:LI.LENGTH,l:!0,int:!0,d:"0"}],KB=new Set(qB.filter((function(t){return!!t.l})).map((function(t){return t.n}))),ZB={},QB=function(){return c((function t(e){var n=this;l(this,t),this.runtime=e,qB.forEach((function(t){n.registerMetadata(t)}))}),[{key:"registerMetadata",value:function(t){[t.n].concat(f(t.a||[])).forEach((function(e){ZB[e]=t}))}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,r=t.parsedStyle.offsetPath;!function(t,e){var n=JB(t);for(var i in e)n.has(i)&&(t.parsedStyle[i]=e[i])}(t,e);var a=!!n.forceUpdateGeometry;if(!a)for(var o in e)if(KB.has(o)){a=!0;break}var l,u=JB(t);u.has("fill")&&e.fill&&(t.parsedStyle.fill=q_(e.fill)),u.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=q_(e.stroke)),u.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=q_(e.shadowColor)),u.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,i=[],r=0;e=n.exec(t);){if(e.index!==r)return[];if(r=e.index+e[0].length,lB.indexOf(e[1])>-1&&i.push({name:e[1],params:e[2].split(" ").map((function(t){return Z_(/deg|rad|grad|turn|px|%/g,t)||q_(t)}))}),n.lastIndex===t.length)return i}return[]}(e.filter)),u.has("radius")&&!ce(e.radius)&&(t.parsedStyle.radius=oB(e.radius,4)),u.has("lineDash")&&!ce(e.lineDash)&&(t.parsedStyle.lineDash=oB(e.lineDash,"even")),u.has("points")&&e.points&&(t.parsedStyle.points={points:he(l=e.points)?l.split(" ").map((function(t){var e=b(t.split(","),2),n=e[0],i=e[1];return[Number(n),Number(i)]})):l,totalLength:0,segments:[]}),u.has("d")&&""===e.d&&(t.parsedStyle.d=s({},RI)),u.has("d")&&e.d&&(t.parsedStyle.d=AB(e.d)),u.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[LI.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),u.has("clipPath")&&!hn(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[LI.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),u.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[LI.DEFINED_PATH].calculator("offsetPath",r,e.offsetPath,t,this.runtime),u.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return _B(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],i=0;for(RB.lastIndex=0;e=RB.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var r=e[1],a=IB[r];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var l=[],u=0;u<s.length;u++){var c,h=o[u],d=s[u];if(void 0===(c=h?{A:function(t){return"0"===t.trim()?P_:iB(t)},N:hB,T:eB,L:J_}[d.toUpperCase()](h):{a:P_,n:l[0],t:O_}[d]))return[];l.push(c)}if(n.push({t:r,d:l}),RB.lastIndex===t.length)return n}return[]}(e.transform)),u.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=$B(e.transformOrigin)),u.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[LI.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),u.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[LI.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),u.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[LI.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),u.has("zIndex")&&!ce(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[LI.Z_INDEX].postProcessor(t),u.has("offsetDistance")&&!ce(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[LI.OFFSET_DISTANCE].postProcessor(t),u.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[LI.TRANSFORM].postProcessor(t),u.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[LI.TRANSFORM_ORIGIN].postProcessor(t),a&&(t.geometry.dirty=!0,t.dirty(!0,!0),n.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t))}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var i=t.geometry;i.contentBounds||(i.contentBounds=new JD),i.renderBounds||(i.renderBounds=new JD);var r=t.parsedStyle,a=n.update(r,t),o=a.cx,s=void 0===o?0:o,l=a.cy,u=void 0===l?0:l,c=a.cz,h=void 0===c?0:c,d=a.hwidth,f=void 0===d?0:d,p=a.hheight,g=void 0===p?0:p,v=a.hdepth,y=void 0===v?0:v,m=[Math.abs(f),Math.abs(g),y],b=r.stroke,x=r.lineWidth,E=void 0===x?1:x,w=r.increasedLineWidthForHitTesting,k=void 0===w?0:w,M=r.shadowType,S=void 0===M?"outer":M,N=r.shadowColor,T=r.filter,A=void 0===T?[]:T,P=r.transformOrigin,C=[s,u,h];i.contentBounds.update(C,m);var R=e===UD.POLYLINE||e===UD.POLYGON||e===UD.PATH?Math.SQRT2:.5;if(b&&!b.isNone){var L=((E||0)+(k||0))*R;m[0]+=L,m[1]+=L}if(i.renderBounds.update(C,m),N&&S&&"inner"!==S){var D=i.renderBounds,I=D.min,_=D.max,B=r.shadowBlur||0,F=r.shadowOffsetX||0,j=r.shadowOffsetY||0,G=I[0]-B+F,z=_[0]+B+F,V=I[1]-B+j,W=_[1]+B+j;I[0]=Math.min(I[0],G),_[0]=Math.max(_[0],z),I[1]=Math.min(I[1],V),_[1]=Math.max(_[1],W),i.renderBounds.setMinMax(I,_)}A.forEach((function(t){var e=t.name,n=t.params;if("blur"===e){var r=n[0].value;i.renderBounds.update(i.renderBounds.center,O(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[r,r,0]))}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=i.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,p=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],p),i.renderBounds.setMinMax(u,c)}})),t.geometry.dirty=!1;var U=g<0,H=(f<0?-1:1)*(P?sB(P[0],0,t,!0):0),Y=(U?-1:1)*(P?sB(P[1],1,t,!0):0);(H||Y)&&t.setOrigin(H,Y)}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===UD.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===UD.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}])}();function JB(t){return t.constructor.PARSED_STYLE_LIST}var tF=function(){return c((function t(){l(this,t),this.mixer=dB}),[{key:"calculator",value:function(t,e,n,i){return aB(n)}}])}(),eF=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i,r){return n instanceof N_&&(n=null),r.sceneGraphService.updateDisplayObjectDependency(t,e,n,i),"clipPath"===t&&i.forEach((function(t){0===t.childNodes.length&&r.sceneGraphService.dirtyToRoot(t)})),n}}])}(),nF=function(){return c((function t(){l(this,t),this.parser=q_,this.mixer=K_}),[{key:"calculator",value:function(t,e,n,i){return n instanceof N_?"none"===n.value?D_:I_:n}}])}(),iF=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n){return n instanceof N_?[]:n}}])}();function rF(t){var e=t.parsedStyle.fontSize;return ce(e)?null:e}var aF=function(){return c((function t(){l(this,t),this.mixer=dB}),[{key:"calculator",value:function(t,e,n,i,r){if(le(n))return n;if(!A_.isRelativeUnit(n.unit))return n.value;if(n.unit===p_.kPercentage)return 0;if(n.unit===p_.kEms){if(i.parentNode){var a=rF(i.parentNode);if(a)return a*n.value}return 0}if(n.unit===p_.kRems){var o;if(null!=i&&null!==(o=i.ownerDocument)&&void 0!==o&&o.documentElement){var s=rF(i.ownerDocument.documentElement);if(s)return s*n.value}return 0}}}])}(),oF=function(){return c((function t(){l(this,t),this.mixer=pB}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),sF=function(){return c((function t(){l(this,t),this.mixer=pB}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),lF=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){var r;n instanceof N_&&(n=null);var a=null===(r=n)||void 0===r?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a}}])}(),uF=function(){return c((function t(){l(this,t),this.mixer=dB}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),cF=function(){return c((function t(){l(this,t),this.mixer=fB(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,i=e.offsetDistance;if(n){var r=n.nodeName;if(r===UD.LINE||r===UD.PATH||r===UD.POLYLINE){var a=n.getPoint(i);a&&t.setLocalPosition(a.x,a.y)}}}}])}(),hF=function(){return c((function t(){l(this,t),this.mixer=fB(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),dF=function(){return c((function t(){l(this,t),this.parser=AB,this.mixer=OB}),[{key:"calculator",value:function(t,e,n){return n instanceof N_&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new iI(0,0,0,0)}:n}}])}(),fF=c((function t(){l(this,t),this.mixer=PB})),pF=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).mixer=fB(0,1/0),t}return m(e,t),c(e)}(aF),gF=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){return n instanceof N_?"unset"===n.value?"":n.value:"".concat(n)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}])}(),vF=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){var r=i.getAttribute("text");if(r){var a=r;"capitalize"===n.value?a=r.charAt(0).toUpperCase()+r.slice(1):"lowercase"===n.value?a=r.toLowerCase():"uppercase"===n.value&&(a=r.toUpperCase()),i.parsedStyle.text=a}return n.value}}])}();new WeakMap,"undefined"!=typeof window&&window.document;var yF={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},mF="object"==typeof performance&&performance.now?performance:Date;function bF(t){return t.nodeName===UD.FRAGMENT||t.getRootNode().nodeName===UD.FRAGMENT}var xF=1,EF="object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:{},wF=Date.now(),kF={},MF=Date.now(),SF=function(t){if("function"!=typeof t)throw new TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-MF,i=n>16?0:16-n,r=xF++;return kF[r]=t,Object.keys(kF).length>1||setTimeout((function(){MF=e;var t=kF;kF={},Object.keys(t).forEach((function(e){return t[e](EF.performance&&"function"==typeof EF.performance.now?EF.performance.now():Date.now()-wF)}))}),i),r},NF=function(t){delete kF[t]},TF=function(t){return"string"!=typeof t?SF:""===t?EF.requestAnimationFrame:EF["".concat(t,"RequestAnimationFrame")]},AF=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1}}(["","webkit","moz","ms","o"],(function(t){return!!TF(t)})),OF=TF(AF),PF=function(t){return"string"!=typeof t?NF:""===t?EF.cancelAnimationFrame:EF["".concat(t,"CancelAnimationFrame")]||EF["".concat(t,"CancelRequestAnimationFrame")]}(AF);EF.requestAnimationFrame=OF,EF.cancelAnimationFrame=PF;var CF=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],RF=/([\"\'])[^\'\"]+\1/;function LF(t){var e=t.fontSize,n=void 0===e?16:e,i=t.fontFamily,r=void 0===i?"sans-serif":i,a=t.fontStyle,o=void 0===a?"normal":a,s=t.fontVariant,l=void 0===s?"normal":s,u=t.fontWeight;return{fontSize:n,fontFamily:r,fontStyle:o,fontVariant:l,fontWeight:void 0===u?"normal":u}}var DF=f_((function(t){for(var e=LF(t),n=e.fontSize,i=e.fontFamily,r=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=le(n)&&"".concat(n,"px")||"16px",l=i.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!RF.test(c)&&CF.indexOf(c)<0&&(c='"'.concat(c,'"')),l[u]=c}return"".concat(r," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","))}),(function(t){var e=LF(t),n=e.fontSize,i=e.fontFamily,r=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(r,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(i)})),IF=function(t){return Math.max(t,1e-6)};function _F(t,e,n){return tt(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t}var BF=q(),FF=q(),jF={scale:function(t){ft(BF,[t[0].value,t[1].value,1].map((function(t){return IF(t)})))},scaleX:function(t){ft(BF,[t[0].value,1,1].map((function(t){return IF(t)})))},scaleY:function(t){ft(BF,[1,t[0].value,1].map((function(t){return IF(t)})))},scaleZ:function(t){ft(BF,[1,1,t[0].value].map((function(t){return IF(t)})))},scale3d:function(t){ft(BF,[t[0].value,t[1].value,t[2].value].map((function(t){return IF(t)})))},translate:function(t){dt(BF,[t[0].value,t[1].value,0])},translateX:function(t){dt(BF,[t[0].value,0,0])},translateY:function(t){dt(BF,[0,t[0].value,0])},translateZ:function(t){dt(BF,[0,0,t[0].value])},translate3d:function(t){dt(BF,[t[0].value,t[1].value,t[2].value])},rotate:function(t){yt(BF,uI(aB(t[0])))},rotateX:function(t){gt(BF,uI(aB(t[0])))},rotateY:function(t){vt(BF,uI(aB(t[0])))},rotateZ:function(t){yt(BF,uI(aB(t[0])))},rotate3d:function(t){pt(BF,uI(aB(t[3])),[t[0].value,t[1].value,t[2].value])},skew:function(t){_F(BF,uI(t[0].value),uI(t[1].value))},skewX:function(t){_F(BF,uI(t[0].value),0)},skewY:function(t){_F(BF,0,uI(t[0].value))},matrix:function(t){J(BF,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1)},matrix3d:function(e){J.apply(t,[BF].concat(f(e.map((function(t){return t.value})))))}},GF=N(1,1,1),zF=k(),VF={translate:function(t,e){jj.sceneGraphService.setLocalScale(t,GF,!1),jj.sceneGraphService.setLocalEulerAngles(t,zF,void 0,void 0,!1),jj.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),jj.sceneGraphService.dirtyLocalTransform(t,t.transformable)}},WF=function(){return c((function t(){l(this,t),this.parser=BB,this.mixer=YB}),[{key:"calculator",value:function(t,e,n,i){return n instanceof N_?[]:n}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&VF[t[0].t])return void VF[t[0].t](e,t[0].d);for(var n=tt(FF),i=0;i<t.length;i++){var r=t[i],a=r.t,o=r.d,s=jF[a];s&&(s(o),Ut(n,n,BF))}e.setLocalTransform(n)}else e.resetLocalTransform();e.getLocalTransform()}(t.parsedStyle.transform,t)}}])}(),UF=function(){return c((function t(){l(this,t)}),[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===p_.kPixels&&e[1].unit===p_.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds()}}])}(),HF=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){return n.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,i=e.sortable;n&&e.dirty(),i&&(i.dirty=!0,i.dirtyReason=TI.Z_INDEX_CHANGED)}}}])}(),YF=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,i=void 0===n?0:n,r=t.cy,a=void 0===r?0:r,o=t.r,s=void 0===o?0:o;return{cx:i,cy:a,hwidth:s,hheight:s}}}])}(),$F=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,i=void 0===n?0:n,r=t.cy,a=void 0===r?0:r,o=t.rx,s=void 0===o?0:o,l=t.ry;return{cx:i,cy:a,hwidth:s,hheight:void 0===l?0:l}}}])}(),XF=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){var e=t.x1,n=t.y1,i=t.x2,r=t.y2,a=Math.min(e,i),o=Math.max(e,i),s=Math.min(n,r),l=(o-a)/2,u=(Math.max(n,r)-s)/2;return{cx:a+l,cy:s+u,hwidth:l,hheight:u}}}])}(),qF=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){var e=t.d.rect,n=e.x,i=e.y,r=e.width/2,a=e.height/2;return{cx:n+r,cy:i+a,hwidth:r,hheight:a}}}])}(),KF=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){if(t.points&&$e(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,f(e.map((function(t){return t[0]})))),i=Math.max.apply(Math,f(e.map((function(t){return t[0]})))),r=Math.min.apply(Math,f(e.map((function(t){return t[1]})))),a=Math.max.apply(Math,f(e.map((function(t){return t[1]})))),o=(i-n)/2,s=(a-r)/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),ZF=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.x,i=void 0===n?0:n,r=t.y,a=void 0===r?0:r,o=t.src,s=t.width,l=void 0===s?0:s,u=t.height,c=l,h=void 0===u?0:u;return o&&!he(o)&&(c||(c=o.width,t.width=c),h||(h=o.height,t.height=h)),{cx:i+c/2,cy:a+h/2,hwidth:c/2,hheight:h/2}}}])}(),QF=function(){return c((function t(e){l(this,t),this.globalRuntime=e}),[{key:"isReadyToMeasure",value:function(t,e){return t.text}},{key:"update",value:function(t,e){var n,i=t.text,r=t.textAlign,a=void 0===r?"start":r,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,p=t.x,g=void 0===p?0:p,v=t.y,y=void 0===v?0:v;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var m=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(i,t,m);t.metrics=b;var x=b.width/2,E=b.height/2,w=g+x;"center"===a||"middle"===a?w+=s/2-x:"right"!==a&&"end"!==a||(w+=s-2*x);var k=y-E;return"middle"===u?k+=E:"top"===u||"hanging"===u?k+=2*E:"alphabetic"===u||"bottom"!==u&&"ideographic"!==u||(k+=0),h&&(w+=h),f&&(k+=f),{cx:w,cy:k,hwidth:x,hheight:E}}}])}(),JF=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),tj=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.x,i=void 0===n?0:n,r=t.y,a=void 0===r?0:r,o=t.width,s=void 0===o?0:o,l=t.height,u=void 0===l?0:l;return{cx:i+s/2,cy:a+u/2,hwidth:s/2,hheight:u/2}}}])}(),ej=function(){return c((function t(e){l(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new nI,this.page=new nI,this.canvas=new nI,this.viewport=new nI,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}),[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(rI)}}])}(),nj=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).client=new nI,t.movement=new nI,t.offset=new nI,t.global=new nI,t.screen=new nI,t}return m(e,t),c(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw new Error(rI)}}])}(ej),ij=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).width=0,t.height=0,t.isPrimary=!1,t}return m(e,t),c(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(nj),rj=function(t){function e(){return l(this,e),v(this,e,arguments)}return m(e,t),c(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(nj),aj=function(t){function e(t,n){var i;return l(this,e),(i=v(this,e,[null])).type=t,i.detail=n,Object.assign(i,n),i}return m(e,t),c(e)}(ej),oj=function(){return c((function t(){l(this,t),this.emitter=new x}),[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this}},{key:"addEventListener",value:function(t,e,n){var i=!1,r=!1;if(pn(n))i=n;else if(n){var a=n.capture;i=void 0!==a&&a;var o=n.once;r=void 0!==o&&o}i&&(t+="capture"),e=gn(e)?e:e.handleEvent;var s=gn(e)?void 0:e;return r?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,e,n){var i;if(!this.emitter)return this;(pn(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=gn(e)?e:null===(i=e)||void 0===i?void 0:i.handleEvent;var r=gn(e)?void 0:e;return this.emitter.off(t,e,r),this}},{key:"emit",value:function(t,e){this.dispatchEvent(new aj(t,e))}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t)}},{key:"dispatchEvent",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(arguments.length>2?arguments[2]:void 0)return this.dispatchEventToSelf(t),!0;if(this.document)e=this;else if(this.defaultView)e=this.defaultView;else{var i;e=null===(i=this.ownerDocument)||void 0===i?void 0:i.defaultView}if(e){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],n||(t.target=this),t.manager.dispatchEvent(t,t.type,n)}else this.dispatchEventToSelf(t);return!t.defaultPrevented}}])}(),sj=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t.destroyed=!1,t}return m(e,t),c(e,[{key:"textContent",get:function(){var t="";this.nodeName===UD.TEXT&&(t+=this.style.text);var e,n=Gn(this.childNodes);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.nodeName===UD.TEXT?t+=i.nodeValue:t+=i.textContent}}catch(t){n.e(t)}finally{n.f()}return t},set:function(t){var e=this;this.childNodes.slice().forEach((function(t){e.removeChild(t)})),this.nodeName===UD.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(t){throw new Error(rI)}},{key:"lookupNamespaceURI",value:function(t){throw new Error(rI)}},{key:"lookupPrefix",value:function(t){throw new Error(rI)}},{key:"normalize",value:function(){throw new Error(rI)}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n=t,i=this,r=[n],a=[i];null!==(o=n.parentNode)&&void 0!==o?o:i.parentNode;){var o;n=n.parentNode?(r.push(n.parentNode),n.parentNode):n,i=i.parentNode?(a.push(i.parentNode),i.parentNode):i}if(n!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=r.length>a.length?r:a,l=s===r?a:r;if(s[s.length-l.length]===l[0])return s===r?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;return f.indexOf(h)<f.indexOf(d)?l===r?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:s===r?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var i=n.childNodes.length-1;i>=0;i--)e.push(n.childNodes[i])}}}],[{key:"isNode",value:function(t){return!!t.childNodes}}])}(oj);sj.DOCUMENT_POSITION_DISCONNECTED=1,sj.DOCUMENT_POSITION_PRECEDING=2,sj.DOCUMENT_POSITION_FOLLOWING=4,sj.DOCUMENT_POSITION_CONTAINS=8,sj.DOCUMENT_POSITION_CONTAINED_BY=16,sj.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var lj=function(){return c((function t(){l(this,t)}),[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||jj.offscreenCanvas)this.canvas=t||jj.offscreenCanvas,this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(t){}try{return document.createElement("canvas")}catch(t){}return null}}])}(),uj=/\[\s*(.*)=(.*)\s*\]/,cj=function(){return c((function t(){l(this,t)}),[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find((function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.find((function(e){return e.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var i=this.getAttribute(t),r=i.name,a=i.value;return r?e.find((function(t){return e!==t&&("name"===r?t.name===a:n.attributeToString(t,r)===a)})):null}return e.find((function(n){return e!==n&&n.nodeName===t}))}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll((function(i){return e!==i&&((null==i?void 0:i.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.findAll((function(i){return e!==i&&i.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var i=this.getAttribute(t),r=i.name,a=i.value;return r?e.findAll((function(t){return e!==t&&("name"===r?t.name===a:n.attributeToString(t,r)===a)})):[]}return e.findAll((function(n){return e!==n&&n.nodeName===t}))}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),i=n.name,r=n.value;return"name"===i?e.name===r:this.attributeToString(e,i)===r}return e.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var e=t.match(uj),n="",i="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),i=e[2].replace(/"/g,"")),{name:n,value:i}}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return ce(n)?"":n.toString?n.toString():""}}])}(),hj=function(t){return t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.MOUNTED="DOMNodeInsertedIntoDocument",t.REMOVED="removed",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.REPARENT="reparent",t.DESTROY="destroy",t.BOUNDS_CHANGED="bounds-changed",t.CULLED="culled",t}({}),dj=function(t){function e(t,n,i,r,a,o,s,u){var c;return l(this,e),(c=v(this,e,[null])).relatedNode=n,c.prevValue=i,c.newValue=r,c.attrName=a,c.attrChange=o,c.prevParsedValue=s,c.newParsedValue=u,c.type=t,c}return m(e,t),c(e)}(ej);dj.ADDITION=2,dj.MODIFICATION=1,dj.REMOVAL=3;var fj=new dj(hj.REPARENT,null,"","","",0,"",""),pj=ae(),gj=k(),vj=N(1,1,1),yj=q(),mj=ae(),bj=k(),xj=q(),Ej=qt(),wj=k(),kj=qt(),Mj=k(),Sj=k(),Nj=k(),Tj=q(),Aj=qt(),Oj=qt(),Pj=qt(),Cj={affectChildren:!0},Rj=function(){return c((function t(e){l(this,t),this.pendingEvents=new Map,this.boundsChangedEvent=new aj(hj.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e}),[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e)}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e)}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e)}},{key:"attach",value:function(t,e,n){var i,r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var a=t.nodeName===UD.FRAGMENT,o=bF(e);t.parentNode=e;var s=a?t.childNodes:[t];le(n)?s.forEach((function(t){e.childNodes.splice(n,0,t),t.parentNode=e})):s.forEach((function(t){e.childNodes.push(t),t.parentNode=e}));var l=e.sortable;if((null!=l&&null!==(i=l.sorted)&&void 0!==i&&i.length||l.dirty||t.parsedStyle.zIndex)&&(-1===l.dirtyChildren.indexOf(t)&&l.dirtyChildren.push(t),l.dirty=!0,l.dirtyReason=TI.ADDED),!o){if(a)this.dirtifyFragment(t);else{var u=t.transformable;u&&this.dirtyWorldTransform(t,u)}if(r){var c,h=!0===(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation);t.dispatchEvent(fj,h,h)}}}},{key:"detach",value:function(t){var e,n;if(t.parentNode){var i=t.transformable,r=t.parentNode.sortable;(null!=r&&null!==(e=r.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===r.dirtyChildren.indexOf(t)&&r.dirtyChildren.push(t),r.dirty=!0,r.dirtyReason=TI.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),i&&this.dirtyWorldTransform(t,i),t.parentNode=null}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return CI(e),e.localTransform}},{key:"setLocalPosition",value:function(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.transformable;Sj[0]=e[0],Sj[1]=e[1],Sj[2]=null!==(n=e[2])&&void 0!==n?n:0,V(r.localPosition,Sj)||(T(r.localPosition,Sj),i&&this.dirtyLocalTransform(t,r))}},{key:"translateLocal",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;V(e,gj)||(z(e,e,n.localRotation),O(n.localPosition,n.localPosition,e),this.dirtyLocalTransform(t,n))}},{key:"setLocalRotation",value:function(t,e,n,i,r){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];"number"==typeof e&&(e=ne(Ej,e,n,i,r));var o=t.transformable;ee(o.localRotation,e),a&&this.dirtyLocalTransform(t,o)}},{key:"rotateLocal",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;Jt(Oj,e[0],e[1],e[2]),ie(n.localRotation,n.localRotation,Oj),this.dirtyLocalTransform(t,n)}},{key:"setLocalScale",value:function(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.transformable;A(bj,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:r.localScale[2]),V(bj,r.localScale)||(T(r.localScale,bj),i&&this.dirtyLocalTransform(t,r))}},{key:"scaleLocal",value:function(t,e){var n,i=t.transformable;C(i.localScale,i.localScale,A(bj,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,i)}},{key:"setLocalSkew",value:function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];"number"==typeof e&&(e=se(mj,e,n));var r=t.transformable;oe(r.localSkew,e),i&&this.dirtyLocalTransform(t,r)}},{key:"setLocalEulerAngles",value:function(t,e){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var i=t.transformable;Jt(i.localRotation,e[0],e[1],e[2]),n&&this.dirtyLocalTransform(t,i)}},{key:"setLocalTransform",value:function(t,e){var n=xt(wj,e),i=wt(kj,e),r=Et(Mj,e);this.setLocalScale(t,r,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,i,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,vj,!1),this.setLocalPosition(t,gj,!1),this.setLocalEulerAngles(t,gj,void 0,void 0,!1),this.setLocalSkew(t,pj,void 0,!1),this.dirtyLocalTransform(t,t.transformable)}},{key:"getPosition",value:function(t){var e=t.transformable;return xt(e.position,this.getWorldTransform(t,e))}},{key:"getRotation",value:function(t){var e=t.transformable;return wt(e.rotation,this.getWorldTransform(t,e))}},{key:"getScale",value:function(t){var e=t.transformable;return Et(e.scaling,this.getWorldTransform(t,e))}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return e.localDirtyFlag||e.dirtyFlag?(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t),e.worldTransform):e.worldTransform}},{key:"setPosition",value:function(t,e){var n,i=t.transformable;if(Nj[0]=e[0],Nj[1]=e[1],Nj[2]=null!==(n=e[2])&&void 0!==n?n:0,!V(this.getPosition(t),Nj)){if(T(i.position,Nj),null!==t.parentNode&&t.parentNode.transformable){var r=t.parentNode.transformable;Z(Tj,r.worldTransform),nt(Tj,Tj),j(i.localPosition,Nj,Tj)}else T(i.localPosition,Nj);this.dirtyLocalTransform(t,i)}}},{key:"translate",value:function(t,e){"number"==typeof e&&(e=A(bj,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)),V(e,gj)||(O(bj,this.getPosition(t),e),this.setPosition(t,bj))}},{key:"setRotation",value:function(t,e,n,i,r){var a=t.transformable;if("number"==typeof e&&(e=te(e,n,i,r)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);ee(Ej,o),Qt(Ej,Ej),Zt(a.localRotation,Ej,e),re(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a)}else this.setLocalRotation(t,e)}},{key:"rotate",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){var i=Ej;Jt(i,e[0],e[1],e[2]);var r=this.getRotation(t),a=this.getRotation(t.parentNode);ee(Pj,a),Qt(Pj,Pj),Zt(i,Pj,i),Zt(n.localRotation,i,r),re(n.localRotation,n.localRotation),this.dirtyLocalTransform(t,n)}else this.rotateLocal(t,e)}},{key:"setOrigin",value:function(t,e){"number"==typeof e&&(e=[e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0]);var n=t.transformable;if(e[0]!==n.origin[0]||e[1]!==n.origin[1]||e[2]!==n.origin[2]){var i=n.origin;i[0]=e[0],i[1]=e[1],i[2]=e[2]||0,this.dirtyLocalTransform(t,n)}}},{key:"setEulerAngles",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){Jt(n.localRotation,e[0],e[1],e[2]);var i=this.getRotation(t.parentNode);ee(Aj,Qt(Ej,i)),ie(n.localRotation,n.localRotation,Aj),this.dirtyLocalTransform(t,n)}else this.setLocalEulerAngles(t,e)}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=this.getGeometryBounds(t,e);if(!JD.isEmpty(i)){var r=n||new JD;return r.setFromTransformedAABB(i,this.getWorldTransform(t)),r}return null}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&jj.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new JD}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.renderable;if(!i.boundsDirty&&!n&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&n&&i.renderBounds)return i.renderBounds;var r=n?i.renderBounds:i.bounds,a=this.getTransformedGeometryBounds(t,n,r);if(t.childNodes.forEach((function(t){var i=e.getBounds(t,n);i&&(a?a.add(i):(a=r||new JD).update(i.center,i.halfExtents))})),a||(a=new JD),n){var o=function(t){var e=t;do{var n;if(null===(n=e.parsedStyle)||void 0===n?void 0:n.clipPath)return e;e=e.parentElement}while(null!==e);return null}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents)}}return n?(i.renderBounds=a,i.renderBoundsDirty=!1):(i.bounds=a,i.boundsDirty=!1),a}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=yj;t.parentNode.transformable&&(e=nt(xj,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!JD.isEmpty(n)){var i=new JD;return i.setFromTransformedAABB(n,e),i}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var e,n,i=this.getGeometryBounds(t);JD.isEmpty(i)||(n=new JD).setFromTransformedAABB(i,this.getWorldTransform(t));var r=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=b(n.getMin(),2),o=a[0],s=a[1],l=b(n.getMax(),2),u=l[0],c=l[1];return new iI(o+((null==r?void 0:r.left)||0),s+((null==r?void 0:r.top)||0),u-o,c-s)}return new iI((null==r?void 0:r.left)||0,(null==r?void 0:r.top)||0,0,0)}},{key:"internalUpdateTransform",value:function(t){var e,n=null===(e=t.parentNode)||void 0===e?void 0:e.transformable;CI(t.transformable),function(t,e){t.dirtyFlag&&(e?at(t.worldTransform,e.worldTransform,t.localTransform):Z(t.worldTransform,t.localTransform),t.dirtyFlag=!1)}(t.transformable,n)}},{key:"internalUpdateElement",value:function(t,e){var n,i,r,a,o,s,l=!0===(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization),u=e[e.length-1],c=(null==u?void 0:u.transformDirty)||(null===(i=t.transformable)||void 0===i?void 0:i.localDirtyFlag);t.transformable&&((o=t.transformable).dirtyFlag||(o.dirtyFlag=c)),this.internalUpdateTransform(t),c&&(null===(s=t.dirty)||void 0===s||s.call(t,!0,!0));var h=(null===(r=t.renderable)||void 0===r?void 0:r.boundsDirty)||(null===(a=t.renderable)||void 0===a?void 0:a.renderBoundsDirty);if((c||h)&&!1===(null==u?void 0:u.shapeUpdated)&&l)for(var d=e.length-1;d>=0;){var f,p,g=e[d];if(g.shapeUpdated)break;null===(f=(p=g.node).dirty)||void 0===f||f.call(p,!0,!0),g.shapeUpdated=!0,d-=1}return c}},{key:"syncHierarchy",value:function(t){for(var e,n,i=[t],r=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];i.length>0;){for(var a=i.pop(),o=r[r.length-1];r.length>0&&a.parentNode!==o.node;)o=r.pop();var s=this.internalUpdateElement(a,r);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)i.push(a.childNodes[l]);r.push({node:a,transformDirty:s,shapeUpdated:!1})}}}},{key:"dirtyLocalTransform",value:function(t,e){bF(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e))}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtifyWorldInternal(t,e),this.dirtyToRoot(t,!0)}},{key:"dirtifyWorldInternal",value:function(t,e){var n,i=this,r=!0===(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization);e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),r||t.childNodes.forEach((function(t){var e=t.transformable;i.dirtifyWorldInternal(t,e)})))}},{key:"dirtyToRoot",value:function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t,r=!0===(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization);i;){var a,o;if(null===(a=(o=i).dirty)||void 0===a||a.call(o,!0,!0),r)break;i=i.parentNode}n&&t.forEach((function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0)})),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,n)}},{key:"dirtifyFragment",value:function(t){var e,n,i=t.transformable;i&&(i.dirtyFlag=!0,i.localDirtyFlag=!0),null===(e=(n=t).dirty)||void 0===e||e.call(n,!0,!0);for(var r=t.childNodes.length,a=0;a<r;a++)this.dirtifyFragment(t.childNodes[a]);t.nodeName===UD.FRAGMENT&&this.pendingEvents.set(t,!1)}},{key:"triggerPendingEvents",value:function(){var t,e,n=this,i=new Set,r=function(e,r){if(e.isConnected&&!i.has(e)&&e.nodeName!==UD.FRAGMENT){var a;if(n.boundsChangedEvent.detail=r,n.boundsChangedEvent.target=e,e.isMutationObserved)e.dispatchEvent(n.boundsChangedEvent);else void 0===t&&(t=!0===(null===(a=e.ownerDocument.defaultView)||void 0===a||null===(a=a.getConfig())||void 0===a||null===(a=a.future)||void 0===a?void 0:a.experimentalCancelEventPropagation)),e.ownerDocument.defaultView.dispatchEvent(n.boundsChangedEvent,!0,t);i.add(e)}};this.pendingEvents.forEach((function(t,n){var i;n.nodeName!==UD.FRAGMENT&&(void 0===e&&(e=!0===(null===(i=n.ownerDocument)||void 0===i||null===(i=i.defaultView)||void 0===i||null===(i=i.getConfig())||void 0===i||null===(i=i.future)||void 0===i?void 0:i.experimentalAttributeUpdateOptimization)),Cj.affectChildren=t,e?r(n,Cj):t?n.forEach((function(t){r(t,Cj)})):r(n,Cj))})),i.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"updateDisplayObjectDependency",value:function(t,e,n,i){if(e&&e!==n){var r=this.displayObjectDependencyMap.get(e);if(r&&r[t]){var a=r[t].indexOf(i);r[t].splice(a,1)}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(i)}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,i=this.displayObjectDependencyMap.get(t);if(i){var r=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(i).forEach((function(t){i[t].forEach((function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new dj(hj.ATTR_MODIFIED,e,n,n,t,dj.MODIFICATION,n,n),r,r),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n)}))}))}}}])}(),Lj=function(){return c((function t(e){if(l(this,t),e<=0)throw new Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map}),[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n)}}},{key:"len",value:function(){return this.cache.size}},{key:"clear",value:function(){this.cache.clear()}}])}(),Dj={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Ij=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,_j=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),Bj=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),Fj=function(){return c((function t(e){var n=this;l(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!(!t||!Bj.exec(e)&&!_j.exec(t))},this.trimByKinsokuShorui=function(t){var e=f(t),n=e[e.length-2];if(!n)return t;var i=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=i+e[e.length-1],e},this.runtime=e,this.charWidthCache=new Lj(100)}),[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),r=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});r.font=t;var a=Dj.MetricsString+Dj.BaselineSymbol,o=Math.ceil(r.measureText(a).width),s=Math.ceil(r.measureText(Dj.BaselineSymbol).width),l=Dj.HeightMultiplier*s;s=s*Dj.BaselineMultiplier|0,i.width=o,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,o,l),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(a,0,s);var u=r.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,p=!1;for(d=0;d<s;++d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){p=!0;break}if(p)break;f+=h}for(n.ascent=s-d,f=c-h,p=!1,d=l;d>s;--d){for(var v=0;v<h;v+=4)if(255!==u[f+v]){p=!0;break}if(p)break;f-=h}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n}},{key:"measureText",value:function(t,e,n){var i=e.fontSize,r=void 0===i?16:i,a=e.wordWrap,o=void 0!==a&&a,s=e.lineHeight,l=e.lineWidth,u=void 0===l?1:l,c=e.textBaseline,h=void 0===c?"alphabetic":c,d=e.textAlign,f=void 0===d?"start":d,p=e.letterSpacing,g=void 0===p?0:p,v=e.textPath;e.textPathSide,e.textPathStartOffset;var y=e.leading,m=void 0===y?0:y,b=DF(e),x=this.measureFont(b,n);0===x.fontSize&&(x.fontSize=r,x.ascent=r);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=b,e.isOverflowing=!1;var w=(o?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),k=new Array(w.length),M=0;if(!v){for(var S=0;S<w.length;S++){var N=E.measureText(w[S]).width+(w[S].length-1)*g;k[S]=N,M=Math.max(M,N)}var T=M+u,A=s||x.fontSize+u,O=Math.max(A,x.fontSize+u)+(w.length-1)*(A+m),P=0;return"middle"===h?P=-O/2:"bottom"===h||"alphabetic"===h||"ideographic"===h?P=-O:"top"!==h&&"hanging"!==h||(P=0),{font:b,width:T,height:O,lines:w,lineWidths:k,lineHeight:A+=m,maxLineWidth:M,fontProperties:x,lineMetrics:k.map((function(t,e){var n=0;return"center"===f||"middle"===f?n-=t/2:"right"!==f&&"end"!==f||(n-=t),new iI(n-u/2,P+e*A,t+u,A)}))}}v.getTotalLength();for(var C=0;C<w.length;C++)E.measureText(w[C]).width,w[C].length}},{key:"wordWrap",value:function(t,e,n){var i=this,r=Array.from(t);if(0===r.length)return"";var a=this,o=e.wordWrapWidth,s=void 0===o?0:o,l=e.letterSpacing,u=void 0===l?0:l,c=e.maxLines,h=void 0===c?1/0:c,d=e.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),p=s+u,g="";"ellipsis"===d?g="...":d&&"clip"!==d&&(g=d);var v=[""],y=0,m=0,b=-1,x=DF(e),E=this.charWidthCache.get(x);E||(E=new Lj(500),this.charWidthCache.put(x,E));var w=function(t){return i.getFromCache(t,u,E,f)},k=w(g);function M(t,e,n,i){for(;w(t)<i&&e<r.length-1&&!a.isNewline(r[e+1]);)t+=r[e+=1];for(;w(t)>i&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e}}function S(t,e){if(!(k<=0||k>p))if(v[t]){var n=M(v[t],e,b+1,p-k);v[t]=n.lineTxt+g}else v[t]=g}for(var N=0;N<r.length;N++){var T=r[N],A=r[N-1],O=r[N+1],P=w(T);if(this.isNewline(T)){if(y+1>=h){N<r.length-1&&S(y,N-1),e.isOverflowing=!0;break}b=N-1,m=0,v[y+=1]=""}else{if(P>p){S(y,N-1),e.isOverflowing=!0;break}if(m>0&&m+P>p){var C=M(v[y],N-1,b+1,p);if(C.txtLastCharIndex!==N-1){if(v[y]=C.lineTxt,C.txtLastCharIndex===r.length-1)break;N=C.txtLastCharIndex+1,T=r[N],A=r[N-1],O=r[N+1],P=w(T)}if(y+1>=h){S(y,N-1),e.isOverflowing=!0;break}if(b=N-1,m=0,v[y+=1]="",this.isBreakingSpace(T))continue;this.canBreakInLastChar(T)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[y]||"",w)),this.shouldBreakByKinsokuShorui(T,O)&&(v=this.trimByKinsokuShorui(v),m+=w(A||""))}m+=P,v[y]+=T}}return v.join("\n")}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&Dj.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return"string"==typeof t&&Dj.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var e=f(t),n=e[e.length-2],i=this.findBreakableIndex(n);if(-1===i||!n)return e;var r=n.slice(i,i+1),a=i+1,o=i+(this.isBreakingSpace(r)?0:1);return e[e.length-1]+=n.slice(a,n.length),e[e.length-2]=n.slice(0,o),e}},{key:"canBreakInLastChar",value:function(t){return!t||!Ij.test(t)}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce((function(t,n){return t+e(n)}),0)}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!Ij.test(t[e]))return e;return-1}},{key:"getFromCache",value:function(t,e,n,i){var r=n.get(t);if("number"!=typeof r){var a=t.length*e;r=i.measureText(t).width+a,n.put(t,r)}return r}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear()}}])}(),jj={},Gj=function(t){var e=new ZF,n=new KF;return a(a(a(a(a(a(a(a(a(a(t={},UD.FRAGMENT,null),UD.CIRCLE,new YF),UD.ELLIPSE,new $F),UD.RECT,e),UD.IMAGE,e),UD.GROUP,new JF),UD.LINE,new XF),UD.TEXT,new QF(jj)),UD.POLYLINE,n),UD.POLYGON,n),a(a(a(t,UD.PATH,new qF),UD.HTML,new tj),UD.MESH,null)}(),zj=function(t){var e=new nF,n=new aF;return a(a(a(a(a(a(a(a(a(a(t={},LI.PERCENTAGE,null),LI.NUMBER,new uF),LI.ANGLE,new tF),LI.DEFINED_PATH,new eF),LI.PAINT,e),LI.COLOR,e),LI.FILTER,new iF),LI.LENGTH,n),LI.LENGTH_PERCENTAGE,n),LI.LENGTH_PERCENTAGE_12,new oF),a(a(a(a(a(a(a(a(a(a(t,LI.LENGTH_PERCENTAGE_14,new sF),LI.COORDINATE,new aF),LI.OFFSET_DISTANCE,new cF),LI.OPACITY_VALUE,new hF),LI.PATH,new dF),LI.LIST_OF_POINTS,new fF),LI.SHADOW_BLUR,new pF),LI.TEXT,new gF),LI.TEXT_TRANSFORM,new vF),LI.TRANSFORM,new WF),a(a(a(t,LI.TRANSFORM_ORIGIN,new UF),LI.Z_INDEX,new HF),LI.MARKER,new lF)}();jj.CameraContribution=SI,jj.AnimationTimeline=null,jj.EasingFunction=null,jj.offscreenCanvasCreator=new lj,jj.sceneGraphSelector=new cj,jj.sceneGraphService=new Rj(jj),jj.textService=new Fj(jj),jj.geometryUpdaterFactory=Gj,jj.CSSPropertySyntaxFactory=zj,jj.styleValueRegistry=new QB(jj),jj.layoutRegistry=null,jj.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},jj.enableStyleSyntax=!0,jj.enableSizeAttenuation=!1;var Vj=0,Wj=new dj(hj.INSERTED,null,"","","",0,"",""),Uj=new dj(hj.REMOVED,null,"","","",0,"",""),Hj=new aj(hj.DESTROY),Yj=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).entity=Vj++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:NI.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return m(e,t),c(e,[{key:"dirty",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.renderable.dirty=t,e&&(this.renderable.boundsDirty=t,this.renderable.renderBoundsDirty=t)}},{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter((function(t){return""!==t}))}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}},{key:"cloneNode",value:function(t){throw new Error(rI)}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw new Error("Cannot append a destroyed element.");return jj.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(bF(this)||t.nodeName!==UD.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(Wj.relatedNode=this,t.dispatchEvent(Wj)),t}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n)}else this.appendChild(t);return t}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e}},{key:"removeChild",value:function(t){var e,n,i=!0===(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation);return Uj.relatedNode=this,t.dispatchEvent(Uj,i,i),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),jj.sceneGraphService.detach(t),t}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e)}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy()}}},{key:"matches",value:function(t){return jj.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return jj.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return jj.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return jj.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return jj.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return jj.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return jj.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var e=this;do{if(jj.sceneGraphService.matches(t,e))return e;e=e.parentElement}while(null!==e);return null}},{key:"find",value:function(t){var e=this,n=null;return this.forEach((function(i){return i===e||!t(i)||(n=i,!1)})),n}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach((function(i){i!==e&&t(i)&&n.push(i)})),n}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];i.forEach((function(n,i){var r;return null===(r=t.parentNode)||void 0===r?void 0:r.appendChild(n,e+i+1)}))}}},{key:"before",value:function(){if(this.parentNode){for(var t,e=this.parentNode.childNodes.indexOf(this),n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=i[0],o=i.slice(1);this.parentNode.appendChild(a,e),(t=a).after.apply(t,f(o))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e){return t.appendChild(e)}))}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e,n){return t.appendChild(e,n)}))}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){var t,e=!0===(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation);this.destroyChildren(),this.dispatchEvent(Hj,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return jj.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return jj.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return jj.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return jj.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return jj.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t]}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,e,n,i){this.attributes[t]=e}},{key:"getAttributeNS",value:function(t,e){throw new Error(rI)}},{key:"getAttributeNode",value:function(t){throw new Error(rI)}},{key:"getAttributeNodeNS",value:function(t,e){throw new Error(rI)}},{key:"hasAttributeNS",value:function(t,e){throw new Error(rI)}},{key:"removeAttributeNS",value:function(t,e){throw new Error(rI)}},{key:"removeAttributeNode",value:function(t){throw new Error(rI)}},{key:"setAttributeNS",value:function(t,e,n){throw new Error(rI)}},{key:"setAttributeNode",value:function(t){throw new Error(rI)}},{key:"setAttributeNodeNS",value:function(t){throw new Error(rI)}},{key:"toggleAttribute",value:function(t,e){throw new Error(rI)}}])}(sj);function $j(t){return!(null==t||!t.nodeName)}var Xj=jj.globalThis.Proxy?jj.globalThis.Proxy:function(){},qj=new dj(hj.ATTR_MODIFIED,null,null,null,null,dj.MODIFICATION,null,null),Kj=k(),Zj=qt(),Qj=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||UD.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),jj.enableStyleSyntax&&(n.style=new Xj({setProperty:function(t,e){n.setAttribute(t,e)},getPropertyValue:function(t){return n.getAttribute(t)},removeProperty:function(t){n.removeAttribute(t)},item:function(){return""}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e)},set:function(t,e,i){return n.setAttribute(e,i),!0}})),n}return m(e,t),c(e,[{key:"destroy",value:function(){bn(e,"destroy",this,3)([]),this.getAnimations().forEach((function(t){t.cancel()}))}},{key:"cloneNode",value:function(t,e){var n=s({},this.attributes);for(var i in n){var r=n[i];$j(r)&&"clipPath"!==i&&"offsetPath"!==i&&"textPath"!==i&&(n[i]=r.cloneNode(t)),e&&(n[i]=e(i,r))}var a=new this.constructor(s(s({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach((function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n)}})),a}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};jj.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty()}},{key:"setAttribute",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];hn(n)||(i||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:r}),bn(e,"setAttribute",this,3)([t,n]))}},{key:"internalSetAttribute",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],r=this.parsedStyle[t];jj.styleValueRegistry.processProperties(this,a({},t,e),n),this.dirty();var o,s=this.parsedStyle[t];if(this.isConnected)if(qj.relatedNode=this,qj.prevValue=i,qj.newValue=e,qj.attrName=t,qj.prevParsedValue=r,qj.newParsedValue=s,this.isMutationObserved)this.dispatchEvent(qj);else{var l,u=!0===(null===(l=this.ownerDocument.defaultView.getConfig().future)||void 0===l?void 0:l.experimentalCancelEventPropagation);qj.target=this,this.ownerDocument.defaultView.dispatchEvent(qj,!0,u)}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(o=this.attributeChangedCallback)||void 0===o||o.call(this,t,i,e,r,s))}},{key:"getBBox",value:function(){var t=this.getBounds(),e=b(t.getMin(),2),n=e[0],i=e[1],r=b(t.getMax(),2),a=r[0],o=r[1];return new iI(n,i,a-n,o-i)}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return jj.sceneGraphService.setOrigin(this,sI(t,e,n,!1)),this}},{key:"getOrigin",value:function(){return jj.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return jj.sceneGraphService.setPosition(this,sI(t,e,n,!1)),this}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return jj.sceneGraphService.setLocalPosition(this,sI(t,e,n,!1)),this}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return jj.sceneGraphService.translate(this,sI(t,e,n,!1)),this}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return jj.sceneGraphService.translateLocal(this,sI(t,e,n,!1)),this}},{key:"getPosition",value:function(){return jj.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return jj.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n)}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(t=sI(t,e=e||t,n=n||t,!1)),jj.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(t=sI(t,e=e||t,n=n||t,!1)),jj.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return jj.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return jj.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){return hI(b(fI(Kj,jj.sceneGraphService.getWorldTransform(this)),3)[2])}},{key:"getLocalEulerAngles",value:function(){return hI(b(fI(Kj,jj.sceneGraphService.getLocalRotation(this)),3)[2])}},{key:"setEulerAngles",value:function(t){return jj.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return jj.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,e,n){return ce(e)&&ce(n)?jj.sceneGraphService.rotateLocal(this,0,0,t):jj.sceneGraphService.rotateLocal(this,t,e,n),this}},{key:"rotate",value:function(t,e,n){return ce(e)&&ce(n)?jj.sceneGraphService.rotate(this,0,0,t):jj.sceneGraphService.rotate(this,t,e,n),this}},{key:"setRotation",value:function(t,e,n,i){return jj.sceneGraphService.setRotation(this,t,e,n,i),this}},{key:"setLocalRotation",value:function(t,e,n,i){return jj.sceneGraphService.setLocalRotation(this,t,e,n,i),this}},{key:"setLocalSkew",value:function(t,e){return jj.sceneGraphService.setLocalSkew(this,t,e),this}},{key:"getRotation",value:function(){return jj.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return jj.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return jj.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return jj.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return jj.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return jj.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){jj.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,e){var n,i=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return i?i.play(this,t,e):null}},{key:"isVisible",value:function(){var t;return"hidden"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return"none"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)}},{key:"isCulled",value:function(){return!(!this.cullable||!this.cullable.enable||this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,f(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,f(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n[0],a=n[1];return r?vn(r)?(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),this):2===n.length?(this.setAttribute(r,a),this):this.attributes[r]:this.attributes}},{key:"getMatrix",value:function(t){var e=t||this.getWorldTransform(),n=b(xt(Kj,e),2),i=n[0],r=n[1],a=b(Et(Kj,e),2),o=a[0],s=a[1],l=wt(Zj,e),u=b(fI(Kj,l),3),c=u[0],h=u[2];return function(t,e,n,i,r){var a=Math.cos(t),o=Math.sin(t);return Xt(i*a,r*o,0,-i*o,r*a,0,e,n,1)}(c||h,i,r,o,s)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var e=b(pI(t),5),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4];this.setEulerAngles(o).setPosition(n,i).setLocalScale(r,a)}},{key:"setLocalMatrix",value:function(t){var e=b(pI(t),5),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4];this.setLocalEulerAngles(o).setLocalPosition(n,i).setLocalScale(r,a)}},{key:"show",value:function(){this.forEach((function(t){t.style.visibility="visible"}))}},{key:"hide",value:function(){this.forEach((function(t){t.style.visibility="hidden"}))}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,e){return this.appendChild(t,e)}},{key:"set",value:function(t,e){this.config[t]=e}},{key:"get",value:function(t){return this.config[t]}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}}])}(Yj);Qj.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var Jj=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:UD.CIRCLE},t)])}return m(e,t),c(e)}(Qj);Jj.PARSED_STYLE_LIST=new Set([].concat(f(Qj.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var tG=["style"],eG=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,tG);return l(this,e),(t=v(this,e,[s({style:i},r)])).isCustomElement=!0,t}return m(e,t),c(e)}(Qj);eG.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var nG=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:UD.ELLIPSE},t)])}return m(e,t),c(e)}(Qj);nG.PARSED_STYLE_LIST=new Set([].concat(f(Qj.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),(function(t){function e(){return l(this,e),v(this,e,[{type:UD.FRAGMENT}])}return m(e,t),c(e)}(Qj)).PARSED_STYLE_LIST=new Set(["class","className"]);var iG=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:UD.GROUP},t)])}return m(e,t),c(e)}(Qj);iG.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var rG=["style"],aG=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,rG);return l(this,e),(t=v(this,e,[s({type:UD.HTML,style:i},r)])).cullable.enable=!1,t}return m(e,t),c(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=nt(q(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!JD.isEmpty(e)){var n=new JD;return n.setFromTransformedAABB(e,t),n}}return this.getBounds()}}])}(Qj);aG.PARSED_STYLE_LIST=new Set([].concat(f(Qj.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"])),(function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:UD.IMAGE},t)])}return m(e,t),c(e)}(Qj)).PARSED_STYLE_LIST=new Set([].concat(f(Qj.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var oG=["style"],sG=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,oG);l(this,e),(t=v(this,e,[s({type:UD.LINE,style:s({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},r)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd;return o&&$j(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&$j(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&$j(i)&&(this.markerStartAngle=0,i.remove()),r&&$j(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t&&(i&&$j(i)&&(this.markerEndAngle=0,i.remove()),r&&$j(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1)))}},{key:"transformMarker",value:function(t){var e,n,i,r,a,o,s,l=this.parsedStyle,u=l.markerStart,c=l.markerEnd,h=l.markerStartOffset,d=l.markerEndOffset,f=l.x1,p=l.x2,g=l.y1,v=l.y2,y=t?u:c;y&&$j(y)&&(t?(r=f,a=g,n=p-f,i=v-g,o=h||0,s=this.markerStartAngle):(r=p,a=v,n=f-p,i=g-v,o=d||0,s=this.markerEndAngle),e=Math.atan2(i,n),y.setLocalEulerAngles(180*e/Math.PI+s),y.setLocalPosition(r+Math.cos(e)*o,a+Math.sin(e)*o))}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,i=Tn(n.x1,n.y1,n.x2,n.y2,t),r=i.x,a=i.y,o=j(k(),N(r,a,0),e?this.getWorldTransform():this.getLocalTransform());return new nI(o[0],o[1])}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle;return Nn(t.x1,t.y1,t.x2,t.y2)}}])}(Qj);sG.PARSED_STYLE_LIST=new Set([].concat(f(Qj.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var lG=["style"],uG=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,lG);l(this,e),(t=v(this,e,[s({type:UD.PATH,style:i,initialParsedStyle:{miterLimit:4,d:s({},RI)}},r)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd,c=a.markerMid;return o&&$j(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),c&&$j(c)&&t.placeMarkerMid(c),u&&$j(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&$j(i)&&(this.markerStartAngle=0,i.remove()),r&&$j(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t?(i&&$j(i)&&(this.markerEndAngle=0,i.remove()),r&&$j(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(r)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,i=e.markerEnd,r=e.markerStartOffset,a=e.markerEndOffset,o=t?n:i;if(o&&$j(o)){var s,l,u,c,h,d,f;if(t){var p=b(this.getStartTangent(),2),g=p[0],v=p[1];c=v[0],h=v[1],l=g[0]-v[0],u=g[1]-v[1],d=r||0,f=this.markerStartAngle}else{var y=b(this.getEndTangent(),2),m=y[0],x=y[1];c=x[0],h=x[1],l=m[0]-x[0],u=m[1]-x[1],d=a||0,f=this.markerEndAngle}s=Math.atan2(u,l),o.setLocalEulerAngles(180*s/Math.PI+f),o.setLocalPosition(c+Math.cos(s)*d,h+Math.sin(s)*d)}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach((function(t){t.remove()})),t&&$j(t))for(var n=1;n<e.length-1;n++){var i=b(e[n].currentPoint,2),r=i[0],a=i[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(r,a)}}},{key:"getTotalLength",value:function(){return gB(this)}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=yn(this.parsedStyle.d.absolutePath,t),i=n.x,r=n.y,a=j(k(),N(i,r,0),e?this.getWorldTransform():this.getLocalTransform());return new nI(a[0],a[1])}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*gB(this),e)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,i=t[1].currentPoint,r=t[1].startTangent;e=[],r?(e.push([n[0]-r[0],n[1]-r[1]]),e.push([n[0],n[1]])):(e.push([i[0],i[1]]),e.push([n[0],n[1]]))}return e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var i=t[e-2].currentPoint,r=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?(n.push([r[0]-a[0],r[1]-a[1]]),n.push([r[0],r[1]])):(n.push([i[0],i[1]]),n.push([r[0],r[1]]))}return n}}])}(Qj);uG.PARSED_STYLE_LIST=new Set([].concat(f(Qj.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var cG=["style"],hG=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,cG);l(this,e),(t=v(this,e,[s({type:UD.POLYGON,style:i,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},r)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd,c=a.markerMid;return o&&$j(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),c&&$j(c)&&t.placeMarkerMid(c),u&&$j(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&$j(i)&&(this.markerStartAngle=0,i.remove()),r&&$j(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t?(i&&$j(i)&&(this.markerEndAngle=0,i.remove()),r&&$j(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(r)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,i=e.markerEnd,r=e.markerStartOffset,a=e.markerEndOffset,o=(e.points||{}).points,s=t?n:i;if(s&&$j(s)&&o){var l,u,c,h,d,f,p;if(h=o[0][0],d=o[0][1],t)u=o[1][0]-o[0][0],c=o[1][1]-o[0][1],f=r||0,p=this.markerStartAngle;else{var g=o.length;this.parsedStyle.isClosed?(u=o[g-1][0]-o[0][0],c=o[g-1][1]-o[0][1]):(h=o[g-1][0],d=o[g-1][1],u=o[g-2][0]-o[g-1][0],c=o[g-2][1]-o[g-1][1]),f=a||0,p=this.markerEndAngle}l=Math.atan2(c,u),s.setLocalEulerAngles(180*l/Math.PI+p),s.setLocalPosition(h+Math.cos(l)*f,d+Math.sin(l)*f)}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach((function(t){t.remove()})),this.markerMidList=[],t&&$j(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var i=e[n][0],r=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(i,r)}}}])}(Qj);hG.PARSED_STYLE_LIST=new Set([].concat(f(Qj.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var dG=["style"],fG=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,i=zn(t,dG);return l(this,e),v(this,e,[s({type:UD.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i)])}return m(e,t),c(e,[{key:"getTotalLength",value:function(){return 0===(t=this).parsedStyle.points.totalLength&&(t.parsedStyle.points.totalLength=Rn(t.parsedStyle.points.points)),t.parsedStyle.points.totalLength;var t}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var i,r,a=[],o=0,s=this.getTotalLength();n.forEach((function(t,e){n[e+1]&&((i=[0,0])[0]=o/s,r=Nn(t[0],t[1],n[e+1][0],n[e+1][1]),o+=r,i[1]=o/s,a.push(i))})),this.parsedStyle.points.segments=a}var l=0,u=0;this.parsedStyle.points.segments.forEach((function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n)}));var c=Tn(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=j(k(),N(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new nI(f[0],f[1])}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n}}])}(hG);fG.PARSED_STYLE_LIST=new Set([].concat(f(hG.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var pG=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:UD.RECT},t)])}return m(e,t),c(e)}(Qj);pG.PARSED_STYLE_LIST=new Set([].concat(f(Qj.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var gG=["style"],vG=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,i=zn(t,gG);return l(this,e),v(this,e,[s({type:UD.TEXT,style:s({fill:"black"},n)},i)])}return m(e,t),c(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(Qj);vG.PARSED_STYLE_LIST=new Set([].concat(f(Qj.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var yG=function(){function t(e){l(this,t),this.strategies=e}return c(t,[{key:"apply",value:function(e){var n=e.config,i=e.camera,r=e.renderingService,a=e.renderingContext,o=this.strategies;r.hooks.cull.tap(t.tag,(function(t){if(t){var e,r=t.cullable;if(0===o.length?r.visible=a.unculledEntities.indexOf(t.entity)>-1:r.visible=o.every((function(e){return e.isVisible(i,t)})),!t.isCulled()&&t.isVisible())return t;var s=!0===(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation);return t.dispatchEvent(new aj(hj.CULLED),s,s),null}return t})),r.hooks.afterRender.tap(t.tag,(function(t){t.cullable.visibilityPlaneMask=-1}))}}])}();yG.tag="Culling";var mG=function(){function t(){var e=this;l(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new ij(null),this.rootWheelEvent=new rj(null),this.onPointerMove=function(t){var n,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView;if(!i.supportsTouchEvents||"touch"!==t.pointerType){var r,a=Gn(e.normalizeToPointerEvent(t,i));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=e.bootstrapEvent(e.rootPointerEvent,o,i,t);e.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var n,i,r=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=Gn(e.normalizeToPointerEvent(t,r));try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.bootstrapEvent(e.rootPointerEvent,o,r,t);e.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}}return c(t,[{key:"apply",value:function(e){var n=this;this.context=e;var i=e.renderingService,r=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler((function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null})),i.hooks.pointerWheel.tap(t.tag,(function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e)})),i.hooks.pointerDown.tap(t.tag,(function(t){if(!r.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,r);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var i,a=Gn(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=n.bootstrapEvent(n.rootPointerEvent,o,r,t);n.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}n.setCursor(n.context.eventService.cursor)}})),i.hooks.pointerUp.tap(t.tag,(function(t){if(!r.supportsTouchEvents||"touch"!==t.pointerType){var e,i=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(i,t)?"":"outside",o=Gn(n.normalizeToPointerEvent(t,r));try{for(o.s();!(e=o.n()).done;){var s=e.value,l=n.bootstrapEvent(n.rootPointerEvent,s,r,t);l.type+=a,n.context.eventService.mapEvent(l)}}catch(t){o.e(t)}finally{o.f()}n.setCursor(n.context.eventService.cursor)}})),i.hooks.pointerMove.tap(t.tag,this.onPointerMove),i.hooks.pointerOver.tap(t.tag,this.onPointerMove),i.hooks.pointerOut.tap(t.tag,this.onPointerMove),i.hooks.click.tap(t.tag,this.onClick),i.hooks.pointerCancel.tap(t.tag,(function(t){var e,i=Gn(n.normalizeToPointerEvent(t,r));try{for(i.s();!(e=i.n()).done;){var a=e.value,o=n.bootstrapEvent(n.rootPointerEvent,a,r,t);n.context.eventService.mapEvent(o)}}catch(t){i.e(t)}finally{i.f()}n.setCursor(n.context.eventService.cursor)}))}},{key:"bootstrapEvent",value:function(t,e,n,i){t.view=n,t.originalEvent=null,t.nativeEvent=i,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=r.x,o=r.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=i.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=yF[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),i=n.x,r=n.y;e.viewport.x=i,e.viewport.y=r;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=mF.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var i=0;i<t.changedTouches.length;i++){var r=t.changedTouches[i];hn(r.button)&&(r.button=0),hn(r.buttons)&&(r.buttons=1),hn(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),hn(r.width)&&(r.width=r.radiusX||1),hn(r.height)&&(r.height=r.radiusY||1),hn(r.tiltX)&&(r.tiltX=0),hn(r.tiltY)&&(r.tiltY=0),hn(r.pointerType)&&(r.pointerType="touch"),hn(r.pointerId)&&(r.pointerId=r.identifier||0),hn(r.pressure)&&(r.pressure=r.force||.5),hn(r.twist)&&(r.twist=0),hn(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,r.type=t.type,n.push(r)}else if(e.isMouseEvent(t)){var a=t;hn(a.isPrimary)&&(a.isPrimary=!0),hn(a.width)&&(a.width=1),hn(a.height)&&(a.height=1),hn(a.tiltX)&&(a.tiltX=0),hn(a.tiltY)&&(a.tiltY=0),hn(a.pointerType)&&(a.pointerType="mouse"),hn(a.pointerId)&&(a.pointerId=1),hn(a.pressure)&&(a.pressure=.5),hn(a.twist)&&(a.twist=0),hn(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}else n.push(t);return n}}])}();mG.tag="Event",UD.CIRCLE,UD.ELLIPSE,UD.IMAGE,UD.RECT,UD.LINE,UD.POLYLINE,UD.POLYGON,UD.TEXT,UD.PATH,UD.HTML;var bG=function(){function t(){l(this,t),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return c(t,[{key:"apply",value:function(e){var n,i,r=this,a=e.config,o=e.renderingService,s=e.renderingContext,l=e.rBushRoot,u=s.root.ownerDocument.defaultView;this.rBush=l;var c=function(t){o.dirtify()},h=function(t){r.syncTasks.set(t.target,t.detail.affectChildren),o.dirtify()},d=function(t){var e=t.target;jj.enableSizeAttenuation&&jj.styleValueRegistry.updateSizeAttenuation(e,u.getCamera().getZoom())},f=function(t){var e=t.target,n=e.rBushNode;null!=n&&n.aabb&&r.rBush.remove(n.aabb),r.syncTasks.delete(e),jj.sceneGraphService.dirtyToRoot(e),o.dirtify()};o.hooks.init.tap(t.tag,(function(){u.addEventListener(hj.MOUNTED,d),u.addEventListener(hj.UNMOUNTED,f),u.addEventListener(hj.ATTR_MODIFIED,c),u.addEventListener(hj.BOUNDS_CHANGED,h)})),o.hooks.destroy.tap(t.tag,(function(){u.removeEventListener(hj.MOUNTED,d),u.removeEventListener(hj.UNMOUNTED,f),u.removeEventListener(hj.ATTR_MODIFIED,c),u.removeEventListener(hj.BOUNDS_CHANGED,h),r.syncTasks.clear()}));var p=null!==(n=jj.globalThis.requestIdleCallback)&&void 0!==n?n:OF.bind(jj.globalThis),g=!0===(null===(i=a.future)||void 0===i?void 0:i.experimentalRICSyncRTree);o.hooks.endFrame.tap(t.tag,(function(){r.isFirstTimeRendering?(r.isFirstTimeRendering=!1,r.syncing=!0,p((function(){r.syncRTree(!0),r.isFirstTimeRenderingFinished=!0}))):g&&jj.globalThis.requestIdleCallback&&jj.globalThis.cancelIdleCallback?(jj.globalThis.cancelIdleCallback(r.ricSyncRTreeId),r.ricSyncRTreeId=jj.globalThis.requestIdleCallback((function(){return r.syncRTree()}))):r.syncRTree()}))}},{key:"syncNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isConnected){var n=t.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var i=t.getRenderBounds();if(i){var r=t.renderable;e&&(r.dirtyRenderBounds||(r.dirtyRenderBounds=new JD),r.dirtyRenderBounds.update(i.center,i.halfExtents));var a=b(i.getMin(),2),o=a[0],s=a[1],l=b(i.getMax(),2),u=l[0],c=l[1];n.aabb||(n.aabb={}),n.aabb.displayObject=t,n.aabb.minX=o,n.aabb.minY=s,n.aabb.maxX=u,n.aabb.maxY=c}return n.aabb&&!(isNaN(n.aabb.maxX)||isNaN(n.aabb.maxX)||isNaN(n.aabb.minX)||isNaN(n.aabb.minY))?n.aabb:void 0}}},{key:"syncRTree",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var n=[],i=new Set,r=function(r){if(!i.has(r)&&r.renderable){var a=t.syncNode(r,e);a&&(n.push(a),i.add(r))}};this.syncTasks.forEach((function(t,e){t&&e.forEach(r);for(var n=e;n;)r(n),n=n.parentElement})),this.rBush.load(n),n.length=0,this.syncing=!1}}}])}();bG.tag="Prepare";var xG=function(t){return t.READY="ready",t.BEFORE_RENDER="beforerender",t.RERENDER="rerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle",t.RENDERER_CHANGED="rendererchanged",t}({}),EG=(new aj(hj.MOUNTED),new aj(hj.UNMOUNTED),new aj(xG.BEFORE_RENDER),new aj(xG.RERENDER),new aj(xG.AFTER_RENDER),function(){function t(){l(this,t)}return c(t,[{key:"apply",value:function(e,n){var i=this,r=e.config.document,a=e.renderingService,o=e.svgElementMap;a.hooks.pick.tapPromise(t.tag,function(){var t=jn(Bn().mark((function t(e){return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.pick(o,r,e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),a.hooks.pickSync.tap(t.tag,(function(t){return i.pick(o,r,t)}))}},{key:"pick",value:function(t,e,n){var i=n.topmost,r=n.position,a=r.clientX,o=r.clientY;try{var s,l=[],u=Gn((e||document).elementsFromPoint(a,o));try{for(u.s();!(s=u.n()).done;){var c=s.value;if(c.shadowRoot&&c.shadowRoot!==e)return this.pick(t,c.shadowRoot,n);var h=t.get(c);if(h&&h.isInteractive()&&(l.push(h),i))return n.picked=l,n}}catch(t){u.e(t)}finally{u.f()}n.picked=l}catch(t){n.picked=[]}return n}}])}());EG.tag="SVGPicker";var wG=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).name="svg-picker",t}return m(e,t),c(e,[{key:"init",value:function(){this.addRenderingPlugin(new EG)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(YD);!function(t){t.exports=function(){function t(t,n,r,a,o){e(t,n,r||0,a||t.length-1,o||i)}function e(t,i,r,a,o){for(;a>r;){if(a-r>600){var s=a-r+1,l=i-r+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);e(t,i,Math.max(r,Math.floor(i-l*c/s+h)),Math.min(a,Math.floor(i+(s-l)*c/s+h)),o)}var d=t[i],f=r,p=a;for(n(t,r,i),o(t[a],d)>0&&n(t,r,a);f<p;){for(n(t,f,p),f++,p--;o(t[f],d)<0;)f++;for(;o(t[p],d)>0;)p--}0===o(t[r],d)?n(t,r,p):n(t,++p,a),p<=i&&(r=p+1),i<=p&&(a=p-1)}}function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var a=e;a<n;a++){var o=t.children[a];l(r,t.leaf?i(o):o)}return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,n,i,r,a){for(var o=[n,i];o.length;)if(!((i=o.pop())-(n=o.pop())<=r)){var s=n+Math.ceil((i-n)/r/2)*r;t(e,s,n,i,a),o.push(n,s,s,i)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!p(t,e))return n;for(var i=this.toBBox,r=[];e;){for(var a=0;a<e.children.length;a++){var o=e.children[a],s=e.leaf?i(o):o;p(t,s)&&(e.leaf?n.push(o):f(t,s)?this._all(o,n):r.push(o))}e=r.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var r=e.children[i],a=e.leaf?this.toBBox(r):r;if(p(t,a)){if(e.leaf||f(t,a))return!0;n.push(r)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=g([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,i,r,o=this.data,s=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),i=l[l.length-1],n=u.pop(),r=!0),o.leaf){var c=a(t,o.children,e);if(-1!==c)return o.children.splice(c,1),l.push(o),this._condense(l),this}r||o.leaf||!f(o,s)?i?(n++,o=i.children[n],r=!1):o=null:(l.push(o),u.push(n),n=0,i=o,o=o.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,i){var r,a=n-e+1,s=this._maxEntries;if(a<=s)return o(r=g(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,i-1))),(r=g([])).leaf=!1,r.height=i;var l=Math.ceil(a/s),u=l*Math.ceil(Math.sqrt(s));v(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);v(t,c,h,l,this.compareMinY);for(var d=c;d<=h;d+=l){var f=Math.min(d+l-1,h);r.children.push(this._build(t,d,f,i-1))}}return o(r,this.toBBox),r},r.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var r=1/0,a=1/0,o=void 0,s=0;s<e.children.length;s++){var l=e.children[s],u=h(l),c=(d=t,f=l,(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-u);c<a?(a=c,r=u<r?u:r,o=l):c===a&&u<r&&(r=u,o=l)}e=o||e.children[0]}var d,f;return e},r.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),r=[],a=this._chooseSubtree(i,this.data,e,r);for(a.children.push(t),l(a,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},r.prototype._split=function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var a=this._chooseSplitIndex(n,r,i),s=g(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var i,r=1/0,a=1/0,o=e;o<=n-e;o++){var l=s(t,0,o,this.toBBox),u=s(t,o,n,this.toBBox),c=(f=l,p=u,g=void 0,v=void 0,y=void 0,m=void 0,g=Math.max(f.minX,p.minX),v=Math.max(f.minY,p.minY),y=Math.min(f.maxX,p.maxX),m=Math.min(f.maxY,p.maxY),Math.max(0,y-g)*Math.max(0,m-v)),d=h(l)+h(u);c<r?(r=c,i=o,a=d<a?d:a):c===r&&d<a&&(a=d,i=o)}var f,p,g,v,y,m;return i||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},r.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var r=this.toBBox,a=s(t,0,e,r),o=s(t,n-e,n,r),u=d(a)+d(o),c=e;c<n-e;c++){var h=t.children[c];l(a,t.leaf?r(h):h),u+=d(a)}for(var f=n-e-1;f>=e;f--){var p=t.children[f];l(o,t.leaf?r(p):p),u+=d(o)}return u},r.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)l(e[i],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}()}(("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self,{exports:{}}));var kG=function(t){return t.GROUP="g",t.FRAGMENT="fragment",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh",t}({}),MG=function(t){return t[t.ZERO=0]="ZERO",t[t.NEGATIVE_ONE=1]="NEGATIVE_ONE",t}({}),SG=function(){return c((function t(){l(this,t),this.plugins=[]}),[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach((function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1)}))}}])}(),NG=O,TG=T,AG=L,OG=R,PG=D,CG=W,RG=function(){function t(){l(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return c(t,[{key:"update",value:function(t,e){TG(this.center,t),TG(this.halfExtents,e),CG(this.min,this.center,this.halfExtents),NG(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,e){NG(this.center,e,t),PG(this.center,this.center,.5),CG(this.halfExtents,e,t),PG(this.halfExtents,this.halfExtents,.5),TG(this.min,t),TG(this.max,e)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!t.isEmpty(e))if(t.isEmpty(this))this.setMinMax(e.getMin(),e.getMax());else{var n=this.center,i=n[0],r=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=i-s,h=i+s,d=r-l,f=r+l,p=a-u,g=a+u,v=e.center,y=v[0],m=v[1],b=v[2],x=e.halfExtents,E=x[0],w=x[1],k=x[2],M=y-E,S=y+E,N=m-w,T=m+w,A=b-k,O=b+k;M<c&&(c=M),S>h&&(h=S),N<d&&(d=N),T>f&&(f=T),A<p&&(p=A),O>g&&(g=O),n[0]=.5*(c+h),n[1]=.5*(d+f),n[2]=.5*(p+g),o[0]=.5*(h-c),o[1]=.5*(f-d),o[2]=.5*(g-p),this.min[0]=c,this.min[1]=d,this.min[2]=p,this.max[0]=h,this.max[1]=f,this.max[2]=g}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,i=this.halfExtents,r=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],p=e[10],g=Math.abs(o),v=Math.abs(s),y=Math.abs(l),m=Math.abs(u),b=Math.abs(c),x=Math.abs(h),E=Math.abs(d),w=Math.abs(f),k=Math.abs(p);n[0]=e[12]+o*r[0]+s*r[1]+l*r[2],n[1]=e[13]+u*r[0]+c*r[1]+h*r[2],n[2]=e[14]+d*r[0]+f*r[1]+p*r[2],i[0]=g*a[0]+v*a[1]+y*a[2],i[1]=m*a[0]+b*a[1]+x*a[2],i[2]=E*a[0]+w*a[1]+k*a[2],CG(this.min,n,i),NG(this.max,n,i)}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),i=t.getMax(),r=t.getMin();return n[0]<=i[0]&&e[0]>=r[0]&&n[1]<=i[1]&&e[1]>=r[1]&&n[2]<=i[2]&&e[2]>=r[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,i=AG([0,0,0],this.getMin(),e.getMin()),r=OG([0,0,0],this.getMax(),e.getMax());return n.setMinMax(i,r),n}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?TG([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?TG([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]}}])}(),LG=function(){return c((function t(e,n){l(this,t),this.distance=e||0,this.normal=n||N(0,1,0),this.updatePNVertexFlag()}),[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return _(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/H(this.normal);D(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,e,n){var i=this.distanceToPoint(t),r=i/(i-this.distanceToPoint(e)),a=r>=0&&r<=1;return a&&n&&F(n,t,e,r),a}}])}(),DG=function(){return c((function t(e){if(l(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new LG)}),[{key:"extractFromVPMatrix",value:function(t){var e=b(t,16),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],y=e[15];A(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-p,A(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+p,A(this.planes[2].normal,a+i,u+s,f+h),this.planes[2].distance=y+g,A(this.planes[3].normal,a-i,u-s,f-h),this.planes[3].distance=y-g,A(this.planes[4].normal,a-r,u-l,f-d),this.planes[4].distance=y-v,A(this.planes[5].normal,a+r,u+l,f+d),this.planes[5].distance=y+v,this.planes.forEach((function(t){t.normalize(),t.updatePNVertexFlag()}))}}])}(),IG=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;l(this,t),this.x=0,this.y=0,this.x=e,this.y=n}return c(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),_G=function(){function t(e,n,i,r){l(this,t),this.x=e,this.y=n,this.width=i,this.height=r,this.left=e,this.right=e+i,this.top=n,this.bottom=n+r}return c(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,n){var i=$(e.x,e.y,0,1),r=$(e.x+e.width,e.y,0,1),a=$(e.x,e.y+e.height,0,1),o=$(e.x+e.width,e.y+e.height,0,1),s=Y(),l=Y(),u=Y(),c=Y();X(s,i,n),X(l,r,n),X(u,a,n),X(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),p=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:p-d})}}])}(),BG="Method not implemented.";function FG(t){return void 0===t?0:t>360||t<-360?t%360:t}var jG=k();function GG(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)&&3===t.length?i?M(t):T(jG,t):le(t)?i?N(t,e,n):A(jG,t,e,n):i?N(t[0],t[1]||e,t[2]||n):A(jG,t[0],t[1]||e,t[2]||n)}var zG=Math.PI/180;function VG(t){return t*zG}var WG=180/Math.PI;function UG(t){return t*WG}var HG=Math.PI/2;function YG(t,e){return 16===e.length?function(t,e){var n,i,r=b(Et(k(),e),3),a=r[0],o=r[1],s=r[2],l=Math.asin(-e[2]/a);return l<HG?l>-HG?(n=Math.atan2(e[6]/o,e[10]/s),i=Math.atan2(e[1]/a,e[0]/a)):(i=0,n=-Math.atan2(e[4]/o,e[5]/o)):(i=0,n=Math.atan2(e[4]/o,e[5]/o)),t[0]=n,t[1]=l,t[2]=i,t}(t,e):function(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=i*i,s=r*r,l=a*a,u=n*n+o+s+l,c=n*a-i*r;return c>.499995*u?(t[0]=HG,t[1]=2*Math.atan2(i,n),t[2]=0):c<-.499995*u?(t[0]=-HG,t[1]=2*Math.atan2(i,n),t[2]=0):(t[0]=Math.asin(2*(n*r-a*i)),t[1]=Math.atan2(2*(n*a+i*r),1-2*(s+l)),t[2]=Math.atan2(2*(n*i+r*a),1-2*(o+s))),t}(t,e)}function $G(t){var e=t[0],n=t[1],i=t[3],r=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(i*i+r*r);if(e*r-n*i<0&&(e<r?a=-a:o=-o),a){var s=1/a;e*=s,n*=s}if(o){var l=1/o;i*=l,r*=l}var u=UG(Math.atan2(n,e));return[t[6],t[7],a,o,u]}var XG=q(),qG=q(),KG=Y(),ZG=[k(),k(),k()],QG=k();function JG(t,e,n,i,r){t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r}var tz=function(t){return t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING",t}({}),ez=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC",t}({}),nz=function(t){return t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE",t}({}),iz=2e-4,rz=function(){return c((function t(){l(this,t),this.clipSpaceNearZ=MG.NEGATIVE_ONE,this.eventEmitter=new x,this.matrix=q(),this.right=N(1,0,0),this.up=N(0,1,0),this.forward=N(0,0,1),this.position=N(0,0,1),this.focalPoint=N(0,0,0),this.distanceVector=N(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=q(),this.projectionMatrixInverse=q(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tz.EXPLORING,this.trackingMode=ez.DEFAULT,this.projectionMode=nz.PERSPECTIVE,this.frustum=new DG,this.orthoMatrix=q()}),[{key:"isOrtho",value:function(){return this.projectionMode===nz.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,e){return this.type=t,this.type===tz.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tz.TRACKING&&void 0!==e&&this.setTrackingMode(e),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==tz.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return nt(q(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,e){var n=dt(q(),[t,e,0]);this.jitteredProjectionMatrix=at(q(),n,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===nz.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===nz.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,e,n,i,r,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.projectionMode===nz.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===nz.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===nz.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===nz.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),i=n.x,r=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(i,r),this.setFocalPoint(i,r),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=N(o.x-i,o.y-r,0),l=_(s,this.right)/S(this.right),u=_(s,this.up)/S(this.up),c=b(this.getPosition(),2),h=c[0],d=c[1],f=b(this.getFocalPoint(),2),p=f[0],g=f[1];return this.setPosition(h-l,d-u),this.setFocalPoint(p-l,g-u),this}},{key:"setPerspective",value:function(t,e,n,i){var r;this.projectionMode=nz.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=i;var a=this.near*Math.tan(VG(.5*this.fov))/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(r=this.view)&&void 0!==r&&r.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c}return function(t,e,n,i,r,a,o){var s,l,u=2*a,c=n-e,h=i-r,d=u/c,f=u/h,p=(n+e)/c,g=(i+r)/h,v=o-a,y=o*a;arguments.length>7&&void 0!==arguments[7]&&arguments[7]?(s=-o/v,l=-y/v):(s=-(o+a)/v,l=-2*y/v),t[0]=d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=p,t[9]=g,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===MG.ZERO),nt(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,e,n,i,r,a){var o;this.projectionMode=nz.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=i,this.near=r,this.far=a;var s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,p=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d=(h+=g*this.view.offsetX)+g*this.view.width,p=(f-=v*this.view.offsetY)-v*this.view.height}return this.clipSpaceNearZ===MG.NEGATIVE_ONE?Rt(this.projectionMatrix,h,d,f,p,r,a):Lt(this.projectionMatrix,h,d,f,p,r,a),nt(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var e=GG(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2]);return this._setPosition(e),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],i=N(0,1,0);if(this.focalPoint=GG(t,e,n),this.trackingMode===ez.CINEMATIC){var r=P(k(),this.focalPoint,this.position);t=r[0],e=r[1],n=r[2];var a=S(r),o=UG(Math.asin(e/a)),s=90+UG(Math.atan2(n,t)),l=q();ct(l,l,VG(s)),ut(l,l,VG(o)),i=j(k(),[0,1,0],l)}return nt(this.matrix,Dt(q(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<iz&&(this.distance=iz),this.dollyingStep=this.distance/100;var e=k();t=this.distance;var n=this.forward,i=this.focalPoint;return e[0]=t*n[0]+i[0],e[1]=t*n[1]+i[1],e[2]=t*n[2]+i[2],this._setPosition(e),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=FG(t),this.computeMatrix(),this._getAxes(),this.type===tz.ORBITING||this.type===tz.EXPLORING?this._getPosition():this.type===tz.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=FG(t),this.computeMatrix(),this._getAxes(),this.type===tz.ORBITING||this.type===tz.EXPLORING?this._getPosition():this.type===tz.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=FG(t),this.computeMatrix(),this._getAxes(),this.type===tz.ORBITING||this.type===tz.EXPLORING?this._getPosition():this.type===tz.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=Kt(qt(),[0,0,1],VG(this.roll));tt(this.matrix);var e=Kt(qt(),[1,0,0],VG((this.rotateWorld&&this.type!==tz.TRACKING||this.type===tz.TRACKING?1:-1)*this.elevation)),n=Kt(qt(),[0,1,0],VG((this.rotateWorld&&this.type!==tz.TRACKING||this.type===tz.TRACKING?1:-1)*this.azimuth)),i=Zt(qt(),n,e);i=Zt(qt(),i,t);var r=St(q(),i);this.type===tz.ORBITING||this.type===tz.EXPLORING?(ot(this.matrix,this.matrix,this.focalPoint),at(this.matrix,this.matrix,r),ot(this.matrix,this.matrix,[0,0,this.distance])):this.type===tz.TRACKING&&(ot(this.matrix,this.matrix,this.position),at(this.matrix,this.matrix,r))}},{key:"_setPosition",value:function(t,e,n){this.position=GG(t,e,n);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){T(this.right,GG(X(Y(),[1,0,0,0],this.matrix))),T(this.up,GG(X(Y(),[0,1,0,0],this.matrix))),T(this.forward,GG(X(Y(),[0,0,1,0],this.matrix))),I(this.right,this.right),I(this.up,this.up),I(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],i=S(this.distanceVector);if(0===i)return this.elevation=0,void(this.azimuth=0);this.type===tz.TRACKING||this.rotateWorld?(this.elevation=UG(Math.asin(e/i)),this.azimuth=UG(Math.atan2(-t,-n))):(this.elevation=-UG(Math.asin(e/i)),this.azimuth=-UG(Math.atan2(-t,-n)))}},{key:"_getPosition",value:function(){T(this.position,GG(X(Y(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){G(this.distanceVector,[0,0,-this.distance],$t(Yt(),this.matrix)),O(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=P(k(),this.focalPoint,this.position),this.distance=S(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===nz.ORTHOGRAPHIC){var t=this.position,e=Kt(qt(),[0,0,1],-this.roll*Math.PI/180);Mt(this.orthoMatrix,e,N((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),N(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=at(q(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit("updated")}}},{key:"rotate",value:function(t,e,n){throw new Error(BG)}},{key:"pan",value:function(t,e){throw new Error(BG)}},{key:"dolly",value:function(t){throw new Error(BG)}},{key:"createLandmark",value:function(t,e){throw new Error(BG)}},{key:"gotoLandmark",value:function(t,e){throw new Error(BG)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(BG)}}])}(),az=function(t){return t[t.Standard=0]="Standard",t}({}),oz=function(t){return t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",t}({}),sz=k(),lz=q(),uz=qt();function cz(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){Mt(t.localTransform,t.localRotation,t.localPosition,N(1,1,1),t.origin),0===t.localSkew[0]&&0===t.localSkew[1]||(tt(lz),lz[4]=Math.tan(t.localSkew[0]),lz[1]=Math.tan(t.localSkew[1]),at(t.localTransform,t.localTransform,lz));var e=Mt(lz,ne(uz,0,0,0,1),A(sz,1,1,1),t.localScale,t.origin);at(t.localTransform,t.localTransform,e)}else{var n=t.localTransform,i=t.localPosition,r=t.localRotation,a=t.localScale,o=t.origin,s=0!==i[0]||0!==i[1]||0!==i[2],l=1!==r[3]||0!==r[0]||0!==r[1]||0!==r[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?Mt(n,r,i,a,o):s?dt(n,i):tt(n)}t.localDirtyFlag=!1}}var hz={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new _G(0,0,0,0)},dz=function(t){return t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_DISTANCE="<offset-distance>",t.DEFINED_PATH="<defined-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>",t}({});function fz(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function pz(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function gz(){}var vz=.7,yz=1.4285714285714286,mz="\\s*([+-]?\\d+)\\s*",bz="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xz="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ez=/^#([0-9a-f]{3,8})$/,wz=new RegExp(`^rgb\\(${mz},${mz},${mz}\\)$`),kz=new RegExp(`^rgb\\(${xz},${xz},${xz}\\)$`),Mz=new RegExp(`^rgba\\(${mz},${mz},${mz},${bz}\\)$`),Sz=new RegExp(`^rgba\\(${xz},${xz},${xz},${bz}\\)$`),Nz=new RegExp(`^hsl\\(${bz},${xz},${xz}\\)$`),Tz=new RegExp(`^hsla\\(${bz},${xz},${xz},${bz}\\)$`),Az={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Oz(){return this.rgb().formatHex()}function Pz(){return this.rgb().formatRgb()}function Cz(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ez.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Rz(e):3===n?new Dz(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Lz(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Lz(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=wz.exec(t))?new Dz(e[1],e[2],e[3],1):(e=kz.exec(t))?new Dz(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Mz.exec(t))?Lz(e[1],e[2],e[3],e[4]):(e=Sz.exec(t))?Lz(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Nz.exec(t))?Gz(e[1],e[2]/100,e[3]/100,1):(e=Tz.exec(t))?Gz(e[1],e[2]/100,e[3]/100,e[4]):Az.hasOwnProperty(t)?Rz(Az[t]):"transparent"===t?new Dz(NaN,NaN,NaN,0):null}function Rz(t){return new Dz(t>>16&255,t>>8&255,255&t,1)}function Lz(t,e,n,i){return i<=0&&(t=e=n=NaN),new Dz(t,e,n,i)}function Dz(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Iz(){return`#${jz(this.r)}${jz(this.g)}${jz(this.b)}`}function _z(){const t=Bz(this.opacity);return`${1===t?"rgb(":"rgba("}${Fz(this.r)}, ${Fz(this.g)}, ${Fz(this.b)}${1===t?")":`, ${t})`}`}function Bz(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Fz(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function jz(t){return((t=Fz(t))<16?"0":"")+t.toString(16)}function Gz(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Vz(t,e,n,i)}function zz(t){if(t instanceof Vz)return new Vz(t.h,t.s,t.l,t.opacity);if(t instanceof gz||(t=Cz(t)),!t)return new Vz;if(t instanceof Vz)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,l=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=l<.5?a+r:2-a-r,o*=60):s=l>0&&l<1?0:o,new Vz(o,s,l,t.opacity)}function Vz(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Wz(t){return(t=(t||0)%360)<0?t+360:t}function Uz(t){return Math.max(0,Math.min(1,t||0))}function Hz(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Yz(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var o=e?e.apply(this,r):r[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,r);return n.cache=s.set(o,l)||s,l};return n.cache=new(Yz.Cache||Map),Yz.cacheList.push(n.cache),n}fz(gz,Cz,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Oz,formatHex:Oz,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return zz(this).formatHsl()},formatRgb:Pz,toString:Pz}),fz(Dz,(function(t,e,n,i){return 1===arguments.length?((r=t)instanceof gz||(r=Cz(r)),r?new Dz((r=r.rgb()).r,r.g,r.b,r.opacity):new Dz):new Dz(t,e,n,null==i?1:i);var r}),pz(gz,{brighter(t){return t=null==t?yz:Math.pow(yz,t),new Dz(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?vz:Math.pow(vz,t),new Dz(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Dz(Fz(this.r),Fz(this.g),Fz(this.b),Bz(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Iz,formatHex:Iz,formatHex8:function(){return`#${jz(this.r)}${jz(this.g)}${jz(this.b)}${jz(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:_z,toString:_z})),fz(Vz,(function(t,e,n,i){return 1===arguments.length?zz(t):new Vz(t,e,n,null==i?1:i)}),pz(gz,{brighter(t){return t=null==t?yz:Math.pow(yz,t),new Vz(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?vz:Math.pow(vz,t),new Vz(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Dz(Hz(t>=240?t-240:t+120,r,i),Hz(t,r,i),Hz(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Vz(Wz(this.h),Uz(this.s),Uz(this.l),Bz(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Bz(this.opacity);return`${1===t?"hsl(":"hsla("}${Wz(this.h)}, ${100*Uz(this.s)}%, ${100*Uz(this.l)}%${1===t?")":`, ${t})`}`}})),Yz.Cache=Map,Yz.cacheList=[],Yz.clearCache=function(){Yz.cacheList.forEach((function(t){return t.clear()}))};var $z=function(t){return t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger",t}({}),Xz=function(t){return t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther",t}({}),qz=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),Kz=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),Zz=[{name:"em",unit_type:$z.kEms},{name:"px",unit_type:$z.kPixels},{name:"deg",unit_type:$z.kDegrees},{name:"rad",unit_type:$z.kRadians},{name:"grad",unit_type:$z.kGradians},{name:"ms",unit_type:$z.kMilliseconds},{name:"s",unit_type:$z.kSeconds},{name:"rem",unit_type:$z.kRems},{name:"turn",unit_type:$z.kTurns}],Qz=function(t){return t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType",t}({}),Jz=function(t){var e=1;switch(t){case $z.kPixels:case $z.kDegrees:case $z.kSeconds:break;case $z.kMilliseconds:e=.001;break;case $z.kRadians:e=180/Math.PI;break;case $z.kGradians:e=.9;break;case $z.kTurns:e=360}return e},tV=function(t){switch(t){case $z.kNumber:case $z.kInteger:return"";case $z.kPercentage:return"%";case $z.kEms:return"em";case $z.kRems:return"rem";case $z.kPixels:return"px";case $z.kDegrees:return"deg";case $z.kRadians:return"rad";case $z.kGradians:return"grad";case $z.kMilliseconds:return"ms";case $z.kSeconds:return"s";case $z.kTurns:return"turn"}return""},eV=function(){return c((function t(){l(this,t)}),[{key:"toString",value:function(){return this.buildCSSText(qz.kNo,Kz.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=Qz.kUnitType&&this.getType()<=Qz.kClampType}}],[{key:"isAngle",value:function(t){return t===$z.kDegrees||t===$z.kRadians||t===$z.kGradians||t===$z.kTurns}},{key:"isLength",value:function(t){return t>=$z.kEms&&t<$z.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===$z.kPercentage||t===$z.kEms||t===$z.kRems}},{key:"isTime",value:function(t){return t===$z.kSeconds||t===$z.kMilliseconds}}])}(),nV=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).colorSpace=t,n}return m(e,t),c(e,[{key:"getType",value:function(){return Qz.kColorType}},{key:"to",value:function(t){return this}}])}(eV),iV=function(t){return t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient",t}({}),rV=function(t){function e(t,n){var i;return l(this,e),(i=v(this,e)).type=t,i.value=n,i}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(t,e,n){return n}},{key:"getType",value:function(){return Qz.kColorType}}])}(eV),aV=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).value=t,n}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return Qz.kKeywordType}},{key:"buildCSSText",value:function(t,e,n){return n+this.value}}])}(eV),oV=function(t){return function(t){switch(t){case Xz.kUNumber:return $z.kNumber;case Xz.kULength:return $z.kPixels;case Xz.kUPercent:return $z.kPercentage;case Xz.kUTime:return $z.kSeconds;case Xz.kUAngle:return $z.kDegrees;default:return $z.kUnknown}}(function(t){switch(t){case $z.kNumber:case $z.kInteger:return Xz.kUNumber;case $z.kPercentage:return Xz.kUPercent;case $z.kPixels:return Xz.kULength;case $z.kMilliseconds:case $z.kSeconds:return Xz.kUTime;case $z.kDegrees:case $z.kRadians:case $z.kGradians:case $z.kTurns:return Xz.kUAngle;default:return Xz.kUOther}}(t))},sV=function(t){function e(t){var n,i,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$z.kNumber;return l(this,e),n=v(this,e),i="string"==typeof a?(r=a)?"number"===r?$z.kNumber:"percent"===r||"%"===r?$z.kPercentage:function(t){return Zz.find((function(e){return e.name===t})).unit_type}(r):$z.kUnknown:a,n.unit=i,n.value=t,n}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(t){var e=t;return this.value===e.value&&this.unit===e.unit}},{key:"getType",value:function(){return Qz.kUnitType}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=oV(this.unit);if(n!==oV(t)||n===$z.kUnknown)return null;var i=Jz(this.unit)/Jz(t);return new e(this.value*i,t)}},{key:"buildCSSText",value:function(t,e,n){var i;switch(this.unit){case $z.kUnknown:break;case $z.kInteger:i=Number(this.value).toFixed(0);break;case $z.kNumber:case $z.kPercentage:case $z.kEms:case $z.kRems:case $z.kPixels:case $z.kDegrees:case $z.kRadians:case $z.kGradians:case $z.kMilliseconds:case $z.kSeconds:case $z.kTurns:var r=this.value,a=tV(this.unit);if(r<-999999||r>999999){var o=tV(this.unit);i=!Number.isFinite(r)||Number.isNaN(r)?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e}(r,o):r+(o||"")}else i="".concat(r).concat(a)}return n+i}}])}(eV),lV=new sV(0,"px");new sV(1,"px");var uV=new sV(0,"deg"),cV=function(t){function e(t,n,i){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return l(this,e),(r=v(this,e,["rgb"])).r=t,r.g=n,r.b=i,r.alpha=a,r.isNone=o,r}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(nV),hV=new aV("unset"),dV={"":hV,unset:hV,initial:new aV("initial"),inherit:new aV("inherit")},fV=new cV(0,0,0,0,!0),pV=new cV(0,0,0,0),gV=Yz((function(t,e,n,i){return new cV(t,e,n,i)}),(function(t,e,n,i){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(i,")")})),vV=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$z.kNumber;return new sV(t,e)};function yV(t){var e=t.type,n=t.value;return"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")")}new sV(50,"%");var mV=function(){var t=/^(linear\-gradient)/i,e=/^(repeating\-linear\-gradient)/i,n=/^(radial\-gradient)/i,i=/^(repeating\-radial\-gradient)/i,r=/^(conic\-gradient)/i,a=/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,o=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,s=/^(left|center|right|top|bottom)/i,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,d=/^\(/,f=/^\)/,p=/^,/,g=/^\#([0-9a-fA-F]+)/,v=/^([a-zA-Z]+)/,y=/^rgb/i,m=/^rgba/i,b=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,x="";function E(t){throw new Error("".concat(x,": ").concat(t))}function w(){return k("linear-gradient",t,S)||k("repeating-linear-gradient",e,S)||k("radial-gradient",n,N)||k("repeating-radial-gradient",i,N)||k("conic-gradient",r,N)}function k(t,e,n){return M(e,(function(e){var i=n();return i&&(B(p)||E("Missing comma before color stops")),{type:t,orientation:i,colorStops:C(R)}}))}function M(t,e){var n=B(t);if(n){B(d)||E("Missing (");var i=e(n);return B(f)||E("Missing )"),i}}function S(){return _("directional",a,1)||_("angular",h,1)}function N(){var t,e,n=T();return n&&((t=[]).push(n),e=x,B(p)&&((n=T())?t.push(n):x=e)),t}function T(){var t,e=function(){var t=_("shape",/^(circle)/i,0);return t&&(t.style=I()||A()),t}()||((t=_("shape",/^(ellipse)/i,0))&&(t.style=D()||A()),t);if(e)e.at=O();else{var n=A();if(n){e=n;var i=O();i&&(e.at=i)}else{var r=P();r&&(e={type:"default-radial",at:r})}}return e}function A(){return _("extent-keyword",o,1)}function O(){if(_("position",/^at/,0)){var t=P();return t||E("Missing positioning value"),t}}function P(){var t={x:D(),y:D()};if(t.x||t.y)return{type:"position",value:t}}function C(t){var e=t(),n=[];if(e)for(n.push(e);B(p);)(e=t())?n.push(e):E("One extra comma");return n}function R(){var t=_("hex",g,1)||M(m,(function(){return{type:"rgba",value:C(L)}}))||M(y,(function(){return{type:"rgb",value:C(L)}}))||_("literal",v,0);return t||E("Expected color definition"),t.length=D(),t}function L(){return B(b)[1]}function D(){return _("%",u,1)||_("position-keyword",s,1)||I()}function I(){return _("px",l,1)||_("em",c,1)}function _(t,e,n){var i=B(e);if(i)return{type:t,value:i[n]}}function B(t){var e=/^[\n\r\t\s]+/.exec(x);e&&F(e[0].length);var n=t.exec(x);return n&&F(n[0].length),n}function F(t){x=x.substring(t)}return function(t){return x=t,e=C(w),x.length>0&&E("Invalid input not EOF"),e;var e}}(),bV=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,xV=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,EV=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,wV=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,kV={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},MV=Yz((function(t){var e;return e="angular"===t.type?Number(t.value):kV[t.value]||0,vV(e,"deg")})),SV=Yz((function(t){var e=50,n=50,i="%",r="%";if("position"===(null==t?void 0:t.type)){var a=t.value,o=a.x,s=a.y;"position-keyword"===(null==o?void 0:o.type)&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),"position-keyword"===(null==s?void 0:s.type)&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),"px"!==(null==o?void 0:o.type)&&"%"!==(null==o?void 0:o.type)&&"em"!==(null==o?void 0:o.type)||(i=null==o?void 0:o.type,e=Number(o.value)),"px"!==(null==s?void 0:s.type)&&"%"!==(null==s?void 0:s.type)&&"em"!==(null==s?void 0:s.type)||(r=null==s?void 0:s.type,n=Number(s.value))}return{cx:vV(e,i),cy:vV(n,r)}})),NV=Yz((function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return mV(t).map((function(t){var e=t.type,n=t.orientation,i=t.colorStops;!function(t){var e,n,i=t.length;t[i-1].length=null!==(e=t[i-1].length)&&void 0!==e?e:{type:"%",value:"100"},i>1&&(t[0].length=null!==(n=t[0].length)&&void 0!==n?n:{type:"%",value:"0"});for(var r=0,a=Number(t[0].length.value),o=1;o<i;o++){var s,l=null===(s=t[o].length)||void 0===s?void 0:s.value;if(!ce(l)&&!ce(a)){for(var u=1;u<o-r;u++)t[r+u].length={type:"%",value:"".concat(a+(Number(l)-a)*u/(o-r))};r=o,a=Number(l)}}}(i);var r,a=i.map((function(t){return{offset:vV(Number(t.length.value),"%"),color:yV(t)}}));if("linear-gradient"===e)return new rV(iV.LinearGradient,{angle:n?MV(n):uV,steps:a});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var o,s=SV(n[0].at),l=s.cx,u=s.cy;if(n[0].style){var c=n[0].style,h=c.type,d=c.value;"extent-keyword"===h?(dV[r=d]||(dV[r]=new aV(r)),o=dV[r]):o=vV(d,h)}return new rV(iV.RadialGradient,{cx:l,cy:u,size:o,steps:a})}}));var e=t[0];if("("===t[1]||"("===t[2])if("l"===e){var n=bV.exec(t);if(n){var i,r=(null===(i=n[2].match(wV))||void 0===i?void 0:i.map((function(t){return t.split(":")})))||[];return[new rV(iV.LinearGradient,{angle:vV(parseFloat(n[1]),"deg"),steps:r.map((function(t){var e=b(t,2),n=e[0],i=e[1];return{offset:vV(100*Number(n),"%"),color:i}}))})]}}else if("r"===e){var a=function(t){var e=xV.exec(t);if(e){var n,i=(null===(n=e[4].match(wV))||void 0===n?void 0:n.map((function(t){return t.split(":")})))||[];return{cx:vV(50,"%"),cy:vV(50,"%"),steps:i.map((function(t){var e=b(t,2),n=e[0],i=e[1];return{offset:vV(100*Number(n),"%"),color:i}}))}}return null}(t);if(a){if(!he(a))return[new rV(iV.RadialGradient,a)];t=a}}else if("p"===e)return function(t){var e=EV.exec(t);if(e){var n=e[1],i=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat"}return{image:i,repetition:n}}return null}(t)}));function TV(t){return t&&!!t.image}function AV(t){return t&&!ce(t.r)&&!ce(t.g)&&!ce(t.b)}var OV=Yz((function(t){if(TV(t))return s({repetition:"repeat"},t);if(ce(t)&&(t=""),"transparent"===t)return pV;if("currentColor"===t)t="black";else if("none"===t)return fV;var e=NV(t);if(e)return e;var n=Cz(t),i=[0,0,0,0];return null!==n&&(i[0]=n.r||0,i[1]=n.g||0,i[2]=n.b||0,i[3]=n.opacity),gV.apply(void 0,i)}));function PV(t,e){if(AV(t)&&AV(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(de(e[n],0,255));return e[3]=de(e[3],0,1),"rgba(".concat(e.join(","),")")}]}function CV(t,e){if(ce(e))return vV(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(t)>=0)return vV(Number(e),"px");if("deg".search(t)>=0)return vV(Number(e),"deg")}var n=[];e=e.replace(t,(function(t){return n.push(t),"U".concat(t)}));var i="U(".concat(t.source,")");return n.map((function(t){return vV(Number(e.replace(new RegExp("U".concat(t),"g"),"").replace(new RegExp(i,"g"),"*0")),t)}))[0]}var RV=function(t){return CV(new RegExp("px","g"),t)},LV=Yz(RV);Yz((function(t){return CV(new RegExp("%","g"),t)}));var DV=function(t){return le(t)||isFinite(Number(t))?vV(Number(t)||0,"px"):CV(new RegExp("px|%|em|rem","g"),t)},IV=Yz(DV),_V=function(t){return CV(new RegExp("deg|rad|grad|turn","g"),t)},BV=Yz(_V);function FV(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=oV(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=tV(t.unit)):(sV.isLength(t.unit)||sV.isLength(e.unit))&&(o=zV(t,r,n),s=zV(e,r,n),a="px"),[o,s,function(t){return i&&(t=Math.max(t,0)),t+a}]}function jV(t){var e=0;return t.unit===$z.kDegrees?e=t.value:t.unit===$z.kRadians?e=UG(Number(t.value)):t.unit===$z.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e}function GV(t,e){var n;return Array.isArray(t)?n=t.map((function(t){return Number(t)})):he(t)?n=t.split(" ").map((function(t){return Number(t)})):le(t)&&(n=[t]),2===e?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat(f(n),f(n)):n}function zV(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===$z.kPixels)return Number(t.value);if(t.unit===$z.kPercentage&&n){var r=n.nodeName===kG.GROUP?n.getLocalBounds():n.getGeometryBounds();return(i?r.min[e]:0)+t.value/100*r.halfExtents[e]*2}return 0}var VV=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function WV(t){return t.toString()}var UV=function(t){return"number"==typeof t?vV(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?vV(Number(t)):vV(0)},HV=Yz(UV);function YV(t,e){return[t,e,WV]}function $V(t,e){return function(n,i){return[n,i,function(n){return WV(de(n,t,e))}]}}function XV(t,e){if(t.length===e.length)return[t,e,function(t){return t}]}function qV(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=Ye(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength}function KV(t,e){return t[0]===e[0]&&t[1]===e[1]}function ZV(t,e){var n=t.prePoint,i=t.currentPoint,r=t.nextPoint,a=Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2),o=Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2),s=Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||0===Math.sin(l)||Ke(l,0))return{xExtra:0,yExtra:0};var u=Math.abs(Math.atan2(r[1]-i[1],r[0]-i[0])),c=Math.abs(Math.atan2(r[0]-i[0],r[1]-i[1]));return u=u>Math.PI/2?Math.PI-u:u,c=c>Math.PI/2?Math.PI-c:c,{xExtra:Math.cos(l/2-u)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(c-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0}}function QV(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}Yz((function(t){return he(t)?t.split(" ").map(HV):t.map(HV)}));var JV=function(t,e){var n=t.x*e.x+t.y*e.y,i=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/i)},tW=function(t,e,n,i,r,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=VG(i=Ze(i,360));if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2));f=f<0?0:f;var p=(r!==a?1:-1)*Math.sqrt(f),g=p*(e*h.y/n),v=p*(-n*h.x/e),y={x:Math.cos(l)*g-Math.sin(l)*v+(t.x+o.x)/2,y:Math.sin(l)*g+Math.cos(l)*v+(t.y+o.y)/2},m={x:(h.x-g)/e,y:(h.y-v)/n},b=JV({x:1,y:0},m),x=JV(m,{x:(-h.x-g)/e,y:(-h.y-v)/n});!a&&x>0?x-=2*Math.PI:a&&x<0&&(x+=2*Math.PI);var E=b+(x%=2*Math.PI)*s,w=e*Math.cos(E),k=n*Math.sin(E);return{x:Math.cos(l)*w-Math.sin(l)*k+y.x,y:Math.sin(l)*w+Math.cos(l)*k+y.y,ellipticalArcStartAngle:b,ellipticalArcEndAngle:b+x,ellipticalArcAngle:E,ellipticalArcCenter:y,resultantRx:e,resultantRy:n}};function eW(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.arcParams,r=i.rx,a=void 0===r?0:r,o=i.ry,s=void 0===o?0:o,l=i.xRotation,u=i.arcFlag,c=i.sweepFlag,h=tW({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=tW({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,p=d.y-h.y,g=Math.sqrt(f*f+p*p);return{x:-f/g,y:-p/g}}function nW(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function iW(t,e){return nW(t)*nW(e)?(t[0]*e[0]+t[1]*e[1])/(nW(t)*nW(e)):1}function rW(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(iW(t,e))}function aW(t,e){var n=e[1],i=e[2],r=Ze(VG(e[3]),2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(r)*(s-u)/2+Math.sin(r)*(l-c)/2,d=-1*Math.sin(r)*(s-u)/2+Math.cos(r)*(l-c)/2,f=h*h/(n*n)+d*d/(i*i);f>1&&(n*=Math.sqrt(f),i*=Math.sqrt(f));var p=n*n*(d*d)+i*i*(h*h),g=p?Math.sqrt((n*n*(i*i)-p)/p):1;a===o&&(g*=-1),isNaN(g)&&(g=0);var v=i?g*n*d/i:0,y=n?g*-i*h/n:0,m=(s+u)/2+Math.cos(r)*v-Math.sin(r)*y,b=(l+c)/2+Math.sin(r)*v+Math.cos(r)*y,x=[(h-v)/n,(d-y)/i],E=[(-1*h-v)/n,(-1*d-y)/i],w=rW([1,0],x),k=rW(x,E);return iW(x,E)<=-1&&(k=Math.PI),iW(x,E)>=1&&(k=0),0===o&&k>0&&(k-=2*Math.PI),1===o&&k<0&&(k+=2*Math.PI),{cx:m,cy:b,rx:KV(t,[u,c])?0:n,ry:KV(t,[u,c])?0:i,startAngle:w,endAngle:w+k,xRotation:r,arcFlag:a,sweepFlag:o}}var oW=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Ie(t)}catch(n){e=Ie(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],i=t[e];if("M"===i[0]&&n){var r=n[0],a=[i[1],i[2]],o=void 0;"L"===r||"M"===r?o=[n[1],n[2]]:"C"!==r&&"A"!==r&&"Q"!==r||(o=[n[n.length-2],n[n.length-1]]),o&&KV(a,o)&&(t.splice(e,1),e--)}}}(e);var n=function(t){for(var e=!1,n=t.length,i=0;i<n;i++){var r=t[i][0];if("C"===r||"A"===r||"Q"===r){e=!0;break}}return e}(e),i=function(t){for(var e=[],n=[],i=[],r=0;r<t.length;r++){var a=t[r],o=a[0];"M"===o?(i.length&&(n.push(i),i=[]),i.push([a[1],a[2]])):"Z"===o?i.length&&(e.push(i),i=[]):i.push([a[1],a[2]])}return i.length>0&&n.push(i),{polygons:e,polylines:n}}(e),r=i.polygons,a=i.polylines,o=function(t){for(var e=[],n=null,i=null,r=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];i=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":r=[l[1],l[2]],a=s;break;case"A":var h=aW(n,l);c.arcParams=h}if("Z"===u)n=r,i=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]]}i&&"Z"===i[0]&&(i=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&KV(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=i?[i[i.length-2],i[i.length-1]]:null;c.nextPoint=f;var p=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];else if("Q"===u){var g=[l[1],l[2]];c.startTangent=[p[0]-g[0],p[1]-g[1]],c.endTangent=[n[0]-g[0],n[1]-g[1]]}else if("T"===u){var v=e[s-1],y=QV(v.currentPoint,p);"Q"===v.command?(c.command="Q",c.startTangent=[p[0]-y[0],p[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]])}else if("C"===u){var m=[l[1],l[2]],b=[l[3],l[4]];c.startTangent=[p[0]-m[0],p[1]-m[1]],c.endTangent=[n[0]-b[0],n[1]-b[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-b[0],m[1]-b[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[b[0]-m[0],b[1]-m[1]])}else if("S"===u){var x=e[s-1],E=QV(x.currentPoint,p),w=[l[1],l[2]];"C"===x.command?(c.command="C",c.startTangent=[p[0]-E[0],p[1]-E[1]],c.endTangent=[n[0]-w[0],n[1]-w[1]]):(c.command="SQ",c.startTangent=[p[0]-w[0],p[1]-w[1]],c.endTangent=[n[0]-w[0],n[1]-w[1]])}else if("A"===u){var k=eW(c,0),M=k.x,S=k.y,N=eW(c,1,!1),T=N.x,A=N.y;c.startTangent=[M,S],c.endTangent=[T,A]}e.push(c)}return e}(e),s=function(t){for(var e=[],n=[],i=[],r=0;r<t.length;r++){var a=t[r],o=a.currentPoint,s=a.params,l=a.prePoint,u=void 0;switch(a.command){case"Q":u=In(l[0],l[1],s[1],s[2],s[3],s[4]);break;case"C":u=Pn(l[0],l[1],s[1],s[2],s[3],s[4],s[5],s[6]);break;case"A":var c=a.arcParams;u=Mn(c.cx,c.cy,c.rx,c.ry,c.xRotation,c.startAngle,c.endAngle);break;default:e.push(o[0]),n.push(o[1])}u&&(a.box=u,e.push(u.x,u.x+u.width),n.push(u.y,u.y+u.height))}e=e.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0})),n=n.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0}));var h=Xe(e),d=Xe(n),f=qe(e),p=qe(n);if(0===i.length)return{x:h,y:d,width:f-h,height:p-d};for(var g=0;g<i.length;g++){var v=i[g],y=v.currentPoint;y[0]===h?h-=ZV(v,0).xExtra:y[0]===f&&(f+=ZV(v,0).xExtra),y[1]===d?d-=ZV(v,0).yExtra:y[1]===p&&(p+=ZV(v,0).yExtra)}return{x:h,y:d,width:f-h,height:p-d}}(o),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:r,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}}},sW=Yz(oW);function lW(t){return he(t)?sW(t):oW(t)}function uW(t,e,n){var i=t.curve,r=e.curve;i&&0!==i.length||(i=rn(t.absolutePath,!1),t.curve=i),r&&0!==r.length||(r=rn(e.absolutePath,!1),e.curve=r);var a=[i,r];i.length!==r.length&&(a=on(i,r));var o=sn(a[0])!==sn(a[1])?ln(a[0]):un(a[0]);return[o,cn(a[1],o),function(t){return t}]}function cW(t,e){return[t.points,e.points,function(t){return t}]}var hW=null,dW=/\s*(\w+)\(([^)]*)\)/g;function fW(t){return function(e){var n=0;return t.map((function(t){return t===hW?e[n++]:t}))}}function pW(t){return t}var gW={matrix:["NNNNNN",[hW,hW,0,0,hW,hW,0,0,0,0,1,0,hW,hW,0,1],pW],matrix3d:["NNNNNNNNNNNNNNNN",pW],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",fW([hW,hW,new sV(1)]),pW],scaleX:["N",fW([hW,new sV(1),new sV(1)]),fW([hW,new sV(1)])],scaleY:["N",fW([new sV(1),hW,new sV(1)]),fW([new sV(1),hW])],scaleZ:["N",fW([new sV(1),new sV(1),hW])],scale3d:["NNN",pW],skew:["Aa",null,pW],skewX:["A",null,fW([hW,uV])],skewY:["A",null,fW([uV,hW])],translate:["Tt",fW([hW,hW,lV]),pW],translateX:["T",fW([hW,lV,lV]),fW([hW,lV])],translateY:["T",fW([lV,hW,lV]),fW([lV,hW])],translateZ:["L",fW([lV,lV,hW])],translate3d:["TTL",pW]};function vW(t){for(var e=[],n=t.length,i=0;i<n;i++){var r=t[i],a=r[0],o=r.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!gW[a])return[];var s=o.map((function(t){return vV(t)}));e.push({t:a,d:s})}return e}function yW(t){if(Array.isArray(t))return vW(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],i=0;for(dW.lastIndex=0;e=dW.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var r=e[1],a=gW[r];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var l=[],u=0;u<s.length;u++){var c,h=o[u],d=s[u];if(void 0===(c=h?{A:function(t){return"0"===t.trim()?uV:BV(t)},N:HV,T:IV,L:LV}[d.toUpperCase()](h):{a:uV,n:l[0],t:lV}[d]))return[];l.push(c)}if(n.push({t:r,d:l}),dW.lastIndex===t.length)return n}return[]}function mW(t){if(Array.isArray(t))return vW(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],i=0;for(dW.lastIndex=0;e=dW.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var r=e[1],a=gW[r];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var l=[],u=0;u<s.length;u++){var c,h=o[u],d=s[u];if(void 0===(c=h?{A:function(t){return"0"===t.trim()?uV:_V(t)},N:UV,T:DV,L:RV}[d.toUpperCase()](h):{a:uV,n:l[0],t:lV}[d]))return[];l.push(c)}if(n.push({t:r,d:l}),dW.lastIndex===t.length)return n}return[]}function bW(t){var e,n,i,r;switch(t.t){case"rotateX":return r=VG(jV(t.d[0])),[1,0,0,0,0,Math.cos(r),Math.sin(r),0,0,-Math.sin(r),Math.cos(r),0,0,0,0,1];case"rotateY":return r=VG(jV(t.d[0])),[Math.cos(r),0,-Math.sin(r),0,0,1,0,0,Math.sin(r),0,Math.cos(r),0,0,0,0,1];case"rotate":case"rotateZ":return r=VG(jV(t.d[0])),[Math.cos(r),Math.sin(r),0,0,-Math.sin(r),Math.cos(r),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,i=t.d[2].value,r=VG(jV(t.d[3]));var a=e*e+n*n+i*i;if(0===a)e=1,n=0,i=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,i/=o}var s=Math.sin(r/2),l=s*Math.cos(r/2),u=s*s;return[1-2*(n*n+i*i)*u,2*(e*n*u+i*l),2*(e*i*u-n*l),0,2*(e*n*u-i*l),1-2*(e*e+i*i)*u,2*(n*i*u+e*l),0,2*(e*i*u+n*l),2*(n*i*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=VG(jV(t.d[0])),h=VG(jV(t.d[1]));return[1,Math.tan(h),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return r=VG(jV(t.d[0])),[1,0,0,0,Math.tan(r),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return r=VG(jV(t.d[0])),[1,Math.tan(r),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=zV(t.d[0],0,null)||0,n=zV(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=zV(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=zV(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,i=zV(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=zV(t.d[0],0,null)||0,n=zV(t.d[1],0,null)||0,i=zV(t.d[2],0,null)||0,1];case"perspective":var d=zV(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,d?-1/d:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map((function(t){return t.value}))}}function xW(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function EW(t){var e=[0,0,0],n=[1,1,1],i=[0,0,0],r=[0,0,0,1],a=[0,0,0,1];return function(t,e,n,i,r,a){if(!function(t,e){var n=e[15];if(0===n)return!1;for(var i=1/n,r=0;r<16;r++)t[r]=e[r]*i;return!0}(XG,t))return!1;if(Z(qG,XG),qG[3]=0,qG[7]=0,qG[11]=0,qG[15]=1,Math.abs(rt(qG))<1e-8)return!1;var o,s,l=XG[3],u=XG[7],c=XG[11],h=XG[12],d=XG[13],f=XG[14],p=XG[15];if(0!==l||0!==u||0!==c){if(KG[0]=l,KG[1]=u,KG[2]=c,KG[3]=p,!nt(qG,qG))return!1;et(qG,qG),X(r,KG,qG)}else r[0]=r[1]=r[2]=0,r[3]=1;if(e[0]=h,e[1]=d,e[2]=f,s=XG,(o=ZG)[0][0]=s[0],o[0][1]=s[1],o[0][2]=s[2],o[1][0]=s[4],o[1][1]=s[5],o[1][2]=s[6],o[2][0]=s[8],o[2][1]=s[9],o[2][2]=s[10],n[0]=S(ZG[0]),I(ZG[0],ZG[0]),i[0]=_(ZG[0],ZG[1]),JG(ZG[1],ZG[1],ZG[0],1,-i[0]),n[1]=S(ZG[1]),I(ZG[1],ZG[1]),i[0]/=n[1],i[1]=_(ZG[0],ZG[2]),JG(ZG[2],ZG[2],ZG[0],1,-i[1]),i[2]=_(ZG[1],ZG[2]),JG(ZG[2],ZG[2],ZG[1],1,-i[2]),n[2]=S(ZG[2]),I(ZG[2],ZG[2]),i[1]/=n[2],i[2]/=n[2],B(QG,ZG[1],ZG[2]),_(ZG[0],QG)<0)for(var g=0;g<3;g++)n[g]*=-1,ZG[g][0]*=-1,ZG[g][1]*=-1,ZG[g][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+ZG[0][0]-ZG[1][1]-ZG[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-ZG[0][0]+ZG[1][1]-ZG[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-ZG[0][0]-ZG[1][1]+ZG[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+ZG[0][0]+ZG[1][1]+ZG[2][2],0)),ZG[2][1]>ZG[1][2]&&(a[0]=-a[0]),ZG[0][2]>ZG[2][0]&&(a[1]=-a[1]),ZG[1][0]>ZG[0][1]&&(a[2]=-a[2])}(function(t){return 0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(bW).reduce(xW)}(t),e,n,i,r,a),[[e,n,i,a,r]]}var wW=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],i=0;i<4;i++)for(var r=0;r<4;r++)for(var a=0;a<4;a++)n[i][r]+=e[i][a]*t[a][r];return n}return function(e,n,i,r,a){for(var o=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],s=0;s<4;s++)o[s][3]=a[s];for(var l=0;l<3;l++)for(var u=0;u<3;u++)o[3][l]+=e[u]*o[u][l];var c=r[0],h=r[1],d=r[2],f=r[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(h*h+d*d),p[0][1]=2*(c*h-d*f),p[0][2]=2*(c*d+h*f),p[1][0]=2*(c*h+d*f),p[1][1]=1-2*(c*c+d*d),p[1][2]=2*(h*d-c*f),p[2][0]=2*(c*d-h*f),p[2][1]=2*(h*d+c*f),p[2][2]=1-2*(c*c+h*h),o=t(o,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];i[2]&&(g[2][1]=i[2],o=t(o,g)),i[1]&&(g[2][1]=0,g[2][0]=i[0],o=t(o,g)),i[0]&&(g[2][0]=0,g[1][0]=i[0],o=t(o,g));for(var v=0;v<3;v++)for(var y=0;y<3;y++)o[v][y]*=n[v];return function(t){return 0===t[0][2]&&0===t[0][3]&&0===t[1][2]&&0===t[1][3]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]&&0===t[2][3]&&0===t[3][2]&&1===t[3][3]}(o)?[o[0][0],o[0][1],o[1][0],o[1][1],o[3][0],o[3][1]]:o[0].concat(o[1],o[2],o[3])}}();function kW(t){return t.toFixed(6).replace(".000000","")}function MW(t,e){var n,i;return t.decompositionPair!==e&&(t.decompositionPair=e,n=EW(t)),e.decompositionPair!==t&&(e.decompositionPair=t,i=EW(e)),null===n[0]||null===i[0]?[[!1],[!0],function(n){return n?e[0].d:t[0].d}]:(n[0].push(0),i[0].push(1),[n,i,function(t){var e=function(t,e,n){var i=function(t,e){for(var n=0,i=0;i<t.length;i++)n+=t[i]*e[i];return n}(t,e),r=[];if(1===(i=de(i,-1,1)))r=t;else for(var a=Math.acos(i),o=1*Math.sin(n*a)/Math.sqrt(1-i*i),s=0;s<4;s++)r.push(t[s]*(Math.cos(n*a)-i*o)+e[s]*o);return r}(n[0][3],i[0][3],t[5]);return wW(t[0],t[1],t[2],e,t[4]).map(kW).join(",")}])}function SW(t){return t.replace(/[XY]/,"")}function NW(t){return t.replace(/(X|Y|Z|3d)?$/,"3d")}function TW(t,e,n){var i=!1;if(!t.length||!e.length){t.length||(i=!0,t=e,e=[]);for(var r=function(){var n=t[a],i=n.t,r=n.d,o="scale"===i.substring(0,5)?1:0;e.push({t:i,d:r.map((function(t){return"number"==typeof t?vV(o):vV(o,t.unit)}))})},a=0;a<t.length;a++)r()}var o,s,l=[],u=[],c=[];if(t.length!==e.length){var h=MW(t,e);l=[h[0]],u=[h[1]],c=[["matrix",[h[2]]]]}else for(var d=0;d<t.length;d++){var f=t[d].t,p=e[d].t,g=t[d].d,v=e[d].d,y=gW[f],m=gW[p],b=void 0;if(s=p,"perspective"===(o=f)&&"perspective"===s||!("matrix"!==o&&"matrix3d"!==o||"matrix"!==s&&"matrix3d"!==s)){var x=MW([t[d]],[e[d]]);l.push(x[0]),u.push(x[1]),c.push(["matrix",[x[2]]])}else{if(f===p)b=f;else if(y[2]&&m[2]&&SW(f)===SW(p))b=SW(f),g=y[2](g),v=m[2](v);else{if(!y[1]||!m[1]||NW(f)!==NW(p)){var E=MW(t,e);l=[E[0]],u=[E[1]],c=[["matrix",[E[2]]]];break}b=NW(f),g=y[1](g),v=m[1](v)}for(var w=[],k=[],M=[],S=0;S<g.length;S++){var N=FV(g[S],v[S],n,!1,S);w[S]=N[0],k[S]=N[1],M.push(N[2])}l.push(w),u.push(k),c.push([b,M])}}if(i){var T=l;l=u,u=T}return[l,u,function(t){return t.map((function(t,e){var n=t.map((function(t,n){return c[e][1][n](t)})).join(",");return"matrix"===c[e][0]&&16===n.split(",").length&&(c[e][0]="matrix3d"),"matrix3d"===c[e][0]&&6===n.split(",").length&&(c[e][0]="matrix"),"".concat(c[e][0],"(").concat(n,")")})).join(" ")}]}var AW=Yz((function(t){if(he(t)){if("text-anchor"===t)return[vV(0,"px"),vV(0,"px")];var e=t.split(" ");return 1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length?null:[IV(OW(e[0])),IV(OW(e[1]))]}return[vV(t[0]||0,"px"),vV(t[1]||0,"px")]}));function OW(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t}var PW=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:dz.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:dz.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:dz.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:dz.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:dz.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:dz.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:dz.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:dz.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:dz.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:dz.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:dz.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:dz.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:dz.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:dz.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:dz.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:dz.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:dz.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:dz.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:dz.FILTER},{n:"clipPath",syntax:dz.DEFINED_PATH},{n:"textPath",syntax:dz.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:dz.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:dz.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:dz.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:dz.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:dz.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:dz.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:dz.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:dz.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:dz.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:dz.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:dz.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:dz.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:dz.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:dz.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:dz.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:dz.COORDINATE},{n:"y1",int:!0,l:!0,syntax:dz.COORDINATE},{n:"z1",int:!0,l:!0,syntax:dz.COORDINATE},{n:"x2",int:!0,l:!0,syntax:dz.COORDINATE},{n:"y2",int:!0,l:!0,syntax:dz.COORDINATE},{n:"z2",int:!0,l:!0,syntax:dz.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:dz.PATH,p:50},{n:"points",int:!0,l:!0,syntax:dz.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:dz.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:dz.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:dz.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:dz.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:dz.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:dz.NUMBER,d:function(t){return t===kG.PATH||t===kG.POLYGON||t===kG.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:dz.MARKER},{n:"markerEnd",syntax:dz.MARKER},{n:"markerMid",syntax:dz.MARKER},{n:"markerStartOffset",syntax:dz.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:dz.LENGTH,l:!0,int:!0,d:"0"}],CW=new Set(PW.filter((function(t){return!!t.l})).map((function(t){return t.n}))),RW={},LW=function(){return c((function t(e){var n=this;l(this,t),this.runtime=e,PW.forEach((function(t){n.registerMetadata(t)}))}),[{key:"registerMetadata",value:function(t){[t.n].concat(f(t.a||[])).forEach((function(e){RW[e]=t}))}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,r=t.parsedStyle.offsetPath;!function(t,e){var n=DW(t);for(var i in e)n.has(i)&&(t.parsedStyle[i]=e[i])}(t,e);var a=!!n.forceUpdateGeometry;if(!a)for(var o in e)if(CW.has(o)){a=!0;break}var l,u=DW(t);u.has("fill")&&e.fill&&(t.parsedStyle.fill=OV(e.fill)),u.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=OV(e.stroke)),u.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=OV(e.shadowColor)),u.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,i=[],r=0;e=n.exec(t);){if(e.index!==r)return[];if(r=e.index+e[0].length,VV.indexOf(e[1])>-1&&i.push({name:e[1],params:e[2].split(" ").map((function(t){return CV(/deg|rad|grad|turn|px|%/g,t)||OV(t)}))}),n.lastIndex===t.length)return i}return[]}(e.filter)),u.has("radius")&&!ce(e.radius)&&(t.parsedStyle.radius=GV(e.radius,4)),u.has("lineDash")&&!ce(e.lineDash)&&(t.parsedStyle.lineDash=GV(e.lineDash,"even")),u.has("points")&&e.points&&(t.parsedStyle.points={points:he(l=e.points)?l.split(" ").map((function(t){var e=b(t.split(","),2),n=e[0],i=e[1];return[Number(n),Number(i)]})):l,totalLength:0,segments:[]}),u.has("d")&&""===e.d&&(t.parsedStyle.d=s({},hz)),u.has("d")&&e.d&&(t.parsedStyle.d=lW(e.d)),u.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[dz.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),u.has("clipPath")&&!hn(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[dz.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),u.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[dz.DEFINED_PATH].calculator("offsetPath",r,e.offsetPath,t,this.runtime),u.has("transform")&&e.transform&&(t.parsedStyle.transform=yW(e.transform)),u.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=AW(e.transformOrigin)),u.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[dz.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),u.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[dz.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),u.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[dz.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),u.has("zIndex")&&!ce(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[dz.Z_INDEX].postProcessor(t),u.has("offsetDistance")&&!ce(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[dz.OFFSET_DISTANCE].postProcessor(t),u.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[dz.TRANSFORM].postProcessor(t),u.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[dz.TRANSFORM_ORIGIN].postProcessor(t),a&&(t.geometry.dirty=!0,t.dirty(!0,!0),n.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t))}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var i=t.geometry;i.contentBounds||(i.contentBounds=new RG),i.renderBounds||(i.renderBounds=new RG);var r=t.parsedStyle,a=n.update(r,t),o=a.cx,s=void 0===o?0:o,l=a.cy,u=void 0===l?0:l,c=a.cz,h=void 0===c?0:c,d=a.hwidth,f=void 0===d?0:d,p=a.hheight,g=void 0===p?0:p,v=a.hdepth,y=void 0===v?0:v,m=[Math.abs(f),Math.abs(g),y],b=r.stroke,x=r.lineWidth,E=void 0===x?1:x,w=r.increasedLineWidthForHitTesting,k=void 0===w?0:w,M=r.shadowType,S=void 0===M?"outer":M,N=r.shadowColor,T=r.filter,A=void 0===T?[]:T,P=r.transformOrigin,C=[s,u,h];i.contentBounds.update(C,m);var R=e===kG.POLYLINE||e===kG.POLYGON||e===kG.PATH?Math.SQRT2:.5;if(b&&!b.isNone){var L=((E||0)+(k||0))*R;m[0]+=L,m[1]+=L}if(i.renderBounds.update(C,m),N&&S&&"inner"!==S){var D=i.renderBounds,I=D.min,_=D.max,B=r.shadowBlur||0,F=r.shadowOffsetX||0,j=r.shadowOffsetY||0,G=I[0]-B+F,z=_[0]+B+F,V=I[1]-B+j,W=_[1]+B+j;I[0]=Math.min(I[0],G),_[0]=Math.max(_[0],z),I[1]=Math.min(I[1],V),_[1]=Math.max(_[1],W),i.renderBounds.setMinMax(I,_)}A.forEach((function(t){var e=t.name,n=t.params;if("blur"===e){var r=n[0].value;i.renderBounds.update(i.renderBounds.center,O(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[r,r,0]))}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=i.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,p=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],p),i.renderBounds.setMinMax(u,c)}})),t.geometry.dirty=!1;var U=g<0,H=(f<0?-1:1)*(P?zV(P[0],0,t,!0):0),Y=(U?-1:1)*(P?zV(P[1],1,t,!0):0);(H||Y)&&t.setOrigin(H,Y)}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===kG.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===kG.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}])}();function DW(t){return t.constructor.PARSED_STYLE_LIST}var IW=function(){return c((function t(){l(this,t),this.mixer=YV}),[{key:"calculator",value:function(t,e,n,i){return jV(n)}}])}(),_W=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i,r){return n instanceof aV&&(n=null),r.sceneGraphService.updateDisplayObjectDependency(t,e,n,i),"clipPath"===t&&i.forEach((function(t){0===t.childNodes.length&&r.sceneGraphService.dirtyToRoot(t)})),n}}])}(),BW=function(){return c((function t(){l(this,t),this.parser=OV,this.mixer=PV}),[{key:"calculator",value:function(t,e,n,i){return n instanceof aV?"none"===n.value?fV:pV:n}}])}(),FW=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n){return n instanceof aV?[]:n}}])}();function jW(t){var e=t.parsedStyle.fontSize;return ce(e)?null:e}var GW=function(){return c((function t(){l(this,t),this.mixer=YV}),[{key:"calculator",value:function(t,e,n,i,r){if(le(n))return n;if(!sV.isRelativeUnit(n.unit))return n.value;if(n.unit===$z.kPercentage)return 0;if(n.unit===$z.kEms){if(i.parentNode){var a=jW(i.parentNode);if(a)return a*n.value}return 0}if(n.unit===$z.kRems){var o;if(null!=i&&null!==(o=i.ownerDocument)&&void 0!==o&&o.documentElement){var s=jW(i.ownerDocument.documentElement);if(s)return s*n.value}return 0}}}])}(),zW=function(){return c((function t(){l(this,t),this.mixer=XV}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),VW=function(){return c((function t(){l(this,t),this.mixer=XV}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),WW=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){var r;n instanceof aV&&(n=null);var a=null===(r=n)||void 0===r?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a}}])}(),UW=function(){return c((function t(){l(this,t),this.mixer=YV}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),HW=function(){return c((function t(){l(this,t),this.mixer=$V(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,i=e.offsetDistance;if(n){var r=n.nodeName;if(r===kG.LINE||r===kG.PATH||r===kG.POLYLINE){var a=n.getPoint(i);a&&t.setLocalPosition(a.x,a.y)}}}}])}(),YW=function(){return c((function t(){l(this,t),this.mixer=$V(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),$W=function(){return c((function t(){l(this,t),this.parser=lW,this.mixer=uW}),[{key:"calculator",value:function(t,e,n){return n instanceof aV&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new _G(0,0,0,0)}:n}}])}(),XW=c((function t(){l(this,t),this.mixer=cW})),qW=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).mixer=$V(0,1/0),t}return m(e,t),c(e)}(GW),KW=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){return n instanceof aV?"unset"===n.value?"":n.value:"".concat(n)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}])}(),ZW=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){var r=i.getAttribute("text");if(r){var a=r;"capitalize"===n.value?a=r.charAt(0).toUpperCase()+r.slice(1):"lowercase"===n.value?a=r.toLowerCase():"uppercase"===n.value&&(a=r.toUpperCase()),i.parsedStyle.text=a}return n.value}}])}();new WeakMap;var QW="undefined"!=typeof window&&void 0!==window.document,JW={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},tU="object"==typeof performance&&performance.now?performance:Date;function eU(t){return t.nodeName===kG.FRAGMENT||t.getRootNode().nodeName===kG.FRAGMENT}var nU=1,iU="object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:{},rU=Date.now(),aU={},oU=Date.now(),sU=function(t){if("function"!=typeof t)throw new TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-oU,i=n>16?0:16-n,r=nU++;return aU[r]=t,Object.keys(aU).length>1||setTimeout((function(){oU=e;var t=aU;aU={},Object.keys(t).forEach((function(e){return t[e](iU.performance&&"function"==typeof iU.performance.now?iU.performance.now():Date.now()-rU)}))}),i),r},lU=function(t){delete aU[t]},uU=function(t){return"string"!=typeof t?sU:""===t?iU.requestAnimationFrame:iU["".concat(t,"RequestAnimationFrame")]},cU=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1}}(["","webkit","moz","ms","o"],(function(t){return!!uU(t)})),hU=uU(cU),dU=function(t){return"string"!=typeof t?lU:""===t?iU.cancelAnimationFrame:iU["".concat(t,"CancelAnimationFrame")]||iU["".concat(t,"CancelRequestAnimationFrame")]}(cU);iU.requestAnimationFrame=hU,iU.cancelAnimationFrame=dU;var fU=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],pU=/([\"\'])[^\'\"]+\1/;function gU(t){var e=t.fontSize,n=void 0===e?16:e,i=t.fontFamily,r=void 0===i?"sans-serif":i,a=t.fontStyle,o=void 0===a?"normal":a,s=t.fontVariant,l=void 0===s?"normal":s,u=t.fontWeight;return{fontSize:n,fontFamily:r,fontStyle:o,fontVariant:l,fontWeight:void 0===u?"normal":u}}var vU=Yz((function(t){for(var e=gU(t),n=e.fontSize,i=e.fontFamily,r=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=le(n)&&"".concat(n,"px")||"16px",l=i.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!pU.test(c)&&fU.indexOf(c)<0&&(c='"'.concat(c,'"')),l[u]=c}return"".concat(r," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","))}),(function(t){var e=gU(t),n=e.fontSize,i=e.fontFamily,r=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(r,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(i)})),yU=function(t){return Math.max(t,1e-6)};function mU(t,e,n){return tt(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t}var bU=q(),xU=q(),EU={scale:function(t){ft(bU,[t[0].value,t[1].value,1].map((function(t){return yU(t)})))},scaleX:function(t){ft(bU,[t[0].value,1,1].map((function(t){return yU(t)})))},scaleY:function(t){ft(bU,[1,t[0].value,1].map((function(t){return yU(t)})))},scaleZ:function(t){ft(bU,[1,1,t[0].value].map((function(t){return yU(t)})))},scale3d:function(t){ft(bU,[t[0].value,t[1].value,t[2].value].map((function(t){return yU(t)})))},translate:function(t){dt(bU,[t[0].value,t[1].value,0])},translateX:function(t){dt(bU,[t[0].value,0,0])},translateY:function(t){dt(bU,[0,t[0].value,0])},translateZ:function(t){dt(bU,[0,0,t[0].value])},translate3d:function(t){dt(bU,[t[0].value,t[1].value,t[2].value])},rotate:function(t){yt(bU,VG(jV(t[0])))},rotateX:function(t){gt(bU,VG(jV(t[0])))},rotateY:function(t){vt(bU,VG(jV(t[0])))},rotateZ:function(t){yt(bU,VG(jV(t[0])))},rotate3d:function(t){pt(bU,VG(jV(t[3])),[t[0].value,t[1].value,t[2].value])},skew:function(t){mU(bU,VG(t[0].value),VG(t[1].value))},skewX:function(t){mU(bU,VG(t[0].value),0)},skewY:function(t){mU(bU,0,VG(t[0].value))},matrix:function(t){J(bU,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1)},matrix3d:function(e){J.apply(t,[bU].concat(f(e.map((function(t){return t.value})))))}},wU=N(1,1,1),kU=k(),MU={translate:function(t,e){wH.sceneGraphService.setLocalScale(t,wU,!1),wH.sceneGraphService.setLocalEulerAngles(t,kU,void 0,void 0,!1),wH.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),wH.sceneGraphService.dirtyLocalTransform(t,t.transformable)}},SU=function(){return c((function t(){l(this,t),this.parser=mW,this.mixer=TW}),[{key:"calculator",value:function(t,e,n,i){return n instanceof aV?[]:n}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&MU[t[0].t])return void MU[t[0].t](e,t[0].d);for(var n=tt(xU),i=0;i<t.length;i++){var r=t[i],a=r.t,o=r.d,s=EU[a];s&&(s(o),Ut(n,n,bU))}e.setLocalTransform(n)}else e.resetLocalTransform();e.getLocalTransform()}(t.parsedStyle.transform,t)}}])}(),NU=function(){return c((function t(){l(this,t)}),[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===$z.kPixels&&e[1].unit===$z.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds()}}])}(),TU=function(){return c((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,i){return n.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,i=e.sortable;n&&e.dirty(),i&&(i.dirty=!0,i.dirtyReason=oz.Z_INDEX_CHANGED)}}}])}(),AU=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,i=void 0===n?0:n,r=t.cy,a=void 0===r?0:r,o=t.r,s=void 0===o?0:o;return{cx:i,cy:a,hwidth:s,hheight:s}}}])}(),OU=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,i=void 0===n?0:n,r=t.cy,a=void 0===r?0:r,o=t.rx,s=void 0===o?0:o,l=t.ry;return{cx:i,cy:a,hwidth:s,hheight:void 0===l?0:l}}}])}(),PU=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){var e=t.x1,n=t.y1,i=t.x2,r=t.y2,a=Math.min(e,i),o=Math.max(e,i),s=Math.min(n,r),l=(o-a)/2,u=(Math.max(n,r)-s)/2;return{cx:a+l,cy:s+u,hwidth:l,hheight:u}}}])}(),CU=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){var e=t.d.rect,n=e.x,i=e.y,r=e.width/2,a=e.height/2;return{cx:n+r,cy:i+a,hwidth:r,hheight:a}}}])}(),RU=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t){if(t.points&&$e(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,f(e.map((function(t){return t[0]})))),i=Math.max.apply(Math,f(e.map((function(t){return t[0]})))),r=Math.min.apply(Math,f(e.map((function(t){return t[1]})))),a=Math.max.apply(Math,f(e.map((function(t){return t[1]})))),o=(i-n)/2,s=(a-r)/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),LU=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.x,i=void 0===n?0:n,r=t.y,a=void 0===r?0:r,o=t.src,s=t.width,l=void 0===s?0:s,u=t.height,c=l,h=void 0===u?0:u;return o&&!he(o)&&(c||(c=o.width,t.width=c),h||(h=o.height,t.height=h)),{cx:i+c/2,cy:a+h/2,hwidth:c/2,hheight:h/2}}}])}(),DU=function(){return c((function t(e){l(this,t),this.globalRuntime=e}),[{key:"isReadyToMeasure",value:function(t,e){return t.text}},{key:"update",value:function(t,e){var n,i=t.text,r=t.textAlign,a=void 0===r?"start":r,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,p=t.x,g=void 0===p?0:p,v=t.y,y=void 0===v?0:v;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var m=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(i,t,m);t.metrics=b;var x=b.width/2,E=b.height/2,w=g+x;"center"===a||"middle"===a?w+=s/2-x:"right"!==a&&"end"!==a||(w+=s-2*x);var k=y-E;return"middle"===u?k+=E:"top"===u||"hanging"===u?k+=2*E:"alphabetic"===u||"bottom"!==u&&"ideographic"!==u||(k+=0),h&&(w+=h),f&&(k+=f),{cx:w,cy:k,hwidth:x,hheight:E}}}])}(),IU=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),_U=function(){return c((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.x,i=void 0===n?0:n,r=t.y,a=void 0===r?0:r,o=t.width,s=void 0===o?0:o,l=t.height,u=void 0===l?0:l;return{cx:i+s/2,cy:a+u/2,hwidth:s/2,hheight:u/2}}}])}(),BU=function(){return c((function t(e){l(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new IG,this.page=new IG,this.canvas=new IG,this.viewport=new IG,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}),[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(BG)}}])}(),FU=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).client=new IG,t.movement=new IG,t.offset=new IG,t.global=new IG,t.screen=new IG,t}return m(e,t),c(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw new Error(BG)}}])}(BU),jU=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).width=0,t.height=0,t.isPrimary=!1,t}return m(e,t),c(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(FU),GU=function(t){function e(){return l(this,e),v(this,e,arguments)}return m(e,t),c(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(FU),zU=function(t){function e(t,n){var i;return l(this,e),(i=v(this,e,[null])).type=t,i.detail=n,Object.assign(i,n),i}return m(e,t),c(e)}(BU),VU=function(){return c((function t(){l(this,t),this.emitter=new x}),[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this}},{key:"addEventListener",value:function(t,e,n){var i=!1,r=!1;if(pn(n))i=n;else if(n){var a=n.capture;i=void 0!==a&&a;var o=n.once;r=void 0!==o&&o}i&&(t+="capture"),e=gn(e)?e:e.handleEvent;var s=gn(e)?void 0:e;return r?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,e,n){var i;if(!this.emitter)return this;(pn(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=gn(e)?e:null===(i=e)||void 0===i?void 0:i.handleEvent;var r=gn(e)?void 0:e;return this.emitter.off(t,e,r),this}},{key:"emit",value:function(t,e){this.dispatchEvent(new zU(t,e))}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t)}},{key:"dispatchEvent",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(arguments.length>2?arguments[2]:void 0)return this.dispatchEventToSelf(t),!0;if(this.document)e=this;else if(this.defaultView)e=this.defaultView;else{var i;e=null===(i=this.ownerDocument)||void 0===i?void 0:i.defaultView}if(e){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],n||(t.target=this),t.manager.dispatchEvent(t,t.type,n)}else this.dispatchEventToSelf(t);return!t.defaultPrevented}}])}(),WU=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t.destroyed=!1,t}return m(e,t),c(e,[{key:"textContent",get:function(){var t="";this.nodeName===kG.TEXT&&(t+=this.style.text);var e,n=Gn(this.childNodes);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.nodeName===kG.TEXT?t+=i.nodeValue:t+=i.textContent}}catch(t){n.e(t)}finally{n.f()}return t},set:function(t){var e=this;this.childNodes.slice().forEach((function(t){e.removeChild(t)})),this.nodeName===kG.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(t){throw new Error(BG)}},{key:"lookupNamespaceURI",value:function(t){throw new Error(BG)}},{key:"lookupPrefix",value:function(t){throw new Error(BG)}},{key:"normalize",value:function(){throw new Error(BG)}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n=t,i=this,r=[n],a=[i];null!==(o=n.parentNode)&&void 0!==o?o:i.parentNode;){var o;n=n.parentNode?(r.push(n.parentNode),n.parentNode):n,i=i.parentNode?(a.push(i.parentNode),i.parentNode):i}if(n!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=r.length>a.length?r:a,l=s===r?a:r;if(s[s.length-l.length]===l[0])return s===r?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;return f.indexOf(h)<f.indexOf(d)?l===r?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:s===r?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var i=n.childNodes.length-1;i>=0;i--)e.push(n.childNodes[i])}}}],[{key:"isNode",value:function(t){return!!t.childNodes}}])}(VU);WU.DOCUMENT_POSITION_DISCONNECTED=1,WU.DOCUMENT_POSITION_PRECEDING=2,WU.DOCUMENT_POSITION_FOLLOWING=4,WU.DOCUMENT_POSITION_CONTAINS=8,WU.DOCUMENT_POSITION_CONTAINED_BY=16,WU.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var UU=function(){return c((function t(){l(this,t)}),[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||wH.offscreenCanvas)this.canvas=t||wH.offscreenCanvas,this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(t){}try{return document.createElement("canvas")}catch(t){}return null}}])}(),HU=function(t){return t[t.CAMERA_CHANGED=0]="CAMERA_CHANGED",t[t.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",t[t.NONE=2]="NONE",t}({}),YU=/\[\s*(.*)=(.*)\s*\]/,$U=function(){return c((function t(){l(this,t)}),[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find((function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.find((function(e){return e.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var i=this.getAttribute(t),r=i.name,a=i.value;return r?e.find((function(t){return e!==t&&("name"===r?t.name===a:n.attributeToString(t,r)===a)})):null}return e.find((function(n){return e!==n&&n.nodeName===t}))}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll((function(i){return e!==i&&((null==i?void 0:i.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.findAll((function(i){return e!==i&&i.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var i=this.getAttribute(t),r=i.name,a=i.value;return r?e.findAll((function(t){return e!==t&&("name"===r?t.name===a:n.attributeToString(t,r)===a)})):[]}return e.findAll((function(n){return e!==n&&n.nodeName===t}))}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),i=n.name,r=n.value;return"name"===i?e.name===r:this.attributeToString(e,i)===r}return e.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var e=t.match(YU),n="",i="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),i=e[2].replace(/"/g,"")),{name:n,value:i}}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return ce(n)?"":n.toString?n.toString():""}}])}(),XU=function(t){return t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.MOUNTED="DOMNodeInsertedIntoDocument",t.REMOVED="removed",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.REPARENT="reparent",t.DESTROY="destroy",t.BOUNDS_CHANGED="bounds-changed",t.CULLED="culled",t}({}),qU=function(t){function e(t,n,i,r,a,o,s,u){var c;return l(this,e),(c=v(this,e,[null])).relatedNode=n,c.prevValue=i,c.newValue=r,c.attrName=a,c.attrChange=o,c.prevParsedValue=s,c.newParsedValue=u,c.type=t,c}return m(e,t),c(e)}(BU);qU.ADDITION=2,qU.MODIFICATION=1,qU.REMOVAL=3;var KU=new qU(XU.REPARENT,null,"","","",0,"",""),ZU=ae(),QU=k(),JU=N(1,1,1),tH=q(),eH=ae(),nH=k(),iH=q(),rH=qt(),aH=k(),oH=qt(),sH=k(),lH=k(),uH=k(),cH=q(),hH=qt(),dH=qt(),fH=qt(),pH={affectChildren:!0},gH=function(){return c((function t(e){l(this,t),this.pendingEvents=new Map,this.boundsChangedEvent=new zU(XU.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e}),[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e)}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e)}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e)}},{key:"attach",value:function(t,e,n){var i,r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var a=t.nodeName===kG.FRAGMENT,o=eU(e);t.parentNode=e;var s=a?t.childNodes:[t];le(n)?s.forEach((function(t){e.childNodes.splice(n,0,t),t.parentNode=e})):s.forEach((function(t){e.childNodes.push(t),t.parentNode=e}));var l=e.sortable;if((null!=l&&null!==(i=l.sorted)&&void 0!==i&&i.length||l.dirty||t.parsedStyle.zIndex)&&(-1===l.dirtyChildren.indexOf(t)&&l.dirtyChildren.push(t),l.dirty=!0,l.dirtyReason=oz.ADDED),!o){if(a)this.dirtifyFragment(t);else{var u=t.transformable;u&&this.dirtyWorldTransform(t,u)}if(r){var c,h=!0===(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation);t.dispatchEvent(KU,h,h)}}}},{key:"detach",value:function(t){var e,n;if(t.parentNode){var i=t.transformable,r=t.parentNode.sortable;(null!=r&&null!==(e=r.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===r.dirtyChildren.indexOf(t)&&r.dirtyChildren.push(t),r.dirty=!0,r.dirtyReason=oz.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),i&&this.dirtyWorldTransform(t,i),t.parentNode=null}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return cz(e),e.localTransform}},{key:"setLocalPosition",value:function(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.transformable;lH[0]=e[0],lH[1]=e[1],lH[2]=null!==(n=e[2])&&void 0!==n?n:0,V(r.localPosition,lH)||(T(r.localPosition,lH),i&&this.dirtyLocalTransform(t,r))}},{key:"translateLocal",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;V(e,QU)||(z(e,e,n.localRotation),O(n.localPosition,n.localPosition,e),this.dirtyLocalTransform(t,n))}},{key:"setLocalRotation",value:function(t,e,n,i,r){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];"number"==typeof e&&(e=ne(rH,e,n,i,r));var o=t.transformable;ee(o.localRotation,e),a&&this.dirtyLocalTransform(t,o)}},{key:"rotateLocal",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;Jt(dH,e[0],e[1],e[2]),ie(n.localRotation,n.localRotation,dH),this.dirtyLocalTransform(t,n)}},{key:"setLocalScale",value:function(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.transformable;A(nH,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:r.localScale[2]),V(nH,r.localScale)||(T(r.localScale,nH),i&&this.dirtyLocalTransform(t,r))}},{key:"scaleLocal",value:function(t,e){var n,i=t.transformable;C(i.localScale,i.localScale,A(nH,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,i)}},{key:"setLocalSkew",value:function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];"number"==typeof e&&(e=se(eH,e,n));var r=t.transformable;oe(r.localSkew,e),i&&this.dirtyLocalTransform(t,r)}},{key:"setLocalEulerAngles",value:function(t,e){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var i=t.transformable;Jt(i.localRotation,e[0],e[1],e[2]),n&&this.dirtyLocalTransform(t,i)}},{key:"setLocalTransform",value:function(t,e){var n=xt(aH,e),i=wt(oH,e),r=Et(sH,e);this.setLocalScale(t,r,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,i,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,JU,!1),this.setLocalPosition(t,QU,!1),this.setLocalEulerAngles(t,QU,void 0,void 0,!1),this.setLocalSkew(t,ZU,void 0,!1),this.dirtyLocalTransform(t,t.transformable)}},{key:"getPosition",value:function(t){var e=t.transformable;return xt(e.position,this.getWorldTransform(t,e))}},{key:"getRotation",value:function(t){var e=t.transformable;return wt(e.rotation,this.getWorldTransform(t,e))}},{key:"getScale",value:function(t){var e=t.transformable;return Et(e.scaling,this.getWorldTransform(t,e))}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return e.localDirtyFlag||e.dirtyFlag?(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t),e.worldTransform):e.worldTransform}},{key:"setPosition",value:function(t,e){var n,i=t.transformable;if(uH[0]=e[0],uH[1]=e[1],uH[2]=null!==(n=e[2])&&void 0!==n?n:0,!V(this.getPosition(t),uH)){if(T(i.position,uH),null!==t.parentNode&&t.parentNode.transformable){var r=t.parentNode.transformable;Z(cH,r.worldTransform),nt(cH,cH),j(i.localPosition,uH,cH)}else T(i.localPosition,uH);this.dirtyLocalTransform(t,i)}}},{key:"translate",value:function(t,e){"number"==typeof e&&(e=A(nH,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)),V(e,QU)||(O(nH,this.getPosition(t),e),this.setPosition(t,nH))}},{key:"setRotation",value:function(t,e,n,i,r){var a=t.transformable;if("number"==typeof e&&(e=te(e,n,i,r)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);ee(rH,o),Qt(rH,rH),Zt(a.localRotation,rH,e),re(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a)}else this.setLocalRotation(t,e)}},{key:"rotate",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){var i=rH;Jt(i,e[0],e[1],e[2]);var r=this.getRotation(t),a=this.getRotation(t.parentNode);ee(fH,a),Qt(fH,fH),Zt(i,fH,i),Zt(n.localRotation,i,r),re(n.localRotation,n.localRotation),this.dirtyLocalTransform(t,n)}else this.rotateLocal(t,e)}},{key:"setOrigin",value:function(t,e){"number"==typeof e&&(e=[e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0]);var n=t.transformable;if(e[0]!==n.origin[0]||e[1]!==n.origin[1]||e[2]!==n.origin[2]){var i=n.origin;i[0]=e[0],i[1]=e[1],i[2]=e[2]||0,this.dirtyLocalTransform(t,n)}}},{key:"setEulerAngles",value:function(t,e){"number"==typeof e&&(e=N(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){Jt(n.localRotation,e[0],e[1],e[2]);var i=this.getRotation(t.parentNode);ee(hH,Qt(rH,i)),ie(n.localRotation,n.localRotation,hH),this.dirtyLocalTransform(t,n)}else this.setLocalEulerAngles(t,e)}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=this.getGeometryBounds(t,e);if(!RG.isEmpty(i)){var r=n||new RG;return r.setFromTransformedAABB(i,this.getWorldTransform(t)),r}return null}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&wH.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new RG}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.renderable;if(!i.boundsDirty&&!n&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&n&&i.renderBounds)return i.renderBounds;var r=n?i.renderBounds:i.bounds,a=this.getTransformedGeometryBounds(t,n,r);if(t.childNodes.forEach((function(t){var i=e.getBounds(t,n);i&&(a?a.add(i):(a=r||new RG).update(i.center,i.halfExtents))})),a||(a=new RG),n){var o=function(t){var e=t;do{var n;if(null===(n=e.parsedStyle)||void 0===n?void 0:n.clipPath)return e;e=e.parentElement}while(null!==e);return null}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents)}}return n?(i.renderBounds=a,i.renderBoundsDirty=!1):(i.bounds=a,i.boundsDirty=!1),a}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=tH;t.parentNode.transformable&&(e=nt(iH,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!RG.isEmpty(n)){var i=new RG;return i.setFromTransformedAABB(n,e),i}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var e,n,i=this.getGeometryBounds(t);RG.isEmpty(i)||(n=new RG).setFromTransformedAABB(i,this.getWorldTransform(t));var r=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=b(n.getMin(),2),o=a[0],s=a[1],l=b(n.getMax(),2),u=l[0],c=l[1];return new _G(o+((null==r?void 0:r.left)||0),s+((null==r?void 0:r.top)||0),u-o,c-s)}return new _G((null==r?void 0:r.left)||0,(null==r?void 0:r.top)||0,0,0)}},{key:"internalUpdateTransform",value:function(t){var e,n=null===(e=t.parentNode)||void 0===e?void 0:e.transformable;cz(t.transformable),function(t,e){t.dirtyFlag&&(e?at(t.worldTransform,e.worldTransform,t.localTransform):Z(t.worldTransform,t.localTransform),t.dirtyFlag=!1)}(t.transformable,n)}},{key:"internalUpdateElement",value:function(t,e){var n,i,r,a,o,s,l=!0===(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization),u=e[e.length-1],c=(null==u?void 0:u.transformDirty)||(null===(i=t.transformable)||void 0===i?void 0:i.localDirtyFlag);t.transformable&&((o=t.transformable).dirtyFlag||(o.dirtyFlag=c)),this.internalUpdateTransform(t),c&&(null===(s=t.dirty)||void 0===s||s.call(t,!0,!0));var h=(null===(r=t.renderable)||void 0===r?void 0:r.boundsDirty)||(null===(a=t.renderable)||void 0===a?void 0:a.renderBoundsDirty);if((c||h)&&!1===(null==u?void 0:u.shapeUpdated)&&l)for(var d=e.length-1;d>=0;){var f,p,g=e[d];if(g.shapeUpdated)break;null===(f=(p=g.node).dirty)||void 0===f||f.call(p,!0,!0),g.shapeUpdated=!0,d-=1}return c}},{key:"syncHierarchy",value:function(t){for(var e,n,i=[t],r=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];i.length>0;){for(var a=i.pop(),o=r[r.length-1];r.length>0&&a.parentNode!==o.node;)o=r.pop();var s=this.internalUpdateElement(a,r);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)i.push(a.childNodes[l]);r.push({node:a,transformDirty:s,shapeUpdated:!1})}}}},{key:"dirtyLocalTransform",value:function(t,e){eU(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e))}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtifyWorldInternal(t,e),this.dirtyToRoot(t,!0)}},{key:"dirtifyWorldInternal",value:function(t,e){var n,i=this,r=!0===(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization);e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),r||t.childNodes.forEach((function(t){var e=t.transformable;i.dirtifyWorldInternal(t,e)})))}},{key:"dirtyToRoot",value:function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t,r=!0===(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization);i;){var a,o;if(null===(a=(o=i).dirty)||void 0===a||a.call(o,!0,!0),r)break;i=i.parentNode}n&&t.forEach((function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0)})),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,n)}},{key:"dirtifyFragment",value:function(t){var e,n,i=t.transformable;i&&(i.dirtyFlag=!0,i.localDirtyFlag=!0),null===(e=(n=t).dirty)||void 0===e||e.call(n,!0,!0);for(var r=t.childNodes.length,a=0;a<r;a++)this.dirtifyFragment(t.childNodes[a]);t.nodeName===kG.FRAGMENT&&this.pendingEvents.set(t,!1)}},{key:"triggerPendingEvents",value:function(){var t,e,n=this,i=new Set,r=function(e,r){if(e.isConnected&&!i.has(e)&&e.nodeName!==kG.FRAGMENT){var a;if(n.boundsChangedEvent.detail=r,n.boundsChangedEvent.target=e,e.isMutationObserved)e.dispatchEvent(n.boundsChangedEvent);else void 0===t&&(t=!0===(null===(a=e.ownerDocument.defaultView)||void 0===a||null===(a=a.getConfig())||void 0===a||null===(a=a.future)||void 0===a?void 0:a.experimentalCancelEventPropagation)),e.ownerDocument.defaultView.dispatchEvent(n.boundsChangedEvent,!0,t);i.add(e)}};this.pendingEvents.forEach((function(t,n){var i;n.nodeName!==kG.FRAGMENT&&(void 0===e&&(e=!0===(null===(i=n.ownerDocument)||void 0===i||null===(i=i.defaultView)||void 0===i||null===(i=i.getConfig())||void 0===i||null===(i=i.future)||void 0===i?void 0:i.experimentalAttributeUpdateOptimization)),pH.affectChildren=t,e?r(n,pH):t?n.forEach((function(t){r(t,pH)})):r(n,pH))})),i.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"updateDisplayObjectDependency",value:function(t,e,n,i){if(e&&e!==n){var r=this.displayObjectDependencyMap.get(e);if(r&&r[t]){var a=r[t].indexOf(i);r[t].splice(a,1)}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(i)}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,i=this.displayObjectDependencyMap.get(t);if(i){var r=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(i).forEach((function(t){i[t].forEach((function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new qU(XU.ATTR_MODIFIED,e,n,n,t,qU.MODIFICATION,n,n),r,r),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n)}))}))}}}])}(),vH=function(){return c((function t(e){if(l(this,t),e<=0)throw new Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map}),[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n)}}},{key:"len",value:function(){return this.cache.size}},{key:"clear",value:function(){this.cache.clear()}}])}(),yH={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},mH=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,bH=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),xH=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),EH=function(){return c((function t(e){var n=this;l(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!(!t||!xH.exec(e)&&!bH.exec(t))},this.trimByKinsokuShorui=function(t){var e=f(t),n=e[e.length-2];if(!n)return t;var i=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=i+e[e.length-1],e},this.runtime=e,this.charWidthCache=new vH(100)}),[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),r=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});r.font=t;var a=yH.MetricsString+yH.BaselineSymbol,o=Math.ceil(r.measureText(a).width),s=Math.ceil(r.measureText(yH.BaselineSymbol).width),l=yH.HeightMultiplier*s;s=s*yH.BaselineMultiplier|0,i.width=o,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,o,l),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(a,0,s);var u=r.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,p=!1;for(d=0;d<s;++d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){p=!0;break}if(p)break;f+=h}for(n.ascent=s-d,f=c-h,p=!1,d=l;d>s;--d){for(var v=0;v<h;v+=4)if(255!==u[f+v]){p=!0;break}if(p)break;f-=h}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n}},{key:"measureText",value:function(t,e,n){var i=e.fontSize,r=void 0===i?16:i,a=e.wordWrap,o=void 0!==a&&a,s=e.lineHeight,l=e.lineWidth,u=void 0===l?1:l,c=e.textBaseline,h=void 0===c?"alphabetic":c,d=e.textAlign,f=void 0===d?"start":d,p=e.letterSpacing,g=void 0===p?0:p,v=e.textPath;e.textPathSide,e.textPathStartOffset;var y=e.leading,m=void 0===y?0:y,b=vU(e),x=this.measureFont(b,n);0===x.fontSize&&(x.fontSize=r,x.ascent=r);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=b,e.isOverflowing=!1;var w=(o?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),k=new Array(w.length),M=0;if(!v){for(var S=0;S<w.length;S++){var N=E.measureText(w[S]).width+(w[S].length-1)*g;k[S]=N,M=Math.max(M,N)}var T=M+u,A=s||x.fontSize+u,O=Math.max(A,x.fontSize+u)+(w.length-1)*(A+m),P=0;return"middle"===h?P=-O/2:"bottom"===h||"alphabetic"===h||"ideographic"===h?P=-O:"top"!==h&&"hanging"!==h||(P=0),{font:b,width:T,height:O,lines:w,lineWidths:k,lineHeight:A+=m,maxLineWidth:M,fontProperties:x,lineMetrics:k.map((function(t,e){var n=0;return"center"===f||"middle"===f?n-=t/2:"right"!==f&&"end"!==f||(n-=t),new _G(n-u/2,P+e*A,t+u,A)}))}}v.getTotalLength();for(var C=0;C<w.length;C++)E.measureText(w[C]).width,w[C].length}},{key:"wordWrap",value:function(t,e,n){var i=this,r=Array.from(t);if(0===r.length)return"";var a=this,o=e.wordWrapWidth,s=void 0===o?0:o,l=e.letterSpacing,u=void 0===l?0:l,c=e.maxLines,h=void 0===c?1/0:c,d=e.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),p=s+u,g="";"ellipsis"===d?g="...":d&&"clip"!==d&&(g=d);var v=[""],y=0,m=0,b=-1,x=vU(e),E=this.charWidthCache.get(x);E||(E=new vH(500),this.charWidthCache.put(x,E));var w=function(t){return i.getFromCache(t,u,E,f)},k=w(g);function M(t,e,n,i){for(;w(t)<i&&e<r.length-1&&!a.isNewline(r[e+1]);)t+=r[e+=1];for(;w(t)>i&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e}}function S(t,e){if(!(k<=0||k>p))if(v[t]){var n=M(v[t],e,b+1,p-k);v[t]=n.lineTxt+g}else v[t]=g}for(var N=0;N<r.length;N++){var T=r[N],A=r[N-1],O=r[N+1],P=w(T);if(this.isNewline(T)){if(y+1>=h){N<r.length-1&&S(y,N-1),e.isOverflowing=!0;break}b=N-1,m=0,v[y+=1]=""}else{if(P>p){S(y,N-1),e.isOverflowing=!0;break}if(m>0&&m+P>p){var C=M(v[y],N-1,b+1,p);if(C.txtLastCharIndex!==N-1){if(v[y]=C.lineTxt,C.txtLastCharIndex===r.length-1)break;N=C.txtLastCharIndex+1,T=r[N],A=r[N-1],O=r[N+1],P=w(T)}if(y+1>=h){S(y,N-1),e.isOverflowing=!0;break}if(b=N-1,m=0,v[y+=1]="",this.isBreakingSpace(T))continue;this.canBreakInLastChar(T)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[y]||"",w)),this.shouldBreakByKinsokuShorui(T,O)&&(v=this.trimByKinsokuShorui(v),m+=w(A||""))}m+=P,v[y]+=T}}return v.join("\n")}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&yH.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return"string"==typeof t&&yH.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var e=f(t),n=e[e.length-2],i=this.findBreakableIndex(n);if(-1===i||!n)return e;var r=n.slice(i,i+1),a=i+1,o=i+(this.isBreakingSpace(r)?0:1);return e[e.length-1]+=n.slice(a,n.length),e[e.length-2]=n.slice(0,o),e}},{key:"canBreakInLastChar",value:function(t){return!t||!mH.test(t)}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce((function(t,n){return t+e(n)}),0)}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!mH.test(t[e]))return e;return-1}},{key:"getFromCache",value:function(t,e,n,i){var r=n.get(t);if("number"!=typeof r){var a=t.length*e;r=i.measureText(t).width+a,n.put(t,r)}return r}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear()}}])}(),wH={},kH=function(t){var e=new LU,n=new RU;return a(a(a(a(a(a(a(a(a(a(t={},kG.FRAGMENT,null),kG.CIRCLE,new AU),kG.ELLIPSE,new OU),kG.RECT,e),kG.IMAGE,e),kG.GROUP,new IU),kG.LINE,new PU),kG.TEXT,new DU(wH)),kG.POLYLINE,n),kG.POLYGON,n),a(a(a(t,kG.PATH,new CU),kG.HTML,new _U),kG.MESH,null)}(),MH=function(t){var e=new BW,n=new GW;return a(a(a(a(a(a(a(a(a(a(t={},dz.PERCENTAGE,null),dz.NUMBER,new UW),dz.ANGLE,new IW),dz.DEFINED_PATH,new _W),dz.PAINT,e),dz.COLOR,e),dz.FILTER,new FW),dz.LENGTH,n),dz.LENGTH_PERCENTAGE,n),dz.LENGTH_PERCENTAGE_12,new zW),a(a(a(a(a(a(a(a(a(a(t,dz.LENGTH_PERCENTAGE_14,new VW),dz.COORDINATE,new GW),dz.OFFSET_DISTANCE,new HW),dz.OPACITY_VALUE,new YW),dz.PATH,new $W),dz.LIST_OF_POINTS,new XW),dz.SHADOW_BLUR,new qW),dz.TEXT,new KW),dz.TEXT_TRANSFORM,new ZW),dz.TRANSFORM,new SU),a(a(a(t,dz.TRANSFORM_ORIGIN,new NU),dz.Z_INDEX,new TU),dz.MARKER,new WW)}();wH.CameraContribution=rz,wH.AnimationTimeline=null,wH.EasingFunction=null,wH.offscreenCanvasCreator=new UU,wH.sceneGraphSelector=new $U,wH.sceneGraphService=new gH(wH),wH.textService=new EH(wH),wH.geometryUpdaterFactory=kH,wH.CSSPropertySyntaxFactory=MH,wH.styleValueRegistry=new LW(wH),wH.layoutRegistry=null,wH.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},wH.enableStyleSyntax=!0,wH.enableSizeAttenuation=!1;var SH=0,NH=new qU(XU.INSERTED,null,"","","",0,"",""),TH=new qU(XU.REMOVED,null,"","","",0,"",""),AH=new zU(XU.DESTROY),OH=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).entity=SH++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:az.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return m(e,t),c(e,[{key:"dirty",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.renderable.dirty=t,e&&(this.renderable.boundsDirty=t,this.renderable.renderBoundsDirty=t)}},{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter((function(t){return""!==t}))}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}},{key:"cloneNode",value:function(t){throw new Error(BG)}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw new Error("Cannot append a destroyed element.");return wH.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(eU(this)||t.nodeName!==kG.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(NH.relatedNode=this,t.dispatchEvent(NH)),t}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n)}else this.appendChild(t);return t}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e}},{key:"removeChild",value:function(t){var e,n,i=!0===(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation);return TH.relatedNode=this,t.dispatchEvent(TH,i,i),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),wH.sceneGraphService.detach(t),t}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e)}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy()}}},{key:"matches",value:function(t){return wH.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return wH.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return wH.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return wH.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return wH.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return wH.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return wH.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var e=this;do{if(wH.sceneGraphService.matches(t,e))return e;e=e.parentElement}while(null!==e);return null}},{key:"find",value:function(t){var e=this,n=null;return this.forEach((function(i){return i===e||!t(i)||(n=i,!1)})),n}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach((function(i){i!==e&&t(i)&&n.push(i)})),n}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];i.forEach((function(n,i){var r;return null===(r=t.parentNode)||void 0===r?void 0:r.appendChild(n,e+i+1)}))}}},{key:"before",value:function(){if(this.parentNode){for(var t,e=this.parentNode.childNodes.indexOf(this),n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=i[0],o=i.slice(1);this.parentNode.appendChild(a,e),(t=a).after.apply(t,f(o))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e){return t.appendChild(e)}))}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e,n){return t.appendChild(e,n)}))}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){var t,e=!0===(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation);this.destroyChildren(),this.dispatchEvent(AH,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return wH.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return wH.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return wH.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return wH.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return wH.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t]}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,e,n,i){this.attributes[t]=e}},{key:"getAttributeNS",value:function(t,e){throw new Error(BG)}},{key:"getAttributeNode",value:function(t){throw new Error(BG)}},{key:"getAttributeNodeNS",value:function(t,e){throw new Error(BG)}},{key:"hasAttributeNS",value:function(t,e){throw new Error(BG)}},{key:"removeAttributeNS",value:function(t,e){throw new Error(BG)}},{key:"removeAttributeNode",value:function(t){throw new Error(BG)}},{key:"setAttributeNS",value:function(t,e,n){throw new Error(BG)}},{key:"setAttributeNode",value:function(t){throw new Error(BG)}},{key:"setAttributeNodeNS",value:function(t){throw new Error(BG)}},{key:"toggleAttribute",value:function(t,e){throw new Error(BG)}}])}(WU);function PH(t){return!(null==t||!t.nodeName)}var CH=wH.globalThis.Proxy?wH.globalThis.Proxy:function(){},RH=new qU(XU.ATTR_MODIFIED,null,null,null,null,qU.MODIFICATION,null,null),LH=k(),DH=qt(),IH=function(t){function e(t){var n;return l(this,e),(n=v(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||kG.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),wH.enableStyleSyntax&&(n.style=new CH({setProperty:function(t,e){n.setAttribute(t,e)},getPropertyValue:function(t){return n.getAttribute(t)},removeProperty:function(t){n.removeAttribute(t)},item:function(){return""}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e)},set:function(t,e,i){return n.setAttribute(e,i),!0}})),n}return m(e,t),c(e,[{key:"destroy",value:function(){bn(e,"destroy",this,3)([]),this.getAnimations().forEach((function(t){t.cancel()}))}},{key:"cloneNode",value:function(t,e){var n=s({},this.attributes);for(var i in n){var r=n[i];PH(r)&&"clipPath"!==i&&"offsetPath"!==i&&"textPath"!==i&&(n[i]=r.cloneNode(t)),e&&(n[i]=e(i,r))}var a=new this.constructor(s(s({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach((function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n)}})),a}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};wH.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty()}},{key:"setAttribute",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];hn(n)||(i||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:r}),bn(e,"setAttribute",this,3)([t,n]))}},{key:"internalSetAttribute",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],r=this.parsedStyle[t];wH.styleValueRegistry.processProperties(this,a({},t,e),n),this.dirty();var o,s=this.parsedStyle[t];if(this.isConnected)if(RH.relatedNode=this,RH.prevValue=i,RH.newValue=e,RH.attrName=t,RH.prevParsedValue=r,RH.newParsedValue=s,this.isMutationObserved)this.dispatchEvent(RH);else{var l,u=!0===(null===(l=this.ownerDocument.defaultView.getConfig().future)||void 0===l?void 0:l.experimentalCancelEventPropagation);RH.target=this,this.ownerDocument.defaultView.dispatchEvent(RH,!0,u)}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(o=this.attributeChangedCallback)||void 0===o||o.call(this,t,i,e,r,s))}},{key:"getBBox",value:function(){var t=this.getBounds(),e=b(t.getMin(),2),n=e[0],i=e[1],r=b(t.getMax(),2),a=r[0],o=r[1];return new _G(n,i,a-n,o-i)}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wH.sceneGraphService.setOrigin(this,GG(t,e,n,!1)),this}},{key:"getOrigin",value:function(){return wH.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wH.sceneGraphService.setPosition(this,GG(t,e,n,!1)),this}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wH.sceneGraphService.setLocalPosition(this,GG(t,e,n,!1)),this}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wH.sceneGraphService.translate(this,GG(t,e,n,!1)),this}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wH.sceneGraphService.translateLocal(this,GG(t,e,n,!1)),this}},{key:"getPosition",value:function(){return wH.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return wH.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n)}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(t=GG(t,e=e||t,n=n||t,!1)),wH.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(t=GG(t,e=e||t,n=n||t,!1)),wH.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return wH.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return wH.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){return UG(b(YG(LH,wH.sceneGraphService.getWorldTransform(this)),3)[2])}},{key:"getLocalEulerAngles",value:function(){return UG(b(YG(LH,wH.sceneGraphService.getLocalRotation(this)),3)[2])}},{key:"setEulerAngles",value:function(t){return wH.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return wH.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,e,n){return ce(e)&&ce(n)?wH.sceneGraphService.rotateLocal(this,0,0,t):wH.sceneGraphService.rotateLocal(this,t,e,n),this}},{key:"rotate",value:function(t,e,n){return ce(e)&&ce(n)?wH.sceneGraphService.rotate(this,0,0,t):wH.sceneGraphService.rotate(this,t,e,n),this}},{key:"setRotation",value:function(t,e,n,i){return wH.sceneGraphService.setRotation(this,t,e,n,i),this}},{key:"setLocalRotation",value:function(t,e,n,i){return wH.sceneGraphService.setLocalRotation(this,t,e,n,i),this}},{key:"setLocalSkew",value:function(t,e){return wH.sceneGraphService.setLocalSkew(this,t,e),this}},{key:"getRotation",value:function(){return wH.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return wH.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return wH.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return wH.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return wH.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return wH.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){wH.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,e){var n,i=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return i?i.play(this,t,e):null}},{key:"isVisible",value:function(){var t;return"hidden"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return"none"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)}},{key:"isCulled",value:function(){return!(!this.cullable||!this.cullable.enable||this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,f(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,f(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n[0],a=n[1];return r?vn(r)?(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),this):2===n.length?(this.setAttribute(r,a),this):this.attributes[r]:this.attributes}},{key:"getMatrix",value:function(t){var e=t||this.getWorldTransform(),n=b(xt(LH,e),2),i=n[0],r=n[1],a=b(Et(LH,e),2),o=a[0],s=a[1],l=wt(DH,e),u=b(YG(LH,l),3),c=u[0],h=u[2];return function(t,e,n,i,r){var a=Math.cos(t),o=Math.sin(t);return Xt(i*a,r*o,0,-i*o,r*a,0,e,n,1)}(c||h,i,r,o,s)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var e=b($G(t),5),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4];this.setEulerAngles(o).setPosition(n,i).setLocalScale(r,a)}},{key:"setLocalMatrix",value:function(t){var e=b($G(t),5),n=e[0],i=e[1],r=e[2],a=e[3],o=e[4];this.setLocalEulerAngles(o).setLocalPosition(n,i).setLocalScale(r,a)}},{key:"show",value:function(){this.forEach((function(t){t.style.visibility="visible"}))}},{key:"hide",value:function(){this.forEach((function(t){t.style.visibility="hidden"}))}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,e){return this.appendChild(t,e)}},{key:"set",value:function(t,e){this.config[t]=e}},{key:"get",value:function(t){return this.config[t]}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}}])}(OH);IH.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var _H=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:kG.CIRCLE},t)])}return m(e,t),c(e)}(IH);_H.PARSED_STYLE_LIST=new Set([].concat(f(IH.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var BH=["style"],FH=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,BH);return l(this,e),(t=v(this,e,[s({style:i},r)])).isCustomElement=!0,t}return m(e,t),c(e)}(IH);FH.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var jH=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:kG.ELLIPSE},t)])}return m(e,t),c(e)}(IH);jH.PARSED_STYLE_LIST=new Set([].concat(f(IH.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),(function(t){function e(){return l(this,e),v(this,e,[{type:kG.FRAGMENT}])}return m(e,t),c(e)}(IH)).PARSED_STYLE_LIST=new Set(["class","className"]);var GH=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:kG.GROUP},t)])}return m(e,t),c(e)}(IH);GH.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var zH=["style"],VH=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,zH);return l(this,e),(t=v(this,e,[s({type:kG.HTML,style:i},r)])).cullable.enable=!1,t}return m(e,t),c(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=nt(q(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!RG.isEmpty(e)){var n=new RG;return n.setFromTransformedAABB(e,t),n}}return this.getBounds()}}])}(IH);VH.PARSED_STYLE_LIST=new Set([].concat(f(IH.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"])),(function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:kG.IMAGE},t)])}return m(e,t),c(e)}(IH)).PARSED_STYLE_LIST=new Set([].concat(f(IH.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var WH=["style"],UH=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,WH);l(this,e),(t=v(this,e,[s({type:kG.LINE,style:s({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},r)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd;return o&&PH(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&PH(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&PH(i)&&(this.markerStartAngle=0,i.remove()),r&&PH(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t&&(i&&PH(i)&&(this.markerEndAngle=0,i.remove()),r&&PH(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1)))}},{key:"transformMarker",value:function(t){var e,n,i,r,a,o,s,l=this.parsedStyle,u=l.markerStart,c=l.markerEnd,h=l.markerStartOffset,d=l.markerEndOffset,f=l.x1,p=l.x2,g=l.y1,v=l.y2,y=t?u:c;y&&PH(y)&&(t?(r=f,a=g,n=p-f,i=v-g,o=h||0,s=this.markerStartAngle):(r=p,a=v,n=f-p,i=g-v,o=d||0,s=this.markerEndAngle),e=Math.atan2(i,n),y.setLocalEulerAngles(180*e/Math.PI+s),y.setLocalPosition(r+Math.cos(e)*o,a+Math.sin(e)*o))}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,i=Tn(n.x1,n.y1,n.x2,n.y2,t),r=i.x,a=i.y,o=j(k(),N(r,a,0),e?this.getWorldTransform():this.getLocalTransform());return new IG(o[0],o[1])}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle;return Nn(t.x1,t.y1,t.x2,t.y2)}}])}(IH);UH.PARSED_STYLE_LIST=new Set([].concat(f(IH.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var HH=["style"],YH=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,HH);l(this,e),(t=v(this,e,[s({type:kG.PATH,style:i,initialParsedStyle:{miterLimit:4,d:s({},hz)}},r)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd,c=a.markerMid;return o&&PH(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),c&&PH(c)&&t.placeMarkerMid(c),u&&PH(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&PH(i)&&(this.markerStartAngle=0,i.remove()),r&&PH(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t?(i&&PH(i)&&(this.markerEndAngle=0,i.remove()),r&&PH(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(r)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,i=e.markerEnd,r=e.markerStartOffset,a=e.markerEndOffset,o=t?n:i;if(o&&PH(o)){var s,l,u,c,h,d,f;if(t){var p=b(this.getStartTangent(),2),g=p[0],v=p[1];c=v[0],h=v[1],l=g[0]-v[0],u=g[1]-v[1],d=r||0,f=this.markerStartAngle}else{var y=b(this.getEndTangent(),2),m=y[0],x=y[1];c=x[0],h=x[1],l=m[0]-x[0],u=m[1]-x[1],d=a||0,f=this.markerEndAngle}s=Math.atan2(u,l),o.setLocalEulerAngles(180*s/Math.PI+f),o.setLocalPosition(c+Math.cos(s)*d,h+Math.sin(s)*d)}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach((function(t){t.remove()})),t&&PH(t))for(var n=1;n<e.length-1;n++){var i=b(e[n].currentPoint,2),r=i[0],a=i[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(r,a)}}},{key:"getTotalLength",value:function(){return qV(this)}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=yn(this.parsedStyle.d.absolutePath,t),i=n.x,r=n.y,a=j(k(),N(i,r,0),e?this.getWorldTransform():this.getLocalTransform());return new IG(a[0],a[1])}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*qV(this),e)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,i=t[1].currentPoint,r=t[1].startTangent;e=[],r?(e.push([n[0]-r[0],n[1]-r[1]]),e.push([n[0],n[1]])):(e.push([i[0],i[1]]),e.push([n[0],n[1]]))}return e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var i=t[e-2].currentPoint,r=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?(n.push([r[0]-a[0],r[1]-a[1]]),n.push([r[0],r[1]])):(n.push([i[0],i[1]]),n.push([r[0],r[1]]))}return n}}])}(IH);YH.PARSED_STYLE_LIST=new Set([].concat(f(IH.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var $H=["style"],XH=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,r=zn(n,$H);l(this,e),(t=v(this,e,[s({type:kG.POLYGON,style:i,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},r)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,u=a.markerEnd,c=a.markerMid;return o&&PH(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),c&&PH(c)&&t.placeMarkerMid(c),u&&PH(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,i,r){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(i&&PH(i)&&(this.markerStartAngle=0,i.remove()),r&&PH(r)&&(this.markerStartAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!0))):"markerEnd"===t?(i&&PH(i)&&(this.markerEndAngle=0,i.remove()),r&&PH(r)&&(this.markerEndAngle=r.getLocalEulerAngles(),this.appendChild(r),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(r)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,i=e.markerEnd,r=e.markerStartOffset,a=e.markerEndOffset,o=(e.points||{}).points,s=t?n:i;if(s&&PH(s)&&o){var l,u,c,h,d,f,p;if(h=o[0][0],d=o[0][1],t)u=o[1][0]-o[0][0],c=o[1][1]-o[0][1],f=r||0,p=this.markerStartAngle;else{var g=o.length;this.parsedStyle.isClosed?(u=o[g-1][0]-o[0][0],c=o[g-1][1]-o[0][1]):(h=o[g-1][0],d=o[g-1][1],u=o[g-2][0]-o[g-1][0],c=o[g-2][1]-o[g-1][1]),f=a||0,p=this.markerEndAngle}l=Math.atan2(c,u),s.setLocalEulerAngles(180*l/Math.PI+p),s.setLocalPosition(h+Math.cos(l)*f,d+Math.sin(l)*f)}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach((function(t){t.remove()})),this.markerMidList=[],t&&PH(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var i=e[n][0],r=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(i,r)}}}])}(IH);XH.PARSED_STYLE_LIST=new Set([].concat(f(IH.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var qH=["style"],KH=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,i=zn(t,qH);return l(this,e),v(this,e,[s({type:kG.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i)])}return m(e,t),c(e,[{key:"getTotalLength",value:function(){return 0===(t=this).parsedStyle.points.totalLength&&(t.parsedStyle.points.totalLength=Rn(t.parsedStyle.points.points)),t.parsedStyle.points.totalLength;var t}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var i,r,a=[],o=0,s=this.getTotalLength();n.forEach((function(t,e){n[e+1]&&((i=[0,0])[0]=o/s,r=Nn(t[0],t[1],n[e+1][0],n[e+1][1]),o+=r,i[1]=o/s,a.push(i))})),this.parsedStyle.points.segments=a}var l=0,u=0;this.parsedStyle.points.segments.forEach((function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n)}));var c=Tn(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=j(k(),N(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new IG(f[0],f[1])}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n}}])}(XH);KH.PARSED_STYLE_LIST=new Set([].concat(f(XH.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var ZH=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),v(this,e,[s({type:kG.RECT},t)])}return m(e,t),c(e)}(IH);ZH.PARSED_STYLE_LIST=new Set([].concat(f(IH.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var QH=["style"],JH=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,i=zn(t,QH);return l(this,e),v(this,e,[s({type:kG.TEXT,style:s({fill:"black"},n)},i)])}return m(e,t),c(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(IH);JH.PARSED_STYLE_LIST=new Set([].concat(f(IH.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var tY=function(){function t(e){l(this,t),this.strategies=e}return c(t,[{key:"apply",value:function(e){var n=e.config,i=e.camera,r=e.renderingService,a=e.renderingContext,o=this.strategies;r.hooks.cull.tap(t.tag,(function(t){if(t){var e,r=t.cullable;if(0===o.length?r.visible=a.unculledEntities.indexOf(t.entity)>-1:r.visible=o.every((function(e){return e.isVisible(i,t)})),!t.isCulled()&&t.isVisible())return t;var s=!0===(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation);return t.dispatchEvent(new zU(XU.CULLED),s,s),null}return t})),r.hooks.afterRender.tap(t.tag,(function(t){t.cullable.visibilityPlaneMask=-1}))}}])}();tY.tag="Culling";var eY=function(){function t(){var e=this;l(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new jU(null),this.rootWheelEvent=new GU(null),this.onPointerMove=function(t){var n,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView;if(!i.supportsTouchEvents||"touch"!==t.pointerType){var r,a=Gn(e.normalizeToPointerEvent(t,i));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=e.bootstrapEvent(e.rootPointerEvent,o,i,t);e.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var n,i,r=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=Gn(e.normalizeToPointerEvent(t,r));try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.bootstrapEvent(e.rootPointerEvent,o,r,t);e.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}}return c(t,[{key:"apply",value:function(e){var n=this;this.context=e;var i=e.renderingService,r=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler((function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null})),i.hooks.pointerWheel.tap(t.tag,(function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e)})),i.hooks.pointerDown.tap(t.tag,(function(t){if(!r.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,r);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var i,a=Gn(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=n.bootstrapEvent(n.rootPointerEvent,o,r,t);n.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}n.setCursor(n.context.eventService.cursor)}})),i.hooks.pointerUp.tap(t.tag,(function(t){if(!r.supportsTouchEvents||"touch"!==t.pointerType){var e,i=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(i,t)?"":"outside",o=Gn(n.normalizeToPointerEvent(t,r));try{for(o.s();!(e=o.n()).done;){var s=e.value,l=n.bootstrapEvent(n.rootPointerEvent,s,r,t);l.type+=a,n.context.eventService.mapEvent(l)}}catch(t){o.e(t)}finally{o.f()}n.setCursor(n.context.eventService.cursor)}})),i.hooks.pointerMove.tap(t.tag,this.onPointerMove),i.hooks.pointerOver.tap(t.tag,this.onPointerMove),i.hooks.pointerOut.tap(t.tag,this.onPointerMove),i.hooks.click.tap(t.tag,this.onClick),i.hooks.pointerCancel.tap(t.tag,(function(t){var e,i=Gn(n.normalizeToPointerEvent(t,r));try{for(i.s();!(e=i.n()).done;){var a=e.value,o=n.bootstrapEvent(n.rootPointerEvent,a,r,t);n.context.eventService.mapEvent(o)}}catch(t){i.e(t)}finally{i.f()}n.setCursor(n.context.eventService.cursor)}))}},{key:"bootstrapEvent",value:function(t,e,n,i){t.view=n,t.originalEvent=null,t.nativeEvent=i,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=r.x,o=r.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=i.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=JW[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),i=n.x,r=n.y;e.viewport.x=i,e.viewport.y=r;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=tU.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var i=0;i<t.changedTouches.length;i++){var r=t.changedTouches[i];hn(r.button)&&(r.button=0),hn(r.buttons)&&(r.buttons=1),hn(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),hn(r.width)&&(r.width=r.radiusX||1),hn(r.height)&&(r.height=r.radiusY||1),hn(r.tiltX)&&(r.tiltX=0),hn(r.tiltY)&&(r.tiltY=0),hn(r.pointerType)&&(r.pointerType="touch"),hn(r.pointerId)&&(r.pointerId=r.identifier||0),hn(r.pressure)&&(r.pressure=r.force||.5),hn(r.twist)&&(r.twist=0),hn(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,r.type=t.type,n.push(r)}else if(e.isMouseEvent(t)){var a=t;hn(a.isPrimary)&&(a.isPrimary=!0),hn(a.width)&&(a.width=1),hn(a.height)&&(a.height=1),hn(a.tiltX)&&(a.tiltX=0),hn(a.tiltY)&&(a.tiltY=0),hn(a.pointerType)&&(a.pointerType="mouse"),hn(a.pointerId)&&(a.pointerId=1),hn(a.pressure)&&(a.pressure=.5),hn(a.twist)&&(a.twist=0),hn(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}else n.push(t);return n}}])}();eY.tag="Event",kG.CIRCLE,kG.ELLIPSE,kG.IMAGE,kG.RECT,kG.LINE,kG.POLYLINE,kG.POLYGON,kG.TEXT,kG.PATH,kG.HTML;var nY=function(){function t(){l(this,t),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return c(t,[{key:"apply",value:function(e){var n,i,r=this,a=e.config,o=e.renderingService,s=e.renderingContext,l=e.rBushRoot,u=s.root.ownerDocument.defaultView;this.rBush=l;var c=function(t){o.dirtify()},h=function(t){r.syncTasks.set(t.target,t.detail.affectChildren),o.dirtify()},d=function(t){var e=t.target;wH.enableSizeAttenuation&&wH.styleValueRegistry.updateSizeAttenuation(e,u.getCamera().getZoom())},f=function(t){var e=t.target,n=e.rBushNode;null!=n&&n.aabb&&r.rBush.remove(n.aabb),r.syncTasks.delete(e),wH.sceneGraphService.dirtyToRoot(e),o.dirtify()};o.hooks.init.tap(t.tag,(function(){u.addEventListener(XU.MOUNTED,d),u.addEventListener(XU.UNMOUNTED,f),u.addEventListener(XU.ATTR_MODIFIED,c),u.addEventListener(XU.BOUNDS_CHANGED,h)})),o.hooks.destroy.tap(t.tag,(function(){u.removeEventListener(XU.MOUNTED,d),u.removeEventListener(XU.UNMOUNTED,f),u.removeEventListener(XU.ATTR_MODIFIED,c),u.removeEventListener(XU.BOUNDS_CHANGED,h),r.syncTasks.clear()}));var p=null!==(n=wH.globalThis.requestIdleCallback)&&void 0!==n?n:hU.bind(wH.globalThis),g=!0===(null===(i=a.future)||void 0===i?void 0:i.experimentalRICSyncRTree);o.hooks.endFrame.tap(t.tag,(function(){r.isFirstTimeRendering?(r.isFirstTimeRendering=!1,r.syncing=!0,p((function(){r.syncRTree(!0),r.isFirstTimeRenderingFinished=!0}))):g&&wH.globalThis.requestIdleCallback&&wH.globalThis.cancelIdleCallback?(wH.globalThis.cancelIdleCallback(r.ricSyncRTreeId),r.ricSyncRTreeId=wH.globalThis.requestIdleCallback((function(){return r.syncRTree()}))):r.syncRTree()}))}},{key:"syncNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isConnected){var n=t.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var i=t.getRenderBounds();if(i){var r=t.renderable;e&&(r.dirtyRenderBounds||(r.dirtyRenderBounds=new RG),r.dirtyRenderBounds.update(i.center,i.halfExtents));var a=b(i.getMin(),2),o=a[0],s=a[1],l=b(i.getMax(),2),u=l[0],c=l[1];n.aabb||(n.aabb={}),n.aabb.displayObject=t,n.aabb.minX=o,n.aabb.minY=s,n.aabb.maxX=u,n.aabb.maxY=c}return n.aabb&&!(isNaN(n.aabb.maxX)||isNaN(n.aabb.maxX)||isNaN(n.aabb.minX)||isNaN(n.aabb.minY))?n.aabb:void 0}}},{key:"syncRTree",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var n=[],i=new Set,r=function(r){if(!i.has(r)&&r.renderable){var a=t.syncNode(r,e);a&&(n.push(a),i.add(r))}};this.syncTasks.forEach((function(t,e){t&&e.forEach(r);for(var n=e;n;)r(n),n=n.parentElement})),this.rBush.load(n),n.length=0,this.syncing=!1}}}])}();nY.tag="Prepare";var iY=function(t){return t.READY="ready",t.BEFORE_RENDER="beforerender",t.RERENDER="rerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle",t.RENDERER_CHANGED="rendererchanged",t}({}),rY=(new zU(XU.MOUNTED),new zU(XU.UNMOUNTED),new zU(iY.BEFORE_RENDER),new zU(iY.RERENDER),new zU(iY.AFTER_RENDER),c((function t(){l(this,t)})));function aY(t,e){return(e||document).createElementNS("http://www.w3.org/2000/svg",t)}rY.tag="c-svg-element";var oY="g-filter-";function sY(t){return t.unit===$z.kPercentage?t.value/100:t.value}function lY(t,e,n){var i=n.type,r=n.slope,a=n.intercept,o=n.tableValues,s=aY("feComponentTransfer",t);[aY("feFuncR",t),aY("feFuncG",t),aY("feFuncB",t)].forEach((function(t){t.setAttribute("type",i),"table"===i?t.setAttribute("tableValues","".concat(o)):(t.setAttribute("slope","".concat(r)),t.setAttribute("intercept","".concat(a))),s.appendChild(t)})),e.appendChild(s)}function uY(t,e,n){var i=aY("feColorMatrix",t);i.setAttribute("type","matrix"),i.setAttribute("values",n.join(" ")),e.appendChild(i)}var cY={},hY=0;function dY(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i="";if((e=t).type&&e.value){var r=t.type,a=t.value;if(r===iV.LinearGradient||r===iV.RadialGradient){var o=s(s({},a),n),l=o.type,u=o.x,c=o.y,h=o.width,d=o.height,f=o.steps,p=o.angle,g=o.cx,v=o.cy,y=o.size;i="gradient-".concat(l,"-").concat((null==u?void 0:u.toString())||0,"-").concat((null==c?void 0:c.toString())||0,"-").concat((null==p?void 0:p.toString())||0,"-").concat((null==g?void 0:g.toString())||0,"-").concat((null==v?void 0:v.toString())||0,"-").concat((null==y?void 0:y.toString())||0,"-").concat(h,"-").concat(d,"-").concat(f.map((function(t){var e=t.offset,n=t.color;return"".concat(e).concat(n)})).join("-"))}}else TV(t)&&(i=he(t.image)?"pattern-".concat(t.image,"-").concat(t.repetition):"rect"===t.image.nodeName?"pattern-rect-".concat(t.image.entity):"pattern-".concat(hY));return i&&(cY[i]||(cY[i]="".concat("g-pattern-").concat(hY++))),cY[i]}function fY(t,e,n,i,r,a,o){var s=i.repetition,l=i.transform,u=aY("pattern",t);l&&u.setAttribute("patternTransform",function(t){return yW(t).map((function(t){var e=t.t,n=t.d;if("translate"===e)return"translate(".concat(n[0].value," ").concat(n[1].value,")");if("translateX"===e)return"translate(".concat(n[0].value," 0)");if("translateY"===e)return"translate(0 ".concat(n[0].value,")");if("rotate"===e)return"rotate(".concat(n[0].value,")");if("scale"===e){var i=(null==n?void 0:n.map((function(t){return t.value})))||[1,1];return"scale(".concat(i[0],", ").concat(i[1],")")}if("scaleX"===e){var r=(null==n?void 0:n.map((function(t){return t.value})))||[1];return"scale(".concat(r[0],", 1)")}if("scaleY"===e){var a=(null==n?void 0:n.map((function(t){return t.value})))||[1];return"scale(1, ".concat(a[0],")")}if("skew"===e){var o=(null==n?void 0:n.map((function(t){return t.value})))||[0,0];return"skewX(".concat(o[0],") skewY(").concat(o[1],")")}if("skewZ"===e){var s=(null==n?void 0:n.map((function(t){return t.value})))||[0];return"skewX(".concat(s[0],")")}if("skewY"===e){var l=(null==n?void 0:n.map((function(t){return t.value})))||[0];return"skewY(".concat(l[0],")")}if("matrix"===e){var u=b(n.map((function(t){return t.value})),6),c=u[0],h=u[1],d=u[2],f=u[3],p=u[4],g=u[5];return"matrix(".concat(c," ").concat(h," ").concat(d," ").concat(f," ").concat(p," ").concat(g,")")}return null})).filter((function(t){return null!==t})).join(" ")}(l)),u.setAttribute("patternUnits","userSpaceOnUse"),u.id=r,e.appendChild(u);var c=n.getGeometryBounds(),h=c.halfExtents,d=c.min;u.setAttribute("x","".concat(d[0])),u.setAttribute("y","".concat(d[1]));var f=a,p=o;return"repeat-x"===s?p=2*h[1]:"repeat-y"===s?f=2*h[0]:"no-repeat"===s&&(f=2*h[0],p=2*h[1]),u.setAttribute("width","".concat(f)),u.setAttribute("height","".concat(p)),u}function pY(t,e,n,i,r){var a=e.getGeometryBounds(),o=a&&2*a.halfExtents[0]||0,s=a&&2*a.halfExtents[1]||0,l=a&&a.min||[0,0],u=dY(r,{x:l[0],y:l[1],width:o,height:s}),c=n.querySelector("#".concat(u));if(!c){(c=aY(r.type===iV.LinearGradient?"linearGradient":"radialGradient",t)).setAttribute("gradientUnits","userSpaceOnUse");var h="";r.value.steps.sort((function(t,e){return t.offset.value-e.offset.value})).forEach((function(t){var e=t.offset,n=t.color;h+='<stop offset="'.concat(e.value/100,'" stop-color="').concat(n,'"></stop>')})),c.innerHTML=h,c.id=u,n.appendChild(c)}if(r.type===iV.LinearGradient){var d=r.value.angle,f=function(t,e,n,i){var r=VG(i.value),a=0+e/2,o=0+n/2,s=Math.abs(e*Math.cos(r))+Math.abs(n*Math.sin(r));return{x1:t[0]+a-Math.cos(r)*s/2,y1:t[1]+o-Math.sin(r)*s/2,x2:t[0]+a+Math.cos(r)*s/2,y2:t[1]+o+Math.sin(r)*s/2}}([l[0],l[1]],o,s,d),p=f.x1,g=f.y1,v=f.x2,y=f.y2;c.setAttribute("x1","".concat(p)),c.setAttribute("y1","".concat(g)),c.setAttribute("x2","".concat(v)),c.setAttribute("y2","".concat(y))}else{var m=r.value,b=m.cx,x=m.cy,E=m.size,w=function(t,e,n,i,r,a){var o=i.value,s=r.value;i.unit===$z.kPercentage&&(o=i.value/100*e),r.unit===$z.kPercentage&&(s=r.value/100*n);var l=Math.max(ue([0,0],[o,s]),ue([0,n],[o,s]),ue([e,n],[o,s]),ue([e,0],[o,s]));return a&&(a instanceof sV?l=a.value:a instanceof aV&&("closest-side"===a.value?l=Math.min(o,e-o,s,n-s):"farthest-side"===a.value?l=Math.max(o,e-o,s,n-s):"closest-corner"===a.value&&(l=Math.min(ue([0,0],[o,s]),ue([0,n],[o,s]),ue([e,n],[o,s]),ue([e,0],[o,s]))))),{x:o+t[0],y:s+t[1],r:l}}([l[0],l[1]],o,s,b,x,E),k=w.x,M=w.y,S=w.r;c.setAttribute("cx","".concat(k)),c.setAttribute("cy","".concat(M)),c.setAttribute("r","".concat(S))}return u}var gY=/url\("?#(.*)\)/,vY=function(){return c((function t(e){l(this,t),this.gradientCache={},this.context=e}),[{key:"getDefElement",value:function(){return this.$def}},{key:"init",value:function(){var t=this.context.config.document,e=this.context.contextService.getContext();this.$def=aY("defs",t),e.appendChild(this.$def)}},{key:"clear",value:function(t){var e=this;Object.keys(this.gradientCache).forEach((function(n){e.clearUnusedDefElement(e.gradientCache,n,t)}))}},{key:"clearUnusedDefElement",value:function(t,e,n){if(t[e]&&1===t[e].size&&t[e].has(n)){var i=this.$def.querySelector("#".concat(e));i&&this.$def.removeChild(i)}}},{key:"createOrUpdateGradientAndPattern",value:function(t,e,n,i,r){var a=this.context.config,o=a.document,s=a.createImage;if(e){var l=(TV(n)?e.style[i]:e.getAttribute(i)||"").match(gY);l&&l.length>1&&this.clearUnusedDefElement(this.gradientCache,l[1].replace('"',""),t.entity);var u=function(t,e,n,i,r,a,o,s){if(!r)return"";if(!AV(r)){if(TV(r)){var l=function(t,e,n,i,r,a){var o=dY(i);if(!e.querySelector("#".concat(o))){var s=i.image,l="";if(he(s)?l=s:QW&&(s instanceof HTMLImageElement?l=s.src:s instanceof HTMLCanvasElement&&(l=s.toDataURL())),l){var u=aY("image",t);u.setAttribute("href",l);var c=r();l.match(/^data:/i)||(c.crossOrigin="Anonymous",u.setAttribute("crossorigin","anonymous")),c.src=l;var h=function(){var r=fY(t,e,n,i,o,c.width,c.height);e.appendChild(r),r.appendChild(u),u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("width","".concat(c.width)),u.setAttribute("height","".concat(c.height))};c.complete?h():c.onload=h}if("rect"===s.nodeName){var d=s.parsedStyle,f=d.width,p=d.height,g=fY(t,e,s,i,o,f,p);s.forEach((function(e){a.createSVGDom(t,e,null);var n=e.elementSVG,i=e.getLocalTransform();a.applyTransform(n.$groupEl,i)}));var v=s.elementSVG;g.appendChild(v.$groupEl)}}return o}(t,e,n,r,o,s);return i.style[a]="url(#".concat(l,")"),l}if(1===r.length){var u=pY(t,n,e,0,r[0]);return null==i||i.setAttribute(a,"url(#".concat(u,")")),u}var c=function(t,e,n,i,r){var a="".concat(oY+e.entity,"-gradient"),o=n.querySelector("#".concat(a));o||((o=aY("filter",t)).setAttribute("filterUnits","userSpaceOnUse"),o.setAttribute("x","0%"),o.setAttribute("y","0%"),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.id=a,n.appendChild(o));var s=0;r.forEach((function(i,r){var l=pY(t,e,n,0,i),u="".concat(l,"_rect"),c=aY("rect",t);c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("width","100%"),c.setAttribute("height","100%"),c.setAttribute("fill","url(#".concat(l,")")),c.id=u,n.appendChild(c);var h=aY("feImage",t);if(h.setAttribute("href","#".concat(u)),h.setAttribute("result","".concat(a,"-").concat(r)),o.appendChild(h),r>0){var d=aY("feBlend",t);d.setAttribute("in",1===r?"".concat(a,"-").concat(r-1):"".concat(a,"-blended-").concat(s-1)),d.setAttribute("in2","".concat(a,"-").concat(r)),d.setAttribute("result","".concat(a,"-blended-").concat(s++)),d.setAttribute("mode","multiply"),o.appendChild(d)}}));var l=aY("feComposite",t);return l.setAttribute("in","".concat(a,"-blended-").concat(s)),l.setAttribute("in2","SourceGraphic"),l.setAttribute("operator","in"),o.appendChild(l),a}(t,n,e,0,r);return null==i||i.setAttribute("filter","url(#".concat(c,")")),null==i||i.setAttribute("fill","black"),c}return"currentColor"===n.style[a]?null==i||i.setAttribute(a,"currentColor"):null==i||i.setAttribute(a,r.isNone?"none":r.toString()),""}(o||document,this.$def,t,e,n,i,s,r);u&&(this.gradientCache[u]||(this.gradientCache[u]=new Set),this.gradientCache[u].add(t.entity))}}},{key:"createOrUpdateShadow",value:function(t,e,n){!function(t,e,n,i,r){var a=n.parsedStyle,o=a.shadowType,s=void 0===o?"outer":o,l=a.shadowBlur,u=a.shadowColor,c=a.shadowOffsetX,h=a.shadowOffsetY,d=!ce(u)&&l>0,f="g-filter-dropshadow-"+n.entity,p=e.querySelector("#".concat(f));if(p&&(p.getAttribute("data-type")===s&&d||(p.remove(),p=null)),d){if(null==i||i.setAttribute("filter","url(#".concat(f,")")),!p){if((p=aY("filter",t)).setAttribute("data-type",s),"outer"===s){var g=aY("feDropShadow",t);g.setAttribute("dx","".concat((c||0)/2)),g.setAttribute("dy","".concat((h||0)/2)),g.setAttribute("stdDeviation","".concat((l||0)/4)),g.setAttribute("flood-color",u.toString()),p.appendChild(g)}else if("inner"===s){var v=aY("feComponentTransfer",t);v.setAttribute("in","SourceAlpha");var y=aY("feFuncA",t);y.setAttribute("type","table"),y.setAttribute("tableValues","1 0"),v.appendChild(y),p.appendChild(v);var m=aY("feGaussianBlur",t);m.setAttribute("stdDeviation","".concat((l||0)/4)),p.appendChild(m);var b=aY("feOffset",t);b.setAttribute("dx","".concat((c||0)/2)),b.setAttribute("dy","".concat((h||0)/2)),b.setAttribute("result","offsetblur"),p.appendChild(b);var x=aY("feFlood",t);x.setAttribute("flood-color",u.toString()),x.setAttribute("result","color"),p.appendChild(x);var E=aY("feComposite",t);E.setAttribute("in2","offsetblur"),E.setAttribute("operator","in"),p.appendChild(E);var w=aY("feComposite",t);w.setAttribute("in2","SourceAlpha"),w.setAttribute("operator","in"),p.appendChild(w);var k=aY("feMerge",t);p.appendChild(k);var M=aY("feMergeNode",t);M.setAttribute("in","SourceGraphic");var S=aY("feMergeNode",t);k.appendChild(M),k.appendChild(S)}return p.id=f,p.setAttribute("filterUnits","userSpaceOnUse"),void e.appendChild(p)}if("inner"===s){var N=p.children[1],T=p.children[2],A=p.children[3];"shadowColor"===r?A.setAttribute("flood-color",u.toString()):"shadowBlur"===r?N.setAttribute("stdDeviation","".concat((l||0)/4)):"shadowOffsetX"===r?T.setAttribute("dx","".concat((c||0)/2)):"shadowOffsetY"===r&&T.setAttribute("dy","".concat((h||0)/2))}else if("outer"===s){var O=p.children[0];"shadowColor"===r?O.setAttribute("flood-color",u.toString()):"shadowBlur"===r?O.setAttribute("stdDeviation","".concat((l||0)/4)):"shadowOffsetX"===r?O.setAttribute("dx","".concat((c||0)/2)):"shadowOffsetY"===r&&O.setAttribute("dy","".concat((h||0)/2))}}else null==i||i.removeAttribute("filter")}(this.context.config.document||document,this.$def,t,e,n)}},{key:"createOrUpdateFilter",value:function(t,e,n){!function(t,e,n,i,r){var a=oY+n.entity,o=e.querySelectorAll("[name=".concat(a,"]"));if(o.length&&o.forEach((function(t){e.removeChild(t)})),0===r.length)null==i||i.removeAttribute("filter");else{var s=r.map((function(n,i){var r=n.name,o=n.params,s=aY("filter",t);return s.setAttribute("filterUnits","userSpaceOnUse"),"blur"===r?function(t,e,n){var i=aY("feGaussianBlur",t);i.setAttribute("in","SourceGraphic"),i.setAttribute("stdDeviation","".concat(n[0].value)),e.appendChild(i)}(t,s,o):"brightness"===r?function(t,e,n){lY(t,e,{type:"linear",slope:sY(n[0]),intercept:0})}(t,s,o):"drop-shadow"===r?function(t,e,n){var i=n[0].value,r=n[1].value,a=n[2].value,o=n[3].formatted,s=aY("feGaussianBlur",t);s.setAttribute("in","SourceAlpha"),s.setAttribute("stdDeviation","".concat(a)),e.appendChild(s);var l=aY("feOffset",t);l.setAttribute("dx","".concat(i)),l.setAttribute("dy","".concat(r)),l.setAttribute("result","offsetblur"),e.appendChild(l);var u=aY("feFlood",t);u.setAttribute("flood-color",o),e.appendChild(u);var c=aY("feComposite",t);c.setAttribute("in2","offsetblur"),c.setAttribute("operator","in"),e.appendChild(c);var h=aY("feMerge",t);e.appendChild(h);var d=aY("feMergeNode",t),f=aY("feMergeNode",t);f.setAttribute("in","SourceGraphic"),h.appendChild(d),h.appendChild(f)}(t,s,o):"contrast"===r?function(t,e,n){var i=sY(n[0]);lY(t,e,{type:"linear",slope:i,intercept:-.5*i+.5})}(t,s,o):"grayscale"===r?function(t,e,n){var i=sY(n[0]);uY(t,e,[.2126+.7874*(1-i),.7152-.7152*(1-i),.0722-.0722*(1-i),0,0,.2126-.2126*(1-i),.7152+.2848*(1-i),.0722-.0722*(1-i),0,0,.2126-.2126*(1-i),.7152-.7152*(1-i),.0722+.9278*(1-i),0,0,0,0,0,1,0])}(t,s,o):"sepia"===r?function(t,e,n){var i=sY(n[0]);uY(t,e,[.393+.607*(1-i),.769-.769*(1-i),.189-.189*(1-i),0,0,.349-.349*(1-i),.686+.314*(1-i),.168-.168*(1-i),0,0,.272-.272*(1-i),.534-.534*(1-i),.131+.869*(1-i),0,0,0,0,0,1,0])}(t,s,o):"saturate"===r?function(t,e,n){var i=sY(n[0]),r=aY("feColorMatrix",t);r.setAttribute("type","saturate"),r.setAttribute("values","".concat(i)),e.appendChild(r)}(t,s,o):"hue-rotate"===r?function(t,e,n){var i=aY("feColorMatrix",t);i.setAttribute("type","hueRotate"),i.setAttribute("values","".concat(n[0].value)),e.appendChild(i)}(t,s,o):"invert"===r&&function(t,e,n){var i=sY(n[0]);lY(t,e,{type:"table",tableValues:"".concat(i," ").concat(1-i)})}(t,s,o),s.id="".concat(a,"-").concat(i),s.setAttribute("name",a),e.appendChild(s),s.id}));setTimeout((function(){null==i||i.setAttribute("filter",s.map((function(t){return"url(#".concat(t,")")})).join(" "))}))}}(this.context.config.document||document,this.$def,t,e,n)}}])}();function yY(t){return t.toFixed(6).replace(".000000","")}function mY(t){return t.replace(/[&|<|>|"|']/g,(function(t){return"&"===t?"&amp;":"<"===t?"&lt;":">"===t?"&gt;":'"'===t?"&quot;":"&apos;"}))}var bY={opacity:"opacity",fillStyle:"fill",fill:"fill",fillRule:"fill-rule",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",clipPath:"clip-path",textPath:"text-path",r:"r",cx:"cx",cy:"cy",rx:"rx",ry:"ry",x:"x",y:"y",width:"width",height:"height",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",letterSpacing:"letter-spacing",startArrow:"marker-start",endArrow:"marker-end",class:"class",id:"id",preserveAspectRatio:"preserveAspectRatio",visibility:"visibility",shadowColor:"flood-color",shadowBlur:"stdDeviation",shadowOffsetX:"dx",shadowOffsetY:"dy",filter:"filter",innerHTML:"innerHTML",textAlign:"text-anchor",pointerEvents:"pointer-events"},xY={textAlign:{inherit:"inherit",left:"left",start:"left",center:"middle",right:"end",end:"end"}},EY={textAlign:"inherit",lineCap:"butt",lineJoin:"miter",lineWidth:"1px",opacity:"1",fillOpacity:"1",fillRule:"nonzero",strokeOpacity:"1",strokeWidth:"0",strokeMiterLimit:"4",letterSpacing:"0",fontSize:"inherit",fontFamily:"inherit",pointerEvents:"auto",transform:"matrix(1,0,0,1,0,0)"},wY="g-svg",kY="clip-path-",MY="text-path-",SY=function(){function t(e,n,i){l(this,t),this.svgElementMap=new WeakMap,this.renderQueue=[],this.dirtyAttributes=new WeakMap,this.pendingReorderQueue=new Set,this.clipPathUseMap=new WeakMap,this.pluginOptions=e,this.defElementManager=n,this.context=i}return c(t,[{key:"apply",value:function(e){var n=this,i=e.renderingService,r=e.renderingContext;this.context=e,this.context.svgElementMap=this.svgElementMap;var a=r.root.ownerDocument.defaultView,o=this.context.config.document,s=function(t){var e=t.target;if(n.clipPathUseMap.get(e)){var i=n.defElementManager.getDefElement().querySelector("#".concat(n.getId(e)));i&&i.remove()}n.createSVGDom(o,e,n.$camera)},l=function(t){var e=t.target;n.defElementManager.clear(e.entity),n.clipPathUseMap.delete(e),n.removeSVGDom(e)},u=function(t){var e,i=t.parentNode,r=null===(e=t.parentNode)||void 0===e||null===(e=e.elementSVG)||void 0===e?void 0:e.$groupEl,a=((null==i?void 0:i.children)||[]).slice();r&&n.reorderChildren(o,r,a)},c=function(t){var e=t.target;u(e)},h=function(t){var e=t.target;if(e.elementSVG){var i=t.attrName,r=n.dirtyAttributes.get(e);r||(n.dirtyAttributes.set(e,[]),r=n.dirtyAttributes.get(e)),r.push(i)}},d=function(t){var e=t.target;(e.nodeName===kG.FRAGMENT?e.childNodes:[e]).forEach((function(t){var e,i=null===(e=t.elementSVG)||void 0===e?void 0:e.$el,r=t.parsedStyle,a=r.fill,o=r.stroke,s=r.clipPath;if(a&&!AV(a)&&n.defElementManager.createOrUpdateGradientAndPattern(t,i,a,"fill",n),o&&!AV(o)&&n.defElementManager.createOrUpdateGradientAndPattern(t,i,o,"stroke",n),s){var l=nt(q(),t.getWorldTransform()),u="".concat(kY+s.entity,"-").concat(t.entity),c=n.defElementManager.getDefElement().querySelector("#".concat(u));c&&n.applyTransform(c,l)}}))};i.hooks.init.tap(t.tag,(function(){var t=n.context.config,e=t.background,i=t.document;n.defElementManager.init();var r=n.context.contextService.getContext();e&&(r.style.background=e),r.setAttribute("color-interpolation-filters","sRGB"),n.$camera=aY("g",i),n.$camera.id="".concat(wY,"-camera"),n.applyTransform(n.$camera,n.context.camera.getOrthoMatrix()),r.appendChild(n.$camera),a.addEventListener(XU.MOUNTED,s),a.addEventListener(XU.UNMOUNTED,l),a.addEventListener(XU.REPARENT,c),a.addEventListener(XU.ATTR_MODIFIED,h),a.addEventListener(XU.BOUNDS_CHANGED,d)})),i.hooks.destroy.tap(t.tag,(function(){a.removeEventListener(XU.MOUNTED,s),a.removeEventListener(XU.UNMOUNTED,l),a.removeEventListener(XU.REPARENT,c),a.removeEventListener(XU.ATTR_MODIFIED,h),a.removeEventListener(XU.BOUNDS_CHANGED,d),hY=0,cY={}})),i.hooks.render.tap(t.tag,(function(t){n.renderQueue.push(t)})),i.hooks.beginFrame.tap(t.tag,(function(){var t=n.context.config.document;n.pendingReorderQueue.size&&(n.pendingReorderQueue.forEach((function(e){var i,r=((null==e?void 0:e.children)||[]).slice(),a=null==e||null===(i=e.elementSVG)||void 0===i?void 0:i.$groupEl;a&&n.reorderChildren(t||o,a,r||[])})),n.pendingReorderQueue.clear())})),i.hooks.endFrame.tap(t.tag,(function(){r.renderReasons.has(HU.CAMERA_CHANGED)&&n.applyTransform(n.$camera,n.context.camera.getOrthoMatrix()),n.renderQueue.forEach((function(t){var e,i,r=null===(e=t.elementSVG)||void 0===e?void 0:e.$el,a=null===(i=t.elementSVG)||void 0===i?void 0:i.$groupEl;if(r&&a){var o=t.getLocalTransform();n.applyTransform(a,o);var s=n.clipPathUseMap.get(t);s&&s.length&&s.forEach((function(e){n.applyTransform(e,t.getWorldTransform())})),t.renderable.dirty=!1}var l=n.dirtyAttributes.get(t);l&&(l.forEach((function(e){"zIndex"===e?u(t):"increasedLineWidthForHitTesting"===e&&n.createOrUpdateHitArea(t,r,a),n.updateAttribute(t,[e])})),n.dirtyAttributes.delete(t))})),n.renderQueue=[]}))}},{key:"getId",value:function(t){return t.id||"".concat(wY,"-").concat(t.entity)}},{key:"reorderChildren",value:function(t,e,n){if(n.sort((function(t,e){return t.sortable.renderOrder-e.sortable.renderOrder})),n.length){var i=(t||document).createDocumentFragment();n.forEach((function(t){if(t.isConnected){var e=t.elementSVG.$groupEl;e&&i.appendChild(e)}})),e.appendChild(i)}}},{key:"applyTransform",value:function(t,e){var n="matrix(".concat(yY(e[0]),",").concat(yY(e[1]),",").concat(yY(e[4]),",").concat(yY(e[5]),",").concat(yY(e[12]),",").concat(yY(e[13]),")");n!==t.getAttribute("transform")&&t.setAttribute("transform",n),n===EY.transform&&t.removeAttribute("transform")}},{key:"applyAttributes",value:function(t){var e=t.elementSVG,n=null==e?void 0:e.$el,i=null==e?void 0:e.$groupEl;if(n&&i){var r=t.nodeName,a=t.attributes;r!==kG.HTML&&n.setAttribute("fill","none"),r===kG.IMAGE&&n.setAttribute("preserveAspectRatio","none"),this.updateAttribute(t,Object.keys(a))}}},{key:"updateAttribute",value:function(t,e){var n=this,i=this.context.config.document,r=t.elementSVG,a=r.$el,o=r.$hitTestingEl,s=t.parsedStyle,l=t.nodeName;e.some((function(e){return n.context.SVGElementLifeCycleContribution.shouldUpdateElementAttribute(t,e)}))&&a&&[a,o].forEach((function(e){e&&n.context.SVGElementLifeCycleContribution.updateElementAttribute(t,e,n.svgElementMap)})),e.forEach((function(e){var r,u,c=bY[e],h=s[e],d=!ce(h)&&h.toString(),f=(null===(r=xY[e])||void 0===r?void 0:r[d])||d,p=s[e],g=c&&!(null===(u=RW[e])||void 0===u||!u.inh);if(l===kG.HTML)"fill"===e?a.style.background=p.toString():"stroke"===e?(a.style["border-color"]=p.toString(),a.style["border-style"]="solid"):"lineWidth"===e?a.style["border-width"]="".concat(p||0,"px"):"lineDash"===e?a.style["border-style"]="dashed":"innerHTML"===e?n.createOrUpdateInnerHTML(i,a,p):"width"===e||"height"===e||"class"===e||"x"===e||"y"===e?a.setAttribute(e,p.toString()):ce(t.style[e])||""===t.style[e]||(a.style[e]=t.style[e]);else{if(!c||(l===kG.GROUP||t.isCustomElement)&&(g||"fill"===c||"stroke"===c))return;"fill"===e||"stroke"===e?n.defElementManager.createOrUpdateGradientAndPattern(t,a,p,c,n):"clipPath"===e?n.createOrUpdateClipOrTextPath(i,p,t):"textPath"===e?n.createOrUpdateClipOrTextPath(i,p,t,!0):"shadowType"===e||"shadowColor"===e||"shadowBlur"===e||"shadowOffsetX"===e||"shadowOffsetY"===e?n.defElementManager.createOrUpdateShadow(t,a,e):"filter"===e?n.defElementManager.createOrUpdateFilter(t,a,p):ce(h)||[a,o].forEach((function(t){t&&c&&("unset"!==d&&d!==EY[e]?t.setAttribute(c,f):t.removeAttribute(c))}))}}))}},{key:"createSVGDom",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.elementSVG=new rY;var r=e.elementSVG,a=this.context.SVGElementLifeCycleContribution.createElement(e,this.svgElementMap);if(a){var o,s;e.nodeName===kG.HTML&&(e.parsedStyle.$el=a),this.pluginOptions.outputSVGElementId&&(a.id=this.getId(e)),this.pluginOptions.outputSVGElementName&&e.name&&a.setAttribute("name",e.name),!a.hasAttribute("data-wrapgroup")&&"g"===a.nodeName||i?s=a:(s=aY("g",t)).appendChild(a),r.$el=a,r.$groupEl=s,this.applyAttributes(e),this.createOrUpdateHitArea(e,a,s);var l=n||e.parentNode&&(null===(o=e.parentNode.elementSVG)||void 0===o?void 0:o.$groupEl);l&&(l.appendChild(s),this.pendingReorderQueue.add(e.parentNode))}}},{key:"removeSVGDom",value:function(t){var e,n=null===(e=t.elementSVG)||void 0===e?void 0:e.$groupEl;n&&n.parentNode&&(n.parentNode.removeChild(n),this.context.SVGElementLifeCycleContribution.destroyElement(t,n))}},{key:"createOrUpdateHitArea",value:function(t,e,n){var i=t.elementSVG,r=i.$hitTestingEl,a=Number(t.parsedStyle.increasedLineWidthForHitTesting);if(a){if(!r){r=e.cloneNode(),["filter"].forEach((function(t){r.removeAttribute(t)}));var o="none"!==e.getAttribute("fill");r.setAttribute("fill",o?"transparent":"none"),r.setAttribute("stroke","transparent"),n.appendChild(r),i.$hitTestingEl=r,this.svgElementMap.set(r,t)}r.setAttribute("stroke-width","".concat(a+t.parsedStyle.lineWidth))}else r&&(n.removeChild(r),i.$hitTestingEl=null)}},{key:"createOrUpdateInnerHTML",value:function(t,e,n){var i=(t||document).createElement("div");"string"==typeof n?i.innerHTML=n:i.appendChild(n),e.innerHTML="",e.appendChild(i)}},{key:"createOrUpdateClipOrTextPath",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=n.elementSVG.$groupEl,a=i?"g":"clipPath",o=i?"text-path":"clip-path";if(e){var s="".concat((i?MY:kY)+e.entity,"-").concat(n.entity),l=this.defElementManager.getDefElement();if(!l.querySelector("#".concat(s))){var u;if(i)this.createSVGDom(t,e,null,!0),u=e.elementSVG.$el;else{e.isConnected||l.querySelector("#".concat(this.getId(e)))||this.createSVGDom(t,e,l,!0),u=aY(a,t);var c=aY("use",t);c.setAttribute("href","#".concat(e.elementSVG.$el.id)),u.appendChild(c);var h=this.clipPathUseMap.get(e);h||(this.clipPathUseMap.set(e,[]),h=this.clipPathUseMap.get(e)),h.push(c),this.applyTransform(c,e.getWorldTransform());var d=nt(q(),n.getWorldTransform());this.applyTransform(u,d)}this.pluginOptions.outputSVGElementId&&(u.id=s),l.appendChild(u)}this.applyAttributes(e),i||r.setAttribute(o,"url(#".concat(s,")"))}else i||r.removeAttribute(o)}}])}();SY.tag="SVGRenderer";var NY,TY={top:"hanging",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",ideographic:"ideographic",hanging:"hanging"},AY=(a(a(a(a(a(a(a(a(a(a(NY={},kG.RECT,"path"),kG.CIRCLE,"circle"),kG.ELLIPSE,"ellipse"),kG.IMAGE,"image"),kG.GROUP,"g"),kG.LINE,"line"),kG.POLYLINE,"polyline"),kG.POLYGON,"polygon"),kG.TEXT,"text"),kG.PATH,"path"),a(NY,kG.HTML,"foreignObject")),OY=a(a(a(a(a(a(a(a(a({},kG.CIRCLE,["cx","cy","r"]),kG.ELLIPSE,["cx","cy","rx","ry"]),kG.RECT,["x","y","width","height","radius"]),kG.IMAGE,["x","y","src","width","height"]),kG.LINE,["x1","y1","x2","y2","markerStart","markerEnd","markerStartOffset","markerEndOffset"]),kG.POLYLINE,["points","markerStart","markerEnd","markerMid","markerStartOffset","markerEndOffset"]),kG.POLYGON,["points","markerStart","markerEnd","markerMid","markerStartOffset","markerEndOffset"]),kG.PATH,["d","markerStart","markerEnd","markerMid","markerStartOffset","markerEndOffset"]),kG.TEXT,["text","font","fontSize","fontFamily","fontStyle","fontWeight","fontVariant","lineHeight","letterSpacing","wordWrap","wordWrapWidth","maxLines","leading","textBaseline","textAlign","textTransform","textOverflow","textPath","textPathSide","textPathStartOffset","textDecorationLine","textDecorationColor","textDecorationStyle","dx","dy"]),PY=function(){return c((function t(e,n){l(this,t),this.context=e,this.runtime=n}),[{key:"createElement",value:function(t,e){var n=this.context.config.document,i=aY(AY[t.nodeName]||"g",n||document);return e.set(i,t),i}},{key:"destroyElement",value:function(t,e){}},{key:"shouldUpdateElementAttribute",value:function(t,e){var n=t.nodeName;return(OY[n]||[]).indexOf(e)>-1}},{key:"updateElementAttribute",value:function(t){var e=t.elementSVG.$el,n=t.nodeName,i=t.parsedStyle;switch(n){case kG.IMAGE:!function(t,e){var n=e.src,i=void 0===n?"":n,r=e.x,a=void 0===r?0:r,o=e.y,s=void 0===o?0:o,l=e.width,u=e.height;if(t.setAttribute("x","".concat(a)),t.setAttribute("y","".concat(s)),he(i))t.setAttribute("href",i);else if(i instanceof Image)l||t.setAttribute("width","".concat(i.width)),u||t.setAttribute("height","".concat(i.height)),t.setAttribute("href",i.src);else if(i instanceof HTMLElement&&he(i.nodeName)&&"CANVAS"===i.nodeName.toUpperCase())t.setAttribute("href",i.toDataURL());else if(i instanceof ImageData){var c=document.createElement("canvas");c.setAttribute("width","".concat(i.width)),c.setAttribute("height","".concat(i.height));var h=c.getContext("2d");h&&(h.putImageData(i,0,0),l||t.setAttribute("width","".concat(i.width)),u||t.setAttribute("height","".concat(i.height)),t.setAttribute("href",c.toDataURL()))}}(e,i);break;case kG.RECT:!function(t,e){var n=e.radius,i=e.x,r=void 0===i?0:i,a=e.y,o=void 0===a?0:a,s=e.width,l=e.height;if(isFinite(s)&&isFinite(l)){var u="";if(n&&n.some((function(t){return 0!==t}))){var c=b(n.map((function(t){return de(t,0,Math.min(Math.abs(s)/2,Math.abs(l)/2))})),4),h=c[0],d=c[1],f=c[2],p=c[3],g=s>0?1:-1,v=l>0?1:-1,y=g+v!==0?1:0;u=[["M ".concat(g*h+r,",").concat(o)],["l ".concat(s-g*(h+d),",0")],["a ".concat(d,",").concat(d,",0,0,").concat(y,",").concat(g*d,",").concat(v*d)],["l 0,".concat(l-v*(d+f))],["a ".concat(f,",").concat(f,",0,0,").concat(y,",").concat(-g*f,",").concat(v*f)],["l ".concat(g*(f+p)-s,",0")],["a ".concat(p,",").concat(p,",0,0,").concat(y,",").concat(-g*p,",").concat(-v*p)],["l 0,".concat(v*(p+h)-l)],["a ".concat(h,",").concat(h,",0,0,").concat(y,",").concat(g*h,",").concat(-v*h)],["z"]].join(" ")}else u="M ".concat(r,",").concat(o," l ").concat(s,",0 l 0,").concat(l," l").concat(-s," 0 z");t.setAttribute("d",u)}}(e,i);break;case kG.LINE:!function(t,e){var n,i,r=e.x1,a=e.y1,o=e.x2,s=e.y2,l=e.markerStart,u=e.markerEnd,c=e.markerStartOffset,h=e.markerEndOffset,d=0,f=0,p=0,g=0,v=0;l&&PH(l)&&c&&(n=o-r,i=s-a,v=Math.atan2(i,n),d=Math.cos(v)*(c||0),f=Math.sin(v)*(c||0)),u&&PH(u)&&h&&(n=r-o,i=a-s,v=Math.atan2(i,n),p=Math.cos(v)*(h||0),g=Math.sin(v)*(h||0)),t.setAttribute("x1","".concat(r+d)),t.setAttribute("y1","".concat(a+f)),t.setAttribute("x2","".concat(o+p)),t.setAttribute("y2","".concat(s+g))}(e,i);break;case kG.POLYGON:case kG.POLYLINE:!function(t,e){var n=e.points.points,i=e.markerStart,r=e.markerStartOffset,a=e.markerEnd,o=e.markerEndOffset,s=n.length;if(n&&s>=2){var l,u,c=0,h=0,d=0,f=0,p=0;i&&PH(i)&&r&&(l=n[1][0]-n[0][0],u=n[1][1]-n[0][1],p=Math.atan2(u,l),c=Math.cos(p)*(r||0),h=Math.sin(p)*(r||0)),a&&PH(a)&&o&&(l=n[s-2][0]-n[s-1][0],u=n[s-2][1]-n[s-1][1],p=Math.atan2(u,l),d=Math.cos(p)*(o||0),f=Math.sin(p)*(o||0)),t.setAttribute("points",n.map((function(t,e){var n=0,i=0;return 0===e?(n=c,i=h):e===s-1&&(n=d,i=f),"".concat(t[0]+n,",").concat(t[1]+i)})).join(" "))}}(e,i);break;case kG.PATH:!function(t,e){var n,i,r=e.d,a=e.markerStart,o=e.markerEnd,s=e.markerStartOffset,l=e.markerEndOffset,u=0,c=0,h=0,d=0,f=0;if(a&&PH(a)&&s){var p=b(a.parentNode.getStartTangent(),2),g=p[0],v=p[1];n=g[0]-v[0],i=g[1]-v[1],f=Math.atan2(i,n),u=Math.cos(f)*(s||0),c=Math.sin(f)*(s||0)}if(o&&PH(o)&&l){var y=b(o.parentNode.getEndTangent(),2),m=y[0],x=y[1];n=m[0]-x[0],i=m[1]-x[1],f=Math.atan2(i,n),h=Math.cos(f)*(l||0),d=Math.sin(f)*(l||0)}t.setAttribute("d",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=t.map((function(a,o){var s=a[0],l=t[o+1],u=0===o&&(0!==e||0!==n),c=(o===t.length-1||l&&("M"===l[0]||"Z"===l[0]))&&0!==i&&0!==r,h=b(u?[e,n]:[0,0],2),d=h[0],f=h[1],p=b(c?[i,r]:[0,0],2),g=p[0],v=p[1];switch(s){case"M":return"M ".concat(a[1]+d,",").concat(a[2]+f);case"L":return"L ".concat(a[1]+g,",").concat(a[2]+v);case"Q":return"Q ".concat(a[1]," ").concat(a[2],",").concat(a[3]+g," ").concat(a[4]+v);case"C":return"C ".concat(a[1]," ").concat(a[2],",").concat(a[3]," ").concat(a[4],",").concat(a[5]+g," ").concat(a[6]+v);case"A":return"A ".concat(a[1]," ").concat(a[2]," ").concat(a[3]," ").concat(a[4]," ").concat(a[5]," ").concat(a[6]," ").concat(a[7]).concat(c?" L ".concat(a[6]+i,",").concat(a[7]+r):"");case"Z":return"Z";default:return null}})).filter((function(t){return null!==t})).join(" ");return~a.indexOf("NaN")?"":a}(r.absolutePath,u,c,h,d))}(e,i);break;case kG.TEXT:!function(t,e,n){n.getBounds();var i=e.lineWidth,r=void 0===i?1:i,a=e.x,o=void 0===a?0:a,s=e.y,l=void 0===s?0:s,u=e.dx,c=void 0===u?0:u,h=e.dy,d=void 0===h?0:h,f=e.textPath,p=e.textPathSide,g=void 0===p?"left":p,v=e.textPathStartOffset,y=void 0===v?0:v,m=e.textDecorationLine,b=void 0===m?"":m,x=e.textDecorationColor,E=void 0===x?"":x,w=e.textDecorationStyle,k=void 0===w?"":w,M=e.metrics,S=e.textBaseline,N=void 0===S?"alphabetic":S;"alphabetic"===N&&(N="bottom"),t.setAttribute("dominant-baseline",TY[N]),t.setAttribute("paint-order","stroke");var T=M.lines,A=M.lineHeight,O=M.height,P=T.length,C="transform:translate(".concat(c,"px, ").concat(d,"px);");if(b&&"none"!==b&&(C+="text-decoration:".concat(b," ").concat(k," ").concat(E,";")),C&&t.setAttribute("style",C),0!==o&&t.setAttribute("x","".concat(o)),0!==l&&t.setAttribute("y","".concat(l)),1===P){var R=mY(T[0]);if(t.setAttribute("dx","".concat(r/2)),"bottom"===N||"top"===N?(t.setAttribute("dominant-baseline",TY.middle),t.setAttribute("dy","bottom"===N?"-".concat(O/2,"px"):"".concat(O/2,"px"))):t.setAttribute("dy","0px"),f){t.innerHTML="";var L=aY("textPath",t.ownerDocument);L.setAttribute("href","#".concat(MY+f.entity)),"left"!==g&&L.setAttribute("side",g),0!==y&&L.setAttribute("startOffset","".concat(y)),L.innerHTML=R,t.appendChild(L)}else t.innerHTML=R}else t.innerHTML=T.map((function(t,e){var n=r/2,i=0;return 0===e?"middle"===N?i=A/2-O/2:"top"===N||"hanging"===N?i=0:"bottom"!==N&&"ideographic"!==N||(i=-A*(P-1)):i=A,"<tspan x=".concat(o,' dx="').concat(n,'" dy="').concat(i,'">').concat(mY(t),"</tspan>")})).join("")}(e,i,t,this.runtime)}}}])}(),CY=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),(t=v(this,e)).name="svg-renderer",t.options=n,t}return m(e,t),c(e,[{key:"init",value:function(t){var e=this.options,n=e.outputSVGElementId,i=e.outputSVGElementName,r=new vY(this.context),a=new PY(this.context,t);this.context.defaultElementLifeCycleContribution=a,this.context.SVGElementLifeCycleContribution=a;var o={outputSVGElementId:!!ce(n)||!!n,outputSVGElementName:!!ce(i)||!!i};this.addRenderingPlugin(new SY(o,r,this.context))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultElementLifeCycleContribution,delete this.context.SVGElementLifeCycleContribution}}])}(SG),RY=["offset","composite","computedOffset","easing"],LY=["offset","composite","computedOffset","easing","transformOrigin"],DY=["offset","composite","computedOffset","easing","transformOrigin"],IY=["offset","composite","computedOffset","easing","transformOrigin"],_Y=function(){return c((function t(e){l(this,t),this.context=e,this.canvasConfig=e.config}),[{key:"init",value:function(){var t=this.canvasConfig,e=t.container,n=t.document,i=t.devicePixelRatio;if(this.$container=he(e)?(n||document).getElementById(e):e,this.$container){this.$container.style.position||(this.$container.style.position="relative");var r=aY("svg",n);r.setAttribute("width","".concat(this.canvasConfig.width)),r.setAttribute("height","".concat(this.canvasConfig.height)),this.$container.appendChild(r),this.$namespace=r}this.dpr=i}},{key:"getDomElement",value:function(){return this.$namespace}},{key:"getContext",value:function(){return this.$namespace}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){var t;return null===(t=this.$namespace)||void 0===t?void 0:t.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$namespace&&this.$namespace.parentNode&&this.$container.removeChild(this.$namespace)}},{key:"resize",value:function(t,e){this.$namespace&&(this.$namespace.setAttribute("width","".concat(t)),this.$namespace.setAttribute("height","".concat(e)))}},{key:"applyCursorStyle",value:function(t){this.$container&&(this.$container.style.cursor=t)}},{key:"generateCSSText",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=i.duration,o=i.easing,s=i.delay,l=i.direction,u=i.iterations,c=i.fill;return"@keyframes ".concat(t,"{").concat(n.map((function(t){t.offset,t.composite;var e=t.computedOffset;t.easing;var n=zn(t,RY),i=Object.keys(n).map((function(t){return"".concat(t,":").concat(r[t]||"").concat(n[t],";")})).join("");return"".concat(100*e,"%{").concat(i,"}")})).join(""),"}")+"".concat(e," {animation: ").concat(t," ").concat(a,"ms ").concat(o," ").concat(s,"ms ").concat(u===1/0?"infinite":u," ").concat(l," ").concat(c,";}")}},{key:"toDataURL",value:(t=jn(Bn().mark((function t(){var e,n,i,r,a,o,s=this;return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.$namespace.cloneNode(!0),n=this.canvasConfig.document,i=0,r=null,this.context.renderingContext.root.forEach((function(t){var a=t.getAnimations();if(a.length){r||(r=(n||document).createElement("style"),e.appendChild(r));var o=t.elementSVG,l="#".concat(o.$el.id),u="#".concat(o.$groupEl.id),c="",h="";a.forEach((function(t){var e=t.effect.getKeyframes();if(e.length){var n=[],r=[],a=e[0];a.offset,a.composite,a.computedOffset,a.easing,a.transformOrigin;var d=zn(a,LY);if(Object.keys(d).forEach((function(t){var e;"transform"===t&&r.push(t),null!==(e=mR[t])&&void 0!==e&&e.inh?r.push(t):"transform"!==t&&n.push(t)})),r.length){var f=e.map((function(t){var e=t.offset,n=t.composite,i=t.computedOffset,a=t.easing;t.transformOrigin;var o=zn(t,DY),s={offset:e,composite:n,computedOffset:i,easing:a};return Object.keys(o).forEach((function(e){r.includes(e)&&(s[e]=t[e])})),s}));h+=s.generateCSSText("a".concat(i++),u,f,t.effect.getComputedTiming(),{transform:o.$groupEl.getAttribute("transform")})}if(n.length){var p=e.map((function(t){var e=t.offset,i=t.composite,r=t.computedOffset,a=t.easing;t.transformOrigin;var o=zn(t,IY),s={offset:e,composite:i,computedOffset:r,easing:a};return Object.keys(o).forEach((function(e){n.includes(e)&&(s[e]=t[e])})),s}));c+=s.generateCSSText("a".concat(i++),l,p,t.effect.getComputedTiming())}}})),r.textContent+=c+h}})),a=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),(o=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",a)).replaceChild(e,o.documentElement),t.abrupt("return","data:image/svg+xml;charset=utf8,".concat(encodeURIComponent((new XMLSerializer).serializeToString(o))));case 1:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})}]);var t}(),BY=function(t){function e(){var t;l(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=v(this,e,[].concat(i))).name="svg-context-register",t}return m(e,t),c(e,[{key:"init",value:function(){this.context.ContextService=_Y}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(dO),FY=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),(t=v(this,e,[n])).registerPlugin(new BY),t.registerPlugin(new CY({outputSVGElementId:n.outputSVGElementId})),t.registerPlugin(new WD),t.registerPlugin(new wG),t}return m(e,t),c(e)}(fO);"undefined"!=typeof window&&(window.SVGRenderer=FY);const jY=[{name:"circle",cls:HA},{name:"rect",cls:YA},{name:"ellipse",cls:$A},{name:"diamond",cls:XA},{name:"triangle",cls:qA},{name:"star",cls:KA},{name:"hexagon",cls:ZA},{name:"image",cls:QA},{name:"donut",cls:JA}];iT(hc.EDGE,"ant-line",class extends Rg{onCreate(){this.shapeMap.key.animate([{lineDashOffset:-20},{lineDashOffset:0}],{duration:500,iterations:1/0})}}),iT(hc.EDGE,"fly-marker-cubic",class extends Og{getMarkerStyle(t){return{r:5,fill:"#000",offsetPath:this.shapeMap.key,...Gd(t,"marker")}}onCreate(){this.upsert("marker",ml,this.getMarkerStyle(this.attributes),this).animate([{offsetDistance:0},{offsetDistance:1}],{duration:3e3,iterations:1/0})}}),iT(hc.COMBO,"circle-combo-with-extra-button",iO),iT(hc.COMBO,"rect-combo-with-extra-button",rO),iT(hc.BEHAVIOR,"create-edge",class extends dv{isCreatingEdge=!1;snappedPort=null;snappedPortOriginalStyle=null;_resetSnappedPortTimeout=null;_processingPointerDown=!1;_processingPointerUp=!1;validate(t){return!0}bindEvents(){const t=this.context.graph,e=this.options.trigger;this.unbindEvents(),"click"===e?(t.on(lc.CLICK,this.customHandleCreateEdge.bind(this)),t.on(nc.CLICK,this.customHandleCreateEdge.bind(this)),t.on(ec.CLICK,this.cancelEdge.bind(this)),t.on(ac.CLICK,this.cancelEdge.bind(this))):(t.on(lc.POINTER_DOWN,this.customHandleCreateEdge.bind(this)),t.on(nc.POINTER_DOWN,this.customHandleCreateEdge.bind(this)),t.on(ic.POINTER_UP,this.customDrop.bind(this))),t.on(ic.POINTER_MOVE,this.customUpdateAssistEdge.bind(this))}isValidTargetPort(t,e){if(!t||!t.key)return!1;if(!this.sourcePort)return!1;if(!t.attributes?.class?.includes("port"))return!1;if(e===this.source)return!1;if(this.sourcePort.attributes?.type===t.attributes?.type)return!1;const n=CA(this.context.graph,e);return!((n?.[t.key]??0)>=("Infinity"===t.attributes?.arity?1/0:t.attributes?.arity||1))}resetSnappedPort(){try{this.snappedPort&&this.snappedPortOriginalStyle&&this.snappedPort.attr({r:this.snappedPortOriginalStyle.r,stroke:this.snappedPortOriginalStyle.stroke,lineWidth:this.snappedPortOriginalStyle.lineWidth,shadowBlur:this.snappedPortOriginalStyle.shadowBlur||0,shadowColor:this.snappedPortOriginalStyle.shadowColor||"transparent",visibility:this.snappedPortOriginalStyle.visibility,fill:this.snappedPortOriginalStyle.fill})}catch(t){}this.snappedPort=null,this.snappedPortOriginalStyle=null}customUpdateAssistEdge(t){if(!this.source)return;const{graph:e}=this.context,n=t.originalTarget,i=t.target?.id,r=this.isValidTargetPort(n,i);if(r&&n!==this.snappedPort){this._resetSnappedPortTimeout&&(clearTimeout(this._resetSnappedPortTimeout),this._resetSnappedPortTimeout=null),this.resetSnappedPort(),this.snappedPort=n,this.snappedPortOriginalStyle={r:n.attr("r"),stroke:n.attr("stroke"),lineWidth:n.attr("lineWidth"),shadowBlur:n.attr("shadowBlur"),shadowColor:n.attr("shadowColor"),visibility:n.attr("visibility"),fill:n.attr("fill")};const t=e.getElementData(i),r=t?.style?.ports||[],a=(Array.isArray(r)?r:Object.values(r)).find((t=>t?.fill)),o=a?.fill||"#6B7280";try{const t=this.snappedPortOriginalStyle.r||10;n.attr({visibility:"visible",fill:"transparent",stroke:o,lineWidth:3,r:t-2})}catch(t){}const s=n.getBounds();if(s){const t=(s.min[0]+s.max[0])/2,n=(s.min[1]+s.max[1])/2;return e.updateNodeData([{id:uO,style:{x:t,y:n}}]),void e.draw()}}else!r&&this.snappedPort&&(this._resetSnappedPortTimeout||(this._resetSnappedPortTimeout=setTimeout((()=>{this.resetSnappedPort(),this._resetSnappedPortTimeout=null}),100)));this.updateAssistEdge(t)}async customDrop(t){if(this._processingPointerUp)return;this._processingPointerUp=!0,setTimeout((()=>{this._processingPointerUp=!1}),0),this._resetSnappedPortTimeout&&(clearTimeout(this._resetSnappedPortTimeout),this._resetSnappedPortTimeout=null),this.resetSnappedPort();const{graph:e}=this.context,n=e.options.mode,i=t.targetType,r=this.sourcePort,a=t.originalTarget;if(e.updateBehavior([{key:"drag-element",enable:!0},{key:"drag-element-force",enable:!0}]),-1!==["node","combo","canvas"].indexOf(i)&&this.source){const o=this.startX??0,s=this.startY??0,l=(t.canvas?.x??t.client?.x??0)-o,u=(t.canvas?.y??t.client?.y??0)-s;if(Math.sqrt(l*l+u*u)<10)return this.isCreatingEdge=!1,void await this.cancelEdge();if(t.target&&t.target.id===this.source)return void await this.cancelEdge();if("canvas"===i){const{style:t,onFinish:n,onCreate:i}=this.options,a=this.source,o=r?.key,s={id:`${a}-canvas-${uv()}`,source:a,target:uO,targetType:"canvas",style:Object.assign({},t,{sourcePort:o,portType:r?.attributes.type})},l="function"==typeof i?i(s):s;l&&"function"==typeof n&&n(l),this.isCreatingEdge=!1,this.source=void 0,this.sourcePort=null;try{e.removeEdgeData([lO]),e.removeNodeData([uO]),await e.draw()}catch(t){}return}const c=this.context.graph.getElementData(t.target?.id);if(c?.style?.ports?.length>0){if(!a?.attributes?.class?.includes("port"))return"dev"===n&&OA("Please release the connecting edge on a port.","warning",5e3),void await this.cancelEdge();if(r?.attributes?.type&&a?.attributes?.type&&r.attributes.type===a.attributes.type)return"dev"===n&&OA("Edge creation failed: source and target ports must be of different types.","warning",5e3),void await this.cancelEdge();const e=CA(this.context.graph,t.target?.id);if((e?.[a.key]??0)>=("Infinity"===a.attributes.arity?1/0:a.attributes.arity))return"dev"===n&&OA("Target port has reached its maximum arity, can't connect.","warning",5e3),void await this.cancelEdge()}await this.customCreateEdge(t)}else await this.cancelEdge()}async customCreateEdge(t){const{graph:e}=this.context,{style:n,onFinish:i,onCreate:r}=this.options,a=t.target?.id;if(void 0===a||void 0===this.source)return;const o=this.getSelectedNodeIDs([t.target.id])?.[0];if(o===this.source)return void await this.cancelEdge();const s=this.sourcePort,l=t.originalTarget;if(s&&l&&"hidden"==l?.attributes?.visibility)return void await this.cancelEdge();const u=Object.assign({},n,s?{sourcePort:s.key}:{},l?{targetPort:l.key}:{}),c={id:`${this.source}-${o}-${uv()}`,source:this.source,targetType:t.targetType,target:o,style:u},h="function"==typeof r?r(c):c;h&&(e.addEdgeData([h]),"function"==typeof i&&i(h)),this.isCreatingEdge=!1,this.source=void 0,this.sourcePort=null;try{e.removeEdgeData([lO]),e.removeNodeData([uO]),await e.draw()}catch(t){}}async customHandleCreateEdge(t){const e=this.options.enable;if("function"==typeof e){if(!e(t))return}else if(!e)return;if(this._processingPointerDown)return;this._processingPointerDown=!0,setTimeout((()=>{this._processingPointerDown=!1}),0),this.isCreatingEdge&&!this.source&&(this.isCreatingEdge=!1),this.startX=t.canvas.x,this.startY=t.canvas.y;const{graph:n,canvas:i,batch:r}=this.context,a=n.options.mode,o=n.getElementData(t.target?.id);let s=o?.style?.ports?.length>0;if(s){const e=t.originalTarget;if(!e||!e.key)return;if(this.sourcePort=e,(CA(n,o.id)[this.sourcePort.key]||0)>=this.sourcePort.arity)return"dev"===a&&OA("Current port has reached its maximum arity, can't drag.","warning",5e3),void(this.sourcePort=null);this.isCreatingEdge=!0;try{n.updateBehavior([{key:"drag-element",enable:!1},{key:"drag-element-force",enable:!1}])}catch(t){}}else this.sourcePort=null;if(!this.validate(t))return;const{style:l}=this.options;if(this.source)return void await this.customCreateEdge(t);r&&r.startBatch(),i&&i.setCursor("crosshair");const u=this.getSelectedNodeIDs([t.target.id]);this.source=u&&u[0];const c=n.getElementData(this.source),h=t.canvas?.x??(c?.style?.x||0),d=t.canvas?.y??(c?.style?.y||0);n.addNodeData([{id:uO,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:h,y:d}}]);const f=Object.assign({pointerEvents:"none",zIndex:n.options.edge.style.zIndex},s&&this.sourcePort?{sourcePort:this.sourcePort.key}:{},l||{});n.addEdgeData([{id:lO,source:this.source,target:uO,style:f}]),await n.draw()}}),jY.forEach((({name:t,cls:e})=>{iT(hc.NODE,`custom-${t}-node`,e)})),HTMLWidgets.widget({name:"g6",type:"output",factory:function(t,e,n){return{renderValue:function(e){let n=e;n.container=t.id,(t=>{const e=[];e.push(t),e.map((t=>{let e=document.createElement("script");e.src=t,document.head.appendChild(e)}))})(n.iconsUrl),((t,e)=>{AA((()=>{const n=n=>{t.data=(t=>{let e=[];t.nodes&&(e=t.nodes.map((t=>("string"!=typeof t.id&&(t.id=t.id.toString()),null!=t.combo&&"string"!=typeof t.combo&&(t.combo=t.combo.toString()),t.style&&Array.isArray(t.style.ports)&&t.style.ports.forEach((e=>{e.key.startsWith(t.id+"-")||(e.key=`${t.id}-${e.key}`)})),t.id))));let n=[];t.edges&&(n=t.edges.map((t=>("string"!=typeof t.source&&(t.source=t.source.toString()),"string"!=typeof t.target&&(t.target=t.target.toString()),null==t.id&&(t.id=`${t.source}-${t.target}`),t.style&&(t.style.sourcePort&&t.source&&(t.style.sourcePort.startsWith(t.source+"-")||(t.style.sourcePort=`${t.source}-${t.style.sourcePort}`)),t.style.targetPort&&t.target&&(t.style.targetPort.startsWith(t.target+"-")||(t.style.targetPort=`${t.target}-${t.style.targetPort}`))),t.id))));let i=[];t.combos&&(i=t.combos.map((t=>("string"!=typeof t.id&&(t.id=t.id.toString()),t.id))));const r=e.concat(n).concat(i),a=new Set(r);if(r.length!==a.size)throw OA("Cannot initialize graph. Duplicated IDs found."),new Error("Invalid graph data: execution aborted");return t})((t=>{const e=(t,n=!1)=>t?Object.values(t).map((t=>(t.style&&t.style.ports&&!Array.isArray(t.style.ports)&&(t.style.ports=e(t.style.ports,!0)),t))):[],n={};return t.nodes&&!Array.isArray(t.nodes)?n.nodes=e(t.nodes):t.nodes&&(n.nodes=t.nodes),t.edges&&!Array.isArray(t.edges)?n.edges=e(t.edges):t.edges&&(n.edges=t.edges),t.combos&&!Array.isArray(t.combos)?n.combos=e(t.combos):t.combos&&(n.combos=t.combos),n})(n)),LA=new pA(t),RA(LA,e,t)};null!==t.jsonUrl?fetch(t.jsonUrl).then((t=>t.json())).then((t=>{n(t)})).catch((e=>{throw"dev"===t.mode&&OA(`Failed to fetch JSON: ${e}`,"error"),e})):n(t.data)}),t.mode)})(n,this)},getWidget:function(){return DA()},resize:function(t,e){DA()&&DA().resize()}}}})})()})();